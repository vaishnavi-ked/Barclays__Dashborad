{"version":3,"file":"stock.js","mappings":"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","sources":["webpack://@amcharts/amcharts5/./src/.internal/charts/stock/PanelControls.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/StockIcons.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/StockChartDefaultTheme.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/StockControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/Dropdown.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DropdownColors.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/StockToolbarCSS.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/ColorControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/SettingsModal.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/StockChart.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/Indicator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/StockLegend.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/StockPanel.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/ChartIndicator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/OverboughtOversold.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MovingAverage.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/Momentum.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/VWAP.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MovingAverageEnvelope.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MovingAverageDeviation.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/AccelerationBands.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/BollingerBands.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/RelativeStrengthIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/AccumulationDistribution.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/AccumulativeSwingIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/Aroon.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MACD.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MACross.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/ChaikinMoneyFlow.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/ChaikinOscillator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/BullBearPower.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/OnBalanceVolume.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/PVT.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/StochasticOscillator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/StochasticMomentumIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/AwesomeOscillator.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/WilliamsR.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/Volume.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/VolumeProfile.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/CommodityChannelIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/DisparityIndex.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/StandardDeviation.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/TypicalPrice.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/Trix.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/MedianPrice.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/ZigZag.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/indicators/AverageTrueRange.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/DrawingSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/PolylineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/SimpleLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/RectangleSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/ParallelChannelSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/LineArrowSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/HorizontalLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/VerticalLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/AverageSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/RegressionSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/DoodleSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/IconSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/LabelSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/CalloutSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/EllipseSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/TrendLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/QuadrantLineSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/FibonacciSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/FibonacciTimezoneSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/HorizontalRaySeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/drawing/Measure.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/StockToolbar.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DropdownList.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DrawingToolControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DropdownListControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DropdownControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/IconControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DrawingControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/IndicatorControl.ts","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/types/options.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/l10n/default.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/index.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/dom.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/formatting.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/dates.js","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/index.js","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DateRangeSelector.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/PeriodSelector.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/SeriesTypeControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/IntervalControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/ResetControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/DataSaveControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/SettingsControl.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/stock/toolbar/ComparisonControl.ts","webpack://@amcharts/amcharts5/./node_modules/flatpickr/dist/esm/utils/polyfills.js","webpack://@amcharts/amcharts5/./tmp/webpack/stock.js"],"sourcesContent":["import type { StockChart } from \"./StockChart\";\r\nimport type { StockPanel } from \"./StockPanel\";\r\n\r\nimport { Container, IContainerPrivate, IContainerSettings } from \"../../core/render/Container\";\r\nimport { Button } from \"../../core/render/Button\";\r\nimport { Graphics } from \"../../core/render/Graphics\";\r\n\r\nexport interface IPanelControlsSettings extends IContainerSettings {\r\n\r\n\t/**\r\n\t * A target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * A target [[StockPanel]].\r\n\t */\r\n\tstockPanel: StockPanel\r\n\r\n}\r\n\r\nexport interface IPanelControlsPrivate extends IContainerPrivate {\r\n\r\n}\r\n\r\n/**\r\n * Creates a button set for [[StockChart]] panels (move up/down, close, etc.)\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/panels/#Panel_controls} for more info\r\n */\r\nexport class PanelControls extends Container {\r\n\r\n\tdeclare public _settings: IPanelControlsSettings;\r\n\tdeclare public _privateSettings: IPanelControlsPrivate;\r\n\r\n\tpublic static className: string = \"PanelControls\";\r\n\tpublic static classNames: Array<string> = Container.classNames.concat([PanelControls.className]);\r\n\r\n\t/**\r\n\t * A [[Button]] which moves panel up.\r\n\t *\r\n\t * @default Button.new()\r\n\t */\r\n\tpublic upButton = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"up\", \"control\", \"panel\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t})\r\n\t}))\r\n\r\n\t/**\r\n\t * A [[Button]] which moves panel down.\r\n\t *\r\n\t * @default Button.new()\r\n\t */\r\n\tpublic downButton = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"down\", \"control\", \"panel\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t})\r\n\t}))\r\n\r\n\t/**\r\n\t * A [[Button]] which expands/collapses the panel.\r\n\t *\r\n\t * @default Button.new()\r\n\t */\r\n\tpublic expandButton = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"expand\", \"control\", \"panel\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t})\r\n\t}))\r\n\r\n\t/**\r\n\t * A [[Button]] which closes the panel.\r\n\t *\r\n\t * @default Button.new()\r\n\t */\r\n\tpublic closeButton = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"close\", \"control\", \"panel\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t})\r\n\t}))\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\r\n\t\tconst upButton = this.upButton;\r\n\t\tconst downButton = this.downButton;\r\n\r\n\t\tdownButton.events.on(\"click\", () => {\r\n\t\t\tconst stockPanel = this.get(\"stockPanel\");\r\n\t\t\tstockPanel.moveDown();\r\n\t\t});\r\n\r\n\t\tupButton.events.on(\"click\", () => {\r\n\t\t\tconst stockPanel = this.get(\"stockPanel\");\r\n\t\t\tstockPanel.moveUp();\r\n\t\t});\r\n\r\n\t\tthis.closeButton.events.on(\"click\", () => {\r\n\t\t\tconst stockPanel = this.get(\"stockPanel\");\r\n\t\t\tstockPanel.close();\r\n\t\t});\r\n\r\n\t\tthis.expandButton.events.on(\"click\", () => {\r\n\t\t\tconst stockPanel = this.get(\"stockPanel\");\r\n\t\t\tstockPanel.expand();\r\n\t\t});\r\n\r\n\t}\r\n}\r\n","export interface StockIcon {\r\n\tviewbox: string;\r\n\tpath: string;\r\n\tstyle?: string;\r\n}\r\n\r\n/**\r\n * A collection of icons used in [[StockChart]].\r\n */\r\nexport class StockIcons {\r\n\tpublic static icons: { [index: string]: StockIcon } = {\r\n\t\t// Misc\r\n\t\t\"Default\": { viewbox: \"0 0 50 50\", path: \"M 25 10 L 25 40 M 10 25 L 41 25\" },\r\n\t\t\"Indicator\": { viewbox: \"0 0 50 50\", path: \"M 2 10 C 28 27 31 1 48 11 M 1 49 C 24 22 25 38 48 44 M 3 25 L 48 25 L 41 19 M 48 25 L 41 31\" },\r\n\t\t\"Color\": { viewbox: \"0 0 50 50\", path: \"\" },\r\n\t\t\"Dash\": { viewbox: \"0 0 60 16\", path: \"M0,8 60,8\" },\r\n\r\n\t\t\"Calendar\": { viewbox: \"0 0 50 50\", path: \"M 3 8 L 47 8 L 47 48 L 3 48 L 3 8 M 3 19 L 47 19 M 9 28 L 15 28 M 22 28 L 28 28 M 35 28 L 41 28 M 9 39 L 15 39 M 22 39 L 28 39 M 35 39 L 41 39 M 12 14 L 12 1 M 38 14 L 38 1\" },\r\n\t\t\"Period\": { viewbox: \"0 0 50 50\", path: \"M 3 3 L 47 3 L 47 48 L 3 48 L 3 3 M 3 12 L 47 12 M 9 21 L 15 21 M 22 21 L 28 21 M 35 21 L 41 21 M 9 30 L 15 30 M 22 30 L 28 30 M 35 30 L 41 30 M 9 39 L 15 39 M 22 39 L 28 39 M 35 39 L 41 39\" },\r\n\t\t\"Interval\": { viewbox: \"0 0 50 50\", path: \"M 3 10 L 3 48 M 3 10 L 43 10 M 13 10 L 13 36 M 23 10 L 23 36 M 43 10 L 43 48 M 33 10 L 33 36\" },\r\n\t\t\"Comparison\": { viewbox: \"0 0 50 50\", path: \"M 25 10 L 25 40 M 10 25 L 41 25\" },\r\n\t\t\"Settings\": { viewbox: \"0 0 50 50\", path: \"M49,25 L47.6,33.2 L41.3,32.6 L39.7,35.3 L43.4,40.4 L37,45.8 L32.6,41.3 L29.7,42.4 L29.2,48.6 L20.8,48.6 L20.3,42.4 L17.4,41.3 L13,45.8 L6.6,40.4 L10.3,35.3 L8.7,32.6 L2.4,33.2 L1,25 L7.1,23.4 L7.6,20.3 L2.4,16.8 L6.6,9.6 L12.3,12.3 L14.7,10.3 L13,4.2 L20.8,1.4 L23.4,7.1 L26.6,7.1 L29.2,1.4 L37,4.2 L35.3,10.3 L37.7,12.3 L43.4,9.6 L47.6,16.8 L42.4,20.3 L42.9,23.4 L49,25 M 17 25 A 1 1 0 0 0 33 25 A 1 1 0 0 0 17 25\" },\r\n\t\t\"Save\": { viewbox: \"0 0 50 50\", path: \"M47 47 47 15 35 3 3 3 3 47 47 47ZM13 3 13 13 33 13 33 3M9 42 9 25 39 25 39 42 9 42\" },\r\n\r\n\t\t// Chart types\r\n\t\t\"Line Series\": { viewbox: \"0 0 50 50\", path: \"M 3 28 L 14 18 L 25 32 L 36 9 L 47 19\" },\r\n\t\t\"Area Series\": { viewbox: \"0 0 50 50\", path: \"M 3 20 L 14 13 L 25 20.95 L 37 9 L 48 16 L 48 48 M 8 17 L 8 48 M 13 14 L 13 48 M 18 16 L 18 48 M 23 20 L 23 48 M 28 18 L 28 48 M 33 13 L 33 48 M 38 10 L 38 48 M 43 13 L 43 48 M 3 20 L 3 48\" },\r\n\t\t\"Candlestick Series\": { viewbox: \"0 0 50 50\", path: \"M 3 17 L 3 37 L 19 37 M 19 37 L 19 17 L 3 17 M 11 17 L 11 6 M 11 37 L 11 50 M 30 11 L 30 31 L 46 31 L 46 11 L 30 11 M 38 11 L 38 0 M 38 31 L 38 44 M 3 22 L 19 22 M 3 27 L 19 27 M 3 32 L 19 32 M 30 16 L 46 16 M 30 21 L 46 21 M 30 26 L 46 26\" },\r\n\t\t\"Pro Candlestick Series\": { viewbox: \"0 0 50 50\", path: \"M 3 10 L 3 31 L 19 31 M 19 31 L 19 10 L 3 10 M 11 10 L 11 0 M 11 31 L 11 43 M 30 17 L 30 37 L 46 37 L 46 17 L 30 17 M 38 17 L 38 4 M 38 37 L 38 50 M 30 22 L 46 22 M 30 27 L 46 27 M 30 32 L 46 32\" },\r\n\t\t\"OHLC Series\": { viewbox: \"0 0 50 50\", path: \"M 11 31 L 20 31 M 11 3 L 11 43 M 38 5 L 38 50 M 29 36 L 38 36 M 38 12 L 47 12 M 11 17 L 2 17\" },\r\n\r\n\t\t// Drawing tools\r\n\t\t\"Draw\": { viewbox: \"0 0 50 50\", path: \"M 29 2 L 48 21 L 22 47 L 3 47 L 3 28 L 29 2 M 23 8 L 42 27 M 3 42 L 8 47 M 18 39 L 36 21 M 11 32 L 29 14 M 3 28 L 11 32 L 13 38 L 18 39 L 22 47 M 25 6 L 44 25 M 27 4 L 46 23 M 3 44 L 6 47 M 3 40 L 10 47\" },\r\n\t\t\"Average\": { viewbox: \"0 0 50 50\", path: \"M2 24a5 5 0 1 0 10 0 5 5 0 1 0-10 0M12 24h26M38 24a5 5 0 1 0 10 0 5 5 0 1 0-10 0\" },\r\n\t\t\"Callout\": { viewbox: \"0 0 50 50\", path: \"M 3 3 L 47 3 L 47 39 L 31 39 L 25 45 L 19 39 L 3 39 L 3 3 M 11 12 L 39 12 M 11 20 L 39 20 M 11 28 L 39 28\" },\r\n\t\t\"Doodle\": { viewbox: \"0 0 48 48\", path: \"M 43.036,2.509 C 32.59,9.83 8.05,6.67 6.29,15.01 5.19,26.29 34.40,18.9 37.4,27.5 c 1.4,3.78 -4.0,8 -15.7,13.18\" },\r\n\t\t\"Ellipse\": { viewbox: \"0 0 50 50\", path: \"M 25 5 a 22 20 0 1 0 1 0 z\" },\r\n\t\t\"Fibonacci\": { viewbox: \"0 0 50 50\", path: \"M2 3 h46 M2 11.5 h46 M2 24 h46 M2 49 h46\" },\r\n\t\t\"Fibonacci Timezone\": { viewbox: \"0 0 50 50\", path: \"M5 2.5 v46 M13.5 2.5 v46 M26 2.5 v46 M46.5 2.5 v46\" },\r\n\t\t\"Horizontal Line\": { viewbox: \"0 0 50 50\", path: \"M20 24a5 5 0 1 0 10 0 5 5 0 1 0-10 0M2 24h18 M32,24 h18\" },\r\n\t\t\"Horizontal Ray\": { viewbox: \"0 0 50 50\", path: \"M2 24a5 5 0 1 0 10 0 5 5 0 1 0-10 0 M14,24 h36\" },\r\n\t\t\"Arrows &amp; Icons\": { viewbox: \"0 0 50 50\", path: \"M 5 35 L 5 15 L 26 15 M 26 15 L 26 5 L 45 26 L 26 45 L 26 35 L 5 35\" },\r\n\t\t\"Label\": { viewbox: \"0 0 50 50\", path: \"M 10 45 l 15 -32 l 15 32 m -24 -13 l 18 0\", style: \"stroke-width: 1.2px\" },\r\n\t\t\"Line\": { viewbox: \"0 0 50 50\", path: \"M 4 46 L 46 4\" },\r\n\t\t\"Line Arrow\": { viewbox: \"0 0 50 50\", path: \"M 4 46 L 46 4 M 30 4 L 46 4 L 46 20\" },\r\n\t\t\"Polyline\": { viewbox: \"0 0 50 50\", path: \"M 2 15 L 16 42 L 36 22 L 48 29\" },\r\n\t\t\"Polyfill\": { viewbox: \"0 0 50 50\", path: \"M 2 15 L 8 44 L 20 26 L 41 32 L 47 13 L 24 4 L 2 15\" },\r\n\t\t\"Quadrant Line\": { viewbox: \"0 0 50 50\", path: \"M2 3 h46 M2 15 h46 M2 29 h46 M2 43 h46\" },\r\n\t\t\"Rectangle\": { viewbox: \"0 0 50 50\", path: \"M3 3 L47 3 L47 47 L3 47 L3 3\" },\r\n\t\t\"Regression\": { viewbox: \"0 0 50 50\", path: \"M 2 15 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0 M 11.36 17.369 L 38.661 32.505 M 38 35 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0\" },\r\n\t\t\"Trend Line\": { viewbox: \"0 0 50 50\", path: \"M 2 35 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0 M 11.343 32.542 L 38.614 17.398 M 38 15 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0\" },\r\n\t\t\"Triangle\": { viewbox: \"0 0 50 50\", path: \"M 2 15 L 22 47 L 48 20 L 2 15\" },\r\n\t\t\"Vertical Line\": { viewbox: \"0 0 50 50\", path: \"M19 25a5 5 0 1 0 10 0 5 5 0 1 0-10 0M24 2v18 M24,32 v18\" },\r\n\t\t\"Parallel Channel\": { viewbox: \"0 0 50 50\", path: \"M 3 37 L 37 3 M 13 47 L 47 13\" },\r\n\r\n\t\t\"Eraser\": { viewbox: \"0 0 50 50\", path: \"M 13 48 L 21 48 L 45 24 L 29 8 L 1 36 L 13 48 M 32 48 L 38 48 M 43 48 L 49 48 M 23 14 L 39 30 M 20 17 L 36 33 M 26 11 L 42 27\" },\r\n\t\t\"Select\": { viewbox: \"0 0 50 50\", path: \"M 8 6 L 35 18 L 24 25 L 38 43 L 33 47 L 20 28 L 11 36 L 8 6\" },\r\n\t\t\"Clear\": { viewbox: \"0 0 50 50\", path: \"M 6 10 L 12 48 L 38 48 L 44 10 L 6 10 M 14 14 L 18 43 M 25 14 L 25 43 M 36 14 L 32 43 M 6 8 L 44 8 M 21 8 L 21 3 L 30 3 L 30 8\" },\r\n\t\t\"Bold\": { viewbox: \"0 0 50 50\", path: \"M 12 4 L 12 47 L 32 47 C 45 47 47 23 32 23 C 42 23 42 4 31 4 L 12 4 Z M 32 23 L 12 23 Z\", style: \"stroke-width: 1.8px\" },\r\n\t\t\"Italic\": { viewbox: \"0 0 50 50\", path: \"M 17 5 L 38 5 M 27 5 L 18 47 M 8 47 L 28 47\" },\r\n\t\t\"Show Extension\": { viewbox: \"0 0 50 50\", path: \"M 10 15 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0 M 30 36 a 5 5 0 1 0 10 0 a 5 5 0 1 0 -10 0 M 40 41 L 50 50 M 20 20 L 30 30 M 10 10 L 0 0\" },\r\n\t\t\"Snap\": { viewbox: \"0 0 50 50\", path: \"M 17 29 L 29 29 M 33 39 a 5 5 0 1 0 15 0 a 5 5 0 1 0 -15 0 M 29 17 L 29 29 L 3 3\" },\r\n\t\t\"Reset\": { viewbox: \"0 0 50 50\", path: \"M 4 25 A 1 1 0 0 0 46 25 Q 46 4 25 4 Q 18 4 11 10 L 5 4 L 5 16 L 17 16 L 11 10\" },\r\n\t\t\"Search\": { viewbox: \"0 0 50 50\", path: \"M 5 11 A 1 1 90 0 0 36 27 A 1 1 90 0 0 5 11 M 34 30 L 49 45 L 47 47 L 32 32\" },\r\n\t\t\"Measure\": { viewbox: \"0 0 50 50\", path: \"M 3 38 L 35 6 L 46 17 L 14 49 L 3 38 M 10 31 L 16 37 M 16 25 L 20 29 M 22 19 L 26 23 M 28 13 L 34 19 M 50 50\" }\r\n\t};\r\n\r\n\tpublic static getIcon(id: string): SVGElement {\r\n\t\tconst icons: any = StockIcons.icons;\r\n\t\tconst icon: any = icons[id] || icons[\"Default\"];\r\n\t\treturn StockIcons._getSVG(icon);\r\n\t}\r\n\r\n\tpublic static _getSVG(icon: any): SVGElement {\r\n\t\tconst svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n\t\tsvg.setAttribute(\"viewBox\", icon.viewbox);\r\n\t\tsvg.setAttribute(\"class\", \"am5stock_control_default_icon\");\r\n\r\n\t\tconst path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n\t\tpath.setAttribute(\"d\", icon.path);\r\n\t\tsvg.appendChild(path);\r\n\r\n\t\tif (icon.style) {\r\n\t\t\tpath.setAttribute(\"style\", icon.style);\r\n\t\t}\r\n\t\treturn svg;\r\n\t}\r\n}","import { Theme } from \"../../core/Theme\";\r\nimport { p100, p50, p0, percent } from \"../../core/util/Percent\";\r\nimport { setColor } from \"../../themes/DefaultTheme\";\r\nimport { Color, color } from \"../../core/util/Color\";\r\nimport { ColorSet } from \"../../core/util/ColorSet\";\r\nimport { StockIcons } from \"./toolbar/StockIcons\";\r\n\r\nimport * as $math from \"../../core/util/Math\";\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport class StockChartDefaultTheme extends Theme {\r\n\tprotected setupDefaultRules() {\r\n\t\tsuper.setupDefaultRules();\r\n\r\n\t\tconst l = this._root.language;\r\n\t\tconst r = this.rule.bind(this);\r\n\t\tconst verticalLayout = this._root.verticalLayout;\r\n\t\tconst ic = this._root.interfaceColors;\r\n\r\n\t\t/**\r\n\t\t * ========================================================================\r\n\t\t * charts/xy\r\n\t\t * ========================================================================\r\n\t\t */\r\n\r\n\t\tr(\"StockChart\").setAll({\r\n\t\t\tpaddingLeft: 18,\r\n\t\t\tpaddingRight: 18,\r\n\t\t\tpaddingTop: 5,\r\n\t\t\tpaddingBottom: 15,\r\n\t\t\twidth: p100,\r\n\t\t\theight: p100,\r\n\t\t\tlayout: verticalLayout,\r\n\t\t\tpercentScaleSeriesSettings: {\r\n\t\t\t\tvalueYShow: \"valueYChangeSelectionPercent\",\r\n\t\t\t\topenValueYShow: \"openValueYChangeSelectionPercent\",\r\n\t\t\t\thighValueYShow: \"highValueYChangeSelectionPercent\",\r\n\t\t\t\tlowValueYShow: \"lowValueYChangeSelectionPercent\"\r\n\t\t\t},\r\n\t\t\tpercentScaleValueAxisSettings: {\r\n\t\t\t\tnumberFormat: \"#.##'%'\",\r\n\t\t\t\tinterpolationDuration: 0,\r\n\t\t\t\textraMax: 0.05,\r\n\t\t\t\tstrictMinMaxSelection: true\r\n\t\t\t},\r\n\t\t\tautoSetPercentScale: true,\r\n\t\t\tdrawingSelectionEnabled: false\r\n\t\t});\r\n\r\n\t\tr(\"StockPanel\").setAll({\r\n\t\t\tpanY: true,\r\n\t\t\twheelY: \"zoomX\",\r\n\t\t\tpanX: true,\r\n\t\t\tminHeight: 1\r\n\t\t});\r\n\r\n\t\tr(\"StockPanel\").states.create(\"hidden\", {\r\n\t\t\theight: p0,\r\n\t\t\tvisible: false\r\n\t\t});\r\n\r\n\t\tr(\"XYChart\", [\"stock\"]).setAll({\r\n\t\t\tpaddingLeft: 0,\r\n\t\t\tpaddingRight: 0,\r\n\t\t\tpaddingBottom: 0,\r\n\t\t\tpaddingTop: 15,\r\n\t\t\tminHeight: 80,\r\n\t\t\twheelZoomPositionX: 1\r\n\t\t});\r\n\r\n\t\tr(\"XYChart\", [\"stock\", \"scrollbar\"]).setAll({\r\n\t\t\tminHeight: 0\r\n\t\t});\r\n\r\n\t\tr(\"StockLegend\").setAll({\r\n\t\t\tclickTarget: \"marker\"\r\n\t\t});\r\n\r\n\t\tr(\"Label\").setAll({\r\n\t\t\tfontSize: \"0.8em\"\r\n\t\t});\r\n\r\n\t\tr(\"Legend\", [\"stocklegend\"]).setAll({\r\n\t\t\tpaddingTop: 6,\r\n\t\t\tpaddingLeft: 6\r\n\t\t})\r\n\r\n\t\tr(\"Container\", [\"itemcontainer\", \"legend\", \"stocklegend\"]).setAll({\r\n\t\t\tmarginLeft: 2,\r\n\t\t\tmarginRight: 2,\r\n\t\t\tmarginTop: 2,\r\n\t\t\tmarginBottom: 2\r\n\t\t})\r\n\r\n\t\tr(\"Label\", [\"legend\", \"value\", \"label\", \"stocklegend\"]).setAll({\r\n\t\t\twidth: null,\r\n\t\t\tpaddingRight: 5\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\").setAll({\r\n\t\t\tuseLastColorForLegendMarker: true\r\n\t\t})\r\n\r\n\t\tr(\"Grid\", [\"middlegrid\"]).setAll({\r\n\t\t\tforceHidden: false,\r\n\t\t\tstrokeOpacity: .4,\r\n\t\t\tstrokeDasharray: [2, 2]\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"legend\", \"itemcontainer\", \"background\", \"stocklegend\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 1,\r\n\t\t\t\tcornerRadiusBL: 4,\r\n\t\t\t\tcornerRadiusBR: 4,\r\n\t\t\t\tcornerRadiusTL: 4,\r\n\t\t\t\tcornerRadiusTR: 4,\r\n\t\t\t\tshadowOffsetX: 0,\r\n\t\t\t\tshadowOffsetY: 0,\r\n\t\t\t\tshadowOpacity: 0.3,\r\n\t\t\t\tshadowBlur: 5,\r\n\t\t\t\tinteractive: true\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"shadowColor\", ic, \"alternativeBackground\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Rectangle\", [\"panelresizer\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\twidth: p100,\r\n\t\t\t\theight: 15,\r\n\t\t\t\tcenterY: p100,\r\n\t\t\t\tfillOpacity: 0,\r\n\t\t\t\tfill: ic.get(\"alternativeBackground\"),\r\n\t\t\t\tcursorOverStyle: \"row-resize\",\r\n\t\t\t\tinteractive: true\r\n\t\t\t})\r\n\r\n\t\t\trule.states.create(\"hover\", { fillOpacity: 0.07 });\r\n\t\t}\r\n\r\n\r\n\t\tr(\"Grid\", [\"renderer\", \"base\", \"y\"]).setAll({\r\n\t\t\tstrokeOpacity: 0.4\r\n\t\t})\r\n\r\n\t\tr(\"Button\", [\"zoom\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"AxisRendererY\", [\"y\"]).setAll({\r\n\t\t\topposite: true,\r\n\t\t\tpan: \"zoom\"\r\n\t\t})\r\n\r\n\t\tr(\"Container\", [\"legend\", \"item\"]).setAll({\r\n\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"axis\", \"fill\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tvisible: true,\r\n\t\t\t\t//isMeasured: false,\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\tfillOpacity: 0.05,\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"fill\", ic, \"alternativeBackground\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Panel Controls\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"PanelControls\");\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tx: p100,\r\n\t\t\t\ty: 0,\r\n\t\t\t\tcenterX: p100,\r\n\t\t\t\tpaddingTop: 10,\r\n\t\t\t\tpaddingRight: 10,\r\n\t\t\t\tlayer: 30,\r\n\t\t\t\tlayout: this._root.horizontalLayout,\r\n\t\t\t\topacity: 0.5\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"hover\", { opacity: 1 });\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Control Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\tr(\"Button\", [\"control\", \"item\"]).setAll({\r\n\t\t\tpaddingTop: 1,\r\n\t\t\tpaddingBottom: 1,\r\n\t\t\tpaddingLeft: 2,\r\n\t\t\tpaddingRight: 2,\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50,\r\n\t\t\tforceHidden: true\r\n\t\t});\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Button\", [\"control\", \"item\", \"settings\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tforceHidden: false\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"background\", \"control\", \"button\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 0,\r\n\t\t\t\tstrokeOpacity: 0\r\n\t\t\t});\r\n\t\t}\r\n\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"control\", \"button\", \"icon\"]).states.create(\"hover\", {\r\n\t\t\t\tfillOpacity: 0.3\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"fill\", ic, \"secondaryButtonHover\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * PanelControls Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\tr(\"Button\", [\"panel\"]).setAll({\r\n\t\t\tscale: 1.2,\r\n\t\t\tpaddingLeft: 0,\r\n\t\t\tpaddingRight: 0,\r\n\t\t\tmarginLeft: 6\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Close Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"close\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tlet r = 5;\r\n\t\t\t\t\tdisplay.moveTo(-r, -r);\r\n\t\t\t\t\tdisplay.lineTo(r, r);\r\n\t\t\t\t\tdisplay.moveTo(-r, r);\r\n\t\t\t\t\tdisplay.lineTo(r, -r);\r\n\t\t\t\t\tdisplay.moveTo(0, 0);\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, r * 2);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Settings Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"settings\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tconst r = 10;\r\n\t\t\t\t\tconst ir = 8;\r\n\t\t\t\t\tconst spikes = 9;\r\n\t\t\t\t\tconst angleStep = 360 / spikes * $math.RADIANS / 2;\r\n\t\t\t\t\tdisplay.moveTo(r, 0)\r\n\t\t\t\t\tlet angle = 0;\r\n\t\t\t\t\tlet dAngle = 5 * $math.RADIANS;\r\n\t\t\t\t\tfor (let i = 0; i < spikes; i++) {\r\n\t\t\t\t\t\tangle += angleStep;\r\n\t\t\t\t\t\tdisplay.lineTo(r * Math.cos(angle), r * Math.sin(angle));\r\n\t\t\t\t\t\tdisplay.lineTo(ir * Math.cos(angle + dAngle), ir * Math.sin(angle + dAngle));\r\n\t\t\t\t\t\tangle += angleStep;\r\n\t\t\t\t\t\tdisplay.lineTo(ir * Math.cos(angle - dAngle), ir * Math.sin(angle - dAngle));\r\n\t\t\t\t\t\tdisplay.lineTo(r * Math.cos(angle), r * Math.sin(angle));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, 4);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Up Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"up\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tlet r = 5;\r\n\t\t\t\t\tdisplay.moveTo(0, 5);\r\n\t\t\t\t\tdisplay.lineTo(0, -5);\r\n\t\t\t\t\tdisplay.moveTo(0, -5);\r\n\t\t\t\t\tdisplay.lineTo(-5, 0);\r\n\t\t\t\t\tdisplay.moveTo(0, -5);\r\n\t\t\t\t\tdisplay.lineTo(5, 0);\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, 2 * r);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Expand Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"expand\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tlet r = 5;\r\n\t\t\t\t\tdisplay.moveTo(-5, -2);\r\n\t\t\t\t\tdisplay.lineTo(-5, -5);\r\n\t\t\t\t\tdisplay.lineTo(5, -5);\r\n\t\t\t\t\tdisplay.lineTo(5, -2);\r\n\r\n\t\t\t\t\tdisplay.moveTo(5, 2);\r\n\t\t\t\t\tdisplay.lineTo(5, 5);\r\n\t\t\t\t\tdisplay.lineTo(-5, 5);\r\n\t\t\t\t\tdisplay.lineTo(-5, 2);\r\n\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, 2 * r);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Down Button\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"down\", \"button\", \"icon\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 0.5,\r\n\t\t\t\tdraw: (display: any) => {\r\n\t\t\t\t\tlet r = 5;\r\n\t\t\t\t\tdisplay.moveTo(0, -5);\r\n\t\t\t\t\tdisplay.lineTo(0, 5);\r\n\t\t\t\t\tdisplay.moveTo(0, 5);\r\n\t\t\t\t\tdisplay.lineTo(-5, 0);\r\n\t\t\t\t\tdisplay.moveTo(0, 5);\r\n\t\t\t\t\tdisplay.lineTo(5, 0);\r\n\t\t\t\t\tdisplay.drawCircle(0, 0, 2 * r);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t}\r\n\r\n\t\t// Class: Inicator\r\n\t\tr(\"Indicator\").setAll({\r\n\t\t\tposition: \"absolute\",\r\n\t\t\tautoOpenSettings: true\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Drawing related\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\tr(\"DrawingSeries\").setAll({\r\n\t\t\tfield: \"value\",\r\n\t\t\tselectorPadding: 10\r\n\t\t})\r\n\r\n\r\n\t\t// bullet of all drawing series\r\n\t\t{\r\n\t\t\tconst rule = r(\"Container\", [\"drawing\", \"grip\"]);\r\n\t\t\trule.states.create(\"hover\", {});\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Circle\", [\"drawing\", \"grip\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0.7,\r\n\t\t\t\tstrokeWidth: 1,\r\n\t\t\t\tradius: 5\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"alternativeBackground\");\r\n\r\n\t\t\tconst stateRule = rule.states.create(\"hover\", { strokeWidth: 2 });\r\n\t\t\tsetColor(stateRule, \"stroke\", ic, \"negative\");\r\n\t\t}\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"outline\"]).setAll({\r\n\t\t\tradius: 8,\r\n\t\t\tstrokeWidth: 4,\r\n\t\t\tstrokeOpacity: 0,\r\n\t\t\tfillOpacity: 0\r\n\t\t})\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"outline\"]).states.create(\"hover\", {\r\n\t\t\tradius: 10,\r\n\t\t\tstrokeWidth: 4,\r\n\t\t\tstrokeOpacity: 0.3\r\n\t\t})\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"outline\", \"label\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"label\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"callout\"]).setAll({\r\n\t\t\tfillOpacity: 0,\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"Circle\", [\"drawing\", \"grip\", \"outline\", \"callout\"]).setAll({\r\n\t\t\tforceHidden: false\r\n\t\t})\r\n\r\n\t\tr(\"Triangle\", [\"drawing\", \"arrow\"]).setAll({\r\n\t\t\twidth: 22,\r\n\t\t\theight: 17\t\t\t\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"series\", \"fill\", \"drawing\"])\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 0.2,\r\n\t\t\t\tvisible: true,\r\n\t\t\t\tdraggable: true\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"hover\", {\r\n\t\t\t\tfillOpacity: 0.4\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tr(\"Line\", [\"drawing\"]).setAll({\r\n\t\t\tstrokeDasharray: [2, 2],\r\n\t\t\tstrokeWidth: 1,\r\n\t\t\tdraggable: true\r\n\t\t});\r\n\r\n\t\tr(\"Line\", [\"drawing\", \"hit\"]).setAll({\r\n\t\t\tstrokeWidth: 22,\r\n\t\t\tstrokeOpacity: 0,\r\n\t\t\tstrokeDasharray: 0,\r\n\t\t\tdraggable: true\r\n\t\t});\r\n\r\n\t\tr(\"Line\", [\"drawing\", \"hit\", \"horizontal\"]).setAll({\r\n\t\t\tstrokeWidth: 22\r\n\t\t});\r\n\r\n\t\tr(\"Line\", [\"drawing\", \"hit\", \"vertical\"]).setAll({\r\n\t\t\tstrokeWidth: 22\r\n\t\t});\r\n\r\n\t\tr(\"Line\", [\"drawing\", \"hit\", \"ray\"]).setAll({\r\n\t\t\tstrokeWidth: 22\r\n\t\t});\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"series\", \"fill\", \"drawing\", \"doodle\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 0\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"hover\", { fillOpacity: 0 })\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"series\", \"stroke\", \"drawing\", \"measure\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 0\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tr(\"Line\", [\"drawing\", \"measure\"]).setAll({\r\n\t\t\tstrokeDasharray: [],\r\n\t\t\tstrokeWidth: 1,\r\n\t\t\tcrisp: true,\r\n\t\t\tstrokeOpacity: 0.7,\r\n\t\t\tdraggable: false\r\n\t\t});\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"line\", \"series\", \"stroke\", \"drawing\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\tdraggable: true\r\n\t\t\t});\r\n\r\n\t\t\tconst stateRule = rule.states.create(\"hover\", {});\r\n\t\t\tsetColor(stateRule, \"stroke\", ic, \"negative\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"drawing\", \"icon\"])\r\n\t\t\trule.setAll({\r\n\t\t\t\tcenterX: p50,\r\n\t\t\t\tcenterY: p100,\r\n\t\t\t\tstrokeOpacity: 1,\r\n\t\t\t\tstrokeWidth: 2\r\n\t\t\t});\r\n\r\n\t\t\tconst hoverRule = rule.states.create(\"hover\", {})\r\n\t\t\tsetColor(hoverRule, \"stroke\", ic, \"negative\")\r\n\t\t}\r\n\r\n\t\tr(\"Label\", [\"drawing\", \"label\"]).setAll({\r\n\t\t\tcenterX: p0,\r\n\t\t\tcenterY: p50,\r\n\t\t\tminHeight: 28,\r\n\t\t\tminWidth: 28\r\n\t\t});\r\n\r\n\t\tr(\"Label\", [\"drawing\", \"measure\"]).setAll({\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50,\r\n\t\t\tfill: ic.get(\"alternativeText\"),\r\n\t\t\ttextAlign: \"center\"\r\n\t\t});\r\n\r\n\t\tr(\"RoundedRectangle\", [\"background\", \"drawing\", \"measure\"]).setAll({\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50,\r\n\t\t\tfillOpacity: 0.7\r\n\t\t});\r\n\r\n\t\tr(\"PointedRectangle\", [\"drawing\", \"callout\"]).setAll({\r\n\t\t\tfillOpacity: 1,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t});\r\n\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Ellipse\", [\"drawing\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tstrokeOpacity: 1,\r\n\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\tisMeasured: false,\r\n\t\t\t\tposition: \"absolute\",\r\n\t\t\t\tdraggable: true,\r\n\t\t\t\tfillOpacity: 0.25\r\n\t\t\t})\r\n\r\n\t\t\tconst stateRule = rule.states.create(\"hover\", {\r\n\t\t\t\tfillOpacity: 0.5\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(stateRule, \"stroke\", ic, \"negative\");\r\n\t\t}\r\n\r\n\t\tr(\"FibonacciSeries\").setAll({\r\n\t\t\tsequence: [0, 0.236, 0.382, 0.5, 0.618, 0.768, 1, 1.618, 2.618, 3.618, 4.236],\r\n\t\t\tcolors: [\r\n\t\t\t\tcolor(0x868686),\r\n\t\t\t\tcolor(0xed483c),\r\n\t\t\t\tcolor(0x83c486),\r\n\t\t\t\tcolor(0x4fab53),\r\n\t\t\t\tcolor(0x059183),\r\n\t\t\t\tcolor(0x69b4f1),\r\n\t\t\t\tcolor(0x868686),\r\n\t\t\t\tcolor(0x3065f8),\r\n\t\t\t\tcolor(0xed483c),\r\n\t\t\t\tcolor(0x982bab),\r\n\t\t\t\tcolor(0xe22465)\r\n\t\t\t]\r\n\t\t})\r\n\r\n\t\tr(\"Graphics\", [\"line\", \"series\", \"stroke\", \"drawing\", \"fibonacci\"]).setAll({\r\n\t\t\tstrokeWidth: 0.5,\r\n\t\t\tstrokeOpacity: 1\r\n\t\t});\r\n\r\n\t\tr(\"Label\", [\"fibonacci\"]).setAll({\r\n\t\t\tpopulateText: true,\r\n\t\t\ttext: \"{sequence} ({value.formatNumber('#.00')})\",\r\n\t\t\tcenterX: p100,\r\n\t\t\tcenterY: p100,\r\n\t\t\tpaddingBottom: 2,\r\n\t\t\tfontSize: \"0.8em\"\r\n\t\t})\r\n\r\n\t\tr(\"Label\", [\"fibonaccitimezone\"]).setAll({\r\n\t\t\tpopulateText: true,\r\n\t\t\ttext: \"{value.formatNumber('#')}\",\r\n\t\t\tcenterX: 0,\r\n\t\t\tcenterY: p100,\r\n\t\t\tpaddingBottom: 2,\r\n\t\t\tpaddingLeft: 3,\r\n\t\t\tfontSize: \"0.8em\"\r\n\t\t})\r\n\r\n\t\tr(\"FibonacciTimezoneSeries\").setAll({\r\n\t\t\tsequence: [0, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89],\r\n\t\t\tcolors: []\r\n\t\t})\r\n\r\n\r\n\t\tr(\"Graphics\", [\"line\", \"series\", \"fill\", \"drawing\", \"fibonaccitimezone\"]).setAll({\r\n\t\t\tdraggable: false,\r\n\t\t\tfillOpacity: 0.1\r\n\t\t});\r\n\r\n\r\n\t\tr(\"Graphics\", [\"line\", \"series\", \"stroke\", \"drawing\", \"fibonaccitimezone\"]).setAll({\r\n\t\t\tdraggable: false,\r\n\t\t\tstrokeWidth: 0.5,\r\n\t\t\tstrokeOpacity: 1\r\n\t\t});\r\n\r\n\r\n\t\tr(\"Grid\", [\"overbought\"]).setAll({\r\n\t\t\tstrokeOpacity: 0.4\r\n\t\t});\r\n\r\n\r\n\t\tr(\"Grid\", [\"oversold\"]).setAll({\r\n\t\t\tstrokeOpacity: 0.4,\r\n\t\t});\r\n\r\n\t\t// series fill below oversold\r\n\t\tr(\"Graphics\", [\"overboughtoversold\", \"oversold\", \"fill\"]).setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tfillOpacity: 0.2\r\n\t\t});\r\n\r\n\t\t// series fill above oversold\r\n\t\tr(\"Graphics\", [\"overboughtoversold\", \"overbought\", \"fill\"]).setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tfillOpacity: 0.2\r\n\t\t});\r\n\r\n\t\tr(\"Graphics\", [\"fill\", \"bollingerbands\", \"upper\"]).setAll({\r\n\t\t\tfillOpacity: 0.2\r\n\t\t})\r\n\r\n\t\tr(\"Graphics\", [\"fill\", \"movingaverageenvelope\", \"upper\"]).setAll({\r\n\t\t\tfillOpacity: 0.2\r\n\t\t})\r\n\r\n\t\tr(\"Graphics\", [\"series\", \"line\", \"accumulativeswingindex\"]).setAll({\r\n\t\t\tfillOpacity: 0.2,\r\n\t\t\tvisible: true\r\n\t\t})\r\n\r\n\t\tr(\"XYChart\", [\"indicator\"]).setAll({\r\n\t\t\theight: percent(30),\r\n\t\t\tminHeight: 80\r\n\t\t})\r\n\r\n\t\tr(\"AxisLabel\", [\"x\", \"indicator\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\r\n\t\tr(\"XYSeries\", [\"indicator\"]).setAll({\r\n\t\t\tlegendLabelText: \"{name}\"\r\n\t\t})\r\n\r\n\r\n\t\t/// LEGEND LABELS\r\n\r\n\t\tr(\"LineSeries\", [\"accumulationdistribution\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({useVolume})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"accumulativeswingindex\"]).setAll({\r\n\t\t\tlegendValueText: \"[{swingColor} bold]{valueY.formatNumber('#.0000')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({limitMoveValue})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"aroon\"]).setAll({\r\n\t\t\tlegendValueText: \"[{upColor} bold]{up.formatNumber('#.00')}%[/] [{downColor} bold]{down.formatNumber('#.00')}%[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\", [\"awesomeoscillator\"]).setAll({\r\n\t\t\tlegendValueText: \"[{oscillatorColor}; bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"indicator\", \"bollingerbands\"]).setAll({\r\n\t\t\tlegendValueText: \"[{lowerColor} bold]{lower.formatNumber('#.00')}[/] [{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{upperColor} bold]{upper.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{field},{standardDeviations.formatNumber('#.')},{type})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"indicator\", \"macross\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{fastColor} bold]{maf.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{fastPeriod.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"indicator\", \"accelerationbands\"]).setAll({\r\n\t\t\tlegendValueText: \"[{lowerColor} bold]{lower.formatNumber('#.00')}[/] [{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{upperColor} bold]{upper.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{factor.formatNumber('#.#####')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"chaikinmoneyflow\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"chaikinoscillator\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{slowPeriod.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"bullbearpower\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber()}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"commoditychannelindex\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"disparityindex\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{field},{movingAverageType})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"macd\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{signalColor} bold]{signal.formatNumber('#.00')}[/] [bold {differenceColor}]{difference.formatNumber('#.00')}[/b]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({fastPeriod.formatNumber('#.')},{slowPeriod.formatNumber('#.')},{signalPeriod.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"medianprice\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"momentum\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{field})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"movingaverage\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{field},{type},{offset.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\", [\"movingaveragedeviation\"]).setAll({\r\n\t\t\tlegendValueText: \"[{deviationColor}; bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"indicator\", \"movingaverageenvelope\"]).setAll({\r\n\t\t\tlegendValueText: \"[{lowerColor} bold]{lower.formatNumber('#.00')}[/] [{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{upperColor} bold]{upper.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{field},{shiftType},{shift.formatNumber('#.')},{type})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"onbalancevolume\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName}\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"pvt\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName}\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"rsi\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{smaColor} bold]{sma.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{smaPeriod.formatNumber('#.')},{field})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"standarddeviation\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{field})\"\r\n\t\t})\r\n\r\n\r\n\t\tr(\"LineSeries\", [\"stochasticmomentum\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{emaColor} bold]{ema.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{dPeriod.formatNumber('#.')},{emaPeriod.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"stochastic\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{slowColor} bold]{slow.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{kSmoothing.formatNumber('#.')},{dSmoothing.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"trix\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/] [{signalColor} bold]{signal.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"typicalprice\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"averagetruerange\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\", [\"volume\"]).setAll({\r\n\t\t\tlegendValueText: \"[{volumeColor}; bold]{valueY.formatNumber('#.000a')}[/]\",\r\n\t\t})\r\n\r\n\t\tr(\"ColumnSeries\", [\"volumeprofile\"]).setAll({\r\n\t\t\tlegendLabelText: \"{shortName}\",\r\n\t\t\tlegendValueText: \"[{downColor}; bold]{down.formatNumber('#.000a')}[/] [{upColor}; bold]{up.formatNumber('#.000a')}[/]  [bold]{total.formatNumber('#.000a')}[/]\"\r\n\t\t})\r\n\r\n\t\tr(\"LineSeries\", [\"vwap\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')},{field})\"\r\n\t\t})\r\n\r\n\r\n\t\tr(\"LineSeries\", [\"williamsr\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({period.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\r\n\t\tr(\"LineSeries\", [\"zigzag\"]).setAll({\r\n\t\t\tlegendValueText: \"[{seriesColor} bold]{valueY.formatNumber('#.00')}[/]\",\r\n\t\t\tlegendLabelText: \"{shortName} ({deviation.formatNumber('#.')}, {depth.formatNumber('#.')})\"\r\n\t\t})\r\n\r\n\t\t// end of legend labels\r\n\r\n\t\tr(\"RoundedRectangle\", [\"series\", \"column\", \"volumeprofile\"]).setAll({\r\n\t\t\tfillOpacity: .3,\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t})\r\n\r\n\t\tr(\"RoundedRectangle\", [\"series\", \"column\", \"volumeprofile\"]).states.create(\"hover\", {\r\n\t\t\tstrokeOpacity: 1\r\n\t\t})\r\n\r\n\t\tr(\"RoundedRectangle\", [\"macd\", \"difference\"]).setAll({\r\n\t\t\tfillOpacity: 0.5,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t})\r\n\r\n\t\tr(\"RoundedRectangle\", [\"series\", \"column\", \"awesomeoscillator\"]).setAll({\r\n\t\t\tfillOpacity: 0.5,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"series\", \"column\", \"volume\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tfillOpacity: 0.5,\r\n\t\t\t\tstroke: ic.get(\"background\"),\r\n\t\t\t\tstrokeOpacity: 0.2\r\n\t\t\t})\r\n\r\n\t\t\trule.adapters.add(\"fill\", (fill, target: any) => {\r\n\t\t\t\tconst dataItem = target.dataItem;\r\n\t\t\t\tif (dataItem) {\r\n\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\tif (dataContext.volumeColor != null) {\r\n\t\t\t\t\t\treturn dataContext.volumeColor;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn fill;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tr(\"RoundedRectangle\", [\"series\", \"column\", \"movingaveragedeviation\"]).setAll({\r\n\t\t\tfillOpacity: 0.5,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t})\r\n\r\n\t\t// Y Axis of overbought/oversold indicators\r\n\t\tr(\"Grid\", [\"renderer\", \"y\", \"overboughtoversold\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\t// Y Axis of indicators\r\n\t\tr(\"Grid\", [\"renderer\", \"y\", \"overboughtoversold\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"AxisLabel\", [\"renderer\", \"y\", \"overboughtoversold\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\r\n\t\tr(\"MovingAverage\").setAll({\r\n\t\t\tname: \"Moving Average\",\r\n\t\t\tshortName: \"MA\",\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\ttype: \"simple\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 20,\r\n\t\t\toffset: 0\r\n\t\t})\r\n\r\n\t\tr(\"MACross\").setAll({\r\n\t\t\tname: \"Moving Average Cross\",\r\n\t\t\tshortName: \"MACross\",\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\tfastColor: color(0x1772DE),\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 9,\r\n\t\t\tfastPeriod: 21\r\n\t\t})\r\n\r\n\t\tr(\"ZigZag\").setAll({\r\n\t\t\tname: \"ZigZag\",\r\n\t\t\tshortName: \"ZigZag\",\r\n\t\t\tseriesColor: ic.get(\"alternativeBackground\"),\r\n\t\t\tdeviation: 5,\r\n\t\t\tdepth: 3\r\n\t\t})\r\n\r\n\t\tr(\"MovingAverageEnvelope\").setAll({\r\n\t\t\tname: \"Moving Average Envelope\",\r\n\t\t\tshortName: \"MA ENV\",\r\n\t\t\tseriesColor: color(0xff903f),\r\n\t\t\tupperColor: color(0xffc948),\r\n\t\t\tlowerColor: color(0xffaf74),\r\n\t\t\ttype: \"simple\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 20,\r\n\t\t\toffset: 0,\r\n\t\t\tshift: 5,\r\n\t\t\tshiftType: \"percent\"\r\n\t\t})\r\n\r\n\t\tr(\"MovingAverageDeviation\").setAll({\r\n\t\t\tname: \"Moving Average Deviation\",\r\n\t\t\tshortName: \"MA Dev\",\r\n\t\t\tincreasingColor: ic.get(\"positive\"),\r\n\t\t\tdecreasingColor: ic.get(\"negative\"),\r\n\t\t\ttype: \"simple\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 20\r\n\t\t})\r\n\r\n\t\tr(\"StandardDeviation\").setAll({\r\n\t\t\tname: \"Standard Deviation\",\r\n\t\t\tseriesColor: ic.get(\"alternativeBackground\"),\r\n\t\t\tshortName: \"STDEV\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 20\r\n\t\t})\r\n\r\n\t\tr(\"TypicalPrice\").setAll({\r\n\t\t\tname: \"Typical Price\",\r\n\t\t\tseriesColor: ic.get(\"alternativeBackground\"),\r\n\t\t\tshortName: \"Typical Price\",\r\n\t\t\tfield: \"hlc/3\",\r\n\t\t\tperiod: 20\r\n\t\t})\r\n\r\n\t\tr(\"AverageTrueRange\").setAll({\r\n\t\t\tname: \"Average True Range\",\r\n\t\t\tseriesColor: color(0xff903f),\r\n\t\t\tshortName: \"ATR\",\r\n\t\t\tperiod: 14\r\n\t\t})\r\n\r\n\t\tr(\"Trix\").setAll({\r\n\t\t\tname: \"Trix\",\r\n\t\t\tseriesColor: ic.get(\"alternativeBackground\"),\r\n\t\t\tsignalColor: color(0xff903f),\r\n\t\t\tshortName: \"Trix\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tperiod: 20,\r\n\t\t\tsignalPeriod: 9\r\n\t\t})\r\n\r\n\t\tr(\"MedianPrice\").setAll({\r\n\t\t\tname: \"Median Price\",\r\n\t\t\tseriesColor: ic.get(\"alternativeBackground\"),\r\n\t\t\tshortName: \"Median Price\",\r\n\t\t\tfield: \"hl/2\",\r\n\t\t\tperiod: 20\r\n\t\t})\r\n\r\n\r\n\t\tr(\"VWAP\").setAll({\r\n\t\t\tname: \"Volume-Weighted Average Price\",\r\n\t\t\tshortName: \"VWAP\",\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\tfield: \"hlc/3\",\r\n\t\t\tperiod: 30\r\n\t\t})\r\n\r\n\t\tr(\"AccumulationDistribution\").setAll({\r\n\t\t\tname: \"Accumulation/Distribution\",\r\n\t\t\tshortName: \"Accum/Dist\",\r\n\t\t\tseriesColor: color(0x707070),\r\n\t\t\tuseVolume: true\r\n\t\t})\r\n\r\n\t\tr(\"DisparityIndex\").setAll({\r\n\t\t\tname: \"Disparity Index\",\r\n\t\t\tshortName: \"Disparity\",\r\n\t\t\tseriesColor: color(0x707070),\r\n\t\t\tperiod: 14,\r\n\t\t\tfield: \"close\",\r\n\t\t\tmovingAverageType: \"simple\"\r\n\t\t})\r\n\r\n\r\n\t\tr(\"ChaikinMoneyFlow\").setAll({\r\n\t\t\tname: \"Chaikin Money Flow\",\r\n\t\t\tshortName: \"Chaikin MF\",\r\n\t\t\tseriesColor: color(0x707070),\r\n\t\t\tperiod: 20\r\n\t\t})\r\n\r\n\t\tr(\"ChaikinOscillator\").setAll({\r\n\t\t\tname: \"Chaikin Oscillator\",\r\n\t\t\tperiod: 3,\r\n\t\t\tslowPeriod: 10,\r\n\t\t\tshortName: \"Chaikin Osc\",\r\n\t\t\tseriesColor: color(0x707070)\r\n\t\t})\r\n\r\n\t\tr(\"BullBearPower\").setAll({\r\n\t\t\tname: \"Bull Bear Power\",\r\n\t\t\tperiod: 13,\r\n\t\t\tshortName: \"BBP\",\r\n\t\t\tseriesColor: color(0x707070)\r\n\t\t})\r\n\r\n\t\tr(\"OnBalanceVolume\").setAll({\r\n\t\t\tname: \"On Balance Volume\",\r\n\t\t\tshortName: \"On Bal Vol\",\r\n\t\t\tseriesColor: color(0x707070)\r\n\t\t})\r\n\r\n\t\tr(\"PVT\").setAll({\r\n\t\t\tname: \"Price Volume Trend\",\r\n\t\t\tshortName: \"PVT\",\r\n\t\t\tseriesColor: color(0x707070)\r\n\t\t})\r\n\r\n\t\tr(\"BollingerBands\").setAll({\r\n\t\t\tname: \"Bollinger Bands\",\r\n\t\t\tshortName: \"Bollinger\",\r\n\t\t\tstandardDeviations: 2,\r\n\t\t\tseriesColor: color(0xff903f),\r\n\t\t\tupperColor: color(0xffc948),\r\n\t\t\tlowerColor: color(0xffaf74)\r\n\t\t});\r\n\r\n\t\tr(\"AccelerationBands\").setAll({\r\n\t\t\tname: \"Acceleration Bands\",\r\n\t\t\tshortName: \"Acceleration\",\r\n\t\t\tfactor: 0.001,\r\n\t\t\tperiod: 20,\r\n\t\t\tseriesColor: color(0xff903f),\r\n\t\t\tupperColor: color(0xe64c9b),\r\n\t\t\tlowerColor: color(0xe64c9b)\r\n\t\t});\r\n\r\n\r\n\t\tr(\"RelativeStrengthIndex\").setAll({\r\n\t\t\tname: \"Relative Strength Index\",\r\n\t\t\tshortName: \"RSI\",\r\n\t\t\tperiod: 14,\r\n\t\t\tsmaPeriod: 3,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: 20,\r\n\t\t\toverBought: 80,\r\n\t\t\toverSoldColor: color(0xe40000),\r\n\t\t\toverBoughtColor: color(0x67b7dc),\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\tsmaColor: color(0xff903f)\r\n\t\t})\r\n\r\n\t\tr(\"Momentum\").setAll({\r\n\t\t\tname: \"Momentum\",\r\n\t\t\tshortName: \"Mom\",\r\n\t\t\tperiod: 14,\r\n\t\t\tfield: \"close\",\r\n\t\t\tseriesColor: color(0xab82da)\r\n\t\t})\r\n\r\n\t\tr(\"WilliamsR\").setAll({\r\n\t\t\tname: \"Williams %R\",\r\n\t\t\tshortName: \"Williams %R\",\r\n\t\t\tperiod: 14,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: -80,\r\n\t\t\toverBought: -20,\r\n\t\t\toverSoldColor: color(0xe40000),\r\n\t\t\toverBoughtColor: color(0x67b7dc),\r\n\t\t\tseriesColor: color(0xab82da)\r\n\t\t})\r\n\r\n\t\tr(\"CommodityChannelIndex\").setAll({\r\n\t\t\tname: \"Commodity Channel Index\",\r\n\t\t\tshortName: \"CCI\",\r\n\t\t\tperiod: 20,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: -100,\r\n\t\t\toverBought: 100,\r\n\t\t\toverSoldColor: color(0xe40000),\r\n\t\t\toverBoughtColor: color(0x67b7dc),\r\n\t\t\tseriesColor: color(0xab82da)\r\n\t\t})\r\n\r\n\t\tr(\"StochasticOscillator\").setAll({\r\n\t\t\tname: \"Stochastic Oscillator\",\r\n\t\t\tshortName: \"Stochastic Osc\",\r\n\t\t\tperiod: 14,\r\n\t\t\tkSmoothing: 1,\r\n\t\t\tdSmoothing: 3,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: 20,\r\n\t\t\toverBought: 80,\r\n\t\t\toverSoldColor: color(0xe40000),\r\n\t\t\toverBoughtColor: color(0x67b7dc),\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\tslowColor: color(0xff903f)\r\n\t\t})\r\n\r\n\t\tr(\"StochasticMomentumIndex\").setAll({\r\n\t\t\tname: \"Stochastic Momentum Index\",\r\n\t\t\tshortName: \"Stochastic MI\",\r\n\t\t\tperiod: 10,\r\n\t\t\tdPeriod: 3,\r\n\t\t\temaPeriod: 3,\r\n\t\t\tfield: \"close\",\r\n\t\t\toverSold: -40,\r\n\t\t\toverBought: 40,\r\n\t\t\toverSoldColor: color(0xe40000),\r\n\t\t\toverBoughtColor: color(0x67b7dc),\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\temaColor: color(0xff903f)\r\n\t\t})\r\n\r\n\t\tr(\"AccumulativeSwingIndex\").setAll({\r\n\t\t\tname: \"Accumulative Swing Index\",\r\n\t\t\tshortName: \"ACC Swing\",\r\n\t\t\tlimitMoveValue: 1000,\r\n\t\t\tpositiveColor: ic.get(\"positive\"),\r\n\t\t\tnegativeColor: ic.get(\"negative\")\r\n\t\t})\r\n\r\n\t\tr(\"Aroon\").setAll({\r\n\t\t\tname: \"Aroon\",\r\n\t\t\tshortName: \"Aroon\",\r\n\t\t\tperiod: 14,\r\n\t\t\tupColor: ic.get(\"positive\"),\r\n\t\t\tdownColor: ic.get(\"negative\")\r\n\t\t})\r\n\r\n\t\tr(\"AwesomeOscillator\").setAll({\r\n\t\t\tname: \"Awesome Oscillator\",\r\n\t\t\tshortName: \"Awesome\",\r\n\t\t\tincreasingColor: ic.get(\"positive\"),\r\n\t\t\tdecreasingColor: ic.get(\"negative\")\r\n\t\t});\r\n\r\n\t\tr(\"Volume\").setAll({\r\n\t\t\tname: \"Volume\",\r\n\t\t\tshortName: \"Volume\",\r\n\t\t\tincreasingColor: ic.get(\"positive\"),\r\n\t\t\tdecreasingColor: ic.get(\"negative\")\r\n\t\t});\r\n\r\n\t\tr(\"VolumeProfile\").setAll({\r\n\t\t\tname: \"Volume Profile\",\r\n\t\t\tshortName: \"Volume Profile\",\r\n\t\t\tupColor: Color.fromHex(0xE3B30C),\r\n\t\t\tdownColor: Color.fromHex(0x2E78E3),\r\n\t\t\tcountType: \"rows\",\r\n\t\t\tcount: 24,\r\n\t\t\taxisWidth: 40,\r\n\t\t\tvalueArea: 70,\r\n\t\t\tvalueAreaOpacity: 0.7\r\n\t\t});\r\n\r\n\t\tr(\"MACD\").setAll({\r\n\t\t\tname: \"MACD\",\r\n\t\t\tfield: \"close\",\r\n\t\t\tshortName: \"MACD\",\r\n\t\t\tfastPeriod: 12,\r\n\t\t\tslowPeriod: 26,\r\n\t\t\tsignalPeriod: 9,\r\n\t\t\tincreasingColor: ic.get(\"positive\"),\r\n\t\t\tdecreasingColor: ic.get(\"negative\"),\r\n\t\t\tseriesColor: color(0xab82da),\r\n\t\t\tsignalColor: color(0xff903f)\r\n\t\t});\r\n\r\n\t\tr(\"Grid\", [\"cursor\", \"y\", \"indicator\"]).set(\"forceHidden\", true);\r\n\r\n\t\t/**\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t * Toolbar\r\n\t\t * ------------------------------------------------------------------------\r\n\t\t */\r\n\r\n\t\tr(\"StockControl\").setAll({\r\n\t\t\tvisible: true,\r\n\t\t\tactive: false\r\n\t\t});\r\n\r\n\t\tr(\"IndicatorControl\").setAll({\r\n\t\t\tname: l.translateAny(\"Indicators\"),\r\n\t\t\tscrollable: true,\r\n\t\t\tfixedLabel: true,\r\n\t\t\tsearchable: true,\r\n\t\t\tindicators: [\"Acceleration Bands\", \"Accumulation Distribution\", \"Accumulative Swing Index\", \"Aroon\", \"Average True Range\", \"Awesome Oscillator\", \"Bollinger Bands\", \"Bull Bear Power\", \"Chaikin Money Flow\", \"Chaikin Oscillator\", \"Commodity Channel Index\", \"Disparity Index\", \"MACD\", \"Median Price\", \"Momentum\", \"Moving Average\", \"Moving Average Cross\", \"Moving Average Deviation\", \"Moving Average Envelope\", \"On Balance Volume\", \"Price Volume Trend\", \"Relative Strength Index\", \"Standard Deviation\", \"Stochastic Momentum Index\", \"Stochastic Oscillator\", \"Trix\", \"Typical Price\", \"Volume\", \"Volume Profile\", \"VWAP\", \"Williams R\", \"ZigZag\"]\r\n\t\t});\r\n\r\n\t\tr(\"ComparisonControl\").setAll({\r\n\t\t\tname: l.translateAny(\"Comparison\")\r\n\t\t});\r\n\r\n\t\tconst drawingIcons = [{\r\n\t\t\tsvgPath: \"M 5 35 L 5 15 L 26 15 L 26 5 L 45 25 L 26 45 L 26 35 L 5 35 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(100),\r\n\t\t\tcenterY: percent(50)\r\n\t\t}, {\r\n\t\t\tsvgPath: \"M 45 35 L 45 15 L 24 15 L 24 5 L 5 25 L 24 45 L 24 35 L 45 35 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(0),\r\n\t\t\tcenterY: percent(50)\r\n\t\t}, {\r\n\t\t\tsvgPath: \"M 35 5 L 15 5 L 15 26 L 5 26 L 25 45 L 45 26 L 35 26 L 35 5 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(100)\r\n\t\t}, {\r\n\t\t\tsvgPath: \"M 35 45 L 15 45 L 15 24 L 5 24 L 25 5 L 45 24 L 35 24 L 35 45 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(0)\r\n\t\t},\r\n\t\t// :)\r\n\t\t{\r\n\t\t\tsvgPath: \"M 5 25 A 1 1 0 0 0 45 25 A 1 1 0 0 0 5 25 M 14 19 A 1 1 0 0 0 19 19 A 1 1 0 0 0 14 19 M 36 19 A 1 1 0 0 0 31 19 A 1 1 0 0 0 36 19 M 16 32 C 20 39 30 39 34 32\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t},\r\n\t\t// :(\r\n\t\t{\r\n\t\t\tsvgPath: \"M 5 25 A 1 1 0 0 0 45 25 A 1 1 0 0 0 5 25 M 14 19 A 1 1 0 0 0 19 19 A 1 1 0 0 0 14 19 M 36 19 A 1 1 0 0 0 31 19 A 1 1 0 0 0 36 19 M 33 37 C 28 32 21 32 16 37\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t},\r\n\t\t// :|\r\n\t\t{\r\n\t\t\tsvgPath: \"M 5 25 A 1 1 0 0 0 45 25 A 1 1 0 0 0 5 25 M 14 19 A 1 1 0 0 0 19 19 A 1 1 0 0 0 14 19 M 36 19 A 1 1 0 0 0 31 19 A 1 1 0 0 0 36 19 M 32 35 L 18 35\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t}, {\r\n\t\t\tsvgPath: \"M 25 46 C 25 38 -6 18 10 5 C 16 1 25 3 25 10 C 25 3 34 1 40 5 C 56 18 25 38 25 46\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(100)\r\n\t\t},\r\n\t\t// Flag right\r\n\t\t{\r\n\t\t\tsvgPath: \"M 2 43 L 2 4 L 26 4 L 17 15 L 26 26 L 2 26 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(0),\r\n\t\t\tcenterY: percent(100)\r\n\t\t},\r\n\t\t// star 5\r\n\t\t{\r\n\t\t\tsvgPath: \"M 25,2 L 25,2 L 33,14 L 47,18 L 37,29 L 39,44 L 25,38 L 11,44 L 13,29 L 3,18 L 17,14 L 25,2 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t},\r\n\t\t// star 8\r\n\t\t{\r\n\t\t\tsvgPath: \"M 25,2 L 25,2 L 30,13 L 41,9 L 37,20 L 48,25 L 37,30 L 41,41 L 30,37 L 25,48 L 20,37 L 9,41 L 13,30 L 2,25 L 13,20 L 9,9 L 20,13 L 25,2 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50)\r\n\t\t},\r\n\t\t// star 10\r\n\t\t{\r\n\t\t\tsvgPath: \"M 25,2 L 25,2 L 30,10 L 39,6 L 38,16 L 47,18 L 41,25 L 47,32 L 38,34 L 39,44 L 30,40 L 25,48 L 20,40 L 11,44 L 12,34 L 3,32 L 9,25 L 3,18 L 12,16 L 11,6 L 20,10 L 25,2 Z\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(50),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tstyle: { fillOpacity: 0 }\r\n\t\t},\r\n\t\t// >>\r\n\t\t{\r\n\t\t\tsvgPath: \"M 8 8 L 25 25 L 8 42 M 20 8 L 37 25 L 20 42\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(100),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tfillDisabled: true\r\n\t\t},\r\n\t\t// <<\r\n\t\t{\r\n\t\t\tsvgPath: \"M 42 8 L 25 25 L 42 42 M 30 8 L 13 25 L 30 42\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(0),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tfillDisabled: true\r\n\t\t},\r\n\t\t// ^^\r\n\t\t{\r\n\t\t\tsvgPath: \"M 42 42 L 25 25 L 9 42 M 9 29 L 25 13 L 42 30\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(100),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tfillDisabled: true\r\n\t\t},\r\n\t\t// vv\r\n\t\t{\r\n\t\t\tsvgPath: \"M 42 8 L 25 25 L 8 8 M 8 20 L 25 37 L 42 20\",\r\n\t\t\tscale: 1,\r\n\t\t\tcenterX: percent(100),\r\n\t\t\tcenterY: percent(50),\r\n\t\t\tfillDisabled: true\r\n\t\t}]\r\n\r\n\r\n\r\n\t\tr(\"DrawingControl\").setAll({\r\n\t\t\tname: l.translateAny(\"Draw\"),\r\n\t\t\ttool: \"Line\",\r\n\t\t\ttools: [\"Arrows &amp; Icons\", \"Average\", \"Callout\", \"Doodle\", \"Ellipse\", \"Fibonacci\", \"Fibonacci Timezone\", \"Horizontal Line\", \"Horizontal Ray\", \"Label\", \"Line\", \"Line Arrow\", \"Measure\", \"Parallel Channel\", \"Polyline\", \"Polyfill\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Triangle\", \"Vertical Line\"],\r\n\t\t\ttogglable: true,\r\n\t\t\tstrokeColor: color(0x882dff),\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\tstrokeWidths: [1, 2, 4, 8, 16],\r\n\t\t\tstrokeDasharray: [],\r\n\t\t\tstrokeDasharrays: [[], [2, 2], [6, 3], [8, 4, 2, 4]],\r\n\t\t\tstrokeOpacity: 1,\r\n\t\t\tshowExtension: true,\r\n\t\t\tfillColor: color(0xad6eff),\r\n\t\t\tfillOpacity: 0.2,\r\n\t\t\tlabelFill: color(0x000000),\r\n\t\t\tlabelFontSize: \"12px\",\r\n\t\t\tlabelFontSizes: [\"8px\", \"10px\", \"11px\", \"12px\", \"14px\", \"16px\", \"20px\", \"24px\", \"36px\", \"48px\"],\r\n\t\t\tlabelFontWeight: \"normal\",\r\n\t\t\tlabelFontStyle: \"normal\",\r\n\t\t\tlabelFontFamily: \"Arial\",\r\n\t\t\tlabelFontFamilies: [\"Arial\", \"Courier New\", \"Garamond\", \"Georgia\", \"Times New Roman\"],\r\n\t\t\tdrawingIcon: drawingIcons[0],\r\n\t\t\tdrawingIcons: drawingIcons,\r\n\t\t\tsnapToData: false,\r\n\t\t\tscrollable: true\r\n\t\t});\r\n\r\n\t\tr(\"ColorControl\").setAll({\r\n\t\t\tuseOpacity: true\r\n\t\t});\r\n\r\n\t\tr(\"DateRangeSelector\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Date Range\"),\r\n\t\t\tminDate: \"auto\",\r\n\t\t\tmaxDate: \"auto\"\r\n\t\t});\r\n\r\n\t\tr(\"PeriodSelector\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Period selector\"),\r\n\t\t\ttogglable: false,\r\n\t\t\ticon: \"none\",\r\n\t\t\tperiods: [\r\n\t\t\t\t//{ timeUnit: \"day\", count: 1, name: \"1\" + l.translateAny(\"D\") },\r\n\t\t\t\t{ timeUnit: \"day\", count: 5, name: \"5\" + l.translateAny(\"D\") },\r\n\t\t\t\t{ timeUnit: \"month\", count: 1, name: \"1\" + l.translateAny(\"M\") },\r\n\t\t\t\t{ timeUnit: \"month\", count: 3, name: \"3\" + l.translateAny(\"M\") },\r\n\t\t\t\t{ timeUnit: \"month\", count: 6, name: \"6\" + l.translateAny(\"M\") },\r\n\t\t\t\t{ timeUnit: \"ytd\", name: l.translateAny(\"YTD\") },\r\n\t\t\t\t{ timeUnit: \"year\", count: 1, name: \"1\" + l.translateAny(\"Y\") },\r\n\t\t\t\t{ timeUnit: \"year\", count: 2, name: \"2\" + l.translateAny(\"Y\") },\r\n\t\t\t\t{ timeUnit: \"year\", count: 5, name: \"5\" + l.translateAny(\"Y\") },\r\n\t\t\t\t{ timeUnit: \"max\", name: l.translateAny(\"Max\") },\r\n\t\t\t]\r\n\t\t});\r\n\r\n\t\t// r(\"IconControl\").setAll({\r\n\t\t// });\r\n\r\n\t\t// r(\"DrawingToolControl\").setAll({\r\n\t\t// \t//name: l.translateAny(\"Draw\"),\r\n\t\t// \t//tools: [\"Average\", \"Callout\", \"Doodle\", \"Ellipse\", \"Fibonacci\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Label\", \"Line\", \"Polyline\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"]\r\n\t\t// });\r\n\r\n\t\tr(\"DropdownListControl\").setAll({\r\n\t\t\tfixedLabel: false\r\n\t\t});\r\n\r\n\t\tr(\"DropdownList\").setAll({\r\n\t\t\tsearchable: true,\r\n\t\t\tmaxSearchItems: 10,\r\n\t\t\titems: []\r\n\t\t});\r\n\r\n\t\tr(\"ComparisonControl\").setAll({\r\n\t\t\tfixedLabel: true\r\n\t\t});\r\n\r\n\t\tr(\"SeriesTypeControl\").setAll({\r\n\t\t\tcurrentItem: \"candlestick\",\r\n\t\t\titems: [{\r\n\t\t\t\tid: \"line\",\r\n\t\t\t\tlabel: l.translateAny(\"Line\"),\r\n\t\t\t\ticon: StockIcons.getIcon(\"Line Series\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"candlestick\",\r\n\t\t\t\tlabel: l.translateAny(\"Candles\"),\r\n\t\t\t\ticon: StockIcons.getIcon(\"Candlestick Series\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"procandlestick\",\r\n\t\t\t\tlabel: l.translateAny(\"Hollow Candles\"),\r\n\t\t\t\ticon: StockIcons.getIcon(\"Pro Candlestick Series\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"ohlc\",\r\n\t\t\t\tlabel: l.translateAny(\"Sticks\"),\r\n\t\t\t\ticon: StockIcons.getIcon(\"OHLC Series\")\r\n\t\t\t}]\r\n\t\t});\r\n\r\n\t\tr(\"IntervalControl\").setAll({\r\n\t\t\tcurrentItem: \"1 day\",\r\n\t\t\titems: [\r\n\t\t\t\t{ id: \"1 minute\", label: \"1 \" + l.translateAny(\"minute\"), interval: { timeUnit: \"minute\", count: 1 } },\r\n\t\t\t\t{ id: \"2 minute\", label: \"2 \" + l.translateAny(\"minutes\"), interval: { timeUnit: \"minute\", count: 2 } },\r\n\t\t\t\t{ id: \"5 minute\", label: \"5 \" + l.translateAny(\"minutes\"), interval: { timeUnit: \"minute\", count: 5 } },\r\n\t\t\t\t{ id: \"15 minute\", label: \"15 \" + l.translateAny(\"minutes\"), interval: { timeUnit: \"minute\", count: 15 } },\r\n\t\t\t\t{ id: \"30 minute\", label: \"30 \" + l.translateAny(\"minutes\"), interval: { timeUnit: \"minute\", count: 30 } },\r\n\t\t\t\t{ id: \"1 hour\", label: \"1 \" + l.translateAny(\"hour\"), interval: { timeUnit: \"hour\", count: 1 } },\r\n\t\t\t\t{ id: \"4 hour\", label: \"4 \" + l.translateAny(\"hours\"), interval: { timeUnit: \"hour\", count: 4 } },\r\n\t\t\t\t{ id: \"1 day\", label: \"1 \" + l.translateAny(\"day\"), interval: { timeUnit: \"day\", count: 1 } },\r\n\t\t\t\t{ id: \"1 week\", label: \"1 \" + l.translateAny(\"week\"), interval: { timeUnit: \"week\", count: 1 } },\r\n\t\t\t\t{ id: \"1 month\", label: \"1 \" + l.translateAny(\"month\"), interval: { timeUnit: \"month\", count: 1 } },\r\n\t\t\t\t{ id: \"1 year\", label: \"1 \" + l.translateAny(\"year\"), interval: { timeUnit: \"year\", count: 1 } }\r\n\t\t\t]\r\n\t\t});\r\n\r\n\t\tr(\"DropdownColors\").setAll({\r\n\t\t\tcolors: ColorSet.new(this._root, {\r\n\t\t\t\tcolors: [\r\n\t\t\t\t\tcolor(0x000000), color(0x464e56), color(0x5b636a), color(0x767d84), color(0xb9bdc5), color(0xe0e4e9), color(0xf7f8ff), color(0xffffff),\r\n\t\t\t\t\tcolor(0x72d3ff), color(0xad6eff), color(0xff80c5), color(0xffbd74), color(0xffe786), color(0x64f1d9), color(0xff8084), color(0x79f4bd),\r\n\t\t\t\t\tcolor(0x2bbcff), color(0x882dff), color(0xff4aad), color(0xffa33f), color(0xffdb48), color(0x22dbbc), color(0xff333a), color(0x00b061),\r\n\t\t\t\t\tcolor(0x0780eb), color(0x6500e8), color(0xc70085), color(0xe5632a), color(0xefbb00), color(0x00a19a), color(0xdc142d), color(0x009c56),\r\n\t\t\t\t\tcolor(0x0061cb), color(0x4300ac), color(0x970064), color(0xc73b0a), color(0xe09c00), color(0x006c84), color(0xae1125), color(0x00894c),\r\n\t\t\t\t]\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t\tr(\"ResetControl\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Reset\"),\r\n\t\t\ttogglable: false,\r\n\t\t\t//align: \"right\"\r\n\t\t});\r\n\r\n\t\tr(\"SettingsControl\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Settings\"),\r\n\t\t\ttogglable: true,\r\n\t\t\tfixedLabel: true,\r\n\t\t\t//align: \"right\",\r\n\t\t\titems: [{\r\n\t\t\t\tid: \"fills\",\r\n\t\t\t\tlabel: l.translateAny(\"X-axis fills\"),\r\n\t\t\t\tclassName: \"am5stock-list-info am5stock-list-heading\"\r\n\t\t\t}, {\r\n\t\t\t\tform: \"checkbox\",\r\n\t\t\t\tid: \"fills\",\r\n\t\t\t\tlabel: l.translateAny(\"Fills\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"y-scale\",\r\n\t\t\t\tlabel: l.translateAny(\"Y-axis scale\"),\r\n\t\t\t\tclassName: \"am5stock-list-info am5stock-list-heading\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"y-scale\",\r\n\t\t\t\tform: \"radio\",\r\n\t\t\t\tvalue: \"percent\",\r\n\t\t\t\tlabel: l.translateAny(\"Change percent\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"y-scale\",\r\n\t\t\t\tform: \"radio\",\r\n\t\t\t\tvalue: \"regular\",\r\n\t\t\t\tlabel: l.translateAny(\"Regular\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"y-scale\",\r\n\t\t\t\tform: \"radio\",\r\n\t\t\t\tvalue: \"logarithmic\",\r\n\t\t\t\tlabel: l.translateAny(\"Logarithmic\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"autosave\",\r\n\t\t\t\tlabel: l.translateAny(\"Drawings &amp; Indicators\"),\r\n\t\t\t\tclassName: \"am5stock-list-info am5stock-list-heading\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"autosave\",\r\n\t\t\t\tform: \"checkbox\",\r\n\t\t\t\tlabel: l.translateAny(\"Auto-save\")\r\n\t\t\t},]\r\n\t\t});\r\n\r\n\t\tr(\"DataSaveControl\").setAll({\r\n\t\t\tdescription: l.translateAny(\"Save drawings and indicators\"),\r\n\t\t\ttogglable: true,\r\n\t\t\tfixedLabel: true,\r\n\t\t\tautoSave: false,\r\n\t\t\titems: [{\r\n\t\t\t\tid: \"autosave\",\r\n\t\t\t\tform: \"checkbox\",\r\n\t\t\t\tlabel: l.translateAny(\"Auto-save drawings and indicators\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"save\",\r\n\t\t\t\tlabel: l.translateAny(\"Save drawings &amp; indicators\"),\r\n\t\t\t\tsubLabel: l.translateAny(\"Saves drawings/indicators to browser local storage\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"restore\",\r\n\t\t\t\tlabel: l.translateAny(\"Restore saved data\"),\r\n\t\t\t\tsubLabel: l.translateAny(\"Restores saved data from browser local storage\")\r\n\t\t\t}, {\r\n\t\t\t\tid: \"clear\",\r\n\t\t\t\tlabel: l.translateAny(\"Clear\"),\r\n\t\t\t\tsubLabel: l.translateAny(\"Clears saved data from browser local storage\")\r\n\t\t\t}]\r\n\t\t});\r\n\r\n\t\tr(\"Measure\").setAll({\r\n\t\t\tlabelText: \"{value} ({percent})\\n{count.formatNumber('#,###.')} \" + l.translateAny(\"bars\") + \" {intervalCount.formatNumber('#,###.')} {intervalUnit}\",\r\n\t\t\tlabelVolumeText: \"\\nVolume: {volume.formatNumber('#.##a')}\",\r\n\t\t});\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Rectangle\", [\"selector\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tisMeasured: false,\r\n\t\t\t\tstrokeDasharray: [2, 2],\r\n\t\t\t\tstrokeOpacity: 0.5,\r\n\t\t\t\tstrokeWidth: 1\r\n\t\t\t});\r\n\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"alternativeBackground\");\r\n\t\t}\r\n\r\n\t}\r\n\r\n}","import { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"../../../core/util/Entity\"\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport type { IPointerEvent } from \"../../../core/render/backend/Renderer\";\r\nimport type { StockToolbar } from \"./StockToolbar\";\r\nimport type { StockChart } from \"../StockChart\";\r\n\r\n//import * as $array from \"../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IStockControlSettings extends IEntitySettings {\r\n\r\n\t/**\r\n\t * A [[StockChart]] the toolbar is for.\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * Is control visible?\r\n\t * \r\n\t * @default true\r\n\t */\r\n\tvisible?: boolean;\r\n\r\n\t/**\r\n\t * Force this control to always be invisible.\r\n\t *\r\n\t * @since 5.8.5\r\n\t * @defaul false\r\n\t */\r\n\tforceHidden?: boolean;\r\n\r\n\t/**\r\n\t * Name of the control. Used for the label.\r\n\t */\r\n\tname?: string;\r\n\r\n\t/**\r\n\t * Description of what the button does.\r\n\t */\r\n\tdescription?: string;\r\n\r\n\t/**\r\n\t * An element with control icon. If not set, each control will aytomatically\r\n\t * create an icon.\r\n\t */\r\n\ticon?: HTMLElement | SVGElement | \"none\";\r\n\r\n\t/**\r\n\t * Indicates if control is active.\r\n\t * \r\n\t * @default false\r\n\t */\r\n\tactive?: boolean;\r\n\r\n\t/**\r\n\t * If set to `true`, control can be toggle on and off by clicking on it.\r\n\t * \r\n\t * @default true\r\n\t */\r\n\ttogglable?: boolean;\r\n\r\n\t/**\r\n\t * Alignment of the control in a toolbar.\r\n\t *\r\n\t * @default \"left\"\r\n\t */\r\n\talign?: \"left\" | \"right\";\r\n\r\n}\r\n\r\n\r\nexport interface IStockControlPrivate extends IEntityPrivate {\r\n\ttoolbar: StockToolbar;\r\n\tbutton?: HTMLDivElement;\r\n\ticon?: HTMLElement;\r\n\tlabel?: HTMLDivElement;\r\n}\r\n\r\nexport interface IStockControlEvents extends IEntityEvents {\r\n\tclick: {\r\n\t\toriginalEvent: IPointerEvent\r\n\t}\r\n}\r\n\r\n/**\r\n * A base class for controls on [[StockToolbar]].\r\n */\r\nexport class StockControl extends Entity {\r\n\tpublic static className: string = \"StockControl\";\r\n\tpublic static classNames: Array<string> = Entity.classNames.concat([StockControl.className]);\r\n\r\n\tdeclare public _settings: IStockControlSettings;\r\n\tdeclare public _privateSettings: IStockControlPrivate;\r\n\tdeclare public _events: IStockControlEvents;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.get(\"stockChart\").controls.push(this);\r\n\r\n\t\t// Inherit default themes from chart\r\n\t\tthis._defaultThemes = this.get(\"stockChart\")._defaultThemes;\r\n\t\tsuper._afterNewApplyThemes();\r\n\r\n\t\tthis._initElements();\r\n\t\tthis._applyClassNames();\r\n\t\tthis._maybeMakeAccessible();\r\n\r\n\t\tthis._root.addDisposer(this);\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\t// Create button\r\n\t\tconst button = document.createElement(\"div\");\r\n\t\tbutton.setAttribute(\"title\", this.get(\"description\", this.get(\"name\", \"\")));\r\n\t\tthis.setPrivate(\"button\", button);\r\n\r\n\t\t// Create icon\r\n\t\tconst icon = document.createElement(\"div\");\r\n\t\ticon.appendChild(this._getIcon());\r\n\t\tif (this.get(\"icon\") == \"none\") {\r\n\t\t\ticon.style.display = \"none\";\r\n\t\t}\r\n\t\tbutton.appendChild(icon);\r\n\t\tthis.setPrivate(\"icon\", icon);\r\n\r\n\t\t// Create label\r\n\t\tconst name = this.get(\"name\", \"\");\r\n\t\tconst label = document.createElement(\"div\");\r\n\t\tlabel.innerHTML = name;\r\n\t\tif (name == \"\") {\r\n\t\t\tlabel.style.display = \"none\";\r\n\t\t}\r\n\t\tbutton.appendChild(label);\r\n\t\tthis.setPrivate(\"label\", label);\r\n\r\n\t\t// Add click event\r\n\t\tthis._disposers.push($utils.addEventListener(button, \"click\", (ev) => {\r\n\t\t\t//ev.stopImmediatePropagation();\r\n\t\t\tif (this.get(\"togglable\") != false) {\r\n\t\t\t\tthis._handleClick();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.events.isEnabled(\"click\")) {\r\n\t\t\t\tthis.events.dispatch(\"click\", {\r\n\t\t\t\t\ttype: \"click\",\r\n\t\t\t\t\ttarget: this,\r\n\t\t\t\t\toriginalEvent: <IPointerEvent>ev\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\tprotected _applyClassNames(): void {\r\n\t\tthis.getPrivate(\"button\")!.className = \"am5stock am5stock-control am5stock-control-button\";\r\n\t\tthis.getPrivate(\"label\")!.className = \"am5stock-control-label\";\r\n\t\tthis.getPrivate(\"icon\")!.className = \"am5stock-control-icon\";\r\n\t}\r\n\r\n\tprotected _getIcon(): HTMLElement | SVGElement {\r\n\t\tconst userIcon = this.get(\"icon\");\r\n\t\tif (userIcon && userIcon != \"none\") {\r\n\t\t\treturn userIcon;\r\n\t\t}\r\n\t\treturn this._getDefaultIcon();\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Default\");\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"visible\") && !this.get(\"visible\")) {\r\n\t\t\tthis.getPrivate(\"button\")!.style.display = \"none\";\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"forceHidden\") && this.get(\"forceHidden\")) {\r\n\t\t\tthis.getPrivate(\"button\")!.style.display = \"none\";\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"name\")) {\r\n\t\t\tthis._setLabel(this.get(\"name\", \"\"));\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"active\")) {\r\n\t\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\t\tif (this.get(\"active\")) {\r\n\t\t\t\t$utils.addClass(button, \"am5stock-control-button-active\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$utils.removeClass(button, \"am5stock-control-button-active\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"align\")) {\r\n\t\t\tif (this.get(\"align\") == \"right\") {\r\n\t\t\t\t$utils.addClass(this.getPrivate(\"button\")!, \"am5stock-align-right\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$utils.removeClass(this.getPrivate(\"button\")!, \"am5stock-align-right\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isPrivateDirty(\"toolbar\")) {\r\n\t\t\tthis._maybeMakeAccessible();\r\n\t\t}\r\n\r\n\t\t// todo icon\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t\t$utils.removeElement(this.getPrivate(\"button\")!);\r\n\t}\r\n\r\n\tprotected _setLabel(name: string): void {\r\n\t\tconst label = this.getPrivate(\"label\")!;\r\n\t\tlabel.innerHTML = name;\r\n\t\tif (name == \"\") {\r\n\t\t\tlabel.style.display = \"none\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlabel.style.display = \"\";\r\n\t\t}\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.setAttribute(\"title\", this.get(\"description\", this.get(\"name\", \"\")));\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tthis.getPrivate(\"button\")!.style.display = \"none\";\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tif (this.get(\"forceHidden\") !== true) {\r\n\t\t\tthis.getPrivate(\"button\")!.style.display = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleClick(): void {\r\n\t\tthis.set(\"active\", !this.get(\"active\"));\r\n\t}\r\n\r\n\tprotected _maybeMakeAccessible() {\r\n\t\tif (this.isAccessible()) {\r\n\t\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\t\tbutton.setAttribute(\"tabindex\", this._root.tabindex.toString());\r\n\t\t\tbutton.setAttribute(\"role\", \"button\");\r\n\r\n\t\t\tif ($utils.supports(\"keyboardevents\")) {\r\n\t\t\t\tbutton.setAttribute(\"aria-label\", button.getAttribute(\"title\") + \"; \" + this._t(\"Press ENTER to toggle\"));\r\n\t\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\r\n\t\t\t\t\tif (document.activeElement == button && ev.keyCode == 13) {\r\n\t\t\t\t\t\t// ENTER\r\n\t\t\t\t\t\tif (this.get(\"togglable\")) {\r\n\t\t\t\t\t\t\tthis._handleClick();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t(document.activeElement as HTMLElement).click();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic isAccessible(): boolean {\r\n\t\tconst toolbar = this.getPrivate(\"toolbar\");\r\n\t\treturn toolbar && toolbar.get(\"focusable\") ? true : false;\r\n\t}\r\n\r\n}","import type { StockControl } from \"./StockControl\";\r\nimport { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"../../../core/util/Entity\"\r\n//import type { IDisposer } from \"../../../core/util/Disposer\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\"\r\n\r\n\r\nexport interface IDropdownSettings extends IEntitySettings {\r\n\tcontrol: StockControl;\r\n\tparent?: HTMLElement;\r\n\tscrollable?: boolean;\r\n}\r\n\r\nexport interface IDropdownPrivate extends IEntityPrivate {\r\n\tcontainer?: HTMLDivElement;\r\n\tarrow?: HTMLDivElement;\r\n}\r\n\r\nexport interface IDropdownEvents extends IEntityEvents {\r\n\topened: {};\r\n\tclosed: {};\r\n}\r\n\r\n/**\r\n * A dropdown control for [[StockToolbar]].\r\n */\r\nexport class Dropdown extends Entity {\r\n\tpublic static className: string = \"Dropdown\";\r\n\tpublic static classNames: Array<string> = Entity.classNames.concat([Dropdown.className]);\r\n\r\n\tdeclare public _settings: IDropdownSettings;\r\n\tdeclare public _privateSettings: IDropdownPrivate;\r\n\tdeclare public _events: IDropdownEvents;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Inherit default themes from chart\r\n\t\tthis._defaultThemes = this.get(\"control\")._defaultThemes;\r\n\t\tsuper._afterNewApplyThemes();\r\n\r\n\t\tthis._initElements();\r\n\t\tthis._root.addDisposer(this);\r\n\r\n\t\t// Close on ESC\r\n\t\tif ($utils.supports(\"keyboardevents\")) {\r\n\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\r\n\t\t\t\tif (this.isOpen() && ev.keyCode == 27) {\r\n\t\t\t\t\tthis.hide();\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\tthis._disposers.push($utils.addEventListener(this.getPrivate(\"container\")!, \"click\", (ev: PointerEvent) => {\r\n\t\t\tif (this.isOpen()) {\r\n\t\t\t\tev.preventDefault();\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis._disposers.push($utils.addEventListener(document, \"click\", () => {\r\n\t\t\tif (this.isOpen()) {\r\n\t\t\t\tthis.hide();\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\t// Create container\r\n\t\tconst container = document.createElement(\"div\");\r\n\t\tcontainer.className = \"am5stock-control-list-container\";\r\n\t\tthis._disposers.push($utils.addEventListener(container, \"click\", (ev) => {\r\n\t\t\tev.stopPropagation();\r\n\t\t}));\r\n\r\n\t\tthis.setPrivate(\"container\", container);\r\n\r\n\t\tconst arrow = document.createElement(\"div\");\r\n\t\tarrow.className = \"am5stock-control-list-arrow\";\r\n\t\tcontainer.appendChild(arrow);\r\n\t\tthis.setPrivate(\"arrow\", arrow);\r\n\r\n\t\tconst parent = this.get(\"parent\");\r\n\t\tif (parent) {\r\n\t\t\tparent.appendChild(container);\r\n\t\t}\r\n\r\n\t\tif (this.get(\"scrollable\")) {\r\n\t\t\tthis._sizeItems();\r\n\t\t\tthis.root.container.onPrivate(\"height\", () => {\r\n\t\t\t\tthis._sizeItems();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.hide();\r\n\t}\r\n\r\n\tprotected _sizeItems(): void {\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\t\tcontainer.style.maxHeight = (this.root.container.height() - 100) + \"px\";\r\n\t\tcontainer.style.overflow = \"auto\";\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"parent\")) {\r\n\t\t\tconst parent = this.get(\"parent\");\r\n\t\t\tconst container = this.getPrivate(\"container\");\r\n\t\t\tif (parent && container) {\r\n\t\t\t\tparent.appendChild(container);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\t/**\r\n\t * Returns `true` if dropdown is currently open.\r\n\t * \r\n\t * @return  Dropdown open?\r\n\t */\r\n\tpublic isOpen(): boolean {\r\n\t\treturn this.getPrivate(\"container\")!.style.display != \"none\";\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tconst arrow = this.getPrivate(\"arrow\")!;\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\t\tcontainer.style.display = \"none\";\r\n\t\tthis.events.dispatch(\"closed\", {\r\n\t\t\ttype: \"closed\",\r\n\t\t\ttarget: this\r\n\t\t});\r\n\r\n\t\tcontainer.style.marginLeft = \"\";\r\n\t\tarrow.style.marginLeft = \"\";\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tconst arrow = this.getPrivate(\"arrow\")!;\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\t\tcontainer.style.display = \"\";\r\n\r\n\t\tlet offset = 0;\r\n\t\tconst toolbar = this.get(\"control\").getPrivate(\"toolbar\");\r\n\t\tif (toolbar) {\r\n\t\t\tconst toolbarContainer = this.get(\"control\").getPrivate(\"toolbar\").get(\"container\");\r\n\t\t\toffset = Math.round(toolbarContainer.getBoundingClientRect().right - container.getBoundingClientRect().right);\r\n\t\t}\r\n\r\n\t\tif (offset < 0) {\r\n\t\t\tcontainer.style.marginLeft = offset + \"px\";\r\n\t\t\tarrow.style.marginLeft = Math.abs(offset) + \"px\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcontainer.style.marginLeft = \"\";\r\n\t\t\tarrow.style.marginLeft = \"\";\r\n\t\t}\r\n\r\n\t\tthis.events.dispatch(\"opened\", {\r\n\t\t\ttype: \"opened\",\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\tpublic toggle(): void {\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\t\tif (container.style.display == \"none\") {\r\n\t\t\tthis.show();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.hide();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _maybeMakeAccessible() {\r\n\t\tif (this.isAccessible()) {\r\n\t\t}\r\n\t}\r\n\r\n\tpublic isAccessible(): boolean {\r\n\t\tconst toolbar = this.get(\"control\").getPrivate(\"toolbar\");\r\n\t\treturn toolbar && toolbar.get(\"focusable\") ? true : false;\r\n\t}\r\n\r\n}","import { Color, color } from \"../../../core/util/Color\";\r\n\r\nimport { ColorSet } from \"../../../core/util/ColorSet\";\r\nimport { Dropdown, IDropdownSettings, IDropdownPrivate, IDropdownEvents } from \"./Dropdown\"\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IDropdownColorsSettings extends IDropdownSettings {\r\n\tcolors?: ColorSet;\r\n\tuseOpacity?: boolean;\r\n}\r\n\r\n\r\nexport interface IDropdownColorsPrivate extends IDropdownPrivate {\r\n\tlist?: HTMLUListElement;\r\n\tcolor?: Color;\r\n\topacity?: number;\r\n}\r\n\r\nexport interface IDropdownColorsEvents extends IDropdownEvents {\r\n\tinvoked: {\r\n\t\tcolor: Color;\r\n\t};\r\n\r\n\tinvokedOpacity: {\r\n\t\topacity: number;\r\n\t};\r\n}\r\n\r\n/**\r\n * A dropdown used for color picker control.\r\n *\r\n * Should not be used as standalone control.\r\n */\r\nexport class DropdownColors extends Dropdown {\r\n\tpublic static className: string = \"DropdownColors\";\r\n\tpublic static classNames: Array<string> = Dropdown.classNames.concat([DropdownColors.className]);\r\n\r\n\tdeclare public _settings: IDropdownColorsSettings;\r\n\tdeclare public _privateSettings: IDropdownColorsPrivate;\r\n\tdeclare public _events: IDropdownColorsEvents;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis._setupKeyboardNav();\r\n\t\tthis._root.addDisposer(this);\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\r\n\t\t// Create container\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\r\n\t\t// Create list\r\n\t\tconst list = document.createElement(\"ul\");\r\n\t\tlist.className = \"am5stock-control-colors\";\r\n\t\tcontainer.appendChild(list);\r\n\t\tthis.setPrivate(\"list\", list);\r\n\r\n\t\tthis._initItems();\r\n\t}\r\n\r\n\tprotected _initItems(): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tlist.innerHTML = \"\";\r\n\r\n\t\tlet cs = this.get(\"colors\");\r\n\t\tif (!cs) {\r\n\t\t\tcs = ColorSet.new(this._root, {});\r\n\t\t}\r\n\t\tconst colors = cs.get(\"colors\", []);\r\n\t\t$array.each(colors, (item) => {\r\n\t\t\tthis.addItem(item);\r\n\t\t});\r\n\t\tthis._initOpacity();\r\n\t\tthis._maybeMakeAccessible();\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"colors\") || this.isDirty(\"useOpacity\") || this.isPrivateDirty(\"color\") || this.isPrivateDirty(\"opacity\")) {\r\n\t\t\tthis._initItems();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"control\")) {\r\n\t\t\tthis._maybeMakeAccessible();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\tpublic addItem(color: Color): void {\r\n\t\tconst currentColor = this.getPrivate(\"color\") ? this.getPrivate(\"color\")!.hex : 0;\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst item = document.createElement(\"li\");\r\n\t\titem.className = \"am5stock-control-color\";\r\n\t\tif (currentColor == color.hex) {\r\n\t\t\titem.className += \" am5stock-control-active\";\r\n\t\t}\r\n\t\titem.style.background = color.toCSS();\r\n\t\tlist.appendChild(item);\r\n\r\n\t\t// Add click event\r\n\t\tthis._disposers.push($utils.addEventListener(item, \"click\", (_ev) => {\r\n\t\t\tthis.hide();\r\n\t\t\tthis.events.dispatch(\"invoked\", {\r\n\t\t\t\ttype: \"invoked\",\r\n\t\t\t\tcolor: color,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t}));\r\n\t}\r\n\r\n\tprotected _initOpacity(): void {\r\n\t\tif (this.get(\"useOpacity\")) {\r\n\t\t\tconst currentOpacity = this.getPrivate(\"opacity\", 1);\r\n\t\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\t\tconst hr = document.createElement(\"hr\");\r\n\t\t\tlist.appendChild(hr);\r\n\r\n\t\t\tfor (let opacity = 100; opacity >= 0; opacity -= 25) {\r\n\t\t\t\tconst fill = color(0x000000);\r\n\t\t\t\tconst item = document.createElement(\"li\");\r\n\t\t\t\titem.innerHTML = opacity + \"%\";\r\n\t\t\t\titem.className = \"am5stock-control-opacity am5stock-control-opacity-\" + opacity;\r\n\t\t\t\tif (currentOpacity * 100 == opacity) {\r\n\t\t\t\t\titem.className += \" am5stock-control-active\";\r\n\t\t\t\t}\r\n\t\t\t\titem.style.background = fill.toCSS(opacity / 100);\r\n\t\t\t\tlist.appendChild(item);\r\n\r\n\t\t\t\t// Add click event\r\n\t\t\t\tthis._disposers.push($utils.addEventListener(item, \"click\", (_ev) => {\r\n\t\t\t\t\tthis.hide();\r\n\t\t\t\t\tthis.events.dispatch(\"invokedOpacity\", {\r\n\t\t\t\t\t\ttype: \"invokedOpacity\",\r\n\t\t\t\t\t\topacity: opacity / 100,\r\n\t\t\t\t\t\ttarget: this\r\n\t\t\t\t\t});\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setupKeyboardNav(): void {\r\n\t\tif ($utils.supports(\"keyboardevents\")) {\r\n\t\t\tconst button = this.get(\"control\").getPrivate(\"button\")!;\r\n\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\r\n\t\t\t\tif (this.isAccessible()) {\r\n\t\t\t\t\tif (document.activeElement && (document.activeElement === button || $utils.contains(button, document.activeElement))) {\r\n\t\t\t\t\t\tif (ev.keyCode == 13) {\r\n\t\t\t\t\t\t\t// ENTER\r\n\t\t\t\t\t\t\tif (document.activeElement !== button) {\r\n\t\t\t\t\t\t\t\t(document.activeElement as HTMLElement).click();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if ([37, 38, 39, 40].indexOf(ev.keyCode) !== -1) {\r\n\t\t\t\t\t\t\tconst dir = ev.keyCode == 37 || ev.keyCode == 38 ? -1 : 1;\r\n\t\t\t\t\t\t\tconst items = this._getActiveItems();\r\n\t\t\t\t\t\t\tconst selected = button.querySelectorAll(\".am5stock-control-color:focus, .am5stock-control-opacity:focus\");\r\n\t\t\t\t\t\t\tlet index: number = -1;\r\n\t\t\t\t\t\t\tif (selected.length > 0) {\r\n\t\t\t\t\t\t\t\titems.forEach((item, key) => {\r\n\t\t\t\t\t\t\t\t\tif (item === selected.item(0)) {\r\n\t\t\t\t\t\t\t\t\t\tindex = key;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tindex += dir;\r\n\t\t\t\t\t\t\tif (index < 0) {\r\n\t\t\t\t\t\t\t\tindex = items.length - 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (index >= items.length) {\r\n\t\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$utils.focus(items.item(index) as HTMLElement);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _maybeMakeAccessible(): void {\r\n\t\tsuper._maybeMakeAccessible();\r\n\t\tif (this.isAccessible()) {\r\n\t\t\t//const tabindex = this._root.tabindex.toString();\r\n\t\t\t//const list = this.getPrivate(\"list\")!;\r\n\t\t\tconst items = this._getActiveItems();\r\n\t\t\titems.forEach((item, key) => {\r\n\t\t\t\t(item as HTMLElement).setAttribute(\"tabindex\", \"-1\");\r\n\t\t\t\t(item as HTMLElement).setAttribute(\"aria-label\", this.root.language.translateAny(\"Selection\") + \" #\" + (key + 1));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getActiveItems(): NodeList {\r\n\t\treturn this.getPrivate(\"list\")!.querySelectorAll(\".am5stock-control-color, .am5stock-control-opacity\");\r\n\t}\r\n\r\n}","import type { Root } from \"../../../core/Root\"\n\nimport { StyleRule } from \"../../../core/util/Utils\"\nimport { MultiDisposer, IDisposer, CounterDisposer } from \"../../../core/util/Disposer\";\n\n/**\n * @ignore\n */\nlet rules: CounterDisposer | undefined;\n\n/**\n * @ignore\n */\nexport default function(element: ShadowRoot | null, root: Root, _prefix?: string): IDisposer {\n\tconst ic = root.interfaceColors;\n\tconst active = ic.get(\"secondaryButton\")!.toCSS();\n\tconst hover = ic.get(\"secondaryButtonHover\")!.toCSS();\n\t//const border = ic.get(\"secondaryButtonStroke\")!.toCSS();\n\tconst text = ic.get(\"text\")!.toCSS();\n\tconst textDisabled = ic.get(\"disabled\")!.toCSS();\n\tconst border = ic.get(\"secondaryButtonActive\")!.toCSS();\n\tconst bg = ic.get(\"background\")!.toCSS();\n\tconst link = ic.get(\"primaryButton\")!.toCSS();\n\n\tif (!rules) {\n\t\tconst disposer = new MultiDisposer([\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"position\": \"relative\",\n\t\t\t\t\"border\": \"1px solid \" + border,\n\t\t\t\t\"border-radius\": \"4px\",\n\t\t\t\t\"padding\": \"3px 0 3px 5px\",\n\t\t\t\t\"margin\": \"2px\",\n\t\t\t\t\"z-index\": \"1\",\n\t\t\t\t\"cursor\": \"default\",\n\t\t\t\t\"line-height\": \"1.5em\",\n\t\t\t\t\"color\": text\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button div\", {\n\t\t\t\t\"box-sizing\": \"initial\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button:hover\", {\n\t\t\t\t//\"background\": hover\n\t\t\t\t\"border-color\": hover\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button.am5stock-no-hover:hover\", {\n\t\t\t\t\"background\": \"initial\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content .am5stock-control-button\", {\n\t\t\t\t\"padding\": \"5px 6px\",\n\t\t\t\t\"line-height\": \"0.8em\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-color .am5stock-control-icon\", {\n\t\t\t\t\"border-radius\": \"3px\",\n\t\t\t\t\"min-height\": \"1em\",\n\t\t\t\t\"max-width\": \"50px\",\n\t\t\t\t\"line-height\": \"0.8em\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content .am5stock-control-color .am5stock-control-icon\", {\n\t\t\t\t\"margin\": \"0\",\n\t\t\t\t\"width\": \"48px\",\n\t\t\t\t\"min-height\": \"1em\",\n\t\t\t\t\"max-width\": \"50px\",\n\t\t\t\t\"line-height\": \"0.8em\",\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content .am5stock-control-button .am5stock-control-icon > .am5stock-control-icon-color\", {\n\t\t\t\t\"width\": \"1px\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content input[type=\\\"text\\\"], .am5-modal-content input[type=\\\"number\\\"], .am5-modal-content select\", {\n\t\t\t\t\"border\": \"1px solid \" + border,\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button.am5stock-align-right\", {\n\t\t\t\t\"float\": \"right\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button.am5stock-control-button-active\", {\n\t\t\t\t\"background\": active,\n\t\t\t\t\"z-index\": \"2\",\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button.am5stock-control-dropdown.am5stock-control-button-active\", {\n\t\t\t\t\"z-index\": \"3\",\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content .am5stock-control-button.am5stock-control-button-active, .am5-modal-content .am5stock-control-button:hover\", {\n\t\t\t\t\"background\": \"none\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content .am5-modal-link-reset\", {\n\t\t\t\t\"display\": \"block\",\n\t\t\t\t\"color\": link,\n\t\t\t\t\"text-transform\": \"uppercase\",\n\t\t\t\t\"font-weight\": \"500\",\n\t\t\t\t\"margin-top\": \"0.5em\",\n\t\t\t\t\"font-size\": \"0.8em\",\n\t\t\t\t\"cursor\": \"pointer\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon\", {\n\t\t\t\t\"min-width\": \"1.2em\",\n\t\t\t\t\"min-height\": \"1.2em\",\n\t\t\t\t\"max-width\": \"1.2em\",\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"position\": \"relative\",\n\t\t\t\t\"margin\": \"0 5px 0 0\",\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon.am5stock-icon-wide\", {\n\t\t\t\t\"max-width\": \"60px\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon > *\", {\n\t\t\t\t\"vertical-align\": \"sub\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon > .am5stock-control-icon-color\", {\n\t\t\t\t\"max-width\": \"20px\",\n\t\t\t\t\"width\": \"20px\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-icon > .am5stock-control-icon-color-bg\", {\n\t\t\t\t\"width\": \"100%\",\n\t\t\t\t\"height\": \"100%\",\n\t\t\t\t\"display\": \"block\",\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"left\": \"0\",\n\t\t\t\t\"top\": \"0\",\n\t\t\t\t\"z-index\": \"-1\",\n\t\t\t\t\"overflow\": \"hidden\",\n\t\t\t\t\"border-radius\": \"3px\",\n\t\t\t\t\"background-image\": \"linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%)\",\n\t\t\t\t\"background-size\": \"10px 10px\",\n\t\t\t\t\"background-position\": \"0 0, 0 5px, 5px -5px, -5px 0px\",\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-button path\", {\n\t\t\t\t\"stroke-width\": \"0.5\",\n\t\t\t\t\"stroke\": text,\n\t\t\t\t\"fill\": \"none\",\n\t\t\t\t\"vector-effect\": \"non-scaling-stroke\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-label\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"margin\": \"0 5px 0 0\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list-container\", {\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"left\": \"0\",\n\t\t\t\t\"top\": \"100%\",\n\t\t\t\t\"margin-top\": \"10px\",\n\t\t\t\t\"background\": bg,\n\t\t\t\t\"border\": \"1px solid \" + border,\n\t\t\t\t\"border-radius\": \"3px\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-align-right .am5stock-control-list-container\", {\n\t\t\t\t\"left\": \"auto\",\n\t\t\t\t\"right\": \"0\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list-arrow\", {\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"left\": \"5px\",\n\t\t\t\t\"top\": \"-5px\",\n\t\t\t\t\"border\": \"solid \" + border,\n\t\t\t\t\"border-width\": \"0 1px 1px 0\",\n\t\t\t\t\"background\": bg,\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"padding\": \"5px\",\n\t\t\t\t\"transform\": \"rotate(-135deg)\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-align-right .am5stock-control-list-arrow\", {\n\t\t\t\t\"right\": \"5px\",\n\t\t\t\t\"left\": \"auto\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list\", {\n\t\t\t\t\"list-style\": \"none\",\n\t\t\t\t\"margin\": \"5px\",\n\t\t\t\t\"padding\": \"2px\",\n\t\t\t\t\"white-space\": \"nowrap\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li\", {\n\t\t\t\t\"padding\": \"2px 6px 2px 6px\",\n\t\t\t\t\"position\": \"relative\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li:hover\", {\n\t\t\t\t\"background\": active\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li.am5stock-list-info\", {\n\t\t\t\t\"font-style\": \"italic\",\n\t\t\t\t\"color\": hover\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list .am5stock-list-sub\", {\n\t\t\t\t\"font-size\": \"0.7em\",\n\t\t\t\t\"color\": hover,\n\t\t\t\t\"display\": \"block\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li.am5stock-list-info:hover\", {\n\t\t\t\t\"background\": \"none\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li.am5stock-list-heading\", {\n\t\t\t\t\"font-style\": \"normal\",\n\t\t\t\t\"font-weight\": \"bold\",\n\t\t\t\t\"color\": \"initial\",\n\t\t\t\t\"margin-top\": \"0.3em\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li.am5stock-disabled:hover, .am5stock-control-list li.am5stock-disabled > *\", {\n\t\t\t\t\"background\": \"none\",\n\t\t\t\t\"color\": textDisabled\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li svg\", {\n\t\t\t\t\"max-width\": \"1em\",\n\t\t\t\t\"max-height\": \"1em\",\n\t\t\t\t\"margin-right\": \"0.8em\",\n\t\t\t\t//\"position\": \"absolute\",\n\t\t\t\t\"left\": \"0px\",\n\t\t\t\t\"top\": \"2px\",\n\t\t\t\t\"display\": \"inline-block\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li svg.am5stock-icon-wide, .am5stock-control-icon > *.am5stock-icon-wide\", {\n\t\t\t\t\"width\": \"60px\",\n\t\t\t\t\"max-width\": \"60px\",\n\t\t\t\t\"margin-right\": \"0\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li div, .am5stock-control-list li label\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"margin-right\": \"1em\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-list li input\", {\n\t\t\t\t\"margin-right\": \"1em\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-list-search\", {\n\t\t\t\t//\"display\": \"inline-block\",\n\t\t\t\t\"margin\": \"0.5em 0.7em\",\n\t\t\t\t\"padding-bottom\": \"0.25em\",\n\t\t\t\t//\"padding-left\": \"30px\",\n\t\t\t\t//\"border-bottom\": \"1px solid \" + active,\n\t\t\t\t\"position\": \"relative\",\n\t\t\t\t//\"background\": \"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyNCIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjEwLjUiIHI9IjcuNSIvPjxsaW5lIHgxPSIyMSIgeDI9IjE1LjgiIHkxPSIyMSIgeTI9IjE1LjgiLz48L3N2Zz4=) left / 20px 20px no-repeat\",\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-list-search input\", {\n\t\t\t\t\"border\": \"1px solid \" + active,\n\t\t\t\t\"padding\": \"6px 10px 6px 30px\",\n\t\t\t\t\"margin-top\": \"5px\",\n\t\t\t\t\"background\": \"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyNCIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMTAuNSIgY3k9IjEwLjUiIHI9IjcuNSIvPjxsaW5lIHgxPSIyMSIgeDI9IjE1LjgiIHkxPSIyMSIgeTI9IjE1LjgiLz48L3N2Zz4=) 5px / 20px 20px no-repeat\",\n\t\t\t\t\"background-color\": \"#fff\",\n\t\t\t\t//\"background-color\": active,\n\t\t\t\t\"color\": \"#888\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-list-search input::placeholder\", {\n\t\t\t\t\"color\": \"#888\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors, .am5stock-control-icons\", {\n\t\t\t\t\"list-style\": \"none\",\n\t\t\t\t\"margin\": \"5px\",\n\t\t\t\t\"padding\": \"2px\",\n\t\t\t\t//\"white-space\": \"nowrap\",\n\t\t\t\t\"width\": \"240px\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors li, .am5stock-control-icons li\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"padding\": \"0\",\n\t\t\t\t\"margin\": \"0\",\n\t\t\t\t\"border\": \"3px solid \" + bg,\n\t\t\t\t\"width\": \"24px\",\n\t\t\t\t\"height\": \"24px\",\n\t\t\t\t\"position\": \"relative\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors li:hover, .am5stock-control-colors li.am5stock-control-active, .am5stock-control-icons li:hover, .am5stock-control-icons li.am5stock-control-active\", {\n\t\t\t\t\"border-color\": \"rgba(200, 200, 200, 1)\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors li.am5stock-control-opacity\", {\n\t\t\t\t\"width\": \"42px\",\n\t\t\t\t\"text-align\": \"center\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-colors li.am5stock-control-opacity\", {\n\t\t\t\t\"width\": \"42px\",\n\t\t\t\t\"text-align\": \"center\",\n\t\t\t\t\"font-size\": \"12px\",\n\t\t\t\t\"line-height\": \"24px\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-control-opacity-100, .am5stock-control-opacity-75, .am5stock-control-opacity-50\", {\n\t\t\t\t\"color\": \"#fff\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-row\", {\n\t\t\t\t\"display\": \"flex\",\n\t\t\t\t\"flex-direction\": \"row\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-column\", {\n\t\t\t\t\"min-width\": \"200px\",\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"padding\": \"1em\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-group\", {\n\t\t\t\t\"white-space\": \"nowrap\",\n\t\t\t\t//\"margin\": \"0.5em 1em\",\n\t\t\t\t\"padding-bottom\": \"0.25em\",\n\t\t\t\t\"border-bottom\": \"1px solid \" + active,\n\t\t\t\t\"position\": \"relative\",\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-group input\", {\n\t\t\t\t\"border\": \"none\",\n\t\t\t\t\"padding\": \"3px 5px\",\n\t\t\t\t//\"margin-top\": \"5px\",\n\t\t\t\t\"width\": \"100%\",\n\t\t\t\t\"box-sizing\": \"border-box\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-small\", {\n\t\t\t\t\"font-size\": \"0.7em\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-link\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"margin\": \"0 0.15em\",\n\t\t\t\t\"padding\": \"0 3px\",\n\t\t\t\t\"border-radius\": \"3px\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-link.am5stock-active, .am5stock-link:hover\", {\n\t\t\t\t//\"font-weight\": \"bold\"\n\t\t\t\t\"background\": active\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-link.am5stock-hidden\", {\n\t\t\t\t\"display\": \"none\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-drawing-label-wrapper\", {\n\t\t\t\t//\"font-weight\": \"bold\"\n\t\t\t\t\"background-color\": bg,\n\t\t\t\t\"bakcground-opacity\": \"0.5\",\n\t\t\t\t\"padding\": \"0.5em\",\n\t\t\t\t\"border-radius\": \"4px\",\n\t\t\t\t\"-webkit-box-shadow\": \"0px 0px 36px 0px rgba(0,0,0,0.45)\",\n\t\t\t\t\"box-shadow\": \"0px 0px 36px 0px rgba(0,0,0,0.45)\"\n\t\t\t}, root.nonce),\n\n\t\t\tnew StyleRule(element, \".am5stock-drawing-label-input\", {\n\t\t\t\t\"width\": \"250px\",\n\t\t\t\t\"min-height\": \"50px\",\n\t\t\t}, root.nonce),\n\n\t\t]);\n\n\t\trules = new CounterDisposer(() => {\n\t\t\trules = undefined;\n\t\t\tdisposer.dispose();\n\t\t});\n\t}\n\n\treturn rules.increment();\n}","import type { ColorSet } from \"../../../core/util/ColorSet\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownColors } from \"./DropdownColors\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\";\r\nimport StockToolbarCSS from \"./StockToolbarCSS\";\r\n\r\nexport interface IColorControlSettings extends IStockControlSettings {\r\n\tcolors?: ColorSet;\r\n\tuseOpacity?: boolean;\r\n}\r\n\r\nexport interface IColorControlPrivate extends IStockControlPrivate {\r\n\tdropdown?: DropdownColors;\r\n\tcolor?: Color;\r\n\topacity?: number;\r\n}\r\n\r\nexport interface IColorControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\tcolor: Color\r\n\t}\r\n\tselectedOpacity: {\r\n\t\topacity: number\r\n\t}\r\n}\r\n\r\n/**\r\n * Color picker control.\r\n */\r\nexport class ColorControl extends StockControl {\r\n\tpublic static className: string = \"ColorControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([ColorControl.className]);\r\n\r\n\tdeclare public _settings: IColorControlSettings;\r\n\tdeclare public _privateSettings: IColorControlPrivate;\r\n\tdeclare public _events: IColorControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Control\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-color\";\r\n\r\n\t\t// Create list of tools\r\n\t\tconst dropdownSettings: any = {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tuseOpacity: this.get(\"useOpacity\")\r\n\t\t}\r\n\t\tif (this.get(\"colors\")) {\r\n\t\t\tdropdownSettings.colors = this.get(\"colors\");\r\n\t\t}\r\n\t\tconst dropdown = DropdownColors.new(this._root, dropdownSettings);\r\n\t\tthis.setPrivate(\"dropdown\", dropdown);\r\n\r\n\t\tdropdown.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"invoked\", (ev) => {\r\n\t\t\tthis.setPrivate(\"color\", ev.color);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\tcolor: ev.color,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"invokedOpacity\", (ev) => {\r\n\t\t\tthis.setPrivate(\"opacity\", ev.opacity);\r\n\t\t\tthis.events.dispatch(\"selectedOpacity\", {\r\n\t\t\t\ttype: \"selectedOpacity\",\r\n\t\t\t\topacity: ev.opacity,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tdropdown.setPrivate(\"color\", this.getPrivate(\"color\"));\r\n\t\t\t\tdropdown.setPrivate(\"opacity\", this.getPrivate(\"opacity\"));\r\n\t\t\t\tthis.setTimeout(() => dropdown.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdropdown.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.onPrivate(\"color\", () => {\r\n\t\t\tconst color = this.getPrivate(\"color\");\r\n\t\t\tthis.getPrivate(\"icon\")!.style.backgroundColor = color ? color.toCSS(this.getPrivate(\"opacity\", 1)) : \"\";\r\n\t\t});\r\n\r\n\t\tthis.onPrivate(\"opacity\", () => {\r\n\t\t\tconst color = this.getPrivate(\"color\");\r\n\t\t\tthis.getPrivate(\"icon\")!.style.backgroundColor = color ? color.toCSS(this.getPrivate(\"opacity\", 1)) : \"\";\r\n\t\t});\r\n\r\n\t\t// Add checkered background for showing opacity\r\n\t\tconst bg = document.createElement(\"div\");\r\n\t\tbg.className = \"am5stock-control-icon-color-bg\";\r\n\t\tthis.getPrivate(\"icon\")!.appendChild(bg);\r\n\r\n\t\tthis.loadDefaultCSS();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sets color.\r\n\t * \r\n\t * @param  color  Color\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic setColor(color: Color) {\r\n\t\tthis.setPrivate(\"color\", color);\r\n\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\ttype: \"selected\",\r\n\t\t\tcolor: color,\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Sets opacity.\r\n\t * \r\n\t * @param  opacity  Opacity\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic setOpacity(opacity: number) {\r\n\t\tthis.setPrivate(\"opacity\", opacity);\r\n\t\tthis.events.dispatch(\"selectedOpacity\", {\r\n\t\t\ttype: \"selectedOpacity\",\r\n\t\t\topacity: opacity,\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\tconst icon = StockIcons.getIcon(\"Color\");\r\n\t\t$utils.addClass(icon, \"am5stock-control-icon-color\");\r\n\t\treturn icon;\r\n\t}\r\n\r\n\t/**\r\n\t * Loads the default CSS.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic loadDefaultCSS(): void {\r\n\t\tconst disposer = StockToolbarCSS($utils.getShadowRoot(this._root.dom), this._root);\r\n\t\tthis._disposers.push(disposer);\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tsuper.hide();\r\n\t}\r\n\r\n\tprotected _maybeMakeAccessible(): void {\r\n\t\tsuper._maybeMakeAccessible();\r\n\t\tif (this.isAccessible()) {\r\n\t\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\t\tbutton.setAttribute(\"aria-label\", button.getAttribute(\"title\") + \"; \" + this._t(\"Press ENTER or use arrow keys to navigate\"));\r\n\r\n\t\t\tif ($utils.supports(\"keyboardevents\")) {\r\n\t\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\r\n\t\t\t\t\tif (document.activeElement == button) {\r\n\t\t\t\t\t\tif (ev.keyCode == 38 || ev.keyCode == 40) {\r\n\t\t\t\t\t\t\t// Open on arrows\r\n\t\t\t\t\t\t\tif (!this.get(\"active\")) {\r\n\t\t\t\t\t\t\t\tthis._handleClick();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}","import type { Indicator, IIndicatorEditableSetting } from \"./indicators/Indicator\";\r\nimport type { StockChart } from \"./StockChart\";\r\nimport type { XYSeries } from \"../xy/series/XYSeries\";\r\n\r\nimport { CandlestickSeries } from \"../xy/series/CandlestickSeries\";\r\nimport { LineSeries } from \"../xy/series/LineSeries\";\r\nimport { Modal, IModalSettings, IModalPrivate, IModalEvents } from \"../../core/util/Modal\";\r\nimport { ColorControl } from \"./toolbar/ColorControl\";\r\n\r\nimport * as $array from \"../../core/util/Array\";\r\nimport * as $object from \"../../core/util/Object\";\r\nimport * as $utils from \"../../core/util/Utils\";\r\nimport * as $type from \"../../core/util/Type\";\r\n\r\n\r\nexport interface ISettingsModalSettings extends IModalSettings {\r\n\r\n\t/**\r\n\t * A target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * Show the \"Reset to default\" link?\r\n\t *\r\n\t * @default true\r\n\t * @since 5.9.0\r\n\t */\r\n\tshowResetLink?: boolean;\r\n\r\n}\r\n\r\nexport interface ISettingsModalPrivate extends IModalPrivate {\r\n}\r\n\r\nexport interface ISettingsModalEvents extends IModalEvents {\r\n\r\n\t/**\r\n\t * Invoked when modal is closed/saved.\r\n\t */\r\n\tdone: {\r\n\t\tsettings?: any,\r\n\t\tsettingsTarget?: Indicator | XYSeries\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\ninterface ISeriesEditableSetting extends IIndicatorEditableSetting {\r\n\tid?: string;\r\n\ttarget?: any;\r\n\tadditionalKeys?: string[];\r\n\tcurrentValue?: any;\r\n\tinvalidateTarget?: XYSeries;\r\n}\r\n\r\n/**\r\n * Used to display a modal dialog with HTML content.\r\n */\r\nexport class SettingsModal extends Modal {\r\n\tpublic static className: string = \"SettingsModal\";\r\n\tpublic static classNames: Array<string> = Modal.classNames.concat([Modal.className]);\r\n\r\n\tdeclare public _settings: ISettingsModalSettings;\r\n\tdeclare public _privateSettings: ISettingsModalPrivate;\r\n\tdeclare public _events: ISettingsModalEvents;\r\n\r\n\tprotected _updatedSettings: { [index: string]: any } = {};\r\n\tprotected _settingsTarget?: Indicator | XYSeries;\r\n\tprotected _colorControl?: ColorControl;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\t// if (this.isDirty(\"content\")) {\r\n\t\t// \tthis.getPrivate(\"content\").innerHTML = this.get(\"content\", \"\");\r\n\t\t// }\r\n\t}\r\n\r\n\t/**\r\n\t * Opens settings modal for an [[Indicator]].\r\n\t * \r\n\t * @param  target  Target indicator\r\n\t */\r\n\tpublic openIndicator(target: Indicator): void {\r\n\t\tthis._settingsTarget = target;\r\n\t\tthis.initContent(target._editableSettings, target);\r\n\t}\r\n\r\n\t/**\r\n\t * Opens settings editing for the any [[XYSeries]].\r\n\t * \r\n\t * @param  series  target series\r\n\t */\r\n\tpublic openSeries(series: XYSeries): void {\r\n\t\tthis._settingsTarget = series;\r\n\r\n\t\tconst l = this._root.language;\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst isline = series instanceof LineSeries;\r\n\r\n\t\tlet settings: ISeriesEditableSetting[] = [];\r\n\r\n\t\tif (series == stockChart.get(\"stockSeries\") && !isline) {\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"stockPositiveColor\",\r\n\t\t\t\tkey: \"stockPositiveColor\",\r\n\t\t\t\tname: l.translateAny(\"Increase\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: stockChart.get(\"stockPositiveColor\", this._root.interfaceColors.get(\"positive\")),\r\n\t\t\t\ttarget: stockChart\r\n\t\t\t});\r\n\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"stockNegativeColor\",\r\n\t\t\t\tkey: \"stockNegativeColor\",\r\n\t\t\t\tname: l.translateAny(\"Decrease\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: stockChart.get(\"stockNegativeColor\", this._root.interfaceColors.get(\"negative\")),\r\n\t\t\t\ttarget: stockChart\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (series == stockChart.get(\"volumeSeries\") && !isline) {\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"volumePositiveColor\",\r\n\t\t\t\tkey: \"volumePositiveColor\",\r\n\t\t\t\tname: l.translateAny(\"Increase\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: stockChart.get(\"volumePositiveColor\", this._root.interfaceColors.get(\"positive\")),\r\n\t\t\t\ttarget: stockChart\r\n\t\t\t});\r\n\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"volumeNegativeColor\",\r\n\t\t\t\tkey: \"volumeNegativeColor\",\r\n\t\t\t\tname: l.translateAny(\"Decrease\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: stockChart.get(\"volumeNegativeColor\", this._root.interfaceColors.get(\"negative\")),\r\n\t\t\t\ttarget: stockChart\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (series instanceof CandlestickSeries && series.columns.length) {\r\n\t\t\tconst column = series.columns.getIndex(0);\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"riseFromOpen.fill\",\r\n\t\t\t\tkey: \"fill\",\r\n\t\t\t\tadditionalKeys: [\"stroke\"],\r\n\t\t\t\tname: l.translateAny(\"Increase\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: column!.states.lookup(\"riseFromOpen\")!.get(\"fill\"),\r\n\t\t\t\ttarget: series.columns.template.states.create(\"riseFromOpen\", {}),\r\n\t\t\t\tinvalidateTarget: series\r\n\t\t\t});\r\n\r\n\t\t\tsettings.push({\r\n\t\t\t\tid: \"dropFromOpen.fill\",\r\n\t\t\t\tkey: \"fill\",\r\n\t\t\t\tadditionalKeys: [\"stroke\"],\r\n\t\t\t\tname: l.translateAny(\"Decrease\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tcurrentValue: column!.states.lookup(\"dropFromOpen\")!.get(\"fill\"),\r\n\t\t\t\ttarget: series.columns.template.states.create(\"dropFromOpen\", {}),\r\n\t\t\t\tinvalidateTarget: series\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (isline) {\r\n\t\t\tsettings = [{\r\n\t\t\t\tkey: \"stroke\",\r\n\t\t\t\tname: l.translateAny(\"Line\"),\r\n\t\t\t\ttype: \"color\",\r\n\t\t\t\tadditionalKeys: [\"fill\"],\r\n\t\t\t\ttarget: (<LineSeries>series),\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"strokeWidth\",\r\n\t\t\t\tname: l.translateAny(\"Line\"),\r\n\t\t\t\ttype: \"dropdown\",\r\n\t\t\t\toptions: [\r\n\t\t\t\t\t{ value: 1, text: \"1px\" },\r\n\t\t\t\t\t{ value: 2, text: \"2px\" },\r\n\t\t\t\t\t{ value: 4, text: \"4px\" },\r\n\t\t\t\t\t{ value: 10, text: \"10px\" }\r\n\t\t\t\t],\r\n\t\t\t\tcurrentValue: (<LineSeries>series).strokes.template.get(\"strokeWidth\", 1),\r\n\t\t\t\ttarget: (<LineSeries>series).strokes.template,\r\n\t\t\t\tinvalidateTarget: series\r\n\t\t\t}];\r\n\t\t\tif ((<LineSeries>series).fills.template.get(\"visible\")) {\r\n\t\t\t\tsettings.push({\r\n\t\t\t\t\tkey: \"fill\",\r\n\t\t\t\t\tname: l.translateAny(\"Fill\"),\r\n\t\t\t\t\ttype: \"color\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsettings = [{\r\n\t\t\t\tkey: \"stroke\",\r\n\t\t\t\tname: l.translateAny(\"Line\"),\r\n\t\t\t\ttype: \"color\"\r\n\t\t\t}, {\r\n\t\t\t\tkey: \"fill\",\r\n\t\t\t\tname: l.translateAny(\"Fill\"),\r\n\t\t\t\ttype: \"color\"\r\n\t\t\t}];\r\n\t\t}\r\n\t\tthis.initContent(settings, series);\r\n\t}\r\n\r\n\tprivate initContent(settings: ISeriesEditableSetting[], target: any) {\r\n\t\tthis._updatedSettings = {};\r\n\t\tconst content = this.getPrivate(\"content\");\r\n\r\n\t\t// Clear\r\n\t\tthis.clear();\r\n\r\n\t\t// Title\r\n\t\tconst title = document.createElement(\"h1\");\r\n\t\ttitle.innerHTML = target.get(\"name\");\r\n\t\tcontent.appendChild(title);\r\n\r\n\t\t// Add fields\r\n\t\tconst table = document.createElement(\"div\");\r\n\t\ttable.className = \"am5-modal-table\";\r\n\t\tcontent.appendChild(table);\r\n\r\n\t\t// Log defaults\r\n\t\tlet populateDefaults = false;\r\n\t\tlet defaults: any = {};\r\n\t\tif (!target.get(\"userData\")) {\r\n\t\t\ttarget.set(\"userData\", {});\r\n\t\t}\r\n\t\tif (!target.get(\"userData\")[\"__defaults\"]) {\r\n\t\t\ttarget.get(\"userData\")[\"__defaults\"] = defaults;\r\n\t\t\tpopulateDefaults = true;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdefaults = target.get(\"userData\")[\"__defaults\"];\r\n\t\t}\r\n\r\n\t\tconst settingInputs: { [index: string]: HTMLInputElement | HTMLSelectElement } = {};\r\n\t\tconst controls: { [index: string]: ColorControl } = {};\r\n\t\tconst settingsWithTarget: { [index: string]: any } = {};\r\n\t\tlet prevName = \"\";\r\n\t\tlet prevLine: HTMLDivElement;\r\n\t\t$array.each(settings, (setting) => {\r\n\t\t\tconst key = this._getSettingKey(setting);\r\n\t\t\tconst keyTarget = setting.target || target;\r\n\t\t\tconst currentValue = setting.currentValue || keyTarget.get(setting.key);\r\n\r\n\t\t\tif (populateDefaults) {\r\n\t\t\t\tdefaults[key] = currentValue;\r\n\t\t\t}\r\n\r\n\t\t\tif (setting.target) {\r\n\t\t\t\tsettingsWithTarget[key] = setting;\r\n\t\t\t}\r\n\r\n\t\t\tlet element: HTMLElement | undefined;\r\n\t\t\tswitch (setting.type) {\r\n\t\t\t\tcase \"dropdown\":\r\n\t\t\t\t\telement = this.getDropdown(setting, currentValue);\r\n\t\t\t\t\tsettingInputs[key] = <HTMLSelectElement>element;\r\n\t\t\t\t\tthis._disposers.push($utils.addEventListener(element, \"change\", (ev: any) => {\r\n\t\t\t\t\t\tconst input: HTMLSelectElement = ev.target!;\r\n\t\t\t\t\t\tconst option = input.options[input!.selectedIndex];\r\n\t\t\t\t\t\tconst extTarget = option.getAttribute(\"data-target\");\r\n\t\t\t\t\t\tif (extTarget) {\r\n\t\t\t\t\t\t\tsettingInputs[extTarget].value = option.getAttribute(\"data-target-value\") + \"\";\r\n\t\t\t\t\t\t\tsettingInputs[extTarget].setAttribute(\"data-min-value\", option.getAttribute(\"data-target-min-value\") + \"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"number\":\r\n\t\t\t\t\telement = this.getNumber(setting, currentValue);\r\n\t\t\t\t\tsettingInputs[key] = <HTMLInputElement>element;\r\n\t\t\t\t\tif (setting.minValue !== undefined) {\r\n\t\t\t\t\t\telement.setAttribute(\"data-min-value\", setting.minValue + \"\");\r\n\t\t\t\t\t\tthis._disposers.push($utils.addEventListener(element, \"change\", (ev: any) => {\r\n\t\t\t\t\t\t\tconst input: HTMLInputElement = ev.target!;\r\n\t\t\t\t\t\t\tconst minValue = Number(input.getAttribute(\"data-min-value\"));\r\n\t\t\t\t\t\t\tconst value = Number(input.value);\r\n\t\t\t\t\t\t\tif (value < minValue) {\r\n\t\t\t\t\t\t\t\tinput.value = minValue + \"\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"color\":\r\n\t\t\t\t\tconst control = this.getColor(setting, currentValue);\r\n\t\t\t\t\telement = control.getPrivate(\"button\")!;\r\n\t\t\t\t\tcontrols[key] = control;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"checkbox\":\r\n\t\t\t\t\telement = this.getCheckbox(setting, currentValue);\r\n\t\t\t\t\tsettingInputs[key] = <HTMLInputElement>element;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// case \"text\":\r\n\t\t\t\t// \telement = this.getText(setting, currentValue);\r\n\t\t\t\t// \tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (element) {\r\n\r\n\t\t\t\tlet line: HTMLDivElement;\r\n\t\t\t\tif (setting.name == prevName && prevLine) {\r\n\t\t\t\t\tline = prevLine;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tline = document.createElement(\"div\");\r\n\t\t\t\t\tline.className = \"am5-modal-table-row\";\r\n\t\t\t\t\ttable.appendChild(line);\r\n\r\n\t\t\t\t\tconst heading = document.createElement(\"div\");\r\n\t\t\t\t\theading.className = \"am5-modal-table-heading\";\r\n\t\t\t\t\theading.innerHTML = setting.name;\r\n\t\t\t\t\tline.appendChild(heading);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst cell = document.createElement(\"div\");\r\n\t\t\t\tcell.className = \"am5-modal-table-cell\";\r\n\t\t\t\tline.appendChild(cell);\r\n\t\t\t\tcell.appendChild(element);\r\n\r\n\t\t\t\tprevName = setting.name;\r\n\t\t\t\tprevLine = line;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Reset\r\n\t\tif (this.get(\"showResetLink\", true)) {\r\n\t\t\tconst resetLink = document.createElement(\"a\");\r\n\t\t\tresetLink.className = \"am5-modal-link am5-modal-table-cell am5-modal-link-reset\";\r\n\t\t\tresetLink.innerHTML = this._root.language.translateAny(\"Reset to default\");\r\n\t\t\ttable.appendChild(resetLink);\r\n\r\n\t\t\tthis._disposers.push($utils.addEventListener(resetLink, \"click\", () => {\r\n\t\t\t\tconst defaults = target.get(\"userData\")[\"__defaults\"];\r\n\t\t\t\t$object.each(settingInputs, (key, element) => {\r\n\t\t\t\t\tif (element.type === \"checkbox\") {\r\n\t\t\t\t\t\t(element as HTMLInputElement).checked = defaults[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\telement.value = defaults[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t$object.each(controls, (key, control) => {\r\n\t\t\t\t\tcontrol.setColor(defaults[key]);\r\n\t\t\t\t});\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\t// Buttons\r\n\t\tconst saveButton = document.createElement(\"input\");\r\n\t\tsaveButton.type = \"button\";\r\n\t\tsaveButton.value = this._root.language.translateAny(\"Save\");\r\n\t\tsaveButton.className = \"am5-modal-button am5-modal-primary\";\r\n\t\tcontent.appendChild(saveButton);\r\n\r\n\t\tthis._disposers.push($utils.addEventListener(saveButton, \"click\", () => {\r\n\t\t\t$object.each(settingInputs, (key, element) => {\r\n\t\t\t\tif (element.type == \"checkbox\") {\r\n\t\t\t\t\tthis._updatedSettings[key] = (<HTMLInputElement>element).checked;\r\n\t\t\t\t}\r\n\t\t\t\telse if (element.type == \"number\") {\r\n\t\t\t\t\tthis._updatedSettings[key] = $type.toNumber(element.value);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._updatedSettings[key] = element.value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t$object.each(this._updatedSettings, (key, value) => {\r\n\t\t\t\tconst targetKey = (<string>key).split(\".\").pop();\r\n\t\t\t\tif ($type.isObject(value) && value.value) {\r\n\t\t\t\t\tif (value.setting && value.setting.target) {\r\n\t\t\t\t\t\tvalue.setting.target.set(targetKey, value.value);\r\n\t\t\t\t\t\tif (value.setting.additionalKeys) {\r\n\t\t\t\t\t\t\t$array.each(value.setting.additionalKeys, (additionalKey) => {\r\n\t\t\t\t\t\t\t\tvalue.setting.target.set(additionalKey, value.value);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttarget.set(targetKey, value.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (settingsWithTarget[targetKey!]) {\r\n\t\t\t\t\tsettingsWithTarget[targetKey!].target.set(targetKey, value);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttarget.set(targetKey, value);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (value.setting && value.setting.invalidateTarget) {\r\n\t\t\t\t\tvalue.setting.invalidateTarget.markDirtyValues();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.close();\r\n\t\t}));\r\n\r\n\t\tconst cancelButton = document.createElement(\"input\");\r\n\t\tcancelButton.type = \"button\";\r\n\t\tcancelButton.value = this._root.language.translateAny(\"Cancel\");\r\n\t\tcancelButton.className = \"am5-modal-button am5-modal-scondary\";\r\n\t\tcontent.appendChild(cancelButton);\r\n\r\n\t\tthis._disposers.push($utils.addEventListener(cancelButton, \"click\", () => {\r\n\t\t\tthis.cancel();\r\n\t\t}));\r\n\r\n\t\t// Open modal\r\n\t\tthis.open();\r\n\r\n\t\t// Auto-focus Save button\r\n\t\tthis.setTimeout(() => {\r\n\t\t\t// Delayed so that pressing ENTER in the list does not trigger save, too\r\n\t\t\tsaveButton.focus();\r\n\t\t}, 10);\r\n\r\n\t}\r\n\r\n\tprivate getDropdown(setting: any, currentValue: any): HTMLSelectElement {\r\n\t\tconst element = document.createElement(\"select\");\r\n\t\t$array.each(setting.options, (option) => {\r\n\t\t\tif (option) {\r\n\t\t\t\tconst optionElement = document.createElement(\"option\");\r\n\t\t\t\tlet value;\r\n\t\t\t\tif ($type.isObject(option)) {\r\n\t\t\t\t\toptionElement.value = <string>((<any>option).value);\r\n\t\t\t\t\toptionElement.text = <string>((<any>option).text);\r\n\t\t\t\t\tvalue = ((<any>option).value);\r\n\r\n\t\t\t\t\tif ((option as any).minValue) {\r\n\t\t\t\t\t\toptionElement.setAttribute(\"data-min-value\", (option as any).minValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ((option as any).extTarget) {\r\n\t\t\t\t\t\toptionElement.setAttribute(\"data-target\", (option as any).extTarget);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ((option as any).extTargetValue) {\r\n\t\t\t\t\t\toptionElement.setAttribute(\"data-target-value\", (option as any).extTargetValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ((option as any).extTargetMinValue) {\r\n\t\t\t\t\t\toptionElement.setAttribute(\"data-target-min-value\", (option as any).extTargetMinValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\toptionElement.value = <string>option;\r\n\t\t\t\t\toptionElement.text = <string>option;\r\n\t\t\t\t\tvalue = option;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (value == currentValue) {\r\n\t\t\t\t\toptionElement.selected = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\telement.appendChild(optionElement);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn element;\r\n\t}\r\n\r\n\tprivate getNumber(_setting: any, currentValue: any): HTMLInputElement {\r\n\t\tconst element = document.createElement(\"input\");\r\n\t\telement.type = \"number\";\r\n\t\telement.value = currentValue;\r\n\t\telement.className = \"am5-modal-input-narrow\"\r\n\t\treturn element;\r\n\t}\r\n\r\n\tprivate getCheckbox(_setting: any, currentValue: any): HTMLInputElement {\r\n\t\tconst element = document.createElement(\"input\");\r\n\t\telement.type = \"checkbox\";\r\n\t\telement.checked = currentValue === true;\r\n\t\treturn element;\r\n\t}\r\n\r\n\tprivate getColor(setting: any, currentValue: any): ColorControl {\r\n\t\tconst control = ColorControl.new(this.root, {\r\n\t\t\tstockChart: this.get(\"stockChart\"),\r\n\t\t\tuseOpacity: false\r\n\t\t});\r\n\t\tcontrol.setPrivate(\"color\", currentValue);\r\n\t\tcontrol.events.on(\"selected\", (ev) => {\r\n\t\t\tthis._updatedSettings[this._getSettingKey(setting)] = {\r\n\t\t\t\tvalue: ev.color,\r\n\t\t\t\tsetting: setting\r\n\t\t\t};\r\n\t\t});\r\n\t\tthis._disposers.push(control);\r\n\t\treturn control;\r\n\t}\r\n\r\n\t/**\r\n\t * Closes the modal, saving settings.\r\n\t */\r\n\tpublic close(): void {\r\n\t\tsuper.close();\r\n\t\tthis.events.dispatch(\"done\", {\r\n\t\t\ttype: \"done\",\r\n\t\t\tsettings: this._updatedSettings,\r\n\t\t\tsettingsTarget: this._settingsTarget,\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Closes the modal without applying any changes.\r\n\t */\r\n\tpublic cancel(): void {\r\n\t\tsuper.cancel();\r\n\t\tthis.events.dispatch(\"done\", {\r\n\t\t\ttype: \"done\",\r\n\t\t\tsettings: null,\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Clears contents of the modal.\r\n\t */\r\n\tpublic clear(): void {\r\n\t\tconst content = this.getPrivate(\"content\");\r\n\t\tcontent.innerHTML = \"\";\r\n\t\tif (this._colorControl) {\r\n\t\t\tthis._colorControl.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _getSettingKey(setting: ISeriesEditableSetting): string {\r\n\t\treturn setting.id || setting.key;\r\n\t}\r\n\r\n}","import type { StockPanel } from \"./StockPanel\";\nimport type { StockLegend, IStockLegendDataItem } from \"./StockLegend\";\nimport type { Axis } from \"../xy/axes/Axis\";\nimport type { DateAxis } from \"../xy/axes/DateAxis\";\nimport type { AxisRenderer } from \"../xy/axes/AxisRenderer\";\nimport type { BaseColumnSeries } from \"../xy/series/BaseColumnSeries\";\nimport type { IValueAxisSettings, ValueAxis } from \"../xy/axes/ValueAxis\";\nimport type { XYSeries, IXYSeriesDataItem, IXYSeriesSettings } from \"../xy/series/XYSeries\";\nimport type { DataItem } from \"../../core/render/Component\";\nimport type { Indicator } from \"./indicators/Indicator\";\nimport type { DrawingSeries } from \"./drawing/DrawingSeries\";\nimport type { StockControl } from \"./toolbar/StockControl\";\nimport { MultiDisposer, IDisposer } from \"../../core/util/Disposer\";\n\nimport { SpriteResizer } from \"../../core/render/SpriteResizer\";\nimport { PanelControls } from \"./PanelControls\";\nimport { StockChartDefaultTheme } from \"./StockChartDefaultTheme\";\nimport { XYChartDefaultTheme } from \"../xy/XYChartDefaultTheme\";\nimport { Container, IContainerPrivate, IContainerSettings, IContainerEvents } from \"../../core/render/Container\";\nimport { ListAutoDispose } from \"../../core/util/List\";\nimport { Rectangle } from \"../../core/render/Rectangle\";\nimport { p100, percent, Percent } from \"../../core/util/Percent\";\nimport { SettingsModal } from \"./SettingsModal\";\nimport { Color } from \"../../core/util/Color\";\nimport { registry } from \"../../core/Registry\";\nimport { registerCustomClass } from \"../../plugins/json/Json\";\n\nimport * as $array from \"../../core/util/Array\";\nimport * as $utils from \"../../core/util/Utils\";\nimport * as $object from \"../../core/util/Object\";\nimport type { GaplessDateAxis } from \"../xy/axes/GaplessDateAxis\";\nimport type { ChartIndicator } from \"./indicators/ChartIndicator\";\nimport type { ISpritePointerEvent } from \"../../core/render/Sprite\";\n\n\nexport interface IStockChartSettings extends IContainerSettings {\n\n\t/**\n\t * Main value series.\n\t *\n\t * This series is used to target by settings, as well as calculating\n\t * indicators, and annotations.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Setting_main_series}\n\t */\n\tstockSeries?: XYSeries;\n\n\t/**\n\t * Main volume series.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Setting_main_series}\n\t */\n\tvolumeSeries?: XYSeries;\n\n\t/**\n\t * @ignore\n\t */\n\tcomparingSeriesSettings?: Partial<IXYSeriesSettings>;\n\n\t/**\n\t * Settings to be applied to the the main value series, when chart is\n\t * switched to \"percent scale\".\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/percent-mode/#Configuring} for more info\n\t */\n\tpercentScaleSeriesSettings?: Partial<IXYSeriesSettings>;\n\n\t/**\n\t * Settings to be applied to the [[ValueAxis]] of the main value series,\n\t * when chart is switched to \"percent scale\".\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/percent-mode/#Configuring} for more info\n\t */\n\tpercentScaleValueAxisSettings?: Partial<IValueAxisSettings<AxisRenderer>>;\n\n\t/**\n\t * If set to `true`, the chart will go into \"percent scale\" when compared\n\t * series are added to chart, and will exit it when all of the comparisons\n\t * are removed.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/percent-mode/} for more info\n\t * @default true\n\t */\n\tautoSetPercentScale?: boolean;\n\n\t/**\n\t * This color will be applied to columns/candles on the main value series (series\n\t * set as `stockSeries`) where the open value is lower or equal to the close\n\t * value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Positive_negative_colors} for more info\n\t */\n\tstockPositiveColor?: Color | null;\n\n\t/**\n\t * This color will be applied to columns/candles on the main value series (series\n\t * set as `stockSeries`) where the open value is higher than the close value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Positive_negative_colors} for more info\n\t */\n\tstockNegativeColor?: Color | null;\n\n\t/**\n\t * This color will be applied to columns/candles on the main volume series (series\n\t * set as `stockSeries`) where the open value is lower or equal to the close\n\t * value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Positive_negative_colors} for more info\n\t */\n\tvolumePositiveColor?: Color | null;\n\n\t/**\n\t * This color will be applied to columns/candles on the main volume series (series\n\t * set as `stockSeries`) where the open value is higher than the close value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Positive_negative_colors} for more info\n\t */\n\tvolumeNegativeColor?: Color | null;\n\n\t/**\n\t * If set to `true`, all drawings will be selectable.\n\t *\n\t * Selectable drawings can be moved, rotated, or deleted.\n\t *\n\t * @default false\n\t * @since 5.9.1\n\t */\n\tdrawingSelectionEnabled?: boolean;\n\n\t/**\n\t * If set to `true`, clicking on drawings will delete them.\n\t *\n\t * @default false\n\t * @since 5.9.2\n\t */\n\terasingEnabled?: boolean;\n\n\t/**\n\t * If set to `true` drawing grips will be hidden when [[StockChart]] is not\n\t * in drawing mode.\n\t *\n\t * @default false\n\t * @since 5.10.6\n\t */\n\thideDrawingGrips?: boolean;\n\n}\n\nexport interface IStockChartPrivate extends IContainerPrivate {\n\n\t/**\n\t * A instance of [[SettingsModal]].\n\t */\n\tsettingsModal: SettingsModal;\n\n\t/**\n\t * Indicates if chart has currently have any \"compared\" series set.\n\t */\n\tcomparing?: boolean;\n\n\t/**\n\t * A list of compared series.\n\t */\n\tcomparedSeries?: XYSeries[];\n\n\t/**\n\t * Main Date axis of a Stock chart\n\t */\n\tmainAxis?: DateAxis<AxisRenderer>\n}\n\nexport interface IStockChartEvents extends IContainerEvents {\n\t/**\n\t * Kicks in when drawings change.\n\t */\n\tdrawingsupdated: {};\n\n\t/**\n\t * Kicks in when indicators change.\n\t */\n\tindicatorsupdated: {};\n\n\t/**\n\t * Kicks in when a drawing is added.\n\t *\n\t * @since 5.9.0\n\t */\n\tdrawingadded: { drawingId: string, series: DrawingSeries, index: number };\n\n\t/**\n\t * Kicks in when a drawing is removed.\n\t *\n\t * @since 5.9.0\n\t */\n\tdrawingremoved: { drawingId: string, series: DrawingSeries, index: number };\n\n\t/**\n\t * Kicks in when a drawing is selected.\n\t *\n\t * @since 5.9.0\n\t */\n\tdrawingselected: { drawingId: string, series: DrawingSeries, index: number };\n\n\t/**\n\t * Kicks in when a drawing is unselected.\n\t *\n\t * @since 5.9.0\n\t */\n\tdrawingunselected: { drawingId: string, series: DrawingSeries, index: number };\n}\n\n\n/**\n * A main class for the Stock Chart.\n *\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/} for more info\n * @important\n */\nexport class StockChart extends Container {\n\n\tpublic static className: string = \"StockChart\";\n\tpublic static classNames: Array<string> = Container.classNames.concat([StockChart.className]);\n\n\n\tdeclare public _settings: IStockChartSettings;\n\tdeclare public _privateSettings: IStockChartPrivate;\n\tdeclare public _events: IStockChartEvents;\n\n\tprotected _xAxes: Array<Axis<AxisRenderer>> = [];\n\tprotected _downY?: number;\n\tprotected _upperPanel?: StockPanel;\n\tprotected _dhp?: Percent;\n\tprotected _uhp?: Percent;\n\tprotected _downResizer?: Rectangle;\n\tprotected _syncExtremesDp?: MultiDisposer;\n\tprotected _drawingsChanged = false;\n\tprotected _indicatorsChanged = false;\n\tprotected _baseDP?: IDisposer;\n\n\tpublic _selectionWasOn: boolean = false;\n\n\t/**\n\t * A list of stock panels.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Panels} for more info\n\t */\n\tpublic readonly panels: ListAutoDispose<StockPanel> = new ListAutoDispose();\n\n\t/**\n\t * A list of indicators on chart.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\n\t */\n\tpublic readonly indicators: ListAutoDispose<Indicator> = new ListAutoDispose();\n\n\t/**\n\t * A [[Container]], resiting on top of the charts, suitable for additional\n\t * tools, like [[Scrollbar]].\n\t *\n\t * @default Container.new()\n\t */\n\tpublic readonly toolsContainer: Container = this.children.push(Container.new(this._root, { width: p100, themeTags: [] }));\n\n\t/**\n\t * A [[Container]] where all the stock panels are placed into.\n\t *\n\t * @default Container.new()\n\t */\n\tpublic readonly panelsContainer: Container = this.children.push(Container.new(this._root, { width: p100, height: p100, layout: this._root.verticalLayout, themeTags: [\"chartscontainer\"] }));\n\n\t/**\n\t * An array of all Stock Controls that are created for this chart.\n\t *\n\t * @since 5.7.0\n\t */\n\tpublic readonly controls: StockControl[] = [];\n\n\t/**\n\t * An instance of [[SpriteResizer]] used for various drawing tools.\n\t *\n\t * @since 5.7.0\n\t */\n\tpublic spriteResizer = this.children.push(SpriteResizer.new(this._root, {}));\n\n\n\tprotected _afterNew() {\n\t\tthis._settings.themeTags = $utils.mergeTags(this._settings.themeTags, [\"stock\"]);\n\t\tthis._defaultThemes.push(StockChartDefaultTheme.new(this._root));\n\t\tthis._defaultThemes.push(XYChartDefaultTheme.new(this._root));\n\n\t\tconst tooltipContainer = this._root.tooltipContainer;\n\t\ttooltipContainer.set(\"themeTags\", $utils.mergeTags(tooltipContainer.get(\"themeTags\", []), [\"stock\"]));\n\n\t\tsuper._afterNew();\n\n\t\tif ($utils.supports(\"keyboardevents\")) {\n\t\t\tthis._disposers.push($utils.addEventListener(document, \"keyup\", (e: KeyboardEvent) => {\n\t\t\t\tif (e.keyCode == 46) {\n\t\t\t\t\tthis.deleteSelectedDrawings();\n\t\t\t\t}\n\t\t\t\tif (e.keyCode == 27) {\n\t\t\t\t\tthis.unselectDrawings();\n\t\t\t\t\tthis.cancelDrawing();\n\t\t\t\t\tthis.spriteResizer.set(\"sprite\", undefined);\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tconst children = this.panelsContainer.children;\n\t\tthis._disposers.push(this.panels.events.onAll((change) => {\n\t\t\tif (change.type === \"clear\") {\n\t\t\t\t$array.each(change.oldValues, (chart) => {\n\t\t\t\t\tthis._removePanel(chart);\n\t\t\t\t})\n\t\t\t} else if (change.type === \"push\") {\n\t\t\t\tchildren.moveValue(change.newValue);\n\t\t\t\tthis._processPanel(change.newValue);\n\t\t\t} else if (change.type === \"setIndex\") {\n\t\t\t\tchildren.setIndex(change.index, change.newValue);\n\t\t\t\tthis._processPanel(change.newValue);\n\t\t\t} else if (change.type === \"insertIndex\") {\n\t\t\t\tchildren.insertIndex(change.index, change.newValue);\n\t\t\t\tthis._processPanel(change.newValue);\n\t\t\t} else if (change.type === \"removeIndex\") {\n\t\t\t\tthis._removePanel(change.oldValue);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unknown IListEvent type\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._disposers.push(this.indicators.events.onAll((change) => {\n\t\t\tif (change.type === \"clear\") {\n\t\t\t\t$array.each(change.oldValues, (indicator) => {\n\t\t\t\t\tthis._removeIndicator(indicator);\n\t\t\t\t})\n\t\t\t} else if (change.type === \"push\") {\n\t\t\t\tthis._processIndicator(change.newValue);\n\t\t\t} else if (change.type === \"setIndex\") {\n\t\t\t\tthis._processIndicator(change.newValue);\n\t\t\t} else if (change.type === \"insertIndex\") {\n\t\t\t\tthis._processIndicator(change.newValue);\n\t\t\t} else if (change.type === \"removeIndex\") {\n\t\t\t\tthis._removeIndicator(change.oldValue);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unknown IListEvent type\");\n\t\t\t}\n\t\t}));\n\n\t\tthis.setPrivateRaw(\"settingsModal\", SettingsModal.new(this.root, {\n\t\t\tstockChart: this\n\t\t}));\n\n\t\tlet license = false;\n\t\tfor (let i = 0; i < registry.licenses.length; i++) {\n\t\t\tif (registry.licenses[i].match(/^AM5S.{5,}/i)) {\n\t\t\t\tlicense = true;\n\t\t\t}\n\t\t}\n\t\tif (!license) {\n\t\t\tthis._root._showBranding();\n\t\t}\n\t\telse {\n\t\t\tthis._root._licenseApplied();\n\t\t}\n\t}\n\n\tprotected _dispose() {\n\t\tsuper._dispose();\n\t\tconst settingsModal = this.getPrivate(\"settingsModal\");\n\t\tif (settingsModal) {\n\t\t\tsettingsModal.dispose();\n\t\t}\n\t}\n\n\t/**\n\t * Forces redrawing of all annotations (drfawings).\n\t */\n\tpublic markDirtyDrawings() {\n\t\tthis._drawingsChanged = true;\n\t\tthis.markDirty();\n\t}\n\n\t/**\n\t * Forces redrawing of Indicators.\n\t */\n\tpublic markDirtyIndicators() {\n\t\tthis._indicatorsChanged = true;\n\t\tthis.markDirty();\n\t}\n\n\n\t/**\n\t * Toggles drawing mode on or off.\n\t *\n\t * @param  enabled  Drawing enabled\n\t * @since 5.10.6\n\t */\n\tpublic toggleDrawing(enabled?: boolean) {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tseries.toggleDrawing(enabled);\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\tpublic _prepareChildren() {\n\n\t\tif (this.isDirty(\"drawingSelectionEnabled\")) {\n\t\t\tconst enabled = this.get(\"drawingSelectionEnabled\", false);\n\t\t\tif (!enabled) {\n\t\t\t\tthis.unselectDrawings();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.set(\"erasingEnabled\", false);\n\t\t\t}\n\n\t\t\tthis.panels.each((panel) => {\n\t\t\t\tpanel.series.each((series) => {\n\t\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\t\tseries.enableDrawingSelection(enabled);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\n\t\tif (this.isDirty(\"erasingEnabled\")) {\n\t\t\tconst enabled = this.get(\"erasingEnabled\", false);\n\t\t\tif (enabled) {\n\t\t\t\tthis.set(\"drawingSelectionEnabled\", false);\n\t\t\t}\n\t\t\tthis.panels.each((panel) => {\n\t\t\t\tpanel.series.each((series) => {\n\t\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\t\tif (enabled) {\n\t\t\t\t\t\t\tseries.enableErasing();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tseries.disableErasing();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\n\t\tif (this.isDirty(\"volumeNegativeColor\") || this.isDirty(\"volumePositiveColor\")) {\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\n\t\t\tif (volumeSeries && volumeSeries.isType<BaseColumnSeries>(\"BaseColumnSeries\")) {\n\t\t\t\tvolumeSeries.columns.each((column) => {\n\t\t\t\t\tcolumn._markDirtyKey(\"fill\");\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\n\t\tif (this.isDirty(\"stockSeries\")) {\n\t\t\tif (stockSeries) {\n\t\t\t\tconst previous = this._prevSettings.stockSeries;\n\t\t\t\tthis.indicators.each((indicator) => {\n\t\t\t\t\tif (previous == indicator.get(\"stockSeries\")) {\n\t\t\t\t\t\tindicator.set(\"stockSeries\", stockSeries);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tindicator._setSoft(\"stockSeries\", stockSeries);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tconst mainChart = stockSeries.chart;\n\n\t\t\t\tif (mainChart) {\n\t\t\t\t\tmainChart.series.each((series) => {\n\t\t\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\t\t\tlet s = series.get(\"series\");\n\t\t\t\t\t\t\tif (s == previous) {\n\t\t\t\t\t\t\t\tseries.set(\"series\", stockSeries);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tseries._setSoft(\"series\", stockSeries);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tconst xAxis = mainChart.xAxes.getIndex(0) as DateAxis<AxisRenderer>;\n\t\t\t\t\tif (xAxis) {\n\t\t\t\t\t\tif (this._syncExtremesDp) {\n\t\t\t\t\t\t\tthis._syncExtremesDp.dispose();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.setPrivateRaw(\"mainAxis\", xAxis);\n\n\t\t\t\t\t\tif (this._baseDP) {\n\t\t\t\t\t\t\tthis._baseDP.dispose();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._baseDP = xAxis.on(\"baseInterval\", (baseInterval) => {\n\t\t\t\t\t\t\tthis.indicators.each((indicator) => {\n\t\t\t\t\t\t\t\tif (indicator.isType<ChartIndicator>(\"ChartIndicator\")) {\n\t\t\t\t\t\t\t\t\tindicator.xAxis.set(\"baseInterval\", baseInterval);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tthis._syncExtremesDp = new MultiDisposer([\n\t\t\t\t\t\t\txAxis.onPrivate(\"max\", () => {\n\t\t\t\t\t\t\t\tthis._syncExtremes();\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\txAxis.onPrivate(\"min\", () => {\n\t\t\t\t\t\t\t\tthis._syncExtremes();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t])\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.getPrivate(\"comparing\")) {\n\t\t\t\t\tthis.setPercentScale(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper._prepareChildren();\n\t}\n\n\tpublic _afterChanged() {\n\t\tsuper._afterChanged();\n\t\tif (this._drawingsChanged) {\n\t\t\tthis._drawingsChanged = false;\n\t\t\tconst type = \"drawingsupdated\";\n\t\t\tif (this.events.isEnabled(type)) {\n\t\t\t\tthis.events.dispatch(type, { type: type, target: this });\n\t\t\t}\n\t\t}\n\n\t\tif (this._indicatorsChanged) {\n\t\t\tthis._indicatorsChanged = false;\n\t\t\tconst type = \"indicatorsupdated\";\n\t\t\tif (this.events.isEnabled(type)) {\n\t\t\t\tthis.events.dispatch(type, { type: type, target: this });\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _updateChildren() {\n\t\tsuper._updateChildren()\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\n\t\tif (this.isDirty(\"volumeSeries\")) {\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\n\t\t\tif (volumeSeries) {\n\t\t\t\tconst volumePanel = volumeSeries.chart;\n\t\t\t\tif (volumePanel) {\n\t\t\t\t\tvolumePanel.series.events.on(\"removeIndex\", (event) => {\n\t\t\t\t\t\tif (event.oldValue == volumeSeries) {\n\t\t\t\t\t\t\tthis.set(\"volumeSeries\", undefined);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"stockNegativeColor\") || this.isDirty(\"stockPositiveColor\") || this.isDirty(\"stockSeries\")) {\n\t\t\tif (stockSeries && stockSeries.isType<BaseColumnSeries>(\"BaseColumnSeries\")) {\n\t\t\t\tconst ic = this._root.interfaceColors;\n\t\t\t\tconst stockNegativeColor = this.get(\"stockNegativeColor\", ic.get(\"negative\"));\n\t\t\t\tconst stockPositiveColor = this.get(\"stockPositiveColor\", ic.get(\"positive\"));\n\t\t\t\tlet previous = stockSeries.dataItems[0];\n\n\t\t\t\tif (stockPositiveColor && stockPositiveColor) {\n\t\t\t\t\t$array.each(stockSeries.dataItems, (dataItem) => {\n\t\t\t\t\t\tconst column = dataItem.get(\"graphics\");\n\t\t\t\t\t\tif (column) {\n\t\t\t\t\t\t\tconst dropFromOpen = column.states.lookup(\"dropFromOpen\");\n\t\t\t\t\t\t\tif (dropFromOpen) {\n\t\t\t\t\t\t\t\tdropFromOpen.setAll({ fill: stockNegativeColor, stroke: stockNegativeColor });\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst riseFromOpen = column.states.lookup(\"riseFromOpen\");\n\t\t\t\t\t\t\tif (riseFromOpen) {\n\t\t\t\t\t\t\t\triseFromOpen.setAll({ fill: stockPositiveColor, stroke: stockPositiveColor });\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst dropFromPrevious = column.states.lookup(\"dropFromPrevious\");\n\t\t\t\t\t\t\tif (dropFromPrevious) {\n\t\t\t\t\t\t\t\tdropFromPrevious.setAll({ fill: stockNegativeColor, stroke: stockNegativeColor });\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst riseFromPrevious = column.states.lookup(\"riseFromPrevious\");\n\t\t\t\t\t\t\tif (riseFromPrevious) {\n\t\t\t\t\t\t\t\triseFromPrevious.setAll({ fill: stockPositiveColor, stroke: stockPositiveColor });\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tstockSeries._applyGraphicsStates(dataItem, previous);\n\t\t\t\t\t\t\tprevious = dataItem;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tconst states = stockSeries.columns.template.states;\n\n\t\t\t\t\tconst riseFromOpen = states.lookup(\"riseFromOpen\");\n\t\t\t\t\tconst themeTags = stockSeries.columns.template.get(\"themeTags\");\n\n\t\t\t\t\tif (stockPositiveColor) {\n\t\t\t\t\t\tif (riseFromOpen) {\n\t\t\t\t\t\t\triseFromOpen.setAll({ fill: stockPositiveColor, stroke: stockPositiveColor });\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tstates.create(\"riseFromOpen\", { fill: stockPositiveColor, stroke: stockPositiveColor });\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tconst riseFromPrevious = states.lookup(\"riseFromPrevious\");\n\t\t\t\t\t\tif (riseFromPrevious) {\n\t\t\t\t\t\t\triseFromPrevious.setAll({ fill: stockPositiveColor, stroke: stockPositiveColor });\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (themeTags && themeTags.indexOf(\"pro\") != -1) {\n\t\t\t\t\t\t\t\tstates.create(\"riseFromPrevious\", { fill: stockPositiveColor, stroke: stockPositiveColor });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (stockNegativeColor) {\n\t\t\t\t\t\tconst dropFromOpen = states.lookup(\"dropFromOpen\");\n\t\t\t\t\t\tif (dropFromOpen) {\n\t\t\t\t\t\t\tdropFromOpen.setAll({ fill: stockNegativeColor, stroke: stockNegativeColor });\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tstates.create(\"dropFromOpen\", { fill: stockNegativeColor, stroke: stockNegativeColor });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst dropFromPrevious = states.lookup(\"dropFromPrevious\");\n\t\t\t\t\t\tif (dropFromPrevious) {\n\t\t\t\t\t\t\tdropFromPrevious.setAll({ fill: stockNegativeColor, stroke: stockNegativeColor });\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif (themeTags && themeTags.indexOf(\"pro\") != -1) {\n\t\t\t\t\t\t\t\tstates.create(\"dropFromPrevious\", { fill: stockNegativeColor, stroke: stockNegativeColor });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstockSeries.markDirtyValues();\n\t\t\t}\n\t\t}\n\t}\n\n\n\t/**\n\t * Enables or disables percent scale mode.\n\t *\n\t * If `percentScale` is not set, it will try to determine the status on its own.\n\t *\n\t * In percent scale mode `percentScaleSeriesSettings` and `percentScaleValueAxisSettings` will\n\t * be applied to the regular series on the main panel and its Y axis.\n\t *\n\t * @param  percentScale  Comparison mode active\n\t */\n\tpublic setPercentScale(percentScale?: boolean): void {\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tconst seriesSettings = this.get(\"percentScaleSeriesSettings\");\n\t\tconst axisSettings = this.get(\"percentScaleValueAxisSettings\");\n\t\tif (stockSeries) {\n\t\t\tconst mainChart = stockSeries.chart;\n\t\t\tconst yAxis = stockSeries.get(\"yAxis\") as ValueAxis<AxisRenderer>;\n\t\t\tyAxis.set(\"logarithmic\", false);\n\n\t\t\tthis._maybePrepAxisDefaults();\n\t\t\tif (mainChart) {\n\t\t\t\tconst seriesList: XYSeries[] = [];\n\t\t\t\tmainChart.series.each((series) => {\n\t\t\t\t\tif (series.get(\"yAxis\") == yAxis) {\n\t\t\t\t\t\tseriesList.push(series);\n\t\t\t\t\t\tthis._maybePrepSeriesDefaults(series);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (percentScale == undefined) {\n\t\t\t\t\tpercentScale = this.getPrivate(\"comparedSeries\", []).length > 0;\n\t\t\t\t}\n\n\t\t\t\tthis.setPrivate(\"comparing\", percentScale);\n\n\t\t\t\tif (seriesSettings) {\n\t\t\t\t\t$array.each(seriesList, (series) => {\n\t\t\t\t\t\tif (percentScale) {\n\t\t\t\t\t\t\tseries.setAll(seriesSettings);\n\t\t\t\t\t\t\tseries.states.lookup(\"default\")!.setAll(seriesSettings);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tseries.states.apply(\"comparingDefaults\");\n\t\t\t\t\t\t\tconst seriesDefaults = series.states.lookup(\"comparingDefaults\");\n\t\t\t\t\t\t\tif (seriesDefaults) {\n\t\t\t\t\t\t\t\tseries.states.lookup(\"default\")!.setAll(seriesDefaults._settings);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (axisSettings) {\n\t\t\t\t\tif (percentScale) {\n\t\t\t\t\t\tyAxis.setAll(axisSettings);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tyAxis.states.apply(\"comparingDefaults\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.indicators.each((indicator) => {\n\t\t\tindicator.markDataDirty();\n\t\t})\n\t}\n\n\t/**\n\t * Adds a \"compared\" series to chart. Returns the same series.\n\t *\n\t * @param   series  Compared series\n\t * @return          Compared series\n\t */\n\tpublic addComparingSeries(series: XYSeries): XYSeries {\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tif (stockSeries) {\n\t\t\tconst chart = stockSeries.chart;\n\t\t\tif (chart) {\n\t\t\t\tchart.series.push(series);\n\t\t\t}\n\n\t\t\t// Apply comparingSeriesSettings\n\t\t\tconst comparingSeriesSettings = this.get(\"comparingSeriesSettings\");\n\t\t\tif (comparingSeriesSettings) {\n\t\t\t\tseries.setAll(comparingSeriesSettings);\n\t\t\t}\n\n\t\t\tconst comparedSeries = this.getPrivate(\"comparedSeries\");\n\t\t\tif (comparedSeries) {\n\t\t\t\tcomparedSeries.push(series);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.setPrivate(\"comparedSeries\", [series]);\n\t\t\t}\n\n\t\t\tconst legendDataItem = stockSeries.get(\"legendDataItem\");\n\n\t\t\tif (legendDataItem) {\n\t\t\t\tconst legend = legendDataItem.component;\n\t\t\t\tif (legend.isType<StockLegend>(\"StockLegend\")) {\n\t\t\t\t\tlegend.data.push(series);\n\t\t\t\t\tconst ldi = series.get(\"legendDataItem\") as DataItem<IStockLegendDataItem>;\n\t\t\t\t\tif (ldi) {\n\t\t\t\t\t\tconst closeButton = ldi.get(\"closeButton\");\n\t\t\t\t\t\tcloseButton.set(\"forceHidden\", false);\n\t\t\t\t\t\tcloseButton.events.on(\"click\", () => {\n\t\t\t\t\t\t\tthis.removeComparingSeries(series);\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.get(\"autoSetPercentScale\")) {\n\t\t\t\tthis.setPercentScale(true);\n\t\t\t}\n\n\t\t}\n\t\treturn series;\n\t}\n\n\t/**\n\t * Removes compared series.\n\t *\n\t * @param  series  Compared series\n\t */\n\tpublic removeComparingSeries(series: XYSeries) {\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tif (stockSeries) {\n\t\t\tconst chart = stockSeries.chart;\n\t\t\tif (chart) {\n\t\t\t\tchart.series.removeValue(series);\n\t\t\t}\n\n\t\t\tconst comparedSeries = this.getPrivate(\"comparedSeries\");\n\t\t\tif (comparedSeries) {\n\t\t\t\t$array.remove(comparedSeries, series);\n\t\t\t\tif (comparedSeries.length == 0 && this.get(\"autoSetPercentScale\")) {\n\t\t\t\t\tthis.setPercentScale(false);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tconst ldi = series.get(\"legendDataItem\") as DataItem<IStockLegendDataItem>;\n\t\tif (ldi) {\n\t\t\tconst legend = ldi.component;\n\t\t\tlegend.data.removeValue(series);\n\t\t}\n\n\t}\n\n\tprotected _maybePrepSeriesDefaults(series: XYSeries): void {\n\t\tif (!series.states.lookup(\"comparingDefaults\")) {\n\t\t\tconst seriesSettings = this.get(\"percentScaleSeriesSettings\");\n\t\t\tconst defaults: any = {};\n\t\t\t$object.each(seriesSettings, (key, _val) => {\n\t\t\t\tdefaults[key] = (<any>series).get(key);\n\t\t\t});\n\t\t\tseries.states.create(\"comparingDefaults\", defaults);\n\t\t}\n\t}\n\n\tpublic getSeriesDefault(series: XYSeries, setting: keyof IXYSeriesSettings): any {\n\t\tconst defaults = series.states.lookup(\"comparingDefaults\");\n\t\treturn defaults ? defaults.get(setting) : series.get(setting);\n\t}\n\n\tprotected _maybePrepAxisDefaults(): void {\n\t\tconst stockSeries = this.get(\"stockSeries\")!;\n\t\tconst axis = stockSeries.get(\"yAxis\");\n\t\tif (!axis.states.lookup(\"comparingDefaults\")) {\n\t\t\tconst axisSettings = this.get(\"percentScaleValueAxisSettings\");\n\t\t\tconst defaults: any = {};\n\t\t\t$object.each(axisSettings, (key, _val) => {\n\t\t\t\tdefaults[key] = (<any>axis).get(key);\n\t\t\t});\n\t\t\taxis.states.create(\"comparingDefaults\", defaults);\n\t\t}\n\t}\n\n\tprotected _processIndicator(indicator: Indicator) {\n\t\tthis.children.push(indicator);\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tif (stockSeries) {\n\t\t\tindicator._setSoft(\"stockSeries\", stockSeries);\n\t\t}\n\n\t\tconst volumeSeries = this.get(\"volumeSeries\");\n\t\tif (volumeSeries) {\n\t\t\tindicator._setSoft(\"volumeSeries\", volumeSeries);\n\t\t}\n\n\t\tif (this.getPrivate(\"comparing\")) {\n\t\t\tthis.setPercentScale(true);\n\t\t}\n\n\n\t\t$array.each(indicator._editableSettings, (setting) => {\n\t\t\tindicator.on((setting as any).key, () => {\n\t\t\t\tthis.markDirtyIndicators();\n\t\t\t})\n\t\t})\n\n\t\tthis.markDirtyIndicators();\n\n\t\t//indicator.markDataDirty(); // not good, shows zoomed out value axis\n\t\tindicator.prepareData();\n\n\t\tthis._syncExtremes();\n\t}\n\n\tprotected _removeIndicator(indicator: Indicator) {\n\t\tthis.children.removeValue(indicator);\n\t\tthis.markDirtyIndicators();\n\t}\n\n\tprotected _removePanel(chart: StockPanel) {\n\t\tthis.panelsContainer.children.removeValue(chart);\n\t}\n\n\tpublic _updateControls() {\n\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\tthis.panels.each((panel) => {\n\t\t\tconst panelControls = panel.panelControls;\n\t\t\tconst index = this.panelsContainer.children.indexOf(panel);\n\t\t\tconst len = this.panels.length;\n\t\t\tconst visible = \"visible\"\n\n\t\t\tpanelControls.upButton.setPrivate(visible, false);\n\t\t\tpanelControls.downButton.setPrivate(visible, false);\n\t\t\tpanelControls.expandButton.setPrivate(visible, false);\n\t\t\tpanelControls.closeButton.setPrivate(visible, false);\n\n\t\t\tif (len > 1) {\n\t\t\t\tpanelControls.expandButton.setPrivate(visible, true);\n\n\t\t\t\tif (index != 0) {\n\t\t\t\t\tpanelControls.upButton.setPrivate(visible, true);\n\t\t\t\t}\n\t\t\t\tif (index != len - 1) {\n\t\t\t\t\tpanelControls.downButton.setPrivate(visible, true);\n\t\t\t\t}\n\n\t\t\t\tif (!stockSeries || stockSeries.chart != panel) {\n\t\t\t\t\tpanelControls.closeButton.setPrivate(visible, true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (stockSeries) {\n\t\t\t\tthis.indicators.each((indicator) => {\n\t\t\t\t\tindicator.set(\"stockSeries\", stockSeries);\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\n\t\tthis._updateResizers();\n\t}\n\n\tprotected _processPanel(panel: StockPanel) {\n\n\t\tpanel.setPrivate(\"otherCharts\", this.panels.values);\n\t\tpanel.setPrivate(\"stockChart\", this);\n\t\tpanel.panelControls = panel.topPlotContainer.children.push(PanelControls.new(this._root, { stockPanel: panel, stockChart: this }));\n\t\tthis._updateControls();\n\n\n\t\tconst resizer = panel.children.push(Rectangle.new(this._root, { themeTags: [\"panelresizer\"] }))\n\n\t\tpanel.panelResizer = resizer;\n\n\t\tresizer.events.on(\"pointerdown\", (e) => {\n\t\t\tconst chartsContainer = this.panelsContainer;\n\t\t\tthis._downResizer = e.target;\n\t\t\tthis.panels.each((chart) => {\n\t\t\t\tchart.set(\"height\", percent(chart.height() / chartsContainer.height() * 100))\n\t\t\t})\n\n\t\t\tthis._downY = chartsContainer.toLocal(e.point).y;\n\n\t\t\tconst upperChart = chartsContainer.children.getIndex(chartsContainer.children.indexOf(panel) - 1) as StockPanel;\n\t\t\tthis._upperPanel = upperChart;\n\t\t\tif (upperChart) {\n\t\t\t\tthis._uhp = upperChart.get(\"height\") as Percent;\n\t\t\t}\n\n\t\t\tthis._dhp = panel.get(\"height\") as Percent;\n\t\t})\n\n\t\tresizer.events.on(\"pointerup\", () => {\n\t\t\tthis._downResizer = undefined;\n\t\t})\n\n\t\tresizer.events.on(\"globalpointermove\", (e) => {\n\t\t\tif (e.target == this._downResizer) {\n\t\t\t\tconst chartsContainer = this.panelsContainer;\n\t\t\t\tconst height = chartsContainer.height();\n\t\t\t\tconst upperChart = this._upperPanel;\n\n\t\t\t\tif (upperChart) {\n\t\t\t\t\tconst index = chartsContainer.children.indexOf(upperChart) + 2\n\t\t\t\t\tlet max = height - panel.get(\"minHeight\", 0);\n\t\t\t\t\tconst lowerChart = chartsContainer.children.getIndex(index);\n\t\t\t\t\tif (lowerChart) {\n\t\t\t\t\t\tmax = lowerChart.y() - panel.get(\"minHeight\", 0);\n\t\t\t\t\t}\n\t\t\t\t\t//console.log(upperChart.get(\"minHeight\", 0))\n\t\t\t\t\tconst y = Math.max(upperChart.y() + upperChart.get(\"minHeight\", 0) + upperChart.get(\"paddingTop\", 0), Math.min(chartsContainer.toLocal(e.point).y, max));\n\n\t\t\t\t\tconst downY = this._downY;\n\t\t\t\t\tconst dhp = this._dhp;\n\t\t\t\t\tconst uhp = this._uhp;\n\t\t\t\t\tif (downY != null && dhp != null && uhp != null) {\n\t\t\t\t\t\tconst diff = (downY - y) / height;\n\t\t\t\t\t\tpanel.set(\"height\", percent((dhp.value + diff) * 100));\n\t\t\t\t\t\tupperChart.set(\"height\", percent((uhp.value - diff) * 100))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tpanel.xAxes.events.onAll((change) => {\n\t\t\tif (change.type === \"clear\") {\n\t\t\t\t$array.each(change.oldValues, (axis) => {\n\t\t\t\t\tthis._removeXAxis(axis);\n\t\t\t\t})\n\t\t\t} else if (change.type === \"push\") {\n\t\t\t\tthis._processXAxis(change.newValue);\n\t\t\t} else if (change.type === \"setIndex\") {\n\t\t\t\tthis._processXAxis(change.newValue);\n\t\t\t} else if (change.type === \"insertIndex\") {\n\t\t\t\tthis._processXAxis(change.newValue);\n\t\t\t} else if (change.type === \"removeIndex\") {\n\t\t\t\tthis._removeXAxis(change.oldValue);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unknown IListEvent type\");\n\t\t\t}\n\t\t})\n\n\t\tpanel.leftAxesContainer.events.on(\"boundschanged\", () => {\n\t\t\tthis._syncYAxesSize();\n\t\t})\n\n\t\tpanel.rightAxesContainer.events.on(\"boundschanged\", () => {\n\t\t\tthis._syncYAxesSize();\n\t\t})\n\n\t\tthis._updateResizers();\n\t}\n\n\tpublic _updateResizers() {\n\t\tthis.panels.each((panel) => {\n\t\t\tlet hidden = false;\n\t\t\tif (this.panelsContainer.children.indexOf(panel) == 0) {\n\t\t\t\thidden = true;\n\t\t\t}\n\t\t\tpanel.panelResizer?.set(\"forceHidden\", hidden);\n\t\t})\n\t}\n\n\tprotected _syncYAxesSize() {\n\t\tlet maxLeft = 0;\n\t\tlet maxRight = 0;\n\t\tthis.panels.each((chart) => {\n\t\t\tlet lw = chart.leftAxesContainer.width();\n\t\t\tlet rw = chart.rightAxesContainer.width();\n\t\t\tif (lw > maxLeft) {\n\t\t\t\tmaxLeft = lw;\n\t\t\t}\n\t\t\tif (rw > maxRight) {\n\t\t\t\tmaxRight = rw;\n\t\t\t}\n\t\t})\n\t\tthis.panels.each((chart) => {\n\t\t\tchart.leftAxesContainer.set(\"minWidth\", maxLeft);\n\t\t\tchart.rightAxesContainer.set(\"minWidth\", maxRight);\n\t\t})\n\n\t\tthis.toolsContainer.set(\"paddingLeft\", maxLeft);\n\t\tthis.toolsContainer.set(\"paddingRight\", maxRight);\n\n\t}\n\n\tprotected _removeXAxis(_axis: Axis<AxisRenderer>) {\n\n\t}\n\n\tprotected _processXAxis(axis: Axis<AxisRenderer>) {\n\t\t$array.move(this._xAxes, axis);\n\t\taxis.on(\"start\", () => {\n\t\t\tif (axis._skipSync != true) {\n\t\t\t\tthis._syncXAxes(axis);\n\t\t\t}\n\t\t})\n\t\taxis.on(\"end\", () => {\n\t\t\tif (axis._skipSync != true) {\n\t\t\t\tthis._syncXAxes(axis);\n\t\t\t}\n\t\t})\n\n\t\tif (this._xAxes[0]) {\n\t\t\tthis._root.events.once(\"frameended\", () => {\n\t\t\t\tthis._syncXAxes(this._xAxes[0])\n\t\t\t})\n\t\t}\n\t}\n\n\tprotected _syncExtremes() {\n\n\t\tconst mainAxis = this.getPrivate(\"mainAxis\");\n\t\tif (mainAxis) {\n\t\t\tconst min = mainAxis.getPrivate(\"min\");\n\t\t\tconst max = mainAxis.getPrivate(\"max\");\n\n\t\t\tthis.panels.each((panel) => {\n\t\t\t\tpanel.xAxes.each((xAxis) => {\n\t\t\t\t\tif (xAxis != mainAxis && xAxis.isType(\"DateAxis\")) {\n\t\t\t\t\t\tlet axisMin = xAxis.getPrivate(\"min\" as any);\n\t\t\t\t\t\tlet axisMax = xAxis.getPrivate(\"max\" as any);\n\n\t\t\t\t\t\tif (axisMin != min) {\n\t\t\t\t\t\t\txAxis.set(\"min\" as any, min);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (axisMax != max) {\n\t\t\t\t\t\t\txAxis.set(\"max\" as any, max);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst type = \"GaplessDateAxis\";\n\t\t\t\t\t\tif (xAxis.isType<GaplessDateAxis<AxisRenderer>>(type) && mainAxis.isType<GaplessDateAxis<AxisRenderer>>(type)) {\n\t\t\t\t\t\t\txAxis._customDates = mainAxis._dates;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\t}\n\n\tprotected _syncXAxes(axis: Axis<AxisRenderer>) {\n\t\t$array.each(this._xAxes, (xAxis) => {\n\t\t\tif (xAxis != axis && xAxis.isType(\"DateAxis\")) {\n\t\t\t\txAxis._skipSync = true;\n\t\t\t\txAxis.set(\"start\", axis.get(\"start\"));\n\t\t\t\txAxis.set(\"end\", axis.get(\"end\"));\n\t\t\t\txAxis._skipSync = false;\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * Returns a color for volume, based on current and previous close.\n\t *\n\t * * `positiveColor` - close is greater or euqal than close of the previous period.\n\t * * `negativeColor` - close is lower than close of the previous period.\n\t *\n\t * @param   dataItem       Target data item\n\t * @param   negativeColor  \"Negative color\" (red)\n\t * @param   positiveColor  \"Positive color\" (green)\n\t * @return  Color\n\t */\n\tpublic getVolumeColor(dataItem: DataItem<IXYSeriesDataItem>, negativeColor?: Color, positiveColor?: Color): Color | undefined {\n\t\tif (dataItem) {\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\n\t\t\tconst volumeSeries = dataItem.component;\n\n\t\t\tif (!negativeColor) {\n\t\t\t\tnegativeColor = this.get(\"volumeNegativeColor\", this.root.interfaceColors.get(\"negative\", Color.fromHex(0xff0000)));\n\t\t\t}\n\n\t\t\tif (!positiveColor) {\n\t\t\t\tpositiveColor = this.get(\"volumePositiveColor\", this.root.interfaceColors.get(\"positive\", Color.fromHex(0x00FF00)));\n\t\t\t}\n\n\n\t\t\tif (negativeColor && positiveColor) {\n\t\t\t\tif (stockSeries && volumeSeries) {\n\t\t\t\t\tconst index = volumeSeries.dataItems.indexOf(dataItem);\n\t\t\t\t\tif (index > 0) {\n\t\t\t\t\t\tlet stockDataItem = stockSeries.dataItems[index];\n\t\t\t\t\t\tif (stockDataItem) {\n\t\t\t\t\t\t\tlet close = stockDataItem.get(\"valueY\");\n\t\t\t\t\t\t\tif (close != null) {\n\t\t\t\t\t\t\t\tfor (let i = index - 1; i >= 0; i--) {\n\t\t\t\t\t\t\t\t\tlet di = stockSeries.dataItems[i];\n\t\t\t\t\t\t\t\t\tlet previousClose = di.get(\"valueY\");\n\n\t\t\t\t\t\t\t\t\tif (previousClose != null) {\n\t\t\t\t\t\t\t\t\t\tif (close < previousClose) {\n\t\t\t\t\t\t\t\t\t\t\treturn negativeColor;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\treturn positiveColor;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn positiveColor;\n\t}\n\n\t/**\n\t * Returns a first [[StockControl]] of specific type.\n\t *\n\t * @since 5.7.0\n\t * @param   type  Control name\n\t * @return        Control\n\t */\n\tpublic getControl(type: string): StockControl | undefined {\n\t\tlet found: StockControl | undefined;\n\t\t$array.eachContinue(this.controls, (control: StockControl) => {\n\t\t\tif (control.className == type) {\n\t\t\t\tfound = control;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\treturn found;\n\t}\n\n\tpublic _dragStartDrawing(event: ISpritePointerEvent) {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tseries._dragStart(event);\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\tpublic _dragStopDrawing(event: ISpritePointerEvent) {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tseries._dragStop(event);\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t/**\n\t * Enables or disables interactivity of annotations (drawings).\n\t *\n\t * @param value Drawings interactive?\n\t * @since 5.4.9\n\t */\n\tpublic drawingsInteractive(value: boolean, except?: DrawingSeries) {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series != except) {\n\t\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\t\tseries.setInteractive(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t/**\n\t * Unselect all currently selected drawings.\n\t *\n\t * @since 5.9.0\n\t */\n\tpublic unselectDrawings(): number {\n\t\tlet count = 0;\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tcount += series.unselectDrawings();\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\n\t\tthis.spriteResizer.set(\"sprite\", undefined);\n\n\t\treturn count;\n\t}\n\n\t/**\n\t * Cancels drawing and deletes drawing which is now being drawn.\n\t *\n\t * @since 5.9.0\n\t */\n\tpublic cancelDrawing() {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tseries.cancelDrawing();\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t/**\n\t * Deletes all currently selected drawings.\n\t *\n\t * @since 5.9.0\n\t *\n\t */\n\tpublic deleteSelectedDrawings() {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tseries.deleteSelected();\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t/**\n\t * Selects drawing by its ID.\n\t *\n\t * @param  id             Drawing ID\n\t * @param  keepSelection  Keep existing selections\n\t * @since 5.9.0\n\t */\n\tpublic selectDrawing(id: string, keepSelection?: boolean) {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tseries.selectDrawing(id, keepSelection);\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t/**\n\t * Unselects drawing by ID.\n\t *\n\t * @param  id  Drawing ID\n\t * @since 5.9.0\n\t */\n\tpublic unselectDrawing(id: string) {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tseries.unselectDrawing(id);\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t/**\n\t * Deletes drawing by drawingId.\n\t *\n\t * @param  id  Drawing ID\n\t * @since 5.9.0\n\t */\n\tpublic deleteDrawing(id: string) {\n\t\tthis.panels.each((panel) => {\n\t\t\tpanel.series.each((series) => {\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\n\t\t\t\t\tseries.deleteDrawing(id);\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n}\n\n/**\n * Registers a custom class so that objects (e.g. indicators) using it can be\n * serialized and restored later.\n *\n * @param  name  Class name\n * @param  ref   Class reference\n * @since 5.7.2\n */\nexport function registerClass(name: string, ref: any) {\n\tref.className = name;\n\tregisterCustomClass(name, ref);\n}\n","import type { XYSeries, IXYSeriesDataItem } from \"../../xy/series/XYSeries\";\r\nimport type { StockLegend } from \"../StockLegend\";\r\nimport type { StockChart } from \"../StockChart\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { Container, IContainerSettings, IContainerPrivate, IContainerEvents } from \"../../../core/render/Container\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport { BaseColumnSeries } from \"../../xy/series/BaseColumnSeries\";\r\nimport { MultiDisposer } from \"../../../core/util/Disposer\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IIndicatorEditableSetting {\r\n\r\n\t/**\r\n\t * Setting key.\r\n\t */\r\n\tkey: string;\r\n\r\n\t/**\r\n\t * Name of the setting (displayed in edit modal).\r\n\t *\r\n\t * Settings with the same name will be grouped in modal.\r\n\t */\r\n\tname: string;\r\n\r\n\t/**\r\n\t * Type of the control to show for editing the setting in modal.\r\n\t */\r\n\ttype: \"color\" | \"number\" | \"dropdown\" | \"checkbox\";\r\n\r\n\t/**\r\n\t * Minimum numeric value allowable in this field.\r\n\t *\r\n\t * @since 5.8.1\r\n\t */\r\n\tminValue?: number;\r\n\r\n\t/**\r\n\t * If `type: \"dropdown\"`, `options` should contain a list of items it.\r\n\t */\r\n\toptions?: Array<string | {\r\n\t\tvalue: number | string,\r\n\t\ttext: string,\r\n\t\textTarget?: string,\r\n\t\textTargetValue?: number | string,\r\n\t\textTargetMinValue?: number\r\n\t}>;\r\n\r\n}\r\n\r\nexport interface IIndicatorSettings extends IContainerSettings {\r\n\r\n\t/**\r\n\t * An instance of target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * A main series indicator will be based on.\r\n\t */\r\n\tstockSeries: XYSeries;\r\n\r\n\t/**\r\n\t * A volume series indicator will be based on, if it reaquires one.\r\n\t */\r\n\tvolumeSeries?: XYSeries;\r\n\r\n\t/**\r\n\t * If set to a reference to [[StockLegend]], indicator will add itself into\r\n\t * the legend.\r\n\t */\r\n\tlegend?: StockLegend;\r\n\r\n\t/**\r\n\t * Period.\r\n\t */\r\n\tperiod?: number;\r\n\r\n\t/**\r\n\t * A value field to use.\r\n\t */\r\n\tfield?: \"open\" | \"close\" | \"low\" | \"high\" | \"hl/2\" | \"hlc/3\" | \"hlcc/4\" | \"ohlc/4\";\r\n\r\n\t/**\r\n\t * Indicator name, e.g. \"Moving Average\".\r\n\t */\r\n\tname?: string;\r\n\r\n\t/**\r\n\t * Short name for the indicator, e.g. \"MA\" (for \"Moving Average\").\r\n\t *\r\n\t * Mainly used for the legend.\r\n\t */\r\n\tshortName?: string;\r\n\r\n\t/**\r\n\t * A color to use for the indicator series.\r\n\t */\r\n\tseriesColor?: Color;\r\n\r\n\t/**\r\n\t * Should indicator settings modal be openend automatically when indicator\r\n\t * is added to a chart via [[IndicatorControl]].\r\n\t * \r\n\t * @default true\r\n\t * @since 5.10.6\r\n\t */\r\n\tautoOpenSettings?: boolean;\r\n\r\n}\r\n\r\nexport interface IIndicatorPrivate extends IContainerPrivate {\r\n}\r\n\r\nexport interface IIndicatorEvents extends IContainerEvents {\r\n}\r\n\r\n/**\r\n * Base class for [[StockChart]] indicators.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport abstract class Indicator extends Container {\r\n\tpublic static className: string = \"Indicator\";\r\n\tpublic static classNames: Array<string> = Container.classNames.concat([Indicator.className]);\r\n\r\n\tdeclare public _settings: IIndicatorSettings;\r\n\tdeclare public _privateSettings: IIndicatorPrivate;\r\n\tdeclare public _events: IIndicatorEvents;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [];\r\n\r\n\tpublic series!: XYSeries;\r\n\r\n\tprotected _dataDirty = false;\r\n\r\n\tprotected _sDP?: MultiDisposer;\r\n\tprotected _vDP?: MultiDisposer;\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tsuper._prepareChildren();\r\n\r\n\t\tif (this.isDirty(\"stockSeries\") || this.isDirty(\"volumeSeries\")) {\r\n\t\t\tthis.markDataDirty();\r\n\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst previousS = this._prevSettings.stockSeries;\r\n\t\t\tif (previousS && this._sDP) {\r\n\t\t\t\tthis._sDP.dispose();\r\n\t\t\t}\r\n\t\t\tif (stockSeries) {\r\n\t\t\t\tthis._sDP = new MultiDisposer([\r\n\t\t\t\t\tstockSeries.events.on(\"datavalidated\", () => {\r\n\t\t\t\t\t\tthis._markDataDirty();\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tstockSeries.events.on(\"datasetchanged\", () => {\r\n\t\t\t\t\t\tthis._markDataDirty();\r\n\t\t\t\t\t})\r\n\t\t\t\t])\r\n\t\t\t}\r\n\r\n\t\t\tconst previousV = this._prevSettings.volumeSeries;\r\n\t\t\tif (previousV && this._vDP) {\r\n\t\t\t\tthis._vDP.dispose();\r\n\t\t\t}\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tif (volumeSeries) {\r\n\t\t\t\tthis._vDP = new MultiDisposer([\r\n\t\t\t\t\tvolumeSeries.events.on(\"datavalidated\", () => {\r\n\t\t\t\t\t\tthis._markDataDirty();\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tvolumeSeries.events.on(\"datasetchanged\", () => {\r\n\t\t\t\t\t\tthis._markDataDirty();\r\n\t\t\t\t\t})\r\n\t\t\t\t])\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"field\")) {\r\n\t\t\tif (this.get(\"field\")) {\r\n\t\t\t\tthis.markDataDirty();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"period\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"period\", this.get(\"period\"));\r\n\t\t}\r\n\r\n\r\n\t\tif (this._dataDirty) {\r\n\t\t\tthis.prepareData();\r\n\t\t\tthis._dataDirty = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _markDataDirty() {\r\n\t\tthis._dataDirty = true;\r\n\t\tthis.markDirty();\r\n\t}\r\n\r\n\tpublic markDataDirty() {\r\n\t\tthis._root.events.once(\"frameended\", () => {\r\n\t\t\tthis._markDataDirty();\r\n\t\t})\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"seriesColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.series, this.get(\"seriesColor\"), \"seriesColor\");\r\n\t\t}\r\n\r\n\t\tthis.setCustomData(\"period\", this.get(\"period\"));\r\n\t\tthis.setCustomData(\"field\", this.get(\"field\"));\r\n\t\tthis.setCustomData(\"name\", this.get(\"name\"));\r\n\t\tthis.setCustomData(\"shortName\", this.get(\"shortName\"));\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tsuper._dispose();\r\n\r\n\t\tif (this._sDP) {\r\n\t\t\tthis._sDP.dispose();\r\n\t\t}\r\n\t\tif (this._vDP) {\r\n\t\t\tthis._vDP.dispose();\r\n\t\t}\r\n\r\n\t\tconst series = this.series;\r\n\t\tif (series) {\r\n\t\t\tseries.dispose();\r\n\r\n\t\t\tconst yAxis = series.get(\"yAxis\");\r\n\t\t\tif (yAxis) {\r\n\t\t\t\tyAxis.markDirtySelectionExtremes();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tif (stockChart) {\r\n\t\t\tconst legend = this.get(\"legend\");\r\n\t\t\tif (legend) {\r\n\t\t\t\tconst legendDataItem = series.get(\"legendDataItem\");\r\n\t\t\t\tif (legendDataItem) {\r\n\t\t\t\t\tlegend.disposeDataItem(legendDataItem as any);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstockChart.indicators.removeValue(this);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic async hide(duration?: number): Promise<any> {\r\n\t\treturn Promise.all([\r\n\t\t\tsuper.hide(duration),\r\n\t\t\tthis.series.hide(duration)\r\n\t\t]);\r\n\t}\r\n\r\n\tpublic async show(duration?: number): Promise<any> {\r\n\t\treturn Promise.all([\r\n\t\t\tsuper.show(duration),\r\n\t\t\tthis.series.show(duration)\r\n\t\t]);\r\n\t}\r\n\r\n\tprotected _handleLegend(series: XYSeries) {\r\n\t\tconst legend = this.get(\"legend\");\r\n\t\tif (legend) {\r\n\t\t\tlegend.data.push(series);\r\n\r\n\t\t\tconst legendDataItem = legend.dataItems[legend.dataItems.length - 1];\r\n\t\t\tlegendDataItem.get(\"marker\").set(\"forceHidden\", true);\r\n\r\n\t\t\tconst closeButton = legendDataItem.get(\"closeButton\");\r\n\t\t\tcloseButton.set(\"forceHidden\", false);\r\n\t\t\tcloseButton.events.on(\"click\", () => {\r\n\t\t\t\tthis.dispose();\r\n\t\t\t})\r\n\r\n\t\t\tconst settingsButton = legendDataItem.get(\"settingsButton\");\r\n\t\t\tsettingsButton.setPrivate(\"customData\", this);\r\n\r\n\t\t\tconst editableSettings = this._editableSettings;\r\n\t\t\tif (!editableSettings || editableSettings.length == 0) {\r\n\t\t\t\tsettingsButton.set(\"forceHidden\", true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateSeriesColor(series?: XYSeries, color?: Color, contextName?: string) {\r\n\t\tif (series) {\r\n\t\t\tseries.set(\"stroke\", color);\r\n\t\t\tseries.set(\"fill\", color);\r\n\t\t\tif (series instanceof LineSeries) {\r\n\t\t\t\tseries.strokes.template.set(\"stroke\", color);\r\n\t\t\t\tseries.fills.template.set(\"fill\", color);\r\n\t\t\t}\r\n\r\n\t\t\tif (series instanceof BaseColumnSeries) {\r\n\t\t\t\tseries.columns.template.setAll({ stroke: color, fill: color });\r\n\t\t\t}\r\n\r\n\t\t\tif (contextName && color) {\r\n\t\t\t\tthis.setCustomData(contextName, color.toCSSHex());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tpublic setCustomData(name: string, value?: any) {\r\n\t\tconst customData = this.series.getPrivate(\"customData\");\r\n\t\tif (customData) {\r\n\t\t\tcustomData[name] = value;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\r\n\t}\r\n\r\n\tprotected _getValue(dataItem: DataItem<IXYSeriesDataItem>): number | undefined {\r\n\t\tconst field = this.get(\"field\");\r\n\r\n\t\tlet o = dataItem.get(\"openValueY\") as number;\r\n\t\tlet h = dataItem.get(\"highValueY\") as number;\r\n\t\tlet l = dataItem.get(\"lowValueY\") as number;\r\n\t\tlet c = dataItem.get(\"valueY\") as number;\r\n\r\n\t\tswitch (field) {\r\n\t\t\tcase \"close\":\r\n\t\t\t\treturn c;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"open\":\r\n\t\t\t\treturn o;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"high\":\r\n\t\t\t\treturn h;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"low\":\r\n\t\t\t\treturn l;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"hl/2\":\r\n\t\t\t\treturn (h + l) / 2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"hlc/3\":\r\n\t\t\t\treturn (h + l + c) / 3;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"hlcc/4\":\r\n\t\t\t\treturn (h + l + c + c) / 4;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"ohlc/4\":\r\n\t\t\t\treturn (o + h + l + c) / 4;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tprotected _getDataArray(dataItems: Array<DataItem<any>>): Array<any> {\r\n\t\tconst data: Array<any> = [];\r\n\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\tdata.push({ valueX: dataItem.get(\"valueX\"), value_y: this._getValue(dataItem) });\r\n\t\t})\r\n\t\treturn data;\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tprotected _getTypicalPrice(dataItems: Array<DataItem<any>>): Array<any> {\r\n\t\tconst data: Array<any> = [];\r\n\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\tdata.push({ valueX: dataItem.get(\"valueX\"), value_y: (dataItem.get(\"valueY\", 0) + dataItem.get(\"highValueY\", 0) + dataItem.get(\"lowValueY\", 0)) / 2 });\r\n\t\t})\r\n\t\treturn data;\r\n\t}\r\n\r\n\tprotected _sma(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet index = 0;\r\n\t\tlet ma = 0;\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet value = dataItem[field];\r\n\t\t\tif (value != null) {\r\n\t\t\t\ti++;\r\n\t\t\t\tma += value / period;\r\n\r\n\t\t\t\tif (i >= period) {\r\n\t\t\t\t\tif (i > period) {\r\n\t\t\t\t\t\tlet valueToRemove = data[index - period][field];\r\n\t\t\t\t\t\tif (valueToRemove != null) {\r\n\t\t\t\t\t\t\tma -= valueToRemove / period;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdataItem[toField] = ma;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tindex++;\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _wma(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet index = 0;\r\n\t\tlet ma = 0;\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet value = dataItem[field];\r\n\t\t\tif (value != null) {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i >= period) {\r\n\t\t\t\t\tlet sum = 0;\r\n\t\t\t\t\tlet m = 0;\r\n\t\t\t\t\tlet count = 0;\r\n\t\t\t\t\tlet k = 0\r\n\t\t\t\t\tfor (let n = index; n >= 0; n--) {\r\n\t\t\t\t\t\tlet pValue = data[n][field];\r\n\r\n\t\t\t\t\t\tif (pValue != null) {\r\n\t\t\t\t\t\t\tsum += pValue * (period - m);\r\n\t\t\t\t\t\t\tcount += (period - m);\r\n\t\t\t\t\t\t\tk++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tm++;\r\n\r\n\t\t\t\t\t\tif (k == period) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tma = sum / count;\r\n\t\t\t\t\tdataItem[toField] = ma;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tindex++;\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _ema(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet ma = 0;\r\n\t\tlet multiplier = 2 / (1 + period);\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet value = dataItem[field];\r\n\t\t\tif (value != null) {\r\n\t\t\t\ti++;\r\n\r\n\t\t\t\tif (i > period) {\r\n\t\t\t\t\tma = value * multiplier + ma * (1 - multiplier);\r\n\t\t\t\t\tdataItem[toField] = ma;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tma += value / period;\r\n\t\t\t\t\tif (i == period) {\r\n\t\t\t\t\t\tdataItem[toField] = ma;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _dema(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet ema2 = 0;\r\n\t\tlet multiplier = 2 / (1 + period);\r\n\r\n\t\tthis._ema(data, period, field, \"ema\");\r\n\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet ema = dataItem.ema;\r\n\t\t\tif (ema != null) {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i > period) {\r\n\t\t\t\t\tema2 = ema * multiplier + ema2 * (1 - multiplier);\r\n\t\t\t\t\tdataItem[toField] = 2 * ema - ema2;\r\n\t\t\t\t\tdataItem.ema2 = ema2;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tema2 += ema / period;\r\n\t\t\t\t\tif (i == period) {\r\n\t\t\t\t\t\tdataItem[toField] = 2 * ema - ema2;\r\n\t\t\t\t\t\tdataItem.ema2 = ema2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _tema(data: Array<any>, period: number, field: string, toField: string) {\r\n\t\tlet i = 0;\r\n\t\tlet ema3 = 0;\r\n\t\tlet multiplier = 2 / (1 + period);\r\n\r\n\t\tthis._dema(data, period, field, \"dema\");\r\n\r\n\t\t$array.each(data, (dataItem) => {\r\n\t\t\tlet ema = dataItem.ema;\r\n\t\t\tlet ema2 = dataItem.ema2;\r\n\r\n\t\t\tif (ema2 != null) {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i > period) {\r\n\t\t\t\t\tema3 = ema2 * multiplier + ema3 * (1 - multiplier);\r\n\t\t\t\t\tdataItem[toField] = 3 * ema - 3 * ema2 + ema3;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tema3 += ema2 / period;\r\n\t\t\t\t\tif (i == period) {\r\n\t\t\t\t\t\tdataItem[toField] = 3 * ema - 3 * ema2 + ema3;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n}","import type { DataItem } from \"../../core/render/Component\";\r\nimport type { StockChart } from \"./StockChart\";\r\nimport type { StockPanel } from \"./StockPanel\";\r\n\r\nimport { Legend, ILegendPrivate, ILegendSettings, ILegendEvents, ILegendDataItem } from \"../../core/render/Legend\";\r\nimport { Button } from \"../../core/render/Button\";\r\nimport { Graphics } from \"../../core/render/Graphics\";\r\nimport { Template } from \"../../core/util/Template\";\r\nimport { ListTemplate } from \"../../core/util/List\";\r\nimport { Indicator } from \"./indicators/Indicator\";\r\n\r\nimport * as $utils from \"../../core/util/Utils\";\r\n\r\nexport interface IStockLegendDataItem extends ILegendDataItem {\r\n\r\n\t/**\r\n\t * Legend item \"close\" [[Button]].\r\n\t */\r\n\tcloseButton: Button;\r\n\r\n\t/**\r\n\t * Legend item \"settings\" [[Button]].\r\n\t */\r\n\tsettingsButton: Button;\r\n\r\n\t/**\r\n\t * Target [[StockPanel]] legend item is attached to.\r\n\t */\r\n\tpanel: StockPanel;\r\n\r\n}\r\n\r\n\r\nexport interface IStockLegendSettings extends ILegendSettings {\r\n\r\n\t/**\r\n\t * A target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n}\r\n\r\nexport interface IStockLegendPrivate extends ILegendPrivate {\r\n}\r\n\r\nexport interface IStockLegendEvents extends ILegendEvents {\r\n}\r\n\r\n/**\r\n * A legend, specifically designed for use in a [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/#Legend} for more info\r\n * @important\r\n */\r\nexport class StockLegend extends Legend {\r\n\r\n\tpublic static className: string = \"StockLegend\";\r\n\tpublic static classNames: Array<string> = Legend.classNames.concat([StockLegend.className]);\r\n\r\n\tdeclare public _settings: IStockLegendSettings;\r\n\tdeclare public _privateSettings: IStockLegendPrivate;\r\n\tdeclare public _events: IStockLegendEvents;\r\n\tdeclare public _dataItemSettings: IStockLegendDataItem;\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._settings.themeTags = $utils.mergeTags(this._settings.themeTags, [\"stocklegend\"]);\r\n\t\tsuper._afterNew();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeCloseButton(): Button {\r\n\t\tconst button = this.closeButtons.make();\r\n\t\tthis.closeButtons.push(button);\r\n\t\treturn button;\r\n\t}\r\n\r\n\t/**\r\n\t * A list of \"close\" buttons in legend items.\r\n\t *\r\n\t * @default new ListTemplate<Button>()\r\n\t */\r\n\tpublic readonly closeButtons: ListTemplate<Button> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Button._new(this._root, {\r\n\t\t\tthemeTags: $utils.mergeTags(this.closeButtons.template.get(\"themeTags\", []), [\"control\", \"close\"]),\r\n\t\t\ticon: Graphics.new(this._root, {\r\n\t\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t\t})\r\n\t\t}, [this.closeButtons.template])\r\n\t));\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeSettingsButton(): Button {\r\n\t\tconst button = this.settingsButtons.make();\r\n\t\tthis.settingsButtons.push(button);\r\n\r\n\t\tbutton.events.on(\"click\", () => {\r\n\r\n\t\t\tconst dataItem = button.dataItem as DataItem<IStockLegendDataItem>;\r\n\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\t\tif (stockChart) {\r\n\t\t\t\t\tconst indicator = button.getPrivate(\"customData\");\r\n\t\t\t\t\tif (indicator instanceof Indicator) {\r\n\t\t\t\t\t\tstockChart.getPrivate(\"settingsModal\").openIndicator(indicator);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tstockChart.getPrivate(\"settingsModal\").openSeries(dataItem.dataContext as any);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tbutton.unhover();\r\n\t\t\t}, 50)\r\n\t\t})\r\n\r\n\t\treturn button;\r\n\t}\r\n\r\n\t/**\r\n\t * A list of \"settings\" buttons in legend items.\r\n\t *\r\n\t * @default new ListTemplate<Button>()\r\n\t */\r\n\tpublic readonly settingsButtons: ListTemplate<Button> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Button._new(this._root, {\r\n\t\t\tthemeTags: $utils.mergeTags(this.settingsButtons.template.get(\"themeTags\", []), [\"control\", \"settings\"]),\r\n\t\t\ticon: Graphics.new(this._root, {\r\n\t\t\t\tthemeTags: [\"icon\", \"button\"]\r\n\t\t\t})\r\n\t\t}, [this.settingsButtons.template])\r\n\t));\r\n\r\n\r\n\tprotected processDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.processDataItem(dataItem);\r\n\r\n\t\tconst itemContainer = dataItem.get(\"itemContainer\");\r\n\r\n\t\tconst settingsButton = this.makeSettingsButton();\r\n\t\titemContainer.children.push(settingsButton);\r\n\t\tsettingsButton._setDataItem(dataItem);\r\n\t\tdataItem.set(\"settingsButton\", settingsButton);\r\n\r\n\t\tconst closeButton = this.makeCloseButton();\r\n\t\titemContainer.children.push(closeButton);\r\n\t\tcloseButton._setDataItem(dataItem);\r\n\t\tdataItem.set(\"closeButton\", closeButton);\r\n\t}\r\n}\r\n","import type { PanelControls } from \"./PanelControls\";\r\nimport type { StockChart } from \"./StockChart\"\r\nimport type { XYSeries } from \"../xy/series/XYSeries\";\r\nimport type { Rectangle } from \"../../core/render/Rectangle\";\r\n\r\nimport { XYChart, IXYChartPrivate, IXYChartSettings, IXYChartEvents } from \"../xy/XYChart\";\r\nimport { ListAutoDispose } from \"../../core/util/List\";\r\n\r\nimport * as $array from \"../../core/util/Array\";\r\n\r\nexport interface IStockPanelSettings extends IXYChartSettings {\r\n}\r\n\r\nexport interface IStockPanelPrivate extends IXYChartPrivate {\r\n\r\n\t/**\r\n\t * A target [[StockChart]].\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n}\r\n\r\nexport interface IStockPanelEvents extends IXYChartEvents {\r\n\t/**\r\n\t * Kicks in when panels is moved up or down.\r\n\t * \r\n\t * @since 5.9.2\r\n\t */\r\n\tmoved: {\r\n\t\toldIndex: number;\r\n\t\tnewIndex: number;\r\n\t};\r\n\r\n\t/**\r\n\t * Kicks in when panel is closed (removed).\r\n\t *\r\n\t * @since 5.9.2\r\n\t */\r\n\tclosed: {};\r\n\r\n\t/**\r\n\t * Kicks in when panel is expanded.\r\n\t *\r\n\t * @since 5.9.2\r\n\t */\r\n\texpanded: {};\r\n\r\n\t/**\r\n\t * Kicks in when panel is collapsed (returns to normal size).\r\n\t *\r\n\t * @since 5.9.2\r\n\t */\r\n\tcollapsed: {};\r\n}\r\n\r\n/**\r\n * A panel instance for the [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/panels/} for more info\r\n * @important\r\n */\r\nexport class StockPanel extends XYChart {\r\n\tpublic static className: string = \"StockPanel\";\r\n\tpublic static classNames: Array<string> = XYChart.classNames.concat([StockPanel.className]);\r\n\r\n\tdeclare public _settings: IStockPanelSettings;\r\n\tdeclare public _privateSettings: IStockPanelPrivate;\r\n\tdeclare public _events: IStockPanelEvents;\r\n\r\n\t/**\r\n\t * An instance of [[PanelControls]].\r\n\t */\r\n\tpublic panelControls!: PanelControls;\r\n\r\n\t/**\r\n\t * Panel resize grip element.\r\n\t *\r\n\t * @since 5.4.7\r\n\t */\r\n\tpublic panelResizer?: Rectangle;\r\n\r\n\t/**\r\n\t * A list of drawings on panel.\r\n\t *\r\n\t */\r\n\tpublic readonly drawings: ListAutoDispose<XYSeries> = new ListAutoDispose();\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis._disposers.push(this.drawings.events.onAll((change) => {\r\n\t\t\tif (change.type === \"clear\") {\r\n\t\t\t\t$array.each(change.oldValues, (series) => {\r\n\t\t\t\t\tthis.series.removeValue(series);\r\n\t\t\t\t})\r\n\t\t\t} else if (change.type === \"push\") {\r\n\t\t\t\tthis.series.push(change.newValue);\r\n\t\t\t} else if (change.type === \"setIndex\") {\r\n\t\t\t\tthis.series.setIndex(change.index, change.newValue);\r\n\t\t\t} else if (change.type === \"insertIndex\") {\r\n\t\t\t\tthis.series.insertIndex(change.index, change.newValue);\r\n\t\t\t} else if (change.type === \"removeIndex\") {\r\n\t\t\t\tthis.series.removeIndex(change.index);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"Unknown IListEvent type\");\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\t/**\r\n\t * Moves panel up.\r\n\t */\r\n\tpublic moveUp(): void {\r\n\t\tconst stockChart = this.getPrivate(\"stockChart\");\r\n\t\tconst children = stockChart.panelsContainer.children;\r\n\r\n\t\tconst index = children.indexOf(this);\r\n\t\tif (index > 0) {\r\n\t\t\tchildren.moveValue(this, index - 1);\r\n\t\t\tconst type = \"moved\";\r\n\t\t\tif (this.events.isEnabled(type)) {\r\n\t\t\t\tthis.events.dispatch(type, {\r\n\t\t\t\t\ttype: type,\r\n\t\t\t\t\toldIndex: index,\r\n\t\t\t\t\tnewIndex: index - 1,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstockChart._updateControls();\r\n\t}\r\n\r\n\t/**\r\n\t * Moves panel down.\r\n\t */\r\n\tpublic moveDown(): void {\r\n\t\tconst stockChart = this.getPrivate(\"stockChart\");\r\n\t\tconst children = stockChart.panelsContainer.children;\r\n\r\n\t\tconst index = children.indexOf(this);\r\n\t\tif (index < children.length - 1) {\r\n\t\t\tchildren.moveValue(this, index + 1);\r\n\t\t\tconst type = \"moved\";\r\n\t\t\tif (this.events.isEnabled(type)) {\r\n\t\t\t\tthis.events.dispatch(type, {\r\n\t\t\t\t\ttype: type,\r\n\t\t\t\t\toldIndex: index,\r\n\t\t\t\t\tnewIndex: index + 1,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tstockChart._updateControls();\r\n\t}\r\n\r\n\t/**\r\n\t * Closes panel.\r\n\t */\r\n\tpublic close(): void {\r\n\t\tconst stockChart = this.getPrivate(\"stockChart\");\r\n\t\tconst type = \"closed\";\r\n\t\tif (this.events.isEnabled(type)) {\r\n\t\t\tthis.events.dispatch(type, {\r\n\t\t\t\ttype: type,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t}\r\n\t\tstockChart.panels.removeValue(this);\r\n\t\tstockChart._updateControls();\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles \"full screen\" mode of the panel on and off.\r\n\t */\r\n\tpublic expand(): void {\r\n\t\tconst stockChart = this.getPrivate(\"stockChart\");\r\n\r\n\t\tconst panels: Array<StockPanel> = [];\r\n\t\tstockChart.panels.each((panel) => {\r\n\t\t\tif (!panel.isVisible()) {\r\n\t\t\t\tpanels.push(panel);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t$array.each(panels, (panel) => {\r\n\t\t\tpanel.setPrivate(\"visible\", true);\r\n\t\t});\r\n\r\n\t\tif (panels.length == 0) {\r\n\t\t\tstockChart.panels.each((panel) => {\r\n\t\t\t\tif (panel != this) {\r\n\t\t\t\t\tpanel.setPrivate(\"visible\", false);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst type = \"expanded\";\r\n\t\t\tif (this.events.isEnabled(type)) {\r\n\t\t\t\tthis.events.dispatch(type, {\r\n\t\t\t\t\ttype: type,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst type = \"collapsed\";\r\n\t\t\tif (this.events.isEnabled(type)) {\r\n\t\t\t\tthis.events.dispatch(type, {\r\n\t\t\t\t\ttype: type,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tstockChart._updateControls();\r\n\r\n\t\tif (panels.length == 0) {\r\n\t\t\tconst panelControls = this.panelControls;\r\n\t\t\tpanelControls.upButton.setPrivate(\"visible\", false);\r\n\t\t\tpanelControls.downButton.setPrivate(\"visible\", false);\r\n\t\t\tpanelControls.closeButton.setPrivate(\"visible\", false);\r\n\t\t}\r\n\t}\r\n}\r\n","import type { XYSeries } from \"../../xy/series/XYSeries\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\n\r\nimport { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents } from \"./Indicator\";\r\nimport { StockPanel } from \"../StockPanel\";\r\nimport { XYCursor } from \"../../xy/XYCursor\";\r\nimport { DateAxis } from \"../../xy/axes/DateAxis\";\r\nimport { GaplessDateAxis } from \"../../xy/axes/GaplessDateAxis\";\r\nimport { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport { AxisRendererX } from \"../../xy/axes/AxisRendererX\";\r\nimport { AxisRendererY } from \"../../xy/axes/AxisRendererY\";\r\nimport { Tooltip } from \"../../../core/render/Tooltip\";\r\nimport { StockLegend } from \"../StockLegend\";\r\n\r\n\r\nexport interface IChartIndicatorSettings extends IIndicatorSettings {\r\n}\r\n\r\nexport interface IChartIndicatorPrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IChartIndicatorEvents extends IIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * A base class for chart-based [[StockChart]] indicators.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport abstract class ChartIndicator extends Indicator {\r\n\tpublic static className: string = \"ChartIndicator\";\r\n\tpublic static classNames: Array<string> = Indicator.classNames.concat([ChartIndicator.className]);\r\n\r\n\tdeclare public _settings: IChartIndicatorSettings;\r\n\tdeclare public _privateSettings: IChartIndicatorPrivate;\r\n\tdeclare public _events: IChartIndicatorEvents;\r\n\r\n\tpublic panel!: StockPanel;\r\n\tpublic xAxis!: DateAxis<AxisRenderer>;\r\n\tpublic yAxis!: ValueAxis<AxisRenderer>;\r\n\tpublic cursor!: XYCursor;\r\n\tpublic legend!: StockLegend;\r\n\r\n\tprotected _themeTag?: string;\r\n\tprotected _themeTags:Array<string> = [\"indicator\"];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst seriesChart = stockSeries.chart;\r\n\t\tconst root = this._root;\r\n\t\tif (stockChart && seriesChart) {\r\n\t\t\t// make chart\r\n\t\t\tconst chart = stockChart.panels.push(StockPanel.new(root, { themeTags: this._themeTags }));\r\n\t\t\tchart.addTag(\"indicator\");\r\n\t\t\tthis.panel = chart;\r\n\r\n\t\t\tthis.addDisposer(stockChart.panels.events.on(\"removeIndex\", (e) => {\r\n\t\t\t\tif (e.oldValue == chart) {\r\n\t\t\t\t\tstockChart.indicators.removeValue(this);\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\r\n\t\t\tconst seriesXAxis = stockSeries.get(\"xAxis\") as any;\r\n\r\n\t\t\t// xAxis\r\n\t\t\tconst xRenderer = AxisRendererX.new(root, {});\r\n\t\t\tlet xAxis: DateAxis<AxisRenderer> | GaplessDateAxis<AxisRenderer> | undefined;\r\n\t\t\tlet baseInterval = seriesXAxis.get(\"baseInterval\");\r\n\t\t\tlet start = seriesXAxis.get(\"start\");\r\n\t\t\tlet end = seriesXAxis.get(\"end\");\r\n\r\n\t\t\tif (seriesXAxis instanceof GaplessDateAxis) {\r\n\t\t\t\txAxis = chart.xAxes.push(GaplessDateAxis.new(root, { renderer: xRenderer, baseInterval: baseInterval }));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\txAxis = chart.xAxes.push(DateAxis.new(root, { renderer: xRenderer, baseInterval: baseInterval }));\r\n\t\t\t}\r\n\r\n\t\t\txRenderer.set(\"minorGridEnabled\", seriesXAxis.get(\"renderer\")?.get(\"minorGridEnabled\"));\r\n\t\t\txAxis.set(\"groupData\", seriesXAxis.get(\"groupData\"));\r\n\t\t\txAxis.set(\"groupCount\", seriesXAxis.get(\"groupCount\"));\r\n\r\n\t\t\txAxis.set(\"tooltip\", Tooltip.new(root, { forceHidden: true }));\r\n\r\n\t\t\txAxis.setAll({ start: start, end: end })\r\n\t\t\tthis.xAxis = xAxis;\r\n\r\n\t\t\t// yAxis\r\n\t\t\tconst yRenderer = AxisRendererY.new(root, {\r\n\t\t\t\tminGridDistance:20\r\n\t\t\t});\r\n\t\t\tconst yAxis = chart.yAxes.push(ValueAxis.new(root, {\r\n\t\t\t\trenderer: yRenderer,\r\n\t\t\t\ttooltip: Tooltip.new(root, { forceHidden: true })\r\n\t\t\t}))\r\n\t\t\tthis.yAxis = yAxis;\r\n\r\n\t\t\tconst series = this._createSeries();\r\n\t\t\tthis.series = series;\r\n\r\n\t\t\t// legend\r\n\t\t\tconst legend = chart.topPlotContainer.children.insertIndex(0,\r\n\t\t\t\tStockLegend.new(root, { stockChart: this.get(\"stockChart\") })\r\n\t\t\t);\r\n\r\n\t\t\tlegend.data.push(series);\r\n\r\n\t\t\tconst legendDataItem = legend.dataItems[legend.dataItems.length - 1];\r\n\t\t\tlegendDataItem.set(\"panel\", chart);\r\n\t\t\tlegendDataItem.get(\"marker\").set(\"forceHidden\", true);\r\n\r\n\t\t\tconst settingsButton = legendDataItem.get(\"settingsButton\");\r\n\t\t\tsettingsButton.setPrivate(\"customData\", this);\r\n\r\n\t\t\tconst editableSettings = this._editableSettings;\r\n\t\t\tif (!editableSettings || editableSettings.length == 0) {\r\n\t\t\t\tsettingsButton.set(\"forceHidden\", true);\r\n\t\t\t}\r\n\r\n\t\t\tchart.set(\"cursor\", XYCursor.new(root, { yAxis: yAxis, xAxis: xAxis }));\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tsuper._dispose();\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.panels.removeValue(this.panel);\r\n\t}\r\n\r\n\tpublic async hide(duration?: number): Promise<any> {\r\n\t\treturn Promise.all([\r\n\t\t\tsuper.hide(duration),\r\n\t\t\tthis.panel.hide(duration)\r\n\t\t]);\r\n\t}\r\n\r\n\tpublic async show(duration?: number): Promise<any> {\r\n\t\treturn Promise.all([\r\n\t\t\tsuper.show(duration),\r\n\t\t\tthis.panel.show(duration)\r\n\t\t]);\r\n\t}\r\n\r\n\tprotected abstract _createSeries(): XYSeries;\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { IValueAxisDataItem } from \"../../xy/axes/ValueAxis\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries, ILineSeriesAxisRange } from \"../../xy/series/LineSeries\";\r\nimport { Button } from \"../../../core/render/Button\";\r\nimport { Graphics } from \"../../../core/render/Graphics\";\r\nimport { AxisBullet } from \"../../xy/axes/AxisBullet\";\r\nimport type { AxisRendererY } from \"../../xy/axes/AxisRendererY\";\r\nimport * as $math from \"../../../core/util/Math\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\n\r\nexport interface IOverboughtOversoldSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * A value for \"overbought\" threshold.\r\n\t */\r\n\toverBought?: number;\r\n\r\n\t/**\r\n\t * A value for \"oversold\" threshold.\r\n\t */\r\n\toverSold?: number;\r\n\r\n\t/**\r\n\t * A color for \"overbought\" section.\r\n\t */\r\n\toverBoughtColor?: Color;\r\n\r\n\t/**\r\n\t * A color for \"oversold\" section.\r\n\t */\r\n\toverSoldColor?: Color;\r\n}\r\n\r\nexport interface IOverboughtOversoldPrivate extends IChartIndicatorPrivate { }\r\n\r\nexport interface IOverboughtOversoldEvents extends IChartIndicatorEvents { }\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class OverboughtOversold extends ChartIndicator {\r\n\tpublic static className: string = \"OverboughtOversold\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([OverboughtOversold.className]);\r\n\r\n\tdeclare public _settings: IOverboughtOversoldSettings;\r\n\tdeclare public _privateSettings: IOverboughtOversoldPrivate;\r\n\tdeclare public _events: IOverboughtOversoldEvents;\r\n\r\n\tpublic overBought!: DataItem<IValueAxisDataItem>;\r\n\tpublic middle!: DataItem<IValueAxisDataItem>;\r\n\tpublic overSold!: DataItem<IValueAxisDataItem>;\r\n\r\n\tpublic overSoldRange!: ILineSeriesAxisRange;\r\n\tpublic overBoughtRange!: ILineSeriesAxisRange;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"overBought\",\r\n\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"overBoughtColor\",\r\n\t\tname: this.root.language.translateAny(\"Overbought\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"overSold\",\r\n\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"overSoldColor\",\r\n\t\tname: this.root.language.translateAny(\"Oversold\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._themeTags.push(\"overboughtoversold\");\r\n\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst chart = this.panel;\r\n\t\tconst yAxis = this.yAxis;\r\n\t\tyAxis.setAll({ strictMinMax: true, autoZoom: false });\r\n\r\n\t\t// middle grid\r\n\t\tthis.middle = this.yAxis.createAxisRange(this.yAxis.makeDataItem({}));\r\n\t\tconst middleGrid = this.middle.get(\"grid\")!;\r\n\t\tmiddleGrid.setAll({ themeTags: [\"middlegrid\"] });\r\n\t\tmiddleGrid._applyThemes();\r\n\r\n\t\tconst middleLabel = this.middle.get(\"label\")!;\r\n\t\tmiddleLabel.setAll({ visible: true, forceHidden: false });\r\n\r\n\t\tconst opposite = (yAxis.get(\"renderer\") as AxisRendererY).get(\"opposite\");\r\n\t\tlet side = \"left\";\r\n\t\tif (opposite) {\r\n\t\t\tside = \"right\"\r\n\t\t}\r\n\r\n\t\t// overbought range\r\n\t\tconst overBought = yAxis.makeDataItem({});\r\n\t\tthis.overBought = overBought;\r\n\t\toverBought.set(\"endValue\", 500);\r\n\r\n\t\tconst overBoughtRB = Button.new(this._root, {\r\n\t\t\tthemeTags: [\"rangegrip\", \"vertical\", side],\r\n\t\t\ticon: Graphics.new(this._root, {\r\n\t\t\t\tthemeTags: [\"rangegrip\", \"icon\"]\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\t// restrict from being dragged vertically\r\n\t\toverBoughtRB.adapters.add(\"x\", function() {\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\t// restrict from being dragged outside of plot\r\n\t\toverBoughtRB.adapters.add(\"y\", function(y) {\r\n\t\t\tif ($type.isNumber(y)) {\r\n\t\t\t\treturn $math.fitToRange(y, 0, chart.plotContainer.height());\r\n\t\t\t}\r\n\t\t\treturn y;\r\n\t\t});\r\n\r\n\t\t// change range when y changes\r\n\t\toverBoughtRB.events.on(\"dragged\", () => {\r\n\t\t\tthis._updateRange(overBoughtRB, \"overBought\");\r\n\t\t});\r\n\r\n\t\toverBought.set(\"bullet\", AxisBullet.new(this._root, {\r\n\t\t\tlocation: 0,\r\n\t\t\tsprite: overBoughtRB\r\n\t\t}))\r\n\r\n\t\tconst overBoughtRange = this.series.createAxisRange(overBought);\r\n\t\tthis.overBoughtRange = overBoughtRange;\r\n\t\tconst overBoughtFills = overBoughtRange.fills;\r\n\t\tif (overBoughtFills) {\r\n\t\t\toverBoughtFills.template.set(\"themeTags\", [\"overbought\", \"fill\"]);\r\n\t\t}\r\n\r\n\t\tconst overBoughtGrid = overBought.get(\"grid\")!;\r\n\t\toverBoughtGrid.setAll({ themeTags: [\"overbought\"], visible: true });\r\n\t\toverBoughtGrid._applyThemes();\r\n\r\n\t\tconst overBoughtLabel = overBought.get(\"label\")!;\r\n\t\toverBoughtLabel.setAll({ visible: true, forceHidden: false, location: 0 });\r\n\r\n\t\t// oversold range\r\n\t\tconst overSold = yAxis.makeDataItem({});\r\n\t\tthis.overSold = overSold;\r\n\t\toverSold.set(\"endValue\", -500);\r\n\r\n\t\tconst overSoldRB = Button.new(this._root, {\r\n\t\t\tthemeTags: [\"rangegrip\", \"vertical\", side],\r\n\t\t\ticon: Graphics.new(this._root, {\r\n\t\t\t\tthemeTags: [\"rangegrip\", \"icon\"]\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\t// restrict from being dragged vertically\r\n\t\toverSoldRB.adapters.add(\"x\", function() {\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\t// restrict from being dragged outside of plot\r\n\t\toverSoldRB.adapters.add(\"y\", function(y) {\r\n\t\t\tif ($type.isNumber(y)) {\r\n\t\t\t\treturn $math.fitToRange(y, 0, chart.plotContainer.height());\r\n\t\t\t}\r\n\t\t\treturn y;\r\n\t\t});\r\n\r\n\t\t// change range when y changes\r\n\t\toverSoldRB.events.on(\"dragged\", () => {\r\n\t\t\tthis._updateRange(overSoldRB, \"overSold\");\r\n\t\t});\r\n\r\n\t\toverSold.set(\"bullet\", AxisBullet.new(this._root, {\r\n\t\t\tlocation: 0,\r\n\t\t\tsprite: overSoldRB\r\n\t\t}))\r\n\r\n\r\n\t\tconst overSoldRange = this.series.createAxisRange(overSold);\r\n\t\tthis.overSoldRange = overSoldRange;\r\n\t\tconst overSoldFills = overSoldRange.fills;\r\n\t\tif (overSoldFills) {\r\n\t\t\toverSoldFills.template.set(\"themeTags\", [\"oversold\", \"fill\"]);\r\n\t\t}\r\n\r\n\t\tconst overSoldGrid = overSold.get(\"grid\")!;\r\n\t\toverSoldGrid.setAll({ themeTags: [\"oversold\"], visible: true });\r\n\t\toverSoldGrid._applyThemes();\r\n\r\n\t\tconst overSoldLabel = overSold.get(\"label\")!;\r\n\t\toverSoldLabel.setAll({ visible: true, forceHidden: false, location: 0 });\r\n\t}\r\n\r\n\tprotected _updateRange(button: Button, key: \"overBought\" | \"overSold\") {\r\n\t\tconst chart = this.yAxis.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst position = this.yAxis.toAxisPosition(button.y() / chart.plotContainer.height());\r\n\t\t\tthis.set(key, Math.round(this.yAxis.positionToValue(position)));\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"valueS\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tsuper._prepareChildren();\r\n\r\n\t\tconst overBoughtLabel = this.overBought.get(\"label\")!;\r\n\t\tconst overSoldLabel = this.overSold.get(\"label\")!;\r\n\t\tconst middleLabel = this.middle.get(\"label\")!;\r\n\r\n\t\tif (this.isDirty(\"overBought\") || this.isDirty(\"overSold\")) {\r\n\t\t\tconst numberFormatter = this.getNumberFormatter();\r\n\r\n\t\t\tconst overSoldValue = this.get(\"overSold\", 0);\r\n\t\t\tconst overBoughtValue = this.get(\"overBought\", 0);\r\n\t\t\tconst middleValue = overSoldValue + (overBoughtValue - overSoldValue) / 2;\r\n\r\n\t\t\toverBoughtLabel.set(\"text\", numberFormatter.format(overBoughtValue));\r\n\t\t\toverSoldLabel.set(\"text\", numberFormatter.format(overSoldValue));\r\n\t\t\tmiddleLabel.set(\"text\", numberFormatter.format(middleValue));\r\n\r\n\t\t\tthis.overBought.set(\"value\", overBoughtValue);\r\n\t\t\tthis.overSold.set(\"value\", overSoldValue);\r\n\r\n\t\t\tthis.middle.set(\"value\", middleValue);\r\n\t\t\tthis.yAxis.set(\"baseValue\", middleValue);\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overSoldColor\")) {\r\n\t\t\tconst color = this.get(\"overSoldColor\");\r\n\t\t\toverSoldLabel.set(\"fill\", color);\r\n\r\n\t\t\tthis.overSold.get(\"grid\")!.set(\"stroke\", color);\r\n\t\t\tthis.overSoldRange.fills!.template.set(\"fill\", color);\r\n\t\t\tthis.overSoldRange.strokes!.template.set(\"stroke\", color);\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"overBoughtColor\")) {\r\n\t\t\tconst color = this.get(\"overBoughtColor\");\r\n\t\t\toverBoughtLabel.set(\"fill\", color);\r\n\r\n\t\t\tthis.overBought.get(\"grid\")!.set(\"stroke\", color);\r\n\t\t\tthis.overBoughtRange.fills!.template.set(\"fill\", color);\r\n\t\t\tthis.overBoughtRange.strokes!.template.set(\"stroke\", color);\r\n\t\t}\r\n\t}\r\n}","import type { DateAxis } from \"../../xy/axes/DateAxis\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\n\r\nimport { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents, IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMovingAverageSettings extends IIndicatorSettings {\r\n\r\n\t/**\r\n\t * Type of the moving average.\r\n\t *\r\n\t * @default \"simple\"\r\n\t */\r\n\ttype?: \"simple\" | \"weighted\" | \"exponential\" | \"dema\" | \"tema\";\r\n\r\n\t/**\r\n\t * Offset.\r\n\t * \r\n\t * @default 0\r\n\t */\r\n\toffset?: number;\r\n\r\n}\r\n\r\nexport interface IMovingAveragePrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IMovingAverageEvents extends IIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MovingAverage extends Indicator {\r\n\tpublic static className: string = \"MovingAverage\";\r\n\tpublic static classNames: Array<string> = Indicator.classNames.concat([MovingAverage.className]);\r\n\r\n\tdeclare public _settings: IMovingAverageSettings;\r\n\tdeclare public _privateSettings: IMovingAveragePrivate;\r\n\tdeclare public _events: IMovingAverageEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"offset\",\r\n\t\tname: this.root.language.translateAny(\"Offset\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}, {\r\n\t\tkey: \"type\",\r\n\t\tname: this.root.language.translateAny(\"Type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t}];\r\n\r\n\tpublic _prepareChildren() {\r\n\r\n\t\tif (this.isDirty(\"type\") || this.isDirty(\"offset\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"type\", this.get(\"type\"));\r\n\t\t\tthis.setCustomData(\"offset\", this.get(\"offset\", 0));\r\n\t\t}\r\n\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst series = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"ma\",\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tthemeTags: [\"indicator\", \"movingaverage\"],\r\n\t\t\t\tname: \"MA\"\r\n\t\t\t}))\r\n\r\n\t\t\tseries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.series = series;\r\n\r\n\t\t\tthis._handleLegend(series);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tlet period = this.get(\"period\", 50);\r\n\t\t\tconst type = this.get(\"type\");\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase \"simple\":\r\n\t\t\t\t\tthis._sma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"weighted\":\r\n\t\t\t\t\tthis._wma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"exponential\":\r\n\t\t\t\t\tthis._ema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dema\":\r\n\t\t\t\t\tthis._dema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tema\":\r\n\t\t\t\t\tthis._tema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tconst offset = this.get(\"offset\", 0);\r\n\r\n\r\n\t\t\tif (offset != 0) {\r\n\t\t\t\tlet i = 0;\r\n\t\t\t\tconst baseDuration = (this.series.get(\"xAxis\") as DateAxis<AxisRenderer>).baseDuration();\r\n\t\t\t\tconst len = dataItems.length;\r\n\t\t\t\tconst firstTime = dataItems[0].get(\"valueX\", 0);\r\n\t\t\t\tconst lastTime = dataItems[len - 1].get(\"valueX\", 0);\r\n\r\n\t\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\t\tlet newX: number = 0;\r\n\r\n\t\t\t\t\tif (i + offset >= len) {\r\n\t\t\t\t\t\tnewX = lastTime + (offset - len + i + 1) * baseDuration;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (i + offset < 0) {\r\n\t\t\t\t\t\tnewX = firstTime + (i + offset) * baseDuration;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tnewX = dataItems[i + offset].get(\"valueX\", 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdataItem.valueX = newX;\r\n\r\n\t\t\t\t\ti++;\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMomentumSettings extends IChartIndicatorSettings {\r\n}\r\n\r\nexport interface IMomentumPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IMomentumEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n * @since 5.4.8\r\n */\r\nexport class Momentum extends ChartIndicator {\r\n\tpublic static className: string = \"Momentum\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([Momentum.className]);\r\n\r\n\tdeclare public _settings: IMomentumSettings;\r\n\tdeclare public _privateSettings: IMomentumPrivate;\r\n\tdeclare public _events: IMomentumEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [\r\n\t\t{\r\n\t\t\tkey: \"period\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"field\",\r\n\t\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}\r\n\t];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"momentum\");\r\n\t\tsuper._afterNew();\r\n\t}\t\t\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"valueY\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst period = this.get(\"period\", 14);\r\n\t\t\tconst data: Array<any> = [];\r\n\r\n\t\t\tlet i = 0;\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tif (i > period) {\r\n\t\t\t\t\tlet value = this._getValue(dataItem);\r\n\t\t\t\t\tlet prevValue = this._getValue(dataItems[i - period]);\r\n\r\n\t\t\t\t\tif (value != undefined && prevValue != undefined) {\r\n\t\t\t\t\t\tdata.push({ valueX: dataItem.get(\"valueX\"), valueY: value - prevValue });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdata.push({ valueX: dataItem.get(\"valueX\") });\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents, IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IVWAPSettings extends IIndicatorSettings {\r\n\r\n}\r\n\r\nexport interface IVWAPPrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IVWAPEvents extends IIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class VWAP extends Indicator {\r\n\tpublic static className: string = \"VWAP\";\r\n\tpublic static classNames: Array<string> = Indicator.classNames.concat([VWAP.className]);\r\n\r\n\tdeclare public _settings: IVWAPSettings;\r\n\tdeclare public _privateSettings: IVWAPPrivate;\r\n\tdeclare public _events: IVWAPEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst series = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"vwap\",\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tthemeTags: [\"indicator\", \"vwap\"],\r\n\t\t\t\tname: \"VWAP\"\r\n\t\t\t}))\r\n\r\n\t\t\tseries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.series = series;\r\n\r\n\t\t\tthis._handleLegend(series);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tlet period = this.get(\"period\", Infinity);\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tif (volumeSeries) {\r\n\t\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\t\tlet i = 0;\r\n\t\t\t\tlet totalVolume = 0;\r\n\t\t\t\tlet totalVW = 0;\r\n\r\n\t\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\tconst volume = volumeDI.get(\"valueY\", 0);\r\n\t\t\t\t\t\tif (volume > 0) {\r\n\t\t\t\t\t\t\tconst vw = dataItem.value_y * volume;\r\n\r\n\t\t\t\t\t\t\tdataItem.vw = vw;\r\n\t\t\t\t\t\t\tdataItem.volume = volume;\r\n\r\n\t\t\t\t\t\t\ttotalVW += vw;\r\n\t\t\t\t\t\t\ttotalVolume += volume;\r\n\r\n\t\t\t\t\t\t\tif (i >= period) {\r\n\t\t\t\t\t\t\t\tlet volumeToRemove = data[i - period].volume;\r\n\t\t\t\t\t\t\t\tlet vwToRemove = data[i - period].vw;\r\n\t\t\t\t\t\t\t\tif (volumeToRemove != null) {\r\n\t\t\t\t\t\t\t\t\ttotalVolume -= volumeToRemove;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (vwToRemove != null) {\r\n\t\t\t\t\t\t\t\t\ttotalVW -= vwToRemove;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tdataItem.totalVW = totalVW;\r\n\t\t\t\t\t\t\tdataItem.vwap = totalVW / totalVolume;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ti++;\r\n\t\t\t\t})\r\n\t\t\t\tthis.series.data.setAll(data);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { MovingAverage, IMovingAverageSettings, IMovingAveragePrivate, IMovingAverageEvents } from \"./MovingAverage\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMovingAverageEnvelopeSettings extends IMovingAverageSettings {\r\n\r\n\t/**\r\n\t * Shift.\r\n\t *\r\n\t * @default 5\r\n\t */\r\n\tshift?: number;\r\n\r\n\t/**\r\n\t * Type of the shift.\r\n\t *\r\n\t * @default \"percent\"\r\n\t */\r\n\tshiftType?: \"percent\" | \"points\";\r\n\r\n\t/**\r\n\t * A color for upper section.\r\n\t */\r\n\tupperColor?: Color;\r\n\r\n\t/**\r\n\t *  A color for lower section.\r\n\t */\r\n\tlowerColor?: Color;\r\n\r\n}\r\n\r\nexport interface IMovingAverageEnvelopePrivate extends IMovingAveragePrivate {\r\n}\r\n\r\nexport interface IMovingAverageEnvelopeEvents extends IMovingAverageEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MovingAverageEnvelope extends MovingAverage {\r\n\tpublic static className: string = \"MovingAverageEnvelope\";\r\n\tpublic static classNames: Array<string> = MovingAverage.classNames.concat([MovingAverageEnvelope.className]);\r\n\r\n\tdeclare public _settings: IMovingAverageEnvelopeSettings;\r\n\tdeclare public _privateSettings: IMovingAverageEnvelopePrivate;\r\n\tdeclare public _events: IMovingAverageEnvelopeEvents;\r\n\r\n\t/**\r\n\t * Indicator series for the upper band.\r\n\t */\r\n\tpublic upperBandSeries!: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the lower band.\r\n\t */\r\n\tpublic lowerBandSeries!: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"type\",\r\n\t\tname: this.root.language.translateAny(\"Type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}, {\r\n\t\tkey: \"shiftType\",\r\n\t\tname: this.root.language.translateAny(\"Shift type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"percent\", \"points\"]\r\n\t}, {\r\n\t\tkey: \"shift\",\r\n\t\tname: this.root.language.translateAny(\"Shift\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"offset\",\r\n\t\tname: this.root.language.translateAny(\"Offset\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"upperColor\",\r\n\t\tname: this.root.language.translateAny(\"Top\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Median\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"lowerColor\",\r\n\t\tname: this.root.language.translateAny(\"Bottom\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst upperBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"upper\",\r\n\t\t\t\topenValueYField: \"lower\",\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\tthemeTags: [\"indicator\", \"movingaverageenvelope\", \"upper\"]\r\n\t\t\t}))\r\n\r\n\t\t\tupperBandSeries.fills.template.set(\"visible\", true);\r\n\t\t\tupperBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\r\n\t\t\tthis.upperBandSeries = upperBandSeries;\r\n\r\n\t\t\tconst lowerBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"lower\",\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\tthemeTags: [\"indicator\", \"movingaverageenvelope\", \"lower\"]\r\n\t\t\t}))\r\n\r\n\t\t\tlowerBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.lowerBandSeries = lowerBandSeries;\r\n\t\t}\r\n\r\n\t\tsuper._afterNew();\r\n\t\tthis.series.addTag(\"movingaverageenvelope\");\r\n\t\tthis.series._applyThemes();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\t\tif (this.isDirty(\"upperColor\")) {\r\n\t\t\tconst color = this.get(\"upperColor\");\r\n\t\t\tconst upperBandSeries = this.upperBandSeries;\r\n\t\t\tupperBandSeries.set(\"stroke\", color);\r\n\t\t\tupperBandSeries.set(\"fill\", color);\r\n\t\t\tupperBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n\t\t\tthis._updateSeriesColor(upperBandSeries, color, \"upperColor\");\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"lowerColor\")) {\r\n\t\t\tconst color = this.get(\"lowerColor\");\r\n\t\t\tconst lowerBandSeries = this.lowerBandSeries;\r\n\t\t\tlowerBandSeries.set(\"stroke\", color);\r\n\t\t\tlowerBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n\t\t\tthis._updateSeriesColor(lowerBandSeries, color, \"lowerColor\");\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"shiftType\") || this.isDirty(\"shift\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"shift\", this.get(\"shift\"));\r\n\t\t\tthis.setCustomData(\"shiftType\", this.get(\"shiftType\"));\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tsuper.prepareData();\r\n\r\n\t\tif (this.series) {\r\n\t\t\tlet smaData = this.series.data.values as any;\r\n\t\t\tlet shift = Number(this.get(\"shift\", 5));\r\n\t\t\tlet shiftType = this.get(\"shiftType\");\r\n\r\n\t\t\t$array.each(smaData, (dataItem: any) => {\r\n\t\t\t\tlet value = dataItem.ma;\r\n\t\t\t\tif (value != null) {\r\n\t\t\t\t\tlet upper = value;\r\n\t\t\t\t\tlet lower = value;\r\n\t\t\t\t\tif (shiftType == \"points\") {\r\n\t\t\t\t\t\tupper += shift;\r\n\t\t\t\t\t\tlower -= shift;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tupper += upper * shift / 100;\r\n\t\t\t\t\t\tlower -= lower * shift / 100;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdataItem.upper = upper;\r\n\t\t\t\t\tdataItem.lower = lower;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.upperBandSeries.data.setAll(smaData);\r\n\t\t\tthis.lowerBandSeries.data.setAll(smaData);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tthis.upperBandSeries.dispose();\r\n\t\tthis.lowerBandSeries.dispose();\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\tpublic async hide(duration?: number): Promise<any> {\r\n\t\treturn Promise.all([\r\n\t\t\tsuper.hide(duration),\r\n\t\t\tthis.upperBandSeries.hide(duration),\r\n\t\t\tthis.lowerBandSeries.hide(duration)\r\n\t\t]);\r\n\t}\r\n\r\n\tpublic async show(duration?: number): Promise<any> {\r\n\t\treturn Promise.all([\r\n\t\t\tsuper.show(duration),\r\n\t\t\tthis.upperBandSeries.show(duration),\r\n\t\t\tthis.lowerBandSeries.show(duration)\r\n\t\t]);\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { Color } from \"../../../core/util/Color\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMovingAverageDeviationSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Increasing color.\r\n\t */\r\n\tincreasingColor?: Color;\r\n\r\n\t/**\r\n\t * Decreasing color.\r\n\t */\r\n\tdecreasingColor?: Color;\r\n\r\n\t/**\r\n\t * Type of the moving average.\r\n\t *\r\n\t * @default \"simple\"\r\n\t */\r\n\ttype?: \"simple\" | \"weighted\" | \"exponential\" | \"dema\" | \"tema\";\r\n\r\n\t/**\r\n\t * How units are calculated.\r\n\t *\r\n\t * @default \"points\"\r\n\t */\r\n\tunit?: \"points\" | \"percent\"\r\n\r\n}\r\n\r\nexport interface IMovingAverageDeviationPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IMovingAverageDeviationEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MovingAverageDeviation extends ChartIndicator {\r\n\tpublic static className: string = \"MovingAverageDeviation\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([MovingAverageDeviation.className]);\r\n\r\n\tdeclare public _settings: IMovingAverageDeviationSettings;\r\n\tdeclare public _privateSettings: IMovingAverageDeviationPrivate;\r\n\tdeclare public _events: IMovingAverageDeviationEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [\r\n\t\t{\r\n\t\t\tkey: \"period\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"field\",\r\n\t\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t\t}, {\r\n\t\t\tkey: \"type\",\r\n\t\t\tname: this.root.language.translateAny(\"Type\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t\t}, {\r\n\t\t\tkey: \"unit\",\r\n\t\t\tname: this.root.language.translateAny(\"Points/Percent\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"points\", \"percent\"]\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"increasingColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Increasing\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"decreasingColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Decreasing\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"movingaveragedeviation\");\r\n\t\tsuper._afterNew();\r\n\t}\t\t\r\n\r\n\tpublic _createSeries(): ColumnSeries {\r\n\t\treturn this.panel.series.push(ColumnSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"deviation\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"increasingColor\") || this.isDirty(\"decreasingColor\")) {\r\n\t\t\tconst template = this.series.columns.template;\r\n\t\t\tconst increasing = this.get(\"increasingColor\");\r\n\t\t\tconst decreasing = this.get(\"decreasingColor\");\r\n\t\t\ttemplate.states.create(\"riseFromPrevious\", { fill: increasing, stroke: increasing });\r\n\t\t\ttemplate.states.create(\"dropFromPrevious\", { fill: decreasing, stroke: decreasing });\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"type\") || this.isDirty(\"unit\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\r\n\t\t\tlet decreasingColor = this.get(\"decreasingColor\", Color.fromHex(0xff0000)).toCSSHex();\r\n\t\t\tlet increasingColor = this.get(\"increasingColor\", Color.fromHex(0x00ff00)).toCSSHex();\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = this.get(\"period\", 50);\r\n\t\t\tconst type = this.get(\"type\");\r\n\t\t\tconst unit = this.get(\"unit\");\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase \"simple\":\r\n\t\t\t\t\tthis._sma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"weighted\":\r\n\t\t\t\t\tthis._wma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"exponential\":\r\n\t\t\t\t\tthis._ema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dema\":\r\n\t\t\t\t\tthis._dema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tema\":\r\n\t\t\t\t\tthis._tema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tlet previous = -Infinity;\r\n\t\t\tlet i = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i >= period) {\r\n\t\t\t\t\tlet deviation = dataItem.value_y - dataItem.ma;\r\n\t\t\t\t\tif (unit == \"percent\") {\r\n\t\t\t\t\t\tdeviation = (dataItem.value_y / dataItem.ma - 1) * 100;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet color = increasingColor;\r\n\r\n\t\t\t\t\tif (deviation < previous) {\r\n\t\t\t\t\t\tcolor = decreasingColor;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdataItem.deviation = deviation;\r\n\t\t\t\t\tdataItem.deviationColor = color;\r\n\t\t\t\t\tprevious = deviation;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents } from \"./Indicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IAccelerationBandsSettings extends IIndicatorSettings {\r\n    /**\r\n     * A color for upper section.\r\n     */\r\n    upperColor?: Color;\r\n\r\n    /**\r\n     * A color for lower section.\r\n     */\r\n    lowerColor?: Color;\r\n\r\n\r\n    factor?: number;\r\n}\r\n\r\nexport interface IAccelerationBandsPrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IAccelerationBandsEvents extends IIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class AccelerationBands extends Indicator {\r\n    public static className: string = \"AccelerationBands\";\r\n    public static classNames: Array<string> = Indicator.classNames.concat([AccelerationBands.className]);\r\n\r\n    declare public _settings: IAccelerationBandsSettings;\r\n    declare public _privateSettings: IAccelerationBandsPrivate;\r\n    declare public _events: IAccelerationBandsEvents;\r\n\r\n    /**\r\n     * Indicator series for the upper band.\r\n     */\r\n    public upperBandSeries!: LineSeries;\r\n\r\n    /**\r\n     * Indicator series for the lower band.\r\n     */\r\n    public lowerBandSeries!: LineSeries;\r\n\r\n    public _editableSettings: IIndicatorEditableSetting[] = [{\r\n        key: \"period\",\r\n        name: this.root.language.translateAny(\"Period\"),\r\n        type: \"number\"\r\n    }, {\r\n        key: \"factor\",\r\n        name: this.root.language.translateAny(\"Factor\"),\r\n        type: \"number\"\r\n    }, {\r\n        key: \"upperColor\",\r\n        name: this.root.language.translateAny(\"Upper\"),\r\n        type: \"color\"\r\n    }, {\r\n        key: \"seriesColor\",\r\n        name: this.root.language.translateAny(\"Average\"),\r\n        type: \"color\"\r\n    }, {\r\n        key: \"lowerColor\",\r\n        name: this.root.language.translateAny(\"Lower\"),\r\n        type: \"color\"\r\n    }];\r\n\r\n    protected _afterNew() {\r\n\r\n        const stockSeries = this.get(\"stockSeries\");\r\n        const chart = stockSeries.chart;\r\n\r\n        if (chart) {\r\n\r\n            const series = chart.series.push(LineSeries.new(this._root, {\r\n                valueXField: \"valueX\",\r\n                valueYField: \"average\",\r\n                groupDataDisabled: true,\r\n                calculateAggregates: true,\r\n                xAxis: stockSeries.get(\"xAxis\"),\r\n                yAxis: stockSeries.get(\"yAxis\"),\r\n                themeTags: [\"indicator\", \"accelerationbands\", \"average\"]\r\n            }))\r\n\r\n            series.setPrivate(\"baseValueSeries\", stockSeries);\r\n            this.series = series;\r\n\r\n            const upperBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n                valueXField: \"valueX\",\r\n                valueYField: \"upper\",\r\n                openValueYField: \"lower\",\r\n                calculateAggregates: true,\r\n                xAxis: stockSeries.get(\"xAxis\"),\r\n                yAxis: stockSeries.get(\"yAxis\"),\r\n                groupDataDisabled: true,\r\n                themeTags: [\"indicator\", \"accelerationbands\", \"upper\"]\r\n            }))\r\n\r\n            upperBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\r\n            this.upperBandSeries = upperBandSeries;\r\n\r\n            const lowerBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n                valueXField: \"valueX\",\r\n                valueYField: \"lower\",\r\n                calculateAggregates: true,\r\n                xAxis: stockSeries.get(\"xAxis\"),\r\n                yAxis: stockSeries.get(\"yAxis\"),\r\n                groupDataDisabled: true,\r\n                themeTags: [\"indicator\", \"accelerationbands\", \"lower\"]\r\n            }))\r\n\r\n            lowerBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n            this.lowerBandSeries = lowerBandSeries;\r\n        }\r\n\r\n        this._handleLegend(this.series);\r\n\r\n        super._afterNew();\r\n        this.series.addTag(\"accelerationbands\");\r\n        this.series._applyThemes();\r\n    }\r\n\r\n    public _prepareChildren() {\r\n\r\n        if (this.isDirty(\"factor\")) {\r\n            this.markDataDirty();\r\n            this.setCustomData(\"factor\", this.get(\"factor\"));\r\n        }\r\n\r\n        super._prepareChildren();\r\n    }\r\n\r\n    public _updateChildren() {\r\n        super._updateChildren();\r\n        const upperColor = \"upperColor\";\r\n        if (this.isDirty(upperColor)) {\r\n            const color = this.get(upperColor);\r\n            const upperBandSeries = this.upperBandSeries;\r\n            upperBandSeries.set(\"stroke\", color);\r\n            upperBandSeries.set(\"fill\", color);\r\n            upperBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n            this._updateSeriesColor(upperBandSeries, color, upperColor);\r\n        }\r\n\r\n        const lowerColor = \"lowerColor\";\r\n        if (this.isDirty(lowerColor)) {\r\n            const color = this.get(lowerColor);\r\n            const lowerBandSeries = this.lowerBandSeries;\r\n            lowerBandSeries.set(\"stroke\", color);\r\n            lowerBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n            this._updateSeriesColor(lowerBandSeries, color, lowerColor);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public prepareData() {\r\n        super.prepareData();\r\n\r\n        if (this.series) {\r\n\r\n            let period = this.get(\"period\", 20);\r\n\r\n            const stockSeries = this.get(\"stockSeries\");\r\n            const dataItems = stockSeries.dataItems;\r\n\r\n            let data = this._getDataArray(dataItems);\r\n            let factor = this.get(\"factor\", 0.001);\r\n\r\n            let i = 0;\r\n\r\n            $array.each(data, (dataItem: any) => {\r\n                let stockDataItem = dataItems[i];\r\n\r\n                if (stockDataItem) {\r\n                    let low = stockDataItem.get(\"lowValueY\");\r\n                    let high = stockDataItem.get(\"highValueY\");\r\n\r\n                    if ($type.isNumber(low) && $type.isNumber(high) && high + low != 0) {\r\n                        dataItem._lower = (high * (1 + 2 * ((((high - low) / ((high + low) / 2)) * 1000) * factor)));\r\n                        dataItem._upper = (low * (1 - 2 * ((((high - low) / ((high + low) / 2)) * 1000) * factor)));\r\n                        dataItem._average = dataItem._lower + (dataItem._upper - dataItem._lower) / 2;\r\n                    }\r\n                }\r\n                i++;\r\n            })\r\n\r\n            this._sma(data, period, \"_lower\", \"lower\");\r\n            this._sma(data, period, \"_upper\", \"upper\");\r\n            this._sma(data, period, \"_average\", \"average\");\r\n\r\n            this.upperBandSeries.data.setAll(data);\r\n            this.lowerBandSeries.data.setAll(data);\r\n            this.series.data.setAll(data);\r\n        }\r\n    }\r\n\r\n    protected _dispose() {\r\n        this.upperBandSeries.dispose();\r\n        this.lowerBandSeries.dispose();\r\n        super._dispose();\r\n    }\r\n\r\n    public async hide(duration?: number): Promise<any> {\r\n        return Promise.all([\r\n            super.hide(duration),\r\n            this.upperBandSeries.hide(duration),\r\n            this.lowerBandSeries.hide(duration)\r\n        ]);\r\n    }\r\n\r\n    public async show(duration?: number): Promise<any> {\r\n        return Promise.all([\r\n            super.show(duration),\r\n            this.upperBandSeries.show(duration),\r\n            this.lowerBandSeries.show(duration)\r\n        ]);\r\n    }\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { MovingAverage, IMovingAverageSettings, IMovingAveragePrivate, IMovingAverageEvents } from \"./MovingAverage\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IBollingerBandsSettings extends IMovingAverageSettings {\r\n\r\n\t/**\r\n\t * A value of standard deviations.\r\n\t */\r\n\tstandardDeviations?: number;\r\n\r\n\t/**\r\n\t * A color for upper section.\r\n\t */\r\n\tupperColor?: Color;\r\n\r\n\t/**\r\n\t * A color for lower section.\r\n\t */\r\n\tlowerColor?: Color;\r\n\r\n}\r\n\r\nexport interface IBollingerBandsPrivate extends IMovingAveragePrivate {\r\n}\r\n\r\nexport interface IBollingerBandsEvents extends IMovingAverageEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class BollingerBands extends MovingAverage {\r\n\tpublic static className: string = \"BollingerBands\";\r\n\tpublic static classNames: Array<string> = MovingAverage.classNames.concat([BollingerBands.className]);\r\n\r\n\tdeclare public _settings: IBollingerBandsSettings;\r\n\tdeclare public _privateSettings: IBollingerBandsPrivate;\r\n\tdeclare public _events: IBollingerBandsEvents;\r\n\r\n\t/**\r\n\t * Indicator series for the upper band.\r\n\t */\r\n\tpublic upperBandSeries!: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the lower band.\r\n\t */\r\n\tpublic lowerBandSeries!: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"standardDeviations\",\r\n\t\tname: this.root.language.translateAny(\"Deviation\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"upperColor\",\r\n\t\tname: this.root.language.translateAny(\"Upper\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Average\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"lowerColor\",\r\n\t\tname: this.root.language.translateAny(\"Lower\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}, {\r\n\t\tkey: \"type\",\r\n\t\tname: this.root.language.translateAny(\"Type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t}];\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst upperBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"upper\",\r\n\t\t\t\topenValueYField: \"lower\",\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"indicator\", \"bollingerbands\", \"upper\"]\r\n\t\t\t}))\r\n\r\n\t\t\tupperBandSeries.fills.template.set(\"visible\", true);\r\n\t\t\tupperBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\r\n\t\t\tthis.upperBandSeries = upperBandSeries;\r\n\r\n\t\t\tconst lowerBandSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"lower\",\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"indicator\", \"bollingerbands\", \"lower\"]\r\n\t\t\t}))\r\n\r\n\t\t\tlowerBandSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.lowerBandSeries = lowerBandSeries;\r\n\t\t}\r\n\r\n\t\tsuper._afterNew();\r\n\t\tthis.series.addTag(\"bollingerbands\");\r\n\t\tthis.series._applyThemes();\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\r\n\t\tif (this.isDirty(\"standardDeviations\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t}\r\n\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\t\tconst upperColor = \"upperColor\";\r\n\t\tif (this.isDirty(upperColor)) {\r\n\t\t\tconst color = this.get(upperColor);\r\n\t\t\tconst upperBandSeries = this.upperBandSeries;\r\n\t\t\tupperBandSeries.set(\"stroke\", color);\r\n\t\t\tupperBandSeries.set(\"fill\", color);\r\n\t\t\tupperBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n\t\t\tthis._updateSeriesColor(upperBandSeries, color, upperColor);\r\n\t\t}\r\n\r\n\t\tconst lowerColor = \"lowerColor\";\r\n\t\tif (this.isDirty(lowerColor)) {\r\n\t\t\tconst color = this.get(lowerColor);\r\n\t\t\tconst lowerBandSeries = this.lowerBandSeries;\r\n\t\t\tlowerBandSeries.set(\"stroke\", color);\r\n\t\t\tlowerBandSeries.strokes.template.set(\"stroke\", color);\r\n\r\n\t\t\tthis._updateSeriesColor(lowerBandSeries, color, lowerColor);\r\n\t\t}\r\n\r\n\t\tthis.setCustomData(\"standardDeviations\", this.get(\"standardDeviations\"));\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tsuper.prepareData();\r\n\r\n\t\tif (this.series) {\r\n\r\n\t\t\tlet period = this.get(\"period\", 20);\r\n\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet standardDeviations = this.get(\"standardDeviations\", 2);\r\n\r\n\t\t\tlet smaData = this.series.data.values as any;\r\n\r\n\t\t\tlet i = 0;\r\n\r\n\t\t\t$array.each(smaData, (dataItem: any) => {\r\n\t\t\t\tif (i >= period - 1) {\r\n\t\t\t\t\tlet mean = dataItem.ma;\r\n\r\n\t\t\t\t\tlet stdSum = 0;\r\n\t\t\t\t\tfor (let j = i - period + 1; j <= i; j++) {\r\n\t\t\t\t\t\tlet di = dataItems[j];\r\n\t\t\t\t\t\tlet diValue = this._getValue(di);\r\n\t\t\t\t\t\tif (diValue != null) {\r\n\t\t\t\t\t\t\tstdSum += Math.pow(diValue - mean, 2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet std = Math.sqrt(stdSum / period);\r\n\r\n\t\t\t\t\tconst lower = mean - standardDeviations * std;\r\n\t\t\t\t\tconst upper = mean + standardDeviations * std;\r\n\r\n\t\t\t\t\tdataItem.upper = upper;\r\n\t\t\t\t\tdataItem.lower = lower;\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tthis.upperBandSeries.data.setAll(smaData);\r\n\t\t\tthis.lowerBandSeries.data.setAll(smaData);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tthis.upperBandSeries.dispose();\r\n\t\tthis.lowerBandSeries.dispose();\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\tpublic async hide(duration?: number): Promise<any> {\r\n\t\treturn Promise.all([\r\n\t\t\tsuper.hide(duration),\r\n\t\t\tthis.upperBandSeries.hide(duration),\r\n\t\t\tthis.lowerBandSeries.hide(duration)\r\n\t\t]);\r\n\t}\r\n\r\n\tpublic async show(duration?: number): Promise<any> {\r\n\t\treturn Promise.all([\r\n\t\t\tsuper.show(duration),\r\n\t\t\tthis.upperBandSeries.show(duration),\r\n\t\t\tthis.lowerBandSeries.show(duration)\r\n\t\t]);\r\n\t}\r\n}","import { OverboughtOversold, IOverboughtOversoldSettings, IOverboughtOversoldPrivate, IOverboughtOversoldEvents } from \"./OverboughtOversold\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IRelativeStrengthIndexSettings extends IOverboughtOversoldSettings {\r\n\t/**\r\n\t * EMA period.\r\n\t */\r\n\tsmaPeriod?: number;\r\n\r\n\t/**\r\n\t * A color for \"ema\" line.\r\n\t */\r\n\tsmaColor?: Color;\r\n}\r\n\r\nexport interface IRelativeStrengthIndexPrivate extends IOverboughtOversoldPrivate { }\r\n\r\nexport interface IRelativeStrengthIndexEvents extends IOverboughtOversoldEvents { }\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class RelativeStrengthIndex extends OverboughtOversold {\r\n\tpublic static className: string = \"RelativeStrengthIndex\";\r\n\tpublic static classNames: Array<string> = OverboughtOversold.classNames.concat([RelativeStrengthIndex.className]);\r\n\r\n\tdeclare public _settings: IRelativeStrengthIndexSettings;\r\n\tdeclare public _privateSettings: IRelativeStrengthIndexPrivate;\r\n\tdeclare public _events: IRelativeStrengthIndexEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tpublic smaSeries!: LineSeries;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\tthis._themeTags.push(\"rsi\");\r\n\t\tsuper._afterNew();\r\n\t\tthis._editableSettings.unshift({\r\n\t\t\tkey: \"period\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"field\",\r\n\t\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\t\ttype: \"dropdown\",\r\n\t\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t\t}, {\r\n\t\t\tkey: \"smaPeriod\",\r\n\t\t\tname: this.root.language.translateAny(\"SMA period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"smaColor\",\r\n\t\t\tname: this.root.language.translateAny(\"SMA period\"),\r\n\t\t\ttype: \"color\"\r\n\t\t})\r\n\r\n\t\tconst smaSeries = this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"sma\",\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tgroupDataDisabled: true,\r\n\t\t\tthemeTags: [\"indicator\", \"sma\"]\r\n\t\t}))\r\n\r\n\t\tthis.smaSeries = smaSeries;\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\t\tif (this.isDirty(\"smaColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.smaSeries, this.get(\"smaColor\"), \"smaColor\")\r\n\t\t}\r\n\t\tif (this.isDirty(\"smaPeriod\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"smaPeriod\", this.get(\"smaPeriod\"));\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet period = this.get(\"period\", 14);\r\n\t\t\tconst data: Array<any> = [];\r\n\t\t\tlet i = 0;\r\n\t\t\tlet averageGain = 0;\r\n\t\t\tlet averageLoss = 0;\r\n\t\t\tlet prevAverageGain = 0;\r\n\t\t\tlet prevAverageLoss = 0;\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tlet rsi = null;\r\n\t\t\t\ti++;\r\n\t\r\n\t\t\t\tif (i == period + 1) {\r\n\t\t\t\t\tfor (let j = 1; j <= period; j++) {\r\n\t\t\t\t\t\tlet value = this._getValue(dataItems[j]);\r\n\t\t\t\t\t\tlet prevValue = this._getValue(dataItems[j - 1]);\r\n\t\t\t\t\t\tif (value != undefined && prevValue != undefined) {\r\n\t\t\t\t\t\t\tlet change = value - prevValue;\r\n\r\n\t\t\t\t\t\t\tif (change >= 0) {\r\n\t\t\t\t\t\t\t\taverageGain += change / period;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\taverageLoss += Math.abs(change) / period;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trsi = 100 - (100 / (1 + averageGain / averageLoss));\r\n\r\n\t\t\t\t\tif($type.isNaN(rsi)){\r\n\t\t\t\t\t\trsi = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (i > period) {\r\n\t\t\t\t\tlet value = this._getValue(dataItem);\r\n\t\t\t\t\tlet prevValue = this._getValue(dataItems[i - 2]);\r\n\t\t\t\t\tif (value != null && prevValue != null) {\r\n\t\t\t\t\t\tlet change = value - prevValue;\r\n\r\n\t\t\t\t\t\tlet gain = 0;\r\n\t\t\t\t\t\tlet loss = 0;\r\n\r\n\t\t\t\t\t\tif (change > 0) {\r\n\t\t\t\t\t\t\tgain = change;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tloss = -change;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\taverageGain = (prevAverageGain * (period - 1) + gain) / period;\r\n\t\t\t\t\t\taverageLoss = (prevAverageLoss * (period - 1) + loss) / period;\r\n\r\n\t\t\t\t\t\trsi = 100 - (100 / (1 + averageGain / averageLoss));\r\n\r\n\r\n\t\t\t\t\t\tif(isNaN(rsi)){\r\n\t\t\t\t\t\t\trsi = 0;\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdata.push({ valueX: dataItem.get(\"valueX\"), valueS: rsi });\r\n\r\n\t\t\t\tprevAverageGain = averageGain;\r\n\t\t\t\tprevAverageLoss = averageLoss;\r\n\t\t\t})\r\n\t\t\tthis.series.data.setAll(data);\r\n\r\n\t\t\tperiod = this.get(\"smaPeriod\", 3);\r\n\t\t\tthis._sma(data, period, \"valueS\", \"sma\");\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t\tthis.smaSeries.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IAccumulationDistributionSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Main volume series of the [[StockChart]].\r\n\t */\r\n\tvolumeSeries?: XYSeries;\r\n\r\n\t/**\r\n\t * Use volume series (if set)?\r\n\t */\r\n\tuseVolume?: boolean;\r\n\r\n}\r\n\r\nexport interface IAccumulationDistributionPrivate extends IChartIndicatorPrivate {\r\n\r\n}\r\n\r\nexport interface IAccumulationDistributionEvents extends IChartIndicatorEvents {\r\n\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class AccumulationDistribution extends ChartIndicator {\r\n\tpublic static className: string = \"AccumulationDistribution\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([AccumulationDistribution.className]);\r\n\r\n\tdeclare public _settings: IAccumulationDistributionSettings;\r\n\tdeclare public _privateSettings: IAccumulationDistributionPrivate;\r\n\tdeclare public _events: IAccumulationDistributionEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"useVolume\",\r\n\t\tname: this.root.language.translateAny(\"Use Volume\"),\r\n\t\ttype: \"checkbox\"\r\n\t}];\r\n\r\n\tpublic _afterNew() {\r\n\t\tthis._themeTags.push(\"accumulationdistribution\");\r\n\t\tsuper._afterNew();\r\n\t\tthis.yAxis.set(\"numberFormat\", \"#.###a\");\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"ad\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tconst useVolume = \"useVolume\";\r\n\t\tif (this.isDirty(useVolume)) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(useVolume, this.get(useVolume) ? \"Y\" : \"N\");\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet prevAD = 0;\r\n\t\t\tlet useVolume = this.get(\"useVolume\");\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tlet close = dataItem.get(\"valueY\") as number;\r\n\t\t\t\tif (close != null) {\r\n\t\t\t\t\tlet low = dataItem.get(\"lowValueY\", close) as number;\r\n\t\t\t\t\tlet high = dataItem.get(\"highValueY\", close) as number;\r\n\r\n\t\t\t\t\tlet volume = 1;\r\n\t\t\t\t\tif (volumeSeries && useVolume) {\r\n\t\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet mf = ((close - low) - (high - close)) / (high - low)\r\n\t\t\t\t\tif (high == low) {\r\n\t\t\t\t\t\tmf = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet ad = prevAD + mf * volume;\r\n\t\t\t\t\tdata[i].ad = ad;\r\n\r\n\t\t\t\t\tprevAD = ad\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { ILineSeriesAxisRange } from \"../../xy/series/LineSeries\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { IValueAxisDataItem } from \"../../xy/axes/ValueAxis\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport { Color } from \"../../../core/util/Color\";\r\n\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IAccumulativeSwingIndexSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * A \"limit move\" value.\r\n\t */\r\n\tlimitMoveValue?: number;\r\n\r\n\t/**\r\n\t * Positive color.\r\n\t */\r\n\tpositiveColor?: Color;\r\n\r\n\t/**\r\n\t * Negative color.\r\n\t */\r\n\tnegativeColor?: Color;\r\n\r\n}\r\n\r\nexport interface IAccumulativeSwingIndexPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IAccumulativeSwingIndexEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class AccumulativeSwingIndex extends ChartIndicator {\r\n\tpublic static className: string = \"AccumulativeSwingIndex\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([AccumulativeSwingIndex.className]);\r\n\r\n\tdeclare public _settings: IAccumulativeSwingIndexSettings;\r\n\tdeclare public _privateSettings: IAccumulativeSwingIndexPrivate;\r\n\tdeclare public _events: IAccumulativeSwingIndexEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"positiveColor\",\r\n\t\tname: this.root.language.translateAny(\"Positive color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"negativeColor\",\r\n\t\tname: this.root.language.translateAny(\"Negative color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"limitMoveValue\",\r\n\t\tname: this.root.language.translateAny(\"Limit move value\"),\r\n\t\ttype: \"number\"\r\n\t}];\r\n\r\n\tprotected _axisRange?: ILineSeriesAxisRange;\r\n\tprotected _axisRangeDI?: DataItem<IValueAxisDataItem>;\r\n\r\n\tpublic _afterNew() {\r\n\t\tthis._themeTags.push(\"accumulativeswingindex\");\r\n\t\tsuper._afterNew();\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\tconst series = this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"asi\"\r\n\t\t}))\r\n\r\n\t\tconst dataItem = this.yAxis.makeDataItem({})\r\n\t\tthis._axisRangeDI = dataItem;\r\n\t\tdataItem.set(\"value\", 0);\r\n\t\tdataItem.set(\"endValue\", -100);\r\n\t\tthis._axisRange = series.createAxisRange(dataItem);\r\n\r\n\t\tthis.yAxis.onPrivate(\"min\", (min) => {\r\n\t\t\tdataItem.set(\"endValue\", min);\r\n\t\t})\r\n\r\n\t\treturn series;\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tconst limitMoveValue = \"limitMoveValue\";\r\n\t\tif (this.isDirty(limitMoveValue)) {\r\n\t\t\tthis.setCustomData(limitMoveValue, this.get(limitMoveValue));\r\n\t\t\tthis.markDataDirty();\r\n\t\t}\r\n\r\n\t\tconst series = this.series;\r\n\t\tif (this.isDirty(\"positiveColor\")) {\r\n\t\t\tlet color = this.get(\"positiveColor\");\r\n\t\t\tseries.setAll({ fill: color, stroke: color });\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"negativeColor\")) {\r\n\t\t\tlet color = this.get(\"negativeColor\");\r\n\t\t\tlet axisRange = this._axisRange;\r\n\t\t\tif (axisRange) {\r\n\t\t\t\tconst fills = axisRange.fills;\r\n\t\t\t\tif (fills) {\r\n\t\t\t\t\tfills.template.set(\"fill\", color);\r\n\t\t\t\t}\r\n\t\t\t\tconst strokes = axisRange.strokes;\r\n\t\t\t\tif (strokes) {\r\n\t\t\t\t\tstrokes.template.set(\"stroke\", color);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\r\n\t\t\tlet t = this.get(\"limitMoveValue\", 0.5);\r\n\r\n\t\t\tlet asi = 0;\r\n\r\n\t\t\tlet negativeColor = this.get(\"negativeColor\", Color.fromHex(0xff0000)).toCSSHex();\r\n\t\t\tlet positiveColor = this.get(\"positiveColor\", Color.fromHex(0x00ff00)).toCSSHex();\r\n\r\n\t\t\tif (dataItems.length > 2) {\r\n\r\n\t\t\t\tdata[0].asi = 0;\r\n\t\t\t\tdata[0].swingColor = positiveColor;\r\n\r\n\t\t\t\tfor (let i = 1, len = dataItems.length; i < len; i++) {\r\n\t\t\t\t\tconst dataItem = dataItems[i];\r\n\t\t\t\t\tconst yDataItem = dataItems[i - 1];\r\n\r\n\t\t\t\t\tlet c = dataItem.get(\"valueY\");\r\n\t\t\t\t\tif ($type.isNumber(c)) {\r\n\t\t\t\t\t\tlet cy = yDataItem.get(\"valueY\", c);\r\n\r\n\t\t\t\t\t\tlet h = dataItem.get(\"highValueY\", c);\r\n\t\t\t\t\t\tlet l = dataItem.get(\"lowValueY\", c);\r\n\t\t\t\t\t\tlet o = dataItem.get(\"openValueY\", c);\r\n\t\t\t\t\t\tlet oy = yDataItem.get(\"openValueY\", c);\r\n\r\n\t\t\t\t\t\tlet hl = h - l;\r\n\t\t\t\t\t\tlet hc = Math.abs(h - cy);\r\n\t\t\t\t\t\tlet lc = Math.abs(l - cy);\r\n\t\t\t\t\t\tlet tr = Math.max(hc, lc, hl);\r\n\r\n\t\t\t\t\t\tlet er = 0;\r\n\t\t\t\t\t\tif (cy > h) {\r\n\t\t\t\t\t\t\ter = hc;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cy < l) {\r\n\t\t\t\t\t\t\ter = lc;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet k = Math.max(hc, lc);\r\n\r\n\t\t\t\t\t\tlet sh = Math.abs(cy - oy);\r\n\r\n\t\t\t\t\t\tlet r = tr - er / 2 + sh / 4;\r\n\r\n\t\t\t\t\t\tlet dasi = 50 * (c - cy + (c - o) / 2 + (cy - oy) / 4) / r * k / t;\r\n\r\n\t\t\t\t\t\tif ($type.isNumber(dasi)) {\r\n\t\t\t\t\t\t\tasi += dasi;\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\tlet color = positiveColor;\r\n\t\t\t\t\t\tif (asi < 0) {\r\n\t\t\t\t\t\t\tcolor = negativeColor;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdata[i].asi = asi;\r\n\t\t\t\t\t\tdata[i].swingColor = color;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { Color } from \"../../../core/util/Color\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IAroonSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Color for ups.\r\n\t */\r\n\tupColor?: Color;\r\n\r\n\t/**\r\n\t * Color for downs.\r\n\t */\r\n\tdownColor?: Color;\r\n\r\n}\r\n\r\nexport interface IAroonPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IAroonEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class Aroon extends ChartIndicator {\r\n\tpublic static className: string = \"Aroon\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([Aroon.className]);\r\n\r\n\tdeclare public _settings: IAroonSettings;\r\n\tdeclare public _privateSettings: IAroonPrivate;\r\n\tdeclare public _events: IAroonEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for downs.\r\n\t */\r\n\tdeclare public downSeries: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"upColor\",\r\n\t\tname: this.root.language.translateAny(\"Aroon up\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"downColor\",\r\n\t\tname: this.root.language.translateAny(\"Aroon down\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"up\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._themeTags.push(\"aroon\");\r\n\t\tsuper._afterNew();\r\n\t\tthis.downSeries = this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"down\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\r\n\t\tthis.yAxis.setAll({ min: -1, max: 101, strictMinMax: true, numberFormat: \"#'%'\" });\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tconst upColor  = \"upColor\";\r\n\t\tif (this.isDirty(upColor)) {\r\n\t\t\tlet color = this.get(upColor, Color.fromHex(0x00ff00));\r\n\t\t\tthis._updateSeriesColor(this.series, color);\r\n\t\t\tthis.setCustomData(upColor, color);\r\n\t\t}\r\n\r\n\t\tconst downColor = \"downColor\";\r\n\t\tif (this.isDirty(downColor)) {\r\n\t\t\tlet color = this.get(downColor, Color.fromHex(0xff0000));\r\n\t\t\tthis._updateSeriesColor(this.downSeries, color);\r\n\t\t\tthis.setCustomData(downColor, color);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tthis.set(\"field\", \"close\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = this.get(\"period\", 14);\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet b = Math.max(0, i - period);\r\n\t\t\t\tlet h = -Infinity;\r\n\t\t\t\tlet l = Infinity;\r\n\r\n\t\t\t\tlet li = 0;\r\n\t\t\t\tlet hi = 0;\r\n\r\n\t\t\t\tfor (let j = b; j <= i; j++) {\r\n\t\t\t\t\tlet vh = dataItems[j].get(\"highValueY\", 0);\r\n\t\t\t\t\tif (vh >= h) {\r\n\t\t\t\t\t\th = vh;\r\n\t\t\t\t\t\thi = j;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet vl = dataItems[j].get(\"lowValueY\", 0);\r\n\t\t\t\t\tif (vl <= l) {\r\n\t\t\t\t\t\tl = vl;\r\n\t\t\t\t\t\tli = j;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdataItem.up = (period - (i - hi)) / period * 100;\r\n\t\t\t\tdataItem.down = (period - (i - li)) / period * 100;\r\n\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t\tthis.downSeries.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { color, Color } from \"../../../core/util/Color\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMACDSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Increasing color.\r\n\t */\r\n\tincreasingColor?: Color;\r\n\r\n\t/**\r\n\t * Decreasing color.\r\n\t */\r\n\tdecreasingColor?: Color;\r\n\r\n\t/**\r\n\t * Signal color.\r\n\t */\r\n\tsignalColor?: Color;\r\n\r\n\t/**\r\n\t * A value for \"fast\" period.\r\n\t */\r\n\tfastPeriod?: number;\r\n\r\n\t/**\r\n\t * A value for \"slow\" period.\r\n\t */\r\n\tslowPeriod?: number;\r\n\r\n\t/**\r\n\t * A value for \"signal\" period.\r\n\t */\r\n\tsignalPeriod?: number;\r\n\r\n}\r\n\r\nexport interface IMACDPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IMACDEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MACD extends ChartIndicator {\r\n\tpublic static className: string = \"MACD\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([MACD.className]);\r\n\r\n\tdeclare public _settings: IMACDSettings;\r\n\tdeclare public _privateSettings: IMACDPrivate;\r\n\tdeclare public _events: IMACDEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the signal.\r\n\t */\r\n\tpublic signalSeries!: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the difference.\r\n\t */\r\n\tpublic differenceSeries!: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"fastPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Fast MA period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"slowPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Slow MA period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"signalPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Signal period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"MACD\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"signalColor\",\r\n\t\tname: this.root.language.translateAny(\"Signal\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"increasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Increasing\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"decreasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Decreasing\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"macd\",\r\n\t\t\tgroupDataDisabled: true,\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._themeTags.push(\"macd\");\r\n\r\n\t\tsuper._afterNew();\t\t\r\n\r\n\t\tconst chart = this.panel;\r\n\r\n\t\tif (chart) {\r\n\r\n\t\t\tconst signalSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"signal\",\r\n\t\t\t\txAxis: this.xAxis,\r\n\t\t\t\tyAxis: this.yAxis,\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"indicator\", \"signal\"]\r\n\t\t\t}))\r\n\r\n\t\t\tthis.signalSeries = signalSeries;\r\n\r\n\t\t\tconst differenceSeries = chart.series.push(ColumnSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"difference\",\r\n\t\t\t\txAxis: this.xAxis,\r\n\t\t\t\tyAxis: this.yAxis,\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"indicator\", \"difference\"]\r\n\t\t\t}))\r\n\r\n\t\t\tthis.differenceSeries = differenceSeries;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"fastPeriod\") || this.isDirty(\"slowPeriod\") || this.isDirty(\"signalPeriod\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"fastPeriod\", this.get(\"fastPeriod\"));\r\n\t\t\tthis.setCustomData(\"slowPeriod\", this.get(\"slowPeriod\"));\r\n\t\t\tthis.setCustomData(\"signalPeriod\", this.get(\"signalPeriod\"));\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"increasingColor\") || this.isDirty(\"decreasingColor\")) {\r\n\t\t\tconst template = this.differenceSeries.columns.template;\r\n\t\t\tconst increasing = this.get(\"increasingColor\");\r\n\t\t\tconst decreasing = this.get(\"decreasingColor\");\r\n\t\t\ttemplate.states.create(\"riseFromPrevious\", { fill: increasing, stroke: increasing });\r\n\t\t\ttemplate.states.create(\"dropFromPrevious\", { fill: decreasing, stroke: decreasing });\r\n\t\t\tthis._dataDirty = true;\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"signalColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.signalSeries, this.get(\"signalColor\"), \"signalColor\");\r\n\t\t}\r\n\r\n\t\tconst dataItem = this.series.dataItem;\r\n\t\tif (dataItem) {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext) {\r\n\t\t\t\tdataContext.fastPeriod = this.get(\"fastPeriod\");\r\n\t\t\t\tdataContext.slowPeriod = this.get(\"slowPeriod\");\r\n\t\t\t\tdataContext.signalPeriod = this.get(\"signalPeriod\");\r\n\r\n\t\t\t\tconst seriesColor = this.get(\"seriesColor\");\r\n\t\t\t\tif (seriesColor) {\r\n\t\t\t\t\tdataContext.seriesColor = seriesColor.toCSSHex();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst signalColor = this.get(\"signalColor\");\r\n\t\t\t\tif (signalColor) {\r\n\t\t\t\t\tdataContext.signalColor = signalColor.toCSSHex();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = this.get(\"fastPeriod\", 12);\r\n\r\n\t\t\tthis._ema(data, period, \"value_y\", \"emaFast\");\r\n\r\n\t\t\tperiod = this.get(\"slowPeriod\", 26);\r\n\t\t\tthis._ema(data, period, \"value_y\", \"emaSlow\");\r\n\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet emaFast = dataItem.emaFast;\r\n\t\t\t\tlet emaSlow = dataItem.emaSlow;\r\n\r\n\t\t\t\tif (emaFast != null && emaSlow != null) {\r\n\t\t\t\t\tdataItem.macd = emaFast - emaSlow;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tperiod = this.get(\"signalPeriod\", 9);\r\n\t\t\tthis._ema(data, period, \"macd\", \"signal\");\r\n\r\n\t\t\tconst increasingColor = this.get(\"increasingColor\", color(0x00ff00)).toCSSHex();\r\n\t\t\tconst decreasingColor = this.get(\"decreasingColor\", color(0xff0000)).toCSSHex();\r\n\r\n\t\t\tlet p = -Infinity;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet macd = dataItem.macd\r\n\t\t\t\tlet signal = dataItem.signal;\r\n\t\t\t\tif (macd != null && signal != null) {\r\n\t\t\t\t\tlet difference = macd - signal;\r\n\t\t\t\t\tdataItem.difference = difference;\r\n\r\n\t\t\t\t\tlet color = increasingColor;\r\n\r\n\t\t\t\t\tif (difference < p) {\r\n\t\t\t\t\t\tcolor = decreasingColor;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdataItem.differenceColor = color;\r\n\t\t\t\t\tp = difference;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.differenceSeries.data.setAll(data);\r\n\t\t\tthis.signalSeries.data.setAll(data);\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents, IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\n\r\nexport interface IMACrossSettings extends IIndicatorSettings {\r\n\t/**\r\n\t * A value for \"fast\" period.\r\n\t */\r\n\tfastPeriod?: number;\r\n\r\n\tfastColor?: Color;\r\n}\r\n\r\nexport interface IMACrossPrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IMACrossEvents extends IIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MACross extends Indicator {\r\n\tpublic static className: string = \"MACross\";\r\n\tpublic static classNames: Array<string> = Indicator.classNames.concat([MACross.className]);\r\n\r\n\tdeclare public _settings: IMACrossSettings;\r\n\tdeclare public _privateSettings: IMACrossPrivate;\r\n\tdeclare public _events: IMACrossEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public fastSeries: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Slow period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Slow period\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"fastPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Fast period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"fastColor\",\r\n\t\tname: this.root.language.translateAny(\"Fast period\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _prepareChildren() {\r\n\r\n\t\tif (this.isDirty(\"period\") || this.isDirty(\"fastPeriod\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"fastColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.fastSeries, this.get(\"fastColor\"), \"fastColor\");\r\n\t\t}\r\n\r\n\t\tthis.setCustomData(\"fastPeriod\", this.get(\"fastPeriod\"));\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tthis.fastSeries.dispose();\r\n\t\tsuper._dispose();\r\n\t}\t\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst series = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"ma\",\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tthemeTags: [\"indicator\", \"macross\"],\r\n\t\t\t\tname: \"MA\"\r\n\t\t\t}))\r\n\r\n\t\t\tseries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.series = series;\r\n\r\n\t\t\tconst fastSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"maf\",\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tstroke: this.get(\"fastColor\"),\r\n\t\t\t\tthemeTags: [\"indicator\", \"macross\", \"fast\"]\r\n\t\t\t}))\r\n\r\n\t\t\tfastSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.fastSeries = fastSeries;\r\n\r\n\t\t\tthis._handleLegend(series);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tlet period = this.get(\"period\", 9);\r\n\t\t\tlet fastPeriod = this.get(\"fastPeriod\", 21);\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\tthis._sma(data, period, \"value_y\", \"ma\");\r\n\t\t\tthis._sma(data, fastPeriod, \"value_y\", \"maf\");\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t\tthis.fastSeries.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IChaikinMoneyFlowSettings extends IChartIndicatorSettings {\r\n\t/**\r\n\t * A volume series indicator will be based on, if it reaquires one.\r\n\t */\r\n\tvolumeSeries: XYSeries;\r\n}\r\n\r\nexport interface IChaikinMoneyFlowPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IChaikinMoneyFlowEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class ChaikinMoneyFlow extends ChartIndicator {\r\n\tpublic static className: string = \"ChaikinMoneyFlow\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([ChaikinMoneyFlow.className]);\r\n\r\n\tdeclare public _settings: IChaikinMoneyFlowSettings;\r\n\tdeclare public _privateSettings: IChaikinMoneyFlowPrivate;\r\n\tdeclare public _events: IChaikinMoneyFlowEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _afterNew() {\r\n\t\tthis._themeTags.push(\"chaikinmoneyflow\");\r\n\t\tsuper._afterNew();\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"cmf\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet i = 0;\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tlet close = dataItem.get(\"valueY\") as number;\r\n\t\t\t\tif (close != null) {\r\n\t\t\t\t\tlet low = dataItem.get(\"lowValueY\", close) as number;\r\n\t\t\t\t\tlet high = dataItem.get(\"highValueY\", close) as number;\r\n\r\n\t\t\t\t\tlet volume = 1;\r\n\r\n\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet mf = ((close - low) - (high - close)) / (high - low)\r\n\t\t\t\t\tif (high == low) {\r\n\t\t\t\t\t\tmf = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet mfv = mf * volume;\r\n\t\t\t\t\tdata[i].mfv = mfv;\r\n\t\t\t\t\tdata[i].volume = volume;\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tconst period = this.get(\"period\", 20);\r\n\t\t\ti = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tif (i >= period - 1) {\r\n\t\t\t\t\tlet mfv = 0;\r\n\t\t\t\t\tlet volume = 0;\r\n\r\n\t\t\t\t\tfor (let j = i; j > i - period; j--) {\r\n\t\t\t\t\t\tmfv += data[j].mfv;\r\n\t\t\t\t\t\tvolume += data[j].volume;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (volume != 0) {\r\n\t\t\t\t\t\tdataItem.cmf = mfv / volume;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IChaikinOscillatorSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Main volume series of the [[StockChart]].\r\n\t */\r\n\tvolumeSeries: XYSeries;\r\n\r\n\t/**\r\n\t * Slow period setting.\r\n\t */\r\n\tslowPeriod?: number;\r\n\r\n}\r\n\r\nexport interface IChaikinOscillatorPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IChaikinOscillatorEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class ChaikinOscillator extends ChartIndicator {\r\n\tpublic static className: string = \"ChaikinOscillator\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([ChaikinOscillator.className]);\r\n\r\n\tdeclare public _settings: IChaikinOscillatorSettings;\r\n\tdeclare public _privateSettings: IChaikinOscillatorPrivate;\r\n\tdeclare public _events: IChaikinOscillatorEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Fast period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"slowPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Slow period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"chaikinoscillator\");\r\n\t\tsuper._afterNew();\r\n\t\tthis.yAxis.set(\"numberFormat\", \"#.###a\");\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"cmf\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"slowPeriod\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"slowPeriod\", this.get(\"slowPeriod\"));\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet prevAD = 0;\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tlet close = dataItem.get(\"valueY\") as number;\r\n\t\t\t\tif (close != null) {\r\n\t\t\t\t\tlet low = dataItem.get(\"lowValueY\", close) as number;\r\n\t\t\t\t\tlet high = dataItem.get(\"highValueY\", close) as number;\r\n\r\n\t\t\t\t\tlet volume = 1;\r\n\r\n\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet mf = ((close - low) - (high - close)) / (high - low)\r\n\t\t\t\t\tif (high == low) {\r\n\t\t\t\t\t\tmf = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet ad = prevAD + mf * volume;\r\n\t\t\t\t\tdata[i].ad = ad;\r\n\r\n\t\t\t\t\tprevAD = ad\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\r\n\t\t\tthis._ema(data, this.get(\"slowPeriod\", 10), \"ad\", \"emaSlow\");\r\n\t\t\tthis._ema(data, this.get(\"period\", 3), \"ad\", \"emaFast\");\r\n\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tconst emaSlow = dataItem.emaSlow;\r\n\t\t\t\tconst emaFast = dataItem.emaFast;\r\n\t\t\t\tif (emaSlow != null && emaFast != null) {\r\n\t\t\t\t\tdataItem.cmf = emaFast - emaSlow;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IBullBearPowerSettings extends IChartIndicatorSettings {\r\n}\r\n\r\nexport interface IBullBearPowerPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IBullBearPowerEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class BullBearPower extends ChartIndicator {\r\n    public static className: string = \"BullBearPower\";\r\n    public static classNames: Array<string> = ChartIndicator.classNames.concat([BullBearPower.className]);\r\n\r\n    declare public _settings: IBullBearPowerSettings;\r\n    declare public _privateSettings: IBullBearPowerPrivate;\r\n    declare public _events: IBullBearPowerEvents;\r\n\r\n    /**\r\n     * Indicator series.\r\n     */\r\n    declare public series: LineSeries;\r\n\r\n    public _editableSettings: IIndicatorEditableSetting[] = [{\r\n        key: \"period\",\r\n        name: this.root.language.translateAny(\"Period\"),\r\n        type: \"number\"\r\n    }, {\r\n        key: \"seriesColor\",\r\n        name: this.root.language.translateAny(\"Color\"),\r\n        type: \"color\"\r\n    }];\r\n\r\n    public _afterNew() {\r\n        this._themeTags.push(\"bullbearpower\");\r\n        super._afterNew();\r\n    }\r\n\r\n    public _createSeries(): LineSeries {\r\n        return this.panel.series.push(LineSeries.new(this._root, {\r\n            themeTags: [\"indicator\"],\r\n            xAxis: this.xAxis,\r\n            yAxis: this.yAxis,\r\n            valueXField: \"valueX\",\r\n            valueYField: \"bbp\",\r\n            stroke: this.get(\"seriesColor\"),\r\n            fill: undefined\r\n        }))\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public prepareData() {\r\n        if (this.series) {\r\n\r\n            const dataItems = this.get(\"stockSeries\").dataItems;\r\n            this.setRaw(\"field\", \"close\");\r\n\r\n            let i = 0;\r\n            let data: Array<any> = this._getDataArray(dataItems);\r\n            let period = this.get(\"period\", 3);\r\n\r\n            this._ema(data, period, \"value_y\", \"ema\");\r\n\r\n            $array.each(dataItems, (dataItem) => {\r\n                if (i >= period - 1) {\r\n                    let close = dataItem.get(\"valueY\") as number;\r\n                    if (close != null) {\r\n                        let low = dataItem.get(\"lowValueY\", close) as number;\r\n                        let high = dataItem.get(\"highValueY\", close) as number;\r\n\r\n                        let ema = data[i].ema;\r\n                        data[i].bbp = high - ema + low - ema;\r\n                    }\r\n                }\r\n\r\n                i++;\r\n            })\r\n\r\n            this.series.data.setAll(data);\r\n        }\r\n    }\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nexport interface IOnBalanceVolumeSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Chart's main volume series.\r\n\t */\r\n\tvolumeSeries: XYSeries;\r\n\r\n}\r\n\r\nexport interface IOnBalanceVolumePrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IOnBalanceVolumeEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class OnBalanceVolume extends ChartIndicator {\r\n\tpublic static className: string = \"OnBalanceVolume\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([OnBalanceVolume.className]);\r\n\r\n\tdeclare public _settings: IOnBalanceVolumeSettings;\r\n\tdeclare public _privateSettings: IOnBalanceVolumePrivate;\r\n\tdeclare public _events: IOnBalanceVolumeEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"onbalancevolume\");\r\n\t\tsuper._afterNew();\r\n\t\tthis.yAxis.set(\"numberFormat\", \"#.###a\");\r\n\t}\t\t\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"obv\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet previous = 0;\r\n\t\t\tlet len = data.length;\r\n\r\n\t\t\tif (volumeSeries && len > 1) {\r\n\t\t\t\tlet cy = data[0].value_y as number;\r\n\r\n\t\t\t\tfor (let i = 1; i < len; i++) {\r\n\t\t\t\t\tconst dataItem = data[i];\r\n\r\n\t\t\t\t\tlet c = dataItem.value_y;\r\n\r\n\t\t\t\t\tif (c != null) {\r\n\t\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\t\tlet volume = 0;\r\n\t\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet obv = previous;\r\n\t\t\t\t\t\tif (c > cy) {\r\n\t\t\t\t\t\t\tobv += volume;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (c < cy) {\r\n\t\t\t\t\t\t\tobv -= volume;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdataItem.obv = obv;\r\n\r\n\t\t\t\t\t\tprevious = obv;\r\n\t\t\t\t\t\tcy = c;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IPVTSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Chart's main volume series.\r\n\t */\r\n\tvolumeSeries: XYSeries;\r\n\r\n}\r\n\r\nexport interface IPVTPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IPVTEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class PVT extends ChartIndicator {\r\n\tpublic static className: string = \"PVT\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([PVT.className]);\r\n\r\n\tdeclare public _settings: IPVTSettings;\r\n\tdeclare public _privateSettings: IPVTPrivate;\r\n\tdeclare public _events: IPVTEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _afterNew() {\r\n\t\tthis._themeTags.push(\"pvt\");\r\n\t\tsuper._afterNew();\r\n\t\tthis.yAxis.set(\"numberFormat\", \"#.###a\");\r\n\t}\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"pvt\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\t\t\tlet previous = 0;\r\n\t\t\tlet len = data.length;\r\n\r\n\t\t\t//PVT = [((CurrentClose - PreviousClose) / PreviousClose) x Volume] + PreviousPVT\r\n\r\n\t\t\tif (volumeSeries && len > 1) {\r\n\t\t\t\tlet cy = data[0].value_y as number;\r\n\r\n\t\t\t\tfor (let i = 1; i < len; i++) {\r\n\t\t\t\t\tconst dataItem = data[i];\r\n\r\n\t\t\t\t\tlet c = dataItem.value_y;\r\n\r\n\t\t\t\t\tif (c != null && $type.isNumber(c) && c != 0) {\r\n\t\t\t\t\t\tconst volumeDI = volumeSeries.dataItems[i];\r\n\t\t\t\t\t\tlet volume = 0;\r\n\t\t\t\t\t\tif (volumeDI) {\r\n\t\t\t\t\t\t\tvolume = volumeDI.get(\"valueY\", 1);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet pvt = (((c - cy) / cy) * volume) + previous;\r\n\r\n\t\t\t\t\t\tdataItem.pvt = pvt;\r\n\r\n\t\t\t\t\t\tprevious = pvt;\r\n\t\t\t\t\t\tcy = c;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { OverboughtOversold, IOverboughtOversoldSettings, IOverboughtOversoldPrivate, IOverboughtOversoldEvents } from \"./OverboughtOversold\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IStochasticOscillatorSettings extends IOverboughtOversoldSettings {\r\n\t/**\r\n\t * A color for \"slow\" section.\r\n\t */\r\n\tslowColor?: Color;\r\n\r\n\t/**\r\n\t * Smoothing \"k\" parameter.\r\n\t */\r\n\tkSmoothing?: number;\r\n\r\n\t/**\r\n\t * Smoothing \"d\" parameter.\r\n\t */\r\n\tdSmoothing?: number;\r\n}\r\n\r\nexport interface IStochasticOscillatorPrivate extends IOverboughtOversoldPrivate {\r\n}\r\n\r\nexport interface IStochasticOscillatorEvents extends IOverboughtOversoldEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class StochasticOscillator extends OverboughtOversold {\r\n\tpublic static className: string = \"StochasticOscillator\";\r\n\tpublic static classNames: Array<string> = OverboughtOversold.classNames.concat([StochasticOscillator.className]);\r\n\r\n\tdeclare public _settings: IStochasticOscillatorSettings;\r\n\tdeclare public _privateSettings: IStochasticOscillatorPrivate;\r\n\tdeclare public _events: IStochasticOscillatorEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tpublic slowSeries!: LineSeries;\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._themeTags.push(\"stochastic\");\r\n\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis._editableSettings.unshift(\r\n\t\t\t{\r\n\t\t\t\tkey: \"period\",\r\n\t\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\t\ttype: \"number\"\r\n\t\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"kSmoothing\",\r\n\t\t\tname: this.root.language.translateAny(\"K period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t},{\r\n\t\t\tkey: \"dSmoothing\",\r\n\t\t\tname: this.root.language.translateAny(\"SMA period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t},  {\r\n\t\t\tkey: \"slowColor\",\r\n\t\t\tname: this.root.language.translateAny(\"SMA period\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}\r\n\t\t)\r\n\r\n\t\tthis.yAxis.setAll({ min: 0, max: 100, strictMinMax: true });\r\n\r\n\t\tconst slowSeries = this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"slow\",\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tgroupDataDisabled: true,\r\n\t\t\tthemeTags: [\"indicator\", \"slow\"]\r\n\t\t}))\r\n\r\n\t\tthis.slowSeries = slowSeries;\r\n\t}\r\n\r\n\r\n\tpublic _updateChildren() {\r\n\t\tif (this.isDirty(\"kSmoothing\") || this.isDirty(\"dSmoothing\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"dSmoothing\", this.get(\"dSmoothing\"));\r\n\t\t\tthis.setCustomData(\"kSmoothing\", this.get(\"kSmoothing\"));\r\n\t\t}\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"slowColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.slowSeries, this.get(\"slowColor\"), \"slowColor\")\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet period = this.get(\"period\", 14);\r\n\t\t\tlet data: Array<any> = [];\r\n\t\t\tlet index = 0;\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tconst valueX = dataItem.get(\"valueX\");\r\n\t\t\t\tlet k;\r\n\t\t\t\tif (index >= period - 1) {\r\n\t\t\t\t\tlet value = this._getValue(dataItem);\r\n\r\n\t\t\t\t\tif (value != null) {\r\n\t\t\t\t\t\tlet lp = Infinity;\r\n\t\t\t\t\t\tlet hp = -lp;\r\n\t\t\t\t\t\tfor (let j = index; j > index - period; j--) {\r\n\t\t\t\t\t\t\tlet h = dataItems[j].get(\"highValueY\");\r\n\t\t\t\t\t\t\tlet l = dataItems[j].get(\"lowValueY\");\r\n\r\n\t\t\t\t\t\t\tif (h != null && l != null) {\r\n\t\t\t\t\t\t\t\tif (l < lp) {\r\n\t\t\t\t\t\t\t\t\tlp = l;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (h > hp) {\r\n\t\t\t\t\t\t\t\t\thp = h;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tk = (value - lp) / (hp - lp) * 100;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (k == null || $type.isNaN(k)) {\r\n\t\t\t\t\tdata.push({ valueX: valueX });\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdata.push({ valueX: valueX, value_y: k });\r\n\t\t\t\t}\r\n\t\t\t\tindex++;\r\n\t\t\t})\r\n\r\n\t\t\tperiod = this.get(\"kSmoothing\", 1);\r\n\t\t\tthis._sma(data, period, \"value_y\", \"valueS\");\r\n\r\n\t\t\tperiod = this.get(\"dSmoothing\", 3);\r\n\t\t\tthis._sma(data, period, \"valueS\", \"slow\");\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t\tthis.slowSeries.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { Color } from \"../../../core/util/Color\";\r\n\r\nimport { OverboughtOversold, IOverboughtOversoldSettings, IOverboughtOversoldPrivate, IOverboughtOversoldEvents } from \"./OverboughtOversold\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IStochasticMomentumIndexSettings extends IOverboughtOversoldSettings {\r\n\t/**\r\n\t * A color for \"ema\" line.\r\n\t */\r\n\temaColor?: Color;\r\n\r\n\t/**\r\n\t * K period.\r\n\t */\r\n\tkPeriod?: number;\r\n\r\n\t/**\r\n\t * D period.\r\n\t */\r\n\tdPeriod?: number;\r\n\r\n\t/**\r\n\t * EMA period.\r\n\t */\r\n\temaPeriod?: number;\r\n}\r\n\r\nexport interface IStochasticMomentumIndexPrivate extends IOverboughtOversoldPrivate {\r\n}\r\n\r\nexport interface IStochasticMomentumIndexEvents extends IOverboughtOversoldEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @since 5.5.3\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class StochasticMomentumIndex extends OverboughtOversold {\r\n\tpublic static className: string = \"StochasticMomentumIndex\";\r\n\tpublic static classNames: Array<string> = OverboughtOversold.classNames.concat([StochasticMomentumIndex.className]);\r\n\r\n\tdeclare public _settings: IStochasticMomentumIndexSettings;\r\n\tdeclare public _privateSettings: IStochasticMomentumIndexPrivate;\r\n\tdeclare public _events: IStochasticMomentumIndexEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tpublic emaSeries!: LineSeries;\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._themeTags.push(\"stochasticmomentum\");\r\n\r\n\t\tsuper._afterNew();\r\n\t\tthis._editableSettings.unshift(\r\n\t\t\t{\r\n\t\t\t\tkey: \"period\",\r\n\t\t\t\tname: this.root.language.translateAny(\"K period\"),\r\n\t\t\t\ttype: \"number\"\r\n\t\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"K period\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}, {\r\n\t\t\tkey: \"dPeriod\",\r\n\t\t\tname: this.root.language.translateAny(\"D period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"emaPeriod\",\r\n\t\t\tname: this.root.language.translateAny(\"EMA period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"emaColor\",\r\n\t\t\tname: this.root.language.translateAny(\"EMA period\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}\r\n\t\t);\r\n\r\n\t\tconst emaSeries = this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"ema\",\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tgroupDataDisabled: true,\r\n\t\t\tthemeTags: [\"indicator\", \"ema\"]\r\n\t\t}))\r\n\r\n\t\tthis.emaSeries = emaSeries;\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tif (this.isDirty(\"dPeriod\") || this.isDirty(\"emaPeriod\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"dPeriod\", this.get(\"dPeriod\"));\r\n\t\t\tthis.setCustomData(\"emaPeriod\", this.get(\"emaPeriod\"));\r\n\t\t}\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"emaColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.emaSeries, this.get(\"emaColor\"), \"emaColor\")\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t * https://www.barchart.com/education/technical-indicators/stochastic_momentum_index\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet kPeriod = this.get(\"period\", 10);\r\n\t\t\tlet data: Array<any> = [];\r\n\t\t\tlet index = 0;\r\n\r\n\t\t\t$array.each(dataItems, (dataItem) => {\r\n\t\t\t\tconst valueX = dataItem.get(\"valueX\");\r\n\t\t\t\tlet lp = Infinity;\r\n\t\t\t\tlet hp = -lp;\r\n\t\t\t\tlet hhh;\r\n\t\t\t\tlet dhl;\r\n\r\n\t\t\t\tif (index >= kPeriod - 1) {\r\n\t\t\t\t\tlet value = this._getValue(dataItem);\r\n\r\n\t\t\t\t\tif (value != null) {\r\n\t\t\t\t\t\tfor (let j = index; j > index - kPeriod; j--) {\r\n\t\t\t\t\t\t\tlet h = dataItems[j].get(\"highValueY\");\r\n\t\t\t\t\t\t\tlet l = dataItems[j].get(\"lowValueY\");\r\n\r\n\t\t\t\t\t\t\tif (h != null && l != null) {\r\n\t\t\t\t\t\t\t\tif (l < lp) {\r\n\t\t\t\t\t\t\t\t\tlp = l;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (h > hp) {\r\n\t\t\t\t\t\t\t\t\thp = h;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet c = (hp + lp) / 2;\r\n\t\t\t\t\t\thhh = value - c;\r\n\t\t\t\t\t\tdhl = hp - lp;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (hhh == null || $type.isNaN(hhh) || hhh === 0) {\r\n\t\t\t\t\tdata.push({ valueX: valueX });\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdata.push({ valueX: valueX, hhh: hhh, dhl: dhl });\r\n\t\t\t\t}\r\n\t\t\t\tindex++;\r\n\t\t\t})\r\n\r\n\t\t\tlet dPeriod = this.get(\"dPeriod\", 3);\r\n\t\t\tthis._ema(data, dPeriod, \"hhh\", \"hhh_ema\");\r\n\t\t\tthis._ema(data, dPeriod, \"hhh_ema\", \"hhh_ema2\");\r\n\r\n\t\t\tthis._ema(data, dPeriod, \"dhl\", \"dhl_ema\");\r\n\t\t\tthis._ema(data, dPeriod, \"dhl_ema\", \"dhl_ema2\");\r\n\r\n\t\t\t$array.each(data, (d) => {\r\n\t\t\t\tlet hhh = d.hhh_ema2;\r\n\t\t\t\tlet dhl = d.dhl_ema2;\r\n\r\n\t\t\t\tif (hhh != null && dhl != null) {\r\n\t\t\t\t\td.valueS = d.hhh_ema2 / d.dhl_ema2 * 200;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tlet emaPeriod = this.get(\"emaPeriod\", 3);\r\n\t\t\tthis._sma(data, emaPeriod, \"valueS\", \"ema\");\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t\tthis.emaSeries.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { Color } from \"../../../core/util/Color\";\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IAwesomeOscillatorSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Increasing color.\r\n\t */\r\n\tincreasingColor?: Color;\r\n\r\n\t/**\r\n\t * Decreasing color.\r\n\t */\r\n\tdecreasingColor?: Color;\r\n\r\n}\r\n\r\nexport interface IAwesomeOscillatorPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IAwesomeOscillatorEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class AwesomeOscillator extends ChartIndicator {\r\n\tpublic static className: string = \"AwesomeOscillator\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([AwesomeOscillator.className]);\r\n\r\n\tdeclare public _settings: IAwesomeOscillatorSettings;\r\n\tdeclare public _privateSettings: IAwesomeOscillatorPrivate;\r\n\tdeclare public _events: IAwesomeOscillatorEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"increasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Increasing\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"decreasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Decreasing\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"awesomeoscillator\");\r\n\t\tsuper._afterNew();\r\n\t}\t\r\n\r\n\tpublic _createSeries(): ColumnSeries {\r\n\t\treturn this.panel.series.push(ColumnSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"ao\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tconst increasingColor= \"increasingColor\";\r\n\t\tconst decreasingColor= \"decreasingColor\";\r\n\r\n\t\tif (this.isDirty(increasingColor) || this.isDirty(decreasingColor)) {\r\n\t\t\tconst template = this.series.columns.template;\r\n\t\t\tconst increasing = this.get(increasingColor);\r\n\t\t\tconst decreasing = this.get(decreasingColor);\r\n\t\t\ttemplate.states.create(\"riseFromPrevious\", { fill: increasing, stroke: increasing });\r\n\t\t\ttemplate.states.create(\"dropFromPrevious\", { fill: decreasing, stroke: decreasing });\r\n\t\t\tthis.markDataDirty();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tthis.set(\"field\", \"hl/2\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\r\n\t\t\tlet decreasingColor = this.get(\"decreasingColor\", Color.fromHex(0xff0000)).toCSSHex();\r\n\t\t\tlet increasingColor = this.get(\"increasingColor\", Color.fromHex(0x00ff00)).toCSSHex();\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = 5;\r\n\t\t\tthis._sma(data, 5, \"value_y\", \"sma5\");\r\n\r\n\t\t\tperiod = 34;\r\n\t\t\tthis._sma(data, 34, \"value_y\", \"sma34\");\r\n\r\n\t\t\tlet po = -Infinity;\r\n\t\t\tlet i = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i >= period) {\r\n\t\t\t\t\tlet o = dataItem.sma5 - dataItem.sma34\r\n\t\t\t\t\tlet color = increasingColor;\r\n\r\n\t\t\t\t\tif (o < po) {\r\n\t\t\t\t\t\tcolor = decreasingColor;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdataItem.ao = o;\r\n\t\t\t\t\tdataItem.oscillatorColor = color;\r\n\t\t\t\t\tpo = o;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import { OverboughtOversold, IOverboughtOversoldSettings, IOverboughtOversoldPrivate, IOverboughtOversoldEvents } from \"./OverboughtOversold\";\r\n\r\nexport interface IWilliamsRSettings extends IOverboughtOversoldSettings { }\r\n\r\nexport interface IWilliamsRPrivate extends IOverboughtOversoldPrivate { }\r\n\r\nexport interface IWilliamsREvents extends IOverboughtOversoldEvents { }\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class WilliamsR extends OverboughtOversold {\r\n\tpublic static className: string = \"WilliamsR\";\r\n\tpublic static classNames: Array<string> = OverboughtOversold.classNames.concat([WilliamsR.className]);\r\n\r\n\tdeclare public _settings: IWilliamsRSettings;\r\n\tdeclare public _privateSettings: IWilliamsRPrivate;\r\n\tdeclare public _events: IWilliamsREvents;\r\n\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._themeTags.push(\"williamsr\");\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis._editableSettings.unshift({\r\n\t\t\tkey: \"period\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"number\"\r\n\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"color\"\r\n\t\t});\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tthis.set(\"field\", \"close\");\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\t\t\tlet period = this.get(\"period\", 14);\r\n\r\n\t\t\tfor (let i = 0, len = data.length; i < len; i++) {\r\n\t\t\t\tconst dataItem = data[i];\r\n\r\n\t\t\t\tlet h = -Infinity;\r\n\t\t\t\tlet l = Infinity;\r\n\t\t\t\tlet b = Math.max(0, i - period);\r\n\t\t\t\tfor (let j = b; j <= i; j++) {\r\n\r\n\t\t\t\t\tlet vh = dataItems[j].get(\"highValueY\", 0);\r\n\t\t\t\t\tif (vh >= h) {\r\n\t\t\t\t\t\th = vh;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet vl = dataItems[j].get(\"lowValueY\", 0);\r\n\t\t\t\t\tif (vl <= l) {\r\n\t\t\t\t\t\tl = vl;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (h - l != 0) {\r\n\t\t\t\t\tdataItem.valueS = -100 * (h - dataItem.value_y) / (h - l);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\nimport { Color } from \"../../../core/util/Color\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IVolumeSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * An icreasing color.\r\n\t */\r\n\tincreasingColor?: Color;\r\n\r\n\t/**\r\n\t * A decreasing color.\r\n\t */\r\n\tdecreasingColor?: Color;\r\n\r\n}\r\n\r\nexport interface IVolumePrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IVolumeEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class Volume extends ChartIndicator {\r\n\tpublic static className: string = \"Volume\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([Volume.className]);\r\n\r\n\tdeclare public _settings: IVolumeSettings;\r\n\tdeclare public _privateSettings: IVolumePrivate;\r\n\tdeclare public _events: IVolumeEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"increasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Up volume\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"decreasingColor\",\r\n\t\tname: this.root.language.translateAny(\"Down volume\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"volume\");\r\n\t\tsuper._afterNew();\r\n\t\tthis.yAxis.set(\"numberFormat\", \"#.###a\");\r\n\t}\r\n\r\n\tpublic _createSeries(): ColumnSeries {\r\n\t\treturn this.panel.series.push(ColumnSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"volume\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"increasingColor\") || this.isDirty(\"decreasingColor\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tif (volumeSeries && stockChart) {\r\n\t\t\t\tconst dataItems = volumeSeries.dataItems;\r\n\r\n\t\t\t\tthis.setRaw(\"field\", \"close\");\r\n\r\n\t\t\t\tlet decreasingColor = this.get(\"decreasingColor\", Color.fromHex(0xff0000));\r\n\t\t\t\tlet increasingColor = this.get(\"increasingColor\", Color.fromHex(0x00ff00));\r\n\r\n\t\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\t\tdataItem.volume = dataItem.value_y;\r\n\t\t\t\t})\r\n\t\t\t\tthis.series.data.setAll(data);\r\n\r\n\t\t\t\t$array.each(this.series.dataItems, (dataItem) => {\r\n\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\tdataContext.volumeColor = stockChart.getVolumeColor(dataItem, decreasingColor, increasingColor);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { DateAxis } from \"../../xy/axes/DateAxis\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\nimport type { Graphics } from \"../../../core/render/Graphics\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\n\r\nimport { AxisRendererX } from \"../../xy/axes/AxisRendererX\";\r\nimport { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents, IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { ColumnSeries } from \"../../xy/series/ColumnSeries\";\r\nimport { percent } from \"../../../core/util/Percent\";\r\n\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IVolumeProfileSettings extends IIndicatorSettings {\r\n\t/**\r\n\t * Volume up color.\r\n\t */\r\n\tupColor?: Color;\r\n\r\n\t/**\r\n\t * Volume down color.\r\n\t */\r\n\tdownColor?: Color;\r\n\r\n\t/**\r\n\t * Type of count.\r\n\t */\r\n\tcountType?: \"rows\" | \"ticks\";\r\n\r\n\t/**\r\n\t * Number of rows or number of ticks, depending on the countType.\r\n\t *\r\n\t * @default 24\r\n\t */\r\n\tcount?: number;\r\n\r\n\t/**\r\n\t * Max width of columns in percent (%).\r\n\t * \r\n\t * @default 40\r\n\t */\r\n\taxisWidth?: number;\r\n\r\n\t/**\r\n\t * Specifies what percentage of all volume for the trading session should\r\n\t * be highlighted by Value Area.\r\n\t * \r\n\t * @default 70\r\n\t */\r\n\tvalueArea?: number;\r\n\r\n\t/**\r\n\t * Opacity of columns which fall withing value area.\r\n\t * \r\n\t * @default .7\r\n\t */\r\n\tvalueAreaOpacity?: number;\r\n\r\n\t/**\r\n\t * Chart's main volume series.\r\n\t */\r\n\tvolumeSeries: XYSeries;\r\n}\r\n\r\nexport interface IVolumeProfilePrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IVolumeProfileEvents extends IIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a Volume Profile indicator for a [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n * @since 5.7.0\r\n */\r\nexport class VolumeProfile extends Indicator {\r\n\tpublic static className: string = \"VolumeProfile\";\r\n\tpublic static classNames: Array<string> = Indicator.classNames.concat([VolumeProfile.className]);\r\n\r\n\tdeclare public _settings: IVolumeProfileSettings;\r\n\tdeclare public _privateSettings: IVolumeProfilePrivate;\r\n\tdeclare public _events: IVolumeProfileEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: ColumnSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"countType\",\r\n\t\tname: this.root.language.translateAny(\"Count\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\r\n\t\t\t{ value: \"rows\", text: this.root.language.translateAny(\"number of rows\"), extTarget: \"count\", extTargetValue: 24 , extTargetMinValue: 1 },\r\n\t\t\t{ value: \"ticks\", text: this.root.language.translateAny(\"ticks per row\"), extTarget: \"count\", extTargetValue: 1000, extTargetMinValue: 200 }\r\n\t\t]\r\n\t}, {\r\n\t\tkey: \"count\",\r\n\t\tname: this.root.language.translateAny(\"Count\"),\r\n\t\ttype: \"number\",\r\n\t\tminValue: 1\r\n\t}, {\r\n\t\tkey: \"valueArea\",\r\n\t\tname: this.root.language.translateAny(\"Value Area\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"upColor\",\r\n\t\tname: this.root.language.translateAny(\"Up volume\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"downColor\",\r\n\t\tname: this.root.language.translateAny(\"Down volume\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"axisWidth\",\r\n\t\tname: this.root.language.translateAny(\"Width %\"),\r\n\t\ttype: \"number\"\r\n\t}];\r\n\r\n\tpublic xAxis!: ValueAxis<AxisRendererX>;\r\n\r\n\tpublic upSeries!: ColumnSeries;\r\n\r\n\tprotected _previousColumn?: Graphics;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tif (volumeSeries) {\r\n\t\t\tconst chart = stockSeries.chart;\r\n\t\t\tconst root = this._root;\r\n\r\n\t\t\tif (chart) {\r\n\t\t\t\tconst yAxis = stockSeries.get(\"yAxis\") as any;\r\n\r\n\t\t\t\tconst step = yAxis.getPrivate(\"step\");\r\n\t\t\t\tif (step !== undefined) {\r\n\t\t\t\t\tconst val = yAxis.getPrivate(\"step\") * 50;\r\n\t\t\t\t\t(this._editableSettings as any)[0].options[1].extTargetValue = val;\r\n\t\t\t\t\t(this._editableSettings as any)[0].options[1].extTargetMinValue = val * 0.2;\r\n\t\t\t\t}\r\n\t\t\t\tyAxis.onPrivate(\"step\", (step: number) => {\r\n\t\t\t\t\tconst val = step * 50;\r\n\t\t\t\t\t(this._editableSettings as any)[0].options[1].extTargetValue = val;\r\n\t\t\t\t\t(this._editableSettings as any)[0].options[1].extTargetMinValue = val * 0.2;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst panelXAxis = stockSeries.get(\"xAxis\") as DateAxis<AxisRendererX>;\r\n\r\n\t\t\t\tpanelXAxis.on(\"start\", () => {\r\n\t\t\t\t\tthis.markDataDirty();\r\n\t\t\t\t})\r\n\t\t\t\tpanelXAxis.on(\"end\", () => {\r\n\t\t\t\t\tthis.markDataDirty();\r\n\t\t\t\t})\r\n\r\n\t\t\t\tconst xRenderer = AxisRendererX.new(root, {});\r\n\t\t\t\txRenderer.grid.template.set(\"forceHidden\", true);\r\n\t\t\t\txRenderer.labels.template.set(\"forceHidden\", true);\r\n\r\n\t\t\t\tthis.xAxis = chart.xAxes.push(ValueAxis.new(root, {\r\n\t\t\t\t\tzoomable: false,\r\n\t\t\t\t\tstrictMinMax: true,\r\n\t\t\t\t\tpanX: false,\r\n\t\t\t\t\tpanY: false,\r\n\t\t\t\t\trenderer: xRenderer\r\n\t\t\t\t}));\r\n\r\n\t\t\t\tif (yAxis.get(\"renderer\").get(\"opposite\")) {\r\n\t\t\t\t\txRenderer.set(\"inversed\", true);\r\n\t\t\t\t\tthis.xAxis.setAll({\r\n\t\t\t\t\t\tx: percent(100),\r\n\t\t\t\t\t\tcenterX: percent(100)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.series = chart.series.unshift(ColumnSeries.new(root, {\r\n\t\t\t\t\txAxis: this.xAxis,\r\n\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\tsnapTooltip:false,\r\n\t\t\t\t\tvalueXField: \"down\",\r\n\t\t\t\t\topenValueXField: \"xOpen\",\r\n\t\t\t\t\topenValueYField: \"yOpen\",\r\n\t\t\t\t\tvalueYField: \"y\",\r\n\t\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\t\tthemeTags: [\"indicator\", \"volumeprofile\", \"down\"]\r\n\t\t\t\t}))\r\n\r\n\r\n\t\t\t\tthis.upSeries = chart.series.unshift(ColumnSeries.new(root, {\r\n\t\t\t\t\txAxis: this.xAxis,\r\n\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\tsnapTooltip:false,\r\n\t\t\t\t\tvalueXField: \"total\",\r\n\t\t\t\t\topenValueXField: \"down\",\r\n\t\t\t\t\topenValueYField: \"yOpen\",\r\n\t\t\t\t\tvalueYField: \"y\",\r\n\t\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\t\tthemeTags: [\"indicator\", \"volumeprofile\", \"up\"]\r\n\t\t\t\t}))\r\n\r\n\t\t\t\tthis.upSeries.setPrivate(\"doNotUpdateLegend\", true);\r\n\t\t\t\tthis.series.setPrivate(\"doNotUpdateLegend\", true);\r\n\r\n\t\t\t\tthis.upSeries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\t\tthis.series.setPrivate(\"baseValueSeries\", stockSeries);\r\n\r\n\t\t\t\tthis._handleLegend(this.series);\r\n\r\n\t\t\t\tthis._addInteractivity(this.series);\r\n\t\t\t\tthis._addInteractivity(this.upSeries);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addInteractivity(series: ColumnSeries) {\r\n\t\tseries.columns.template.events.on(\"pointerover\", (e) => {\r\n\t\t\tlet dataItem = e.target.dataItem;\r\n\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tif (dataItem.component == this.upSeries) {\r\n\t\t\t\t\tdataItem = this.series.dataItems[this.upSeries.dataItems.indexOf(dataItem)];\r\n\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\tconst column = dataItem.get(\"graphics\" as any);\r\n\t\t\t\t\t\tif (column) {\r\n\t\t\t\t\t\t\tcolumn.hover();\r\n\t\t\t\t\t\t\tthis._previousColumn = column;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdataItem = this.upSeries.dataItems[this.series.dataItems.indexOf(dataItem)];\r\n\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\tconst column = dataItem.get(\"graphics\" as any);\r\n\t\t\t\t\t\tif (column) {\r\n\t\t\t\t\t\t\tcolumn.hover();\r\n\t\t\t\t\t\t\tthis._previousColumn = column;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.series.updateLegendValue(dataItem);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tseries.columns.template.events.on(\"pointerout\", () => {\r\n\t\t\tthis.series.updateLegendValue(undefined);\r\n\t\t\tif (this._previousColumn) {\r\n\t\t\t\tthis._previousColumn.unhover();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tseries.columns.template.adapters.add(\"fillOpacity\", (fillOpacity, target) => {\r\n\t\t\tconst dataItem = target.dataItem;\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\tif (dataContext) {\r\n\t\t\t\t\tif (dataContext.area) {\r\n\t\t\t\t\t\treturn this.get(\"valueAreaOpacity\", .7);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn fillOpacity;\r\n\t\t})\r\n\t}\r\n\r\n\tpublic _updateChildren(): void {\r\n\t\tif (this.series) {\r\n\t\t\tsuper._updateChildren();\r\n\r\n\t\t\tif (this.isDirty(\"count\") || this.isDirty(\"countType\") || this.isDirty(\"valueArea\")) {\r\n\t\t\t\tthis.markDataDirty();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.isDirty(\"countType\")) {\r\n\t\t\t\tconst countType = this.get(\"countType\");\r\n\t\t\t\tif (countType == \"ticks\") {\r\n\t\t\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\t\t\tconst yAxis = stockSeries.get(\"yAxis\") as any;\r\n\t\t\t\t\tthis._editableSettings[1].minValue = yAxis.getPrivate(\"step\") * 50 * 0.2;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._editableSettings[1].minValue = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.isDirty(\"upColor\")) {\r\n\t\t\t\tconst upColor = this.get(\"upColor\");\r\n\t\t\t\tthis.upSeries.set(\"fill\", upColor);\r\n\t\t\t\tthis.upSeries.set(\"stroke\", upColor);\r\n\r\n\t\t\t\tthis.upSeries.columns.template.setAll({\r\n\t\t\t\t\tfill: upColor,\r\n\t\t\t\t\tstroke: upColor\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.setCustomData(\"upColor\", upColor);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.isDirty(\"downColor\")) {\r\n\t\t\t\tconst downColor = this.get(\"downColor\");\r\n\t\t\t\tthis.series.set(\"fill\", downColor);\r\n\t\t\t\tthis.series.set(\"stroke\", downColor);\r\n\r\n\t\t\t\tthis.series.columns.template.setAll({\r\n\t\t\t\t\tfill: downColor,\r\n\t\t\t\t\tstroke: downColor\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.setCustomData(\"downColor\", downColor);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.isDirty(\"axisWidth\")) {\r\n\t\t\t\tthis.xAxis.set(\"width\", percent(this.get(\"axisWidth\", 40)));\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tconst volumeSeries = this.get(\"volumeSeries\");\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\r\n\t\tif (volumeSeries && this.series) {\r\n\t\t\tlet startIndex = volumeSeries.getPrivate(\"adjustedStartIndex\", volumeSeries.startIndex());\r\n\t\t\tlet endIndex = volumeSeries.endIndex();\r\n\r\n\t\t\tconst count = this.get(\"count\", 20);\r\n\t\t\tconst type = this.get(\"countType\");\r\n\t\t\tlet step = 1;\r\n\r\n\t\t\tlet min = Infinity;\r\n\t\t\tlet max = -Infinity;\r\n\r\n\t\t\tfor (let i = startIndex; i < endIndex; i++) {\r\n\t\t\t\tconst dataItem = stockSeries.dataItems[i];\r\n\t\t\t\tif (dataItem) {\r\n\t\t\t\t\tconst close = dataItem.get(\"valueY\");\r\n\t\t\t\t\tif ($type.isNumber(close)) {\r\n\t\t\t\t\t\tif (close < min) {\r\n\t\t\t\t\t\t\tmin = close;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (close > max) {\r\n\t\t\t\t\t\t\tmax = close;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (min != Infinity) {\r\n\r\n\t\t\t\tlet rows: number;\r\n\t\t\t\tif (type == \"ticks\") {\r\n\t\t\t\t\tstep = count / 100;\r\n\t\t\t\t\tmin = Math.floor(min / step) * step;\r\n\t\t\t\t\tmax = Math.ceil(max / step) * step;\r\n\t\t\t\t\trows = (max - min) / step;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tstep = (max - min) / count;\r\n\t\t\t\t\trows = count;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst rowDataDown: Array<number> = [];\r\n\t\t\t\tconst rowDataUp: Array<number> = [];\r\n\r\n\t\t\t\tfor (let i = 0; i < rows; i++) {\r\n\t\t\t\t\trowDataDown[i] = 0;\r\n\t\t\t\t\trowDataUp[i] = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet previousDataItem;\r\n\t\t\t\tfor (let i = startIndex; i < endIndex; i++) {\r\n\t\t\t\t\tconst dataItem = stockSeries.dataItems[i];\r\n\t\t\t\t\tconst volumeDataItem = volumeSeries.dataItems[i];\r\n\t\t\t\t\tif (dataItem && volumeDataItem) {\r\n\t\t\t\t\t\tconst close = dataItem.get(\"valueY\");\r\n\t\t\t\t\t\tconst volume = volumeDataItem.get(\"valueY\");\r\n\r\n\t\t\t\t\t\tif ($type.isNumber(close) && $type.isNumber(volume)) {\r\n\t\t\t\t\t\t\tlet index = Math.floor((close - min) / step);\r\n\t\t\t\t\t\t\tif (index == count) {\r\n\t\t\t\t\t\t\t\tindex = count - 1;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ($type.isNumber(index)) {\r\n\t\t\t\t\t\t\t\tif (previousDataItem && previousDataItem.get(\"valueY\", close) < close) {\r\n\t\t\t\t\t\t\t\t\trowDataDown[index] += volume;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\trowDataUp[index] += volume;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpreviousDataItem = dataItem;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst dataDown = [];\r\n\t\t\t\tlet sum = 0;\r\n\t\t\t\tfor (let i = 0; i < rows; i++) {\r\n\t\t\t\t\tlet total = rowDataUp[i] + rowDataDown[i];\r\n\t\t\t\t\tsum += total;\r\n\r\n\t\t\t\t\tdataDown.push({\r\n\t\t\t\t\t\tyOpen: min + i * step,\r\n\t\t\t\t\t\ty: min + (i + 1) * step,\r\n\t\t\t\t\t\tup: rowDataUp[i],\r\n\t\t\t\t\t\tdown: rowDataDown[i],\r\n\t\t\t\t\t\ttotal: total,\r\n\t\t\t\t\t\txOpen: 0,\r\n\t\t\t\t\t\tarea: false\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet len = this.series.data.length;\r\n\t\t\t\tif (len && len == dataDown.length) {\r\n\t\t\t\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\t\t\t\tthis.series.data.setIndex(i, dataDown[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.series.data.setAll(dataDown);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst dataUp = [];\r\n\r\n\t\t\t\tlet highest = 0;\r\n\t\t\t\tlet hi = 0;\r\n\r\n\t\t\t\tfor (let i = 0; i < rows; i++) {\r\n\t\t\t\t\tlet total = rowDataUp[i] + rowDataDown[i];\r\n\t\t\t\t\tdataUp.push({\r\n\t\t\t\t\t\tyOpen: min + i * step,\r\n\t\t\t\t\t\ty: min + (i + 1) * step,\r\n\t\t\t\t\t\tup: rowDataUp[i],\r\n\t\t\t\t\t\tdown: rowDataDown[i],\r\n\t\t\t\t\t\ttotal: total,\r\n\t\t\t\t\t\tarea: false\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tif (total > highest) {\r\n\t\t\t\t\t\thighest = total;\r\n\t\t\t\t\t\thi = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet valueArea = sum * this.get(\"valueArea\", 70) / 100;\r\n\t\t\t\tlet area = highest;\r\n\r\n\t\t\t\tlet cd = 1;\r\n\t\t\t\tlet cu = 1;\r\n\t\t\t\tlet dlen = dataUp.length;\r\n\r\n\t\t\t\tdataUp[hi].area = true;\r\n\t\t\t\tdataDown[hi].area = true;\r\n\r\n\t\t\t\t// single row\r\n\t\t\t\twhile (area < valueArea) {\r\n\t\t\t\t\tlet rowAbove1 = hi + cu;\r\n\t\t\t\t\tlet sumAbove = 0\r\n\t\t\t\t\tif (rowAbove1 < dlen) {\r\n\t\t\t\t\t\tsumAbove += dataUp[rowAbove1].total;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet rowBelow1 = hi - cd;\r\n\r\n\t\t\t\t\tlet sumBelow = 0\r\n\t\t\t\t\tif (rowBelow1 >= 0) {\r\n\t\t\t\t\t\tsumBelow += dataUp[rowBelow1].total;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (sumBelow <= sumAbove) {\r\n\t\t\t\t\t\tarea += sumAbove;\r\n\t\t\t\t\t\tif (rowAbove1 < dlen) {\r\n\t\t\t\t\t\t\tdataDown[rowAbove1].area = true;\r\n\t\t\t\t\t\t\tdataUp[rowAbove1].area = true;\r\n\t\t\t\t\t\t\tcu++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tarea += sumBelow;\r\n\t\t\t\t\t\tif (rowBelow1 >= 0) {\r\n\t\t\t\t\t\t\tdataDown[rowBelow1].area = true;\r\n\t\t\t\t\t\t\tdataUp[rowBelow1].area = true;\r\n\t\t\t\t\t\t\tcd++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (sumBelow == 0) {\r\n\t\t\t\t\t\tcd++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (sumAbove == 0) {\r\n\t\t\t\t\t\tcu++;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ((cd > dlen && cu > dlen)) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarea = Math.ceil(area);\r\n\r\n\t\t\t\tlen = this.upSeries.data.length;\r\n\t\t\t\tif (len > 0 && len == dataUp.length) {\r\n\t\t\t\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\t\t\t\tthis.upSeries.data.setIndex(i, dataUp[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.upSeries.data.setAll(dataUp);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.upSeries.data.clear();\r\n\t\t\t\tthis.series.data.clear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.series.columns.each((column) => {\r\n\t\t\tcolumn._markDirtyKey(\"fillOpacity\")\r\n\t\t})\r\n\r\n\t\tthis.upSeries.columns.each((column) => {\r\n\t\t\tcolumn._markDirtyKey(\"fillOpacity\")\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _dispose() {\r\n\t\tsuper._dispose();\r\n\t\tif (this.upSeries) {\r\n\t\t\tthis.upSeries.dispose();\r\n\t\t}\r\n\r\n\t\tif (this.xAxis) {\r\n\t\t\tthis.xAxis.dispose();\r\n\t\t}\r\n\t}\r\n}","import { OverboughtOversold, IOverboughtOversoldSettings, IOverboughtOversoldPrivate, IOverboughtOversoldEvents } from \"./OverboughtOversold\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface ICommodityChannelIndexSettings extends IOverboughtOversoldSettings { }\r\n\r\nexport interface ICommodityChannelIndexPrivate extends IOverboughtOversoldPrivate { }\r\n\r\nexport interface ICommodityChannelIndexEvents extends IOverboughtOversoldEvents { }\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class CommodityChannelIndex extends OverboughtOversold {\r\n\tpublic static className: string = \"CommodityChannelIndex\";\r\n\tpublic static classNames: Array<string> = OverboughtOversold.classNames.concat([CommodityChannelIndex.className]);\r\n\r\n\tdeclare public _settings: ICommodityChannelIndexSettings;\r\n\tdeclare public _privateSettings: ICommodityChannelIndexPrivate;\r\n\tdeclare public _events: ICommodityChannelIndexEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\tthis._themeTags.push(\"commoditychannelindex\")\r\n\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis._editableSettings.unshift(\r\n\t\t\t{\r\n\t\t\t\tkey: \"period\",\r\n\t\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\t\ttype: \"number\"\r\n\t\t\t}, {\r\n\t\t\tkey: \"seriesColor\",\r\n\t\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\t\ttype: \"color\"\r\n\t\t}\r\n\t\t)\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tlet data = this._getTypicalPrice(dataItems);\r\n\t\t\tlet period = this.get(\"period\", 20);\r\n\r\n\t\t\tthis._sma(data, period, \"value_y\", \"sma\");\r\n\r\n\t\t\tfor (let i = 0, len = data.length; i < len; i++) {\r\n\t\t\t\tconst dataItem = data[i];\r\n\t\t\t\tconst value = dataItem.value_y;\r\n\t\t\t\tlet ma = dataItem.sma;\r\n\r\n\t\t\t\tlet meanDeviation = 0;\r\n\t\t\t\tif (i >= period - 1) {\r\n\t\t\t\t\tfor (let j = i; j > i - period; j--) {\r\n\t\t\t\t\t\tlet di = data[j];\r\n\t\t\t\t\t\tmeanDeviation += Math.abs(di.value_y - ma)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmeanDeviation = meanDeviation / period;\r\n\r\n\t\t\t\t\tlet valueS = (value - ma) / (0.015 * meanDeviation);\r\n\t\t\t\t\tif ($type.isNumber(valueS)) {\r\n\t\t\t\t\t\tdataItem.valueS = valueS;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IDisparityIndexSettings extends IChartIndicatorSettings {\r\n\r\n\t/**\r\n\t * Type of the moving average.\r\n\t *\r\n\t * @default \"simple\"\r\n\t */\r\n\tmovingAverageType?: \"simple\" | \"weighted\" | \"exponential\" | \"dema\" | \"tema\";\r\n\r\n}\r\n\r\nexport interface IDisparityIndexPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IDisparityIndexEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class DisparityIndex extends ChartIndicator {\r\n\tpublic static className: string = \"DisparityIndex\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([DisparityIndex.className]);\r\n\r\n\tdeclare public _settings: IDisparityIndexSettings;\r\n\tdeclare public _privateSettings: IDisparityIndexPrivate;\r\n\tdeclare public _events: IDisparityIndexEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}, {\r\n\t\tkey: \"movingAverageType\",\r\n\t\tname: this.root.language.translateAny(\"Moving Average Type\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"simple\", \"weighted\", \"exponential\", \"dema\", \"tema\"]\r\n\t}];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"disparityindex\");\r\n\t\tsuper._afterNew();\r\n\t}\t\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"disparity\",\r\n\t\t\tstroke: this.get(\"seriesColor\"),\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tconst movingAverageType = \"movingAverageType\";\r\n\t\tif (this.isDirty(movingAverageType)) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(movingAverageType, this.get(movingAverageType));\r\n\t\t}\r\n\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\r\n\t\t\tconst dataItems = this.get(\"stockSeries\").dataItems;\r\n\t\t\tconst period = this.get(\"period\", 14);\r\n\t\t\tconst type = this.get(\"movingAverageType\");\r\n\r\n\t\t\tlet data: Array<any> = this._getDataArray(dataItems);\r\n\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase \"simple\":\r\n\t\t\t\t\tthis._sma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"weighted\":\r\n\t\t\t\t\tthis._wma(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"exponential\":\r\n\t\t\t\t\tthis._ema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dema\":\r\n\t\t\t\t\tthis._dema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"tema\":\r\n\t\t\t\t\tthis._tema(data, period, \"value_y\", \"ma\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tconst ma = dataItem.ma;\r\n\t\t\t\tif (ma != null) {\r\n\t\t\t\t\tdataItem.disparity = 100 * (dataItem.value_y - ma) / ma\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IStandardDeviationSettings extends IChartIndicatorSettings {\r\n}\r\n\r\nexport interface IStandardDeviationPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IStandardDeviationEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class StandardDeviation extends ChartIndicator {\r\n\tpublic static className: string = \"StandardDeviation\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([StandardDeviation.className]);\r\n\r\n\tdeclare public _settings: IStandardDeviationSettings;\r\n\tdeclare public _privateSettings: IStandardDeviationPrivate;\r\n\tdeclare public _events: IStandardDeviationEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"field\",\r\n\t\tname: this.root.language.translateAny(\"Field\"),\r\n\t\ttype: \"dropdown\",\r\n\t\toptions: [\"open\", \"close\", \"low\", \"high\", \"hl/2\", \"hlc/3\", \"hlcc/4\", \"ohlc/4\"]\r\n\t}];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"standarddeviation\");\r\n\t\tsuper._afterNew();\r\n\t}\t\t\t\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"deviation\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tsuper.prepareData();\r\n\r\n\t\tif (this.series) {\r\n\r\n\t\t\tlet period = this.get(\"period\", 20);\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\tthis._sma(data, period, \"value_y\", \"ma\");\r\n\r\n\t\t\tlet i = 0;\r\n\r\n\t\t\t$array.each(data, (dataItem: any) => {\r\n\t\t\t\tif (i >= period - 1) {\r\n\t\t\t\t\tlet mean = dataItem.ma;\r\n\r\n\t\t\t\t\tlet stdSum = 0;\r\n\t\t\t\t\tfor (let j = i - period + 1; j <= i; j++) {\r\n\t\t\t\t\t\tlet di = dataItems[j];\r\n\t\t\t\t\t\tlet diValue = this._getValue(di);\r\n\t\t\t\t\t\tif (diValue != null) {\r\n\t\t\t\t\t\t\tstdSum += Math.pow(diValue - mean, 2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet std = Math.sqrt(stdSum / period);\r\n\r\n\t\t\t\t\tdataItem.deviation = std;\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t})\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface ITypicalPriceSettings extends IChartIndicatorSettings {\r\n}\r\n\r\nexport interface ITypicalPricePrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface ITypicalPriceEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class TypicalPrice extends ChartIndicator {\r\n\tpublic static className: string = \"TypicalPrice\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([TypicalPrice.className]);\r\n\r\n\tdeclare public _settings: ITypicalPriceSettings;\r\n\tdeclare public _privateSettings: ITypicalPricePrivate;\r\n\tdeclare public _events: ITypicalPriceEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"typicalprice\");\r\n\t\tsuper._afterNew();\r\n\t}\t\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"typical\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tsuper.prepareData();\r\n\r\n\t\tif (this.series) {\r\n\r\n\t\t\tlet period = this.get(\"period\", 20);\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\tlet index = 0;\r\n\t\t\tlet typical = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet value = dataItem.value_y;\r\n\t\t\t\tif (value != null) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\ttypical += value / period;\r\n\r\n\t\t\t\t\tif (i >= period) {\r\n\t\t\t\t\t\tif (i > period) {\r\n\t\t\t\t\t\t\tlet valueToRemove = data[index - period].value_y;\r\n\t\t\t\t\t\t\tif (valueToRemove != null) {\r\n\t\t\t\t\t\t\t\ttypical -= valueToRemove / period;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdataItem.typical = typical;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tindex++;\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $type from \"../../../core/util/Type\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\n\r\nexport interface ITrixSettings extends IChartIndicatorSettings {\r\n\t/**\r\n\t * Signal color.\r\n\t */\r\n\tsignalColor?: Color;\r\n\r\n\t/**\r\n\t * A value for \"signal\" period.\r\n\t */\r\n\tsignalPeriod?: number;\r\n}\r\n\r\nexport interface ITrixPrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface ITrixEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class Trix extends ChartIndicator {\r\n\tpublic static className: string = \"Trix\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([Trix.className]);\r\n\r\n\tdeclare public _settings: ITrixSettings;\r\n\tdeclare public _privateSettings: ITrixPrivate;\r\n\tdeclare public _events: ITrixEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\t/**\r\n\t * Indicator series for the signal.\r\n\t */\r\n\tpublic signalSeries!: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}, {\r\n\t\tkey: \"signalPeriod\",\r\n\t\tname: this.root.language.translateAny(\"Signal period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"signalColor\",\r\n\t\tname: this.root.language.translateAny(\"Signal color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tprotected _themeTag: string = \"trix\";\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"trix\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis._themeTags.push(\"trix\");\r\n\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst chart = this.panel;\r\n\r\n\t\tif (chart) {\r\n\r\n\t\t\tconst signalSeries = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"valueX\",\r\n\t\t\t\tvalueYField: \"signal\",\r\n\t\t\t\txAxis: this.xAxis,\r\n\t\t\t\tyAxis: this.yAxis,\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tthemeTags: [\"indicator\", \"signal\"]\r\n\t\t\t}))\r\n\r\n\t\t\tthis.signalSeries = signalSeries;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tif (this.isDirty(\"signalPeriod\")) {\r\n\t\t\tthis.markDataDirty();\r\n\t\t\tthis.setCustomData(\"signalPeriod\", this.get(\"signalPeriod\"));\r\n\t\t}\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"signalColor\")) {\r\n\t\t\tthis._updateSeriesColor(this.signalSeries, this.get(\"signalColor\"), \"signalColor\");\r\n\t\t}\r\n\r\n\t\tconst dataItem = this.series.dataItem;\r\n\t\tif (dataItem) {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext) {\r\n\t\t\t\tdataContext.signalPeriod = this.get(\"signalPeriod\");\r\n\t\t\t\tconst signalColor = this.get(\"signalColor\");\r\n\t\t\t\tif (signalColor) {\r\n\t\t\t\t\tdataContext.signalColor = signalColor.toCSSHex();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tsuper.prepareData();\r\n\r\n\t\tif (this.series) {\r\n\r\n\t\t\tlet period = this.get(\"period\", 14);\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\tthis._ema(data, period, \"value_y\", \"ema\");\r\n\t\t\tthis._ema(data, period, \"ema\", \"ema2\");\r\n\t\t\tthis._ema(data, period, \"ema2\", \"ema3\");\r\n\r\n\t\t\tlet previousDataItem: any;\r\n\t\t\tlet previousValue: number;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet value = dataItem.ema3;\r\n\t\t\t\tif (previousDataItem) {\r\n\t\t\t\t\tpreviousValue = previousDataItem.ema3;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($type.isNumber(value) && $type.isNumber(previousValue)) {\r\n\t\t\t\t\tdataItem.trix = 100 * (value - previousValue) / previousValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpreviousDataItem = dataItem;\r\n\t\t\t})\r\n\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\r\n\r\n\t\t\tperiod = this.get(\"signalPeriod\", 9);\r\n\t\t\tthis._sma(data, period, \"trix\", \"signal\");\r\n\r\n\t\t\tthis.signalSeries.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IMedianPriceSettings extends IChartIndicatorSettings {\r\n}\r\n\r\nexport interface IMedianPricePrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IMedianPriceEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class MedianPrice extends ChartIndicator {\r\n\tpublic static className: string = \"MedianPrice\";\r\n\tpublic static classNames: Array<string> = ChartIndicator.classNames.concat([MedianPrice.className]);\r\n\r\n\tdeclare public _settings: IMedianPriceSettings;\r\n\tdeclare public _privateSettings: IMedianPricePrivate;\r\n\tdeclare public _events: IMedianPriceEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"period\",\r\n\t\tname: this.root.language.translateAny(\"Period\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _afterNew(){\r\n\t\tthis._themeTags.push(\"medianprice\");\r\n\t\tsuper._afterNew();\r\n\t}\t\r\n\r\n\tpublic _createSeries(): LineSeries {\r\n\t\treturn this.panel.series.push(LineSeries.new(this._root, {\r\n\t\t\tthemeTags: [\"indicator\"],\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis,\r\n\t\t\tvalueXField: \"valueX\",\r\n\t\t\tvalueYField: \"median\",\r\n\t\t\tfill: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tsuper.prepareData();\r\n\r\n\t\tif (this.series) {\r\n\r\n\t\t\tlet period = this.get(\"period\", 20);\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst dataItems = stockSeries.dataItems;\r\n\r\n\t\t\tlet data = this._getDataArray(dataItems);\r\n\r\n\t\t\tlet i = 0;\r\n\t\t\tlet index = 0;\r\n\t\t\tlet median = 0;\r\n\t\t\t$array.each(data, (dataItem) => {\r\n\t\t\t\tlet value = dataItem.value_y;\r\n\t\t\t\tif (value != null) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tmedian += value / period;\r\n\r\n\t\t\t\t\tif (i >= period) {\r\n\t\t\t\t\t\tif (i > period) {\r\n\t\t\t\t\t\t\tlet valueToRemove = data[index - period].value_y;\r\n\t\t\t\t\t\t\tif (valueToRemove != null) {\r\n\t\t\t\t\t\t\t\tmedian -= valueToRemove / period;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdataItem.median = median;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tindex++;\r\n\t\t\t})\r\n\r\n\t\t\tthis.series.data.setAll(data);\r\n\t\t}\r\n\t}\r\n}","import { Indicator, IIndicatorSettings, IIndicatorPrivate, IIndicatorEvents, IIndicatorEditableSetting } from \"./Indicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\n\r\nexport interface IZigZagSettings extends IIndicatorSettings {\r\n\t/**\r\n\t * Percentage of price movement you want to set as your threshold\r\n\t */\r\n\tdeviation?: number;\r\n\r\n\t/**\r\n\t * The minimum number of price bars required where there is no secondary high or low.\r\n\t */\r\n\tdepth?: number;\r\n}\r\n\r\nexport interface IZigZagPrivate extends IIndicatorPrivate {\r\n}\r\n\r\nexport interface IZigZagEvents extends IIndicatorEvents {\r\n}\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class ZigZag extends Indicator {\r\n\tpublic static className: string = \"ZigZag\";\r\n\tpublic static classNames: Array<string> = Indicator.classNames.concat([ZigZag.className]);\r\n\r\n\tdeclare public _settings: IZigZagSettings;\r\n\tdeclare public _privateSettings: IZigZagPrivate;\r\n\tdeclare public _events: IZigZagEvents;\r\n\r\n\t/**\r\n\t * Indicator series.\r\n\t */\r\n\tdeclare public series: LineSeries;\r\n\r\n\tpublic _editableSettings: IIndicatorEditableSetting[] = [{\r\n\t\tkey: \"deviation\",\r\n\t\tname: this.root.language.translateAny(\"Deviation\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"depth\",\r\n\t\tname: this.root.language.translateAny(\"Depth\"),\r\n\t\ttype: \"number\"\r\n\t}, {\r\n\t\tkey: \"seriesColor\",\r\n\t\tname: this.root.language.translateAny(\"Color\"),\r\n\t\ttype: \"color\"\r\n\t}];\r\n\r\n\tpublic _prepareChildren() {\r\n\r\n\t\tif (this.isDirty(\"deviation\") || this.isDirty(\"depth\")) {\r\n\t\t\tthis._dataDirty = true;\r\n\t\t\tthis.setCustomData(\"deviation\", this.get(\"deviation\"));\r\n\t\t\tthis.setCustomData(\"depth\", this.get(\"depth\"));\r\n\t\t}\r\n\r\n\t\tsuper._prepareChildren();\r\n\t}\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\tconst chart = stockSeries.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst series = chart.series.push(LineSeries.new(this._root, {\r\n\t\t\t\tvalueXField: \"time\",\r\n\t\t\t\tvalueYField: \"zigzag\",\r\n\t\t\t\tgroupDataDisabled: true,\r\n\t\t\t\tcalculateAggregates: true,\r\n\t\t\t\txAxis: stockSeries.get(\"xAxis\"),\r\n\t\t\t\tyAxis: stockSeries.get(\"yAxis\"),\r\n\t\t\t\tthemeTags: [\"indicator\", \"zigzag\"],\r\n\t\t\t\tname: \"ZigZag\",\r\n\t\t\t\tsnapTooltip: true\r\n\t\t\t}))\r\n\t\t\tseries.setPrivate(\"baseValueSeries\", stockSeries);\r\n\t\t\tthis.series = series;\r\n\r\n\t\t\tthis._handleLegend(series);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic prepareData() {\r\n\t\tif (this.series) {\r\n\t\t\tconst deviation = this.get(\"deviation\", 5) / 100;\r\n\t\t\tconst stockSeries = this.get(\"stockSeries\");\r\n\t\t\tconst data: Array<any> = [];\r\n\t\t\tif (stockSeries) {\r\n\t\t\t\tconst dataItems = stockSeries.dataItems;\r\n\t\t\t\tif (dataItems.length > 1) {\r\n\t\t\t\t\tlet firstDataItem = dataItems[0];\r\n\r\n\t\t\t\t\tlet goesUp = false;\r\n\t\t\t\t\tlet firstTime = firstDataItem.get(\"valueX\", 0);\r\n\t\t\t\t\tlet firstValue = firstDataItem.get(\"valueY\");\r\n\t\t\t\t\tlet firstHigh = firstDataItem.get(\"highValueY\", firstValue);\r\n\t\t\t\t\tlet firstLow = firstDataItem.get(\"lowValueY\", firstValue);\r\n\r\n\t\t\t\t\tlet zigZagTime: number | undefined;\r\n\t\t\t\t\tlet zigZagValue: number | undefined;\r\n\r\n\t\t\t\t\tlet j = 1;\r\n\t\t\t\t\tfor (let i = 1, len = dataItems.length; i < len; i++) {\r\n\t\t\t\t\t\tlet dataItem = dataItems[i];\r\n\t\t\t\t\t\tlet value = dataItem.get(\"value\", 0);\r\n\t\t\t\t\t\tlet low = dataItem.get(\"lowValueY\", value);\r\n\t\t\t\t\t\tlet high = dataItem.get(\"highValueY\", value);\r\n\t\t\t\t\t\tlet time = dataItem.get(\"valueX\", 0);\r\n\r\n\t\t\t\t\t\tif (low <= Number(firstHigh) * (1 - deviation)) {\r\n\t\t\t\t\t\t\tdata.push({ time: firstTime, zigzag: firstHigh });\r\n\t\t\t\t\t\t\tzigZagTime = time;\r\n\t\t\t\t\t\t\tzigZagValue = low;\r\n\t\t\t\t\t\t\tgoesUp = true;\r\n\t\t\t\t\t\t\tj = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (high >= Number(firstLow) * (1 + deviation)) {\r\n\t\t\t\t\t\t\tdata.push({ time: firstTime, zigzag: firstLow });\r\n\t\t\t\t\t\t\tzigZagTime = time;\r\n\t\t\t\t\t\t\tzigZagValue = high;\r\n\t\t\t\t\t\t\tgoesUp = false;\r\n\t\t\t\t\t\t\tj = i;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (zigZagValue != null) {\r\n\t\t\t\t\t\tlet depth = this.get(\"depth\", 3);\r\n\t\t\t\t\t\tfor (let i = j - 1, len = dataItems.length; i < len; i++) {\r\n\t\t\t\t\t\t\tlet dataItem = dataItems[i];\r\n\t\t\t\t\t\t\tlet value = dataItem.get(\"value\", 0);\r\n\t\t\t\t\t\t\tlet low = dataItem.get(\"lowValueY\", value);\r\n\t\t\t\t\t\t\tlet high = dataItem.get(\"highValueY\", value);\r\n\t\t\t\t\t\t\tlet time = dataItem.get(\"valueX\", 0);\r\n\r\n\t\t\t\t\t\t\tif (goesUp) {\r\n\t\t\t\t\t\t\t\tif (low <= zigZagValue) {\r\n\t\t\t\t\t\t\t\t\tzigZagValue = low;\r\n\t\t\t\t\t\t\t\t\tzigZagTime = time;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (high >= zigZagValue * (1 + deviation)) {\r\n\t\t\t\t\t\t\t\t\tlet b = Math.max(0, i - depth);\r\n\t\t\t\t\t\t\t\t\tlet skip = false;\r\n\t\t\t\t\t\t\t\t\tfor (let k = i; k > b; k--) {\r\n\t\t\t\t\t\t\t\t\t\tif (high < dataItems[k].get(\"highValueY\")) {\r\n\t\t\t\t\t\t\t\t\t\t\tskip = true;\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (!skip) {\r\n\t\t\t\t\t\t\t\t\t\tdata.push({ time: zigZagTime, zigzag: zigZagValue });\r\n\t\t\t\t\t\t\t\t\t\tzigZagValue = high;\r\n\t\t\t\t\t\t\t\t\t\tzigZagTime = time;\r\n\t\t\t\t\t\t\t\t\t\tgoesUp = false;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tif (high >= zigZagValue) {\r\n\t\t\t\t\t\t\t\t\tzigZagValue = high;\r\n\t\t\t\t\t\t\t\t\tzigZagTime = time;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse if (low <= zigZagValue * (1 - deviation)) {\r\n\t\t\t\t\t\t\t\t\tlet b = Math.max(0, i - depth);\r\n\t\t\t\t\t\t\t\t\tlet skip = false;\r\n\t\t\t\t\t\t\t\t\tfor (let k = i; k > b; k--) {\r\n\t\t\t\t\t\t\t\t\t\tif (low > dataItems[k].get(\"lowValueY\")) {\r\n\t\t\t\t\t\t\t\t\t\t\tskip = true;\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (!skip) {\r\n\t\t\t\t\t\t\t\t\t\tdata.push({ time: zigZagTime, zigzag: zigZagValue });\r\n\t\t\t\t\t\t\t\t\t\tzigZagValue = low;\r\n\t\t\t\t\t\t\t\t\t\tzigZagTime = time;\r\n\t\t\t\t\t\t\t\t\t\tgoesUp = true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst lastDataItem = dataItems[dataItems.length - 1];\r\n\t\t\t\t\t\tlet lastTime = lastDataItem.get(\"valueX\", 0);\r\n\t\t\t\t\t\tlet lastValue = lastDataItem.get(\"valueY\");\r\n\t\t\t\t\t\tlet lastHigh = lastDataItem.get(\"highValueY\", lastValue);\r\n\t\t\t\t\t\tlet lastLow = lastDataItem.get(\"lowValueY\", lastValue);\r\n\r\n\t\t\t\t\t\tif (zigZagValue < lastHigh) {\r\n\t\t\t\t\t\t\tdata.push({ time: lastTime, zigzag: lastLow });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tdata.push({ time: lastTime, zigzag: lastHigh });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.series.data.setAll(data);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { IIndicatorEditableSetting } from \"./Indicator\";\r\n\r\nimport { ChartIndicator, IChartIndicatorSettings, IChartIndicatorPrivate, IChartIndicatorEvents } from \"./ChartIndicator\";\r\nimport { LineSeries } from \"../../xy/series/LineSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport type { DataItem } from \"../../../..\";\r\n\r\nexport interface IAverageTrueRangeSettings extends IChartIndicatorSettings {\r\n}\r\n\r\nexport interface IAverageTrueRangePrivate extends IChartIndicatorPrivate {\r\n}\r\n\r\nexport interface IAverageTrueRangeEvents extends IChartIndicatorEvents {\r\n}\r\n\r\n\r\n/**\r\n * An implementation of a [[StockChart]] indicator.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/indicators/} for more info\r\n */\r\nexport class AverageTrueRange extends ChartIndicator {\r\n    public static className: string = \"AverageTrueRange\";\r\n    public static classNames: Array<string> = ChartIndicator.classNames.concat([AverageTrueRange.className]);\r\n\r\n    declare public _settings: IAverageTrueRangeSettings;\r\n    declare public _privateSettings: IAverageTrueRangePrivate;\r\n    declare public _events: IAverageTrueRangeEvents;\r\n\r\n    /**\r\n     * Indicator series.\r\n     */\r\n    declare public series: LineSeries;\r\n\r\n    public _editableSettings: IIndicatorEditableSetting[] = [{\r\n        key: \"period\",\r\n        name: this.root.language.translateAny(\"Period\"),\r\n        type: \"number\"\r\n    }, {\r\n        key: \"seriesColor\",\r\n        name: this.root.language.translateAny(\"Color\"),\r\n        type: \"color\"\r\n    }];\r\n\r\n    public _afterNew() {\r\n        this._themeTags.push(\"averagetruerange\");\r\n        super._afterNew();\r\n    }\r\n\r\n    public _createSeries(): LineSeries {\r\n        return this.panel.series.push(LineSeries.new(this._root, {\r\n            themeTags: [\"indicator\"],\r\n            xAxis: this.xAxis,\r\n            yAxis: this.yAxis,\r\n            valueXField: \"valueX\",\r\n            valueYField: \"atr\",\r\n            fill: undefined\r\n        }))\r\n    }\r\n\r\n    protected _getDataArray(dataItems: Array<DataItem<any>>): Array<any> {\r\n        const data: Array<any> = [];\r\n        $array.each(dataItems, (dataItem) => {\r\n            data.push({ valueX: dataItem.get(\"valueX\"), value_close: dataItem.get(\"valueY\"), value_high: dataItem.get(\"highValueY\"), value_low: dataItem.get(\"lowValueY\") });\r\n        })\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    public prepareData() {\r\n        super.prepareData();\r\n\r\n        if (this.series) {\r\n\r\n            let period = this.get(\"period\", 20);\r\n            const stockSeries = this.get(\"stockSeries\");\r\n            const dataItems = stockSeries.dataItems;\r\n\r\n            let data = this._getDataArray(dataItems);\r\n\r\n            let i = 0;\r\n            let index = 0;\r\n            let tr = 0;\r\n            let prevClose: number | undefined;\r\n            let prevATR: number | undefined;\r\n\r\n            $array.each(data, (dataItem) => {\r\n\r\n                let valueClose = dataItem.value_close;\r\n\r\n                if (valueClose != null && prevClose != null) {\r\n                    i++;\r\n                    tr = Math.max(dataItem.value_high - dataItem.value_low, Math.abs(dataItem.value_high - prevClose), Math.abs(dataItem.value_low - prevClose));\r\n                    dataItem.tr = tr;\r\n\r\n                    if (i >= period) {\r\n                        if (i == period) {\r\n                            let sum = 0;\r\n                            let k = 0;\r\n                            for (let j = index; j >= 0; j--) {\r\n                                sum += data[j].tr;\r\n                                k++;\r\n                                if (k == period) {\r\n                                    break;\r\n                                }\r\n                            }\r\n                            dataItem.atr = sum / period;\r\n                        }\r\n                        else {\r\n                            if (prevATR != null) {\r\n                                dataItem.atr = (prevATR * (period - 1) + tr) / period;\r\n                            }\r\n                        }\r\n\r\n                        prevATR = dataItem.atr;\r\n                    }\r\n                }\r\n                prevClose = valueClose;\r\n                index++;\r\n            })\r\n\r\n            this.series.data.setAll(data);\r\n        }\r\n    }\r\n}","import type { IDisposer } from \"../../../core/util/Disposer\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\nimport type { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport type { DateAxis } from \"../../xy/axes/DateAxis\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\nimport type { Sprite } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\nimport type { StockChart } from \"../StockChart\";\r\nimport type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { Graphics } from \"../../../core/render/Graphics\";\r\n\r\nimport { LineSeries, ILineSeriesSettings, ILineSeriesPrivate, ILineSeriesDataItem } from \"../../xy/series/LineSeries\";\r\nimport { Bullet } from \"../../../core/render/Bullet\";\r\nimport { Circle } from \"../../../core/render/Circle\";\r\nimport { Rectangle } from \"../../../core/render/Rectangle\";\r\nimport { Container } from \"../../../core/render/Container\";\r\nimport { Template } from \"../../../core/util/Template\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\n\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $time from \"../../../core/util/Time\";\r\nimport * as $type from \"../../../core/util/Type\";\r\nimport * as $math from \"../../../core/util/Math\";\r\nimport * as $object from \"../../../core/util/Object\";\r\n\r\n\r\n\r\nexport interface IDrawingSeriesDataItem extends ILineSeriesDataItem {\r\n\r\n}\r\n\r\nexport interface IDrawingSeriesSettings extends ILineSeriesSettings {\r\n\r\n\t/**\r\n\t * X-Axis.\r\n\t */\r\n\txAxis: DateAxis<AxisRenderer>;\r\n\r\n\t/**\r\n\t * Y-axis.\r\n\t */\r\n\tyAxis: ValueAxis<AxisRenderer>;\r\n\r\n\t/**\r\n\t * Color of the lines/borders.\r\n\t */\r\n\tstrokeColor?: Color;\r\n\r\n\t/**\r\n\t * Color of the fills.\r\n\t */\r\n\tfillColor?: Color;\r\n\r\n\t/**\r\n\t * Opacity of the lines/borders (0-1).\r\n\t */\r\n\tstrokeOpacity?: number;\r\n\r\n\t/**\r\n\t * Opacity of the fills (0-1).\r\n\t */\r\n\tfillOpacity?: number;\r\n\r\n\t/**\r\n\t * Width of the lines/borders in pixels.\r\n\t */\r\n\tstrokeWidth?: number;\r\n\r\n\t/**\r\n\t * Dash information for lines/borders.\r\n\t */\r\n\tstrokeDasharray?: Array<number>;\r\n\r\n\t/**\r\n\t * [[XYSeries]] used for drawing.\r\n\t */\r\n\tseries?: XYSeries;\r\n\r\n\t/**\r\n\t * Indicates if drawings should snap to x and y values.\r\n\t * @ignore\r\n\t */\r\n\tsnapToData?: boolean;\r\n\r\n\t/**\r\n\t * Value field to use when snapping data or calculating averages/regresions/etc.\r\n\t *\r\n\t * @default \"value\"\r\n\t */\r\n\tfield?: \"open\" | \"value\" | \"low\" | \"high\";\r\n\r\n\t/**\r\n\t * Padding of a selector rectangle (how many pixels will be added to each side around the drawing when it's selected)\r\n\t * @default 5\r\n\t */\r\n\tselectorPadding?: number;\r\n}\r\n\r\nexport interface IDrawingSeriesPrivate extends ILineSeriesPrivate {\r\n\tallowChangeSnap?: boolean;\r\n}\r\n\r\n\r\nexport class DrawingSeries extends LineSeries {\r\n\tpublic static className: string = \"DrawingSeries\";\r\n\tpublic static classNames: Array<string> = LineSeries.classNames.concat([DrawingSeries.className]);\r\n\r\n\tdeclare public _settings: IDrawingSeriesSettings;\r\n\tdeclare public _privateSettings: IDrawingSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IDrawingSeriesDataItem;\r\n\r\n\tprotected _clickDp?: IDisposer;\r\n\tprotected _moveDp?: IDisposer;\r\n\tprotected _downDp?: IDisposer;\r\n\tprotected _upDp?: IDisposer;\r\n\r\n\tprotected _drawingEnabled: boolean = false;\r\n\r\n\tprotected _clickPointerPoint?: IPoint;\r\n\tprotected _movePointerPoint?: IPoint;\r\n\r\n\tprotected _isDrawing: boolean = false;\r\n\tprotected _isPointerDown: boolean = false;\r\n\r\n\tpublic _index: number = 0;\r\n\tpublic _drawingId?: string;\r\n\r\n\tprotected _di: Array<{ [index: string]: DataItem<IDrawingSeriesDataItem> }> = [];\r\n\r\n\tprotected _dragStartPX: number = 0;\r\n\tprotected _dragStartY: number = 0;\r\n\r\n\tprotected _dvpX: Array<{ [index: string]: number | undefined }> = [];\r\n\tprotected _dvY: Array<{ [index: string]: number | undefined }> = [];\r\n\r\n\tprotected _isHover: boolean = false;\r\n\r\n\tprotected _erasingEnabled: boolean = false;\r\n\r\n\tprotected _tag?: string;\r\n\r\n\tprotected _movePoint: IPoint = { x: 0, y: 0 };\r\n\r\n\tprotected selectorContainer: Container = this.children.push(Container.new(this.root, {}));\r\n\r\n\tprotected _selected: Array<number> = [];\r\n\r\n\tprotected _isSelecting: boolean = false;\r\n\r\n\t// point index in segment\r\n\tprotected _pIndex: number = 0;\r\n\r\n\tpublic readonly grips: ListTemplate<Container> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Container._new(this._root, {\r\n\t\t\tthemeTags: [\"grip\"],\r\n\t\t\tsetStateOnChildren: true,\r\n\t\t\tdraggable: true\r\n\t\t}, [this.grips.template]),\r\n\t));\r\n\r\n\tpublic readonly circles: ListTemplate<Circle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Circle._new(this._root, {\r\n\t\t}, [this.circles.template]),\r\n\t));\r\n\r\n\tpublic readonly outerCircles: ListTemplate<Circle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Circle._new(this._root, {\r\n\t\t\tthemeTags: [\"outline\"]\r\n\t\t}, [this.outerCircles.template]),\r\n\t));\r\n\r\n\tpublic readonly selectors: ListTemplate<Rectangle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Rectangle._new(this._root, {\r\n\t\t\tthemeTags: [\"selector\"]\r\n\t\t}, [this.selectors.template]),\r\n\t));\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis.addTag(\"drawing\");\r\n\t\tthis.setPrivate(\"allowChangeSnap\", true);\r\n\r\n\t\tif (this._tag) {\r\n\t\t\tthis.addTag(this._tag);\r\n\t\t}\r\n\r\n\t\tthis.set(\"valueYField\", \"valueY\");\r\n\t\tthis.set(\"valueXField\", \"valueX\");\r\n\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.set(\"connect\", false);\r\n\t\tthis.set(\"autoGapCount\", Infinity);\r\n\t\tthis.set(\"ignoreMinMax\", true);\r\n\t\tthis.set(\"groupDataDisabled\", true);\r\n\r\n\t\tconst strokesTemplate = this.strokes.template;\r\n\t\tstrokesTemplate.set(\"templateField\", \"stroke\");\r\n\r\n\t\tconst fillsTemplate = this.fills.template;\r\n\t\tfillsTemplate.setAll({ templateField: \"fill\" });\r\n\r\n\t\tfillsTemplate.events.on(\"pointerdown\", (e) => {\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tthis._disposeIndex(index);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\tif (!originalEvent.button && this._drawingEnabled) {\r\n\t\t\t\t\tthis._handlePointerDown(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst stroke = this.strokes.getIndex(this._getStrokeIndex(index));\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.dragStart(e);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis.startDragItem(e, this._getIndex(e.target));\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"click\", (e) => {\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\tif (!this._isDrawing) {\r\n\t\t\t\tthis._selectDrawing(index, originalEvent.ctrlKey);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\t\t\tthis.stopDragItem(e, index);\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\t\t\tconst stroke = this.strokes.getIndex(this._getStrokeIndex(index));\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.hover();\r\n\t\t\t}\r\n\t\t\tthis._isHover = true;\r\n\t\t\tthis._showSegmentBullets(index);\r\n\t\t})\r\n\r\n\t\tfillsTemplate.events.on(\"pointerout\", () => {\r\n\t\t\tthis._isHover = false;\r\n\t\t\t//this._hideAllBullets();\r\n\t\t})\r\n\r\n\r\n\t\tstrokesTemplate.events.on(\"pointerdown\", (e) => {\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tthis._disposeIndex(index);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"click\", (e) => {\r\n\t\t\tconst index = this._getIndex(e.target);\r\n\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\tthis._selectDrawing(index, originalEvent.ctrlKey);\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tthis._isHover = true;\r\n\t\t\tthis._showSegmentBullets(this._getIndex(e.target));\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"pointerout\", () => {\r\n\t\t\tthis._isHover = false;\r\n\t\t\t//this._hideAllBullets();\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tthis.stopDragItem(e, this._getIndex(e.target));\r\n\t\t})\r\n\r\n\t\tstrokesTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis.startDragItem(e, this._getIndex(e.target));\r\n\t\t})\r\n\r\n\t\tthis.bulletsContainer.states.create(\"hidden\", { visible: true, opacity: 0 });\r\n\r\n\t\tthis.bullets.push((_root, _series, dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst di = this._di[index][\"e\"] as DataItem<IDrawingSeriesDataItem>;\r\n\t\t\tlet color = this.get(\"strokeColor\", this.get(\"stroke\"));\r\n\r\n\t\t\tif (di) {\r\n\t\t\t\tconst dc = di.dataContext as any;\r\n\t\t\t\tif (dc) {\r\n\t\t\t\t\tconst strokeTemplate = dc.stroke;\r\n\t\t\t\t\tif (strokeTemplate) {\r\n\t\t\t\t\t\tcolor = strokeTemplate.get(\"stroke\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst container = this.grips.make();\r\n\t\t\tcontainer.setRaw(\"userData\", \"grip\");\r\n\t\t\tthis.grips.push(container);\r\n\r\n\t\t\tconst circle = container.children.push(this.circles.make())\r\n\t\t\tthis.circles.push(circle);\r\n\t\t\tcircle.set(\"stroke\", color);\r\n\r\n\t\t\tconst outerCircle = container.children.push(this.outerCircles.make())\r\n\t\t\tthis.outerCircles.push(outerCircle);\r\n\t\t\touterCircle.set(\"stroke\", color);\r\n\r\n\t\t\tcontainer.events.on(\"pointerover\", (event) => {\r\n\t\t\t\tconst dataItem = event.target.dataItem;\r\n\t\t\t\tif (dataItem) {\r\n\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\tthis._showSegmentBullets(dataContext.index);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t//container.events.on(\"pointerout\", () => {\r\n\t\t\t//\tthis._hideAllBullets();\r\n\t\t\t//})\r\n\r\n\t\t\tthis._addBulletInteraction(container);\r\n\t\t\tthis._tweakBullet(container, dataItem);\r\n\r\n\t\t\treturn Bullet.new(this._root, {\r\n\t\t\t\tlocationX: undefined,\r\n\t\t\t\tsprite: container\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.events.on(\"pointerover\", () => {\r\n\t\t\tthis._handlePointerOver();\r\n\t\t})\r\n\r\n\t\tthis.events.on(\"pointerout\", () => {\r\n\t\t\tthis._handlePointerOut();\r\n\t\t})\r\n\r\n\t\tthis._getStockChart().markDirtyKey(\"drawingSelectionEnabled\");\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Disposes a drawing with the specified index.\r\n\t *\r\n\t * @param  index  Index\r\n\t * @since 5.7.7\r\n\t */\r\n\tpublic disposeIndex(index: number) {\r\n\t\tthis._disposeIndex(index);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Returns index of a drawing with the specific ID, or `null` if not found.\r\n\t *\r\n\t * @param   id  ID\r\n\t * @return      Index\r\n\t * @since 5.8.4\r\n\t */\r\n\tpublic getIndex(id: string): number | null {\r\n\t\tlet index = null;\r\n\t\t$array.eachContinue(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext.drawingId == id) {\r\n\t\t\t\tindex = dataContext.index;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\treturn index;\r\n\t}\r\n\r\n\tprotected _disposeIndex(index: number) {\r\n\t\tconst dataItems = this._di[index];\r\n\r\n\t\tif (dataItems) {\r\n\t\t\tlet drawingId!: string;\r\n\t\t\tlet index!: number;\r\n\r\n\t\t\t$object.each(dataItems, (_key, dataItem) => {\r\n\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\tthis.data.removeValue(dataContext);\r\n\r\n\t\t\t\tif (dataContext) {\r\n\t\t\t\t\tif (dataContext.drawingId) {\r\n\t\t\t\t\t\tdrawingId = dataContext.drawingId;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (dataContext.index) {\r\n\t\t\t\t\t\tindex = dataContext.index;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tfor (let i = this.dataItems.length - 1; i >= 0; i--) {\r\n\t\t\t\tconst dataItem = this.dataItems[i];\r\n\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\tif (dataContext.index == index) {\r\n\t\t\t\t\tthis.data.removeValue(dataContext);\r\n\t\t\t\t\tthis.disposeDataItem(dataItem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._pIndex = 0;\r\n\t\t\tdelete this._di[index];\r\n\r\n\t\t\tthis._dispatchStockEvent(\"drawingremoved\", drawingId, index);\r\n\t\t}\r\n\t\tconst selector = this._getSprite(this.selectors, index) as Rectangle;\r\n\t\tif (selector) {\r\n\t\t\tthis.selectors.removeValue(selector);\r\n\t\t}\r\n\r\n\t\t$array.remove(this._selected, index);\r\n\t}\r\n\r\n\tprotected _afterDataChange() {\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst corner = dataContext.corner;\r\n\r\n\t\t\tif (index != undefined) {\r\n\t\t\t\tif (this._di[index] == undefined) {\r\n\t\t\t\t\tthis._di[index] = {};\r\n\t\t\t\t}\r\n\t\t\t\tthis._createElements(index, dataItem);\r\n\t\t\t\tthis._di[index][corner] = dataItem;\r\n\t\t\t\tthis._index = index;\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _createElements(_index: number, _dataItem?: DataItem<IDrawingSeriesDataItem>) {\r\n\r\n\t}\r\n\r\n\tpublic _clearDirty(): void {\r\n\t\tsuper._clearDirty();\r\n\t\tthis._isSelecting = false;\r\n\t}\r\n\r\n\tpublic clearDrawings(): void {\r\n\t\t$array.each(this._di, (_dataItems, index) => {\r\n\t\t\tthis._disposeIndex(index);\r\n\t\t});\r\n\r\n\t\tthis.data.setAll([]);\r\n\t\tthis._index = 0;\r\n\t\tthis._selected = [];\r\n\t}\r\n\r\n\tprotected _getIndex(sprite: Sprite): number {\r\n\t\tconst userData = sprite.get(\"userData\");\r\n\r\n\t\tif (userData && userData.length > 0) {\r\n\t\t\tconst dataItem = this.dataItems[userData[0]];\r\n\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\t\t\tif (dataContext) {\r\n\t\t\t\t\treturn dataContext.index;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tprotected _getStrokeIndex(index: number) {\r\n\t\tlet i = 0;\r\n\t\tlet c = index;\r\n\t\tthis.strokes.each((stroke) => {\r\n\t\t\tconst strokeIndex = this._getIndex(stroke);\r\n\t\t\tif (strokeIndex == index) {\r\n\t\t\t\tc = i;\r\n\t\t\t}\r\n\t\t\ti++;\r\n\t\t})\r\n\t\treturn c;\r\n\t}\r\n\r\n\tpublic setInteractive(value: boolean) {\r\n\t\tthis.strokes.template.set(\"forceInactive\", !value);\r\n\t\tthis.fills.template.set(\"forceInactive\", !value);\r\n\r\n\t\t//if(value){\r\n\t\t//\tthis.showAllBullets();\r\n\t\t//}\r\n\t}\r\n\r\n\tpublic enableDrawingSelection(value: boolean) {\r\n\t\tthis._erasingEnabled = false;\r\n\t\tthis.strokes.template.set(\"forceInactive\", !value);\r\n\t\tthis.fills.template.set(\"forceInactive\", !value);\r\n\t}\r\n\r\n\tprotected _showSegmentBullets(index: number) {\r\n\t\tconst dataItems = this._di[index];\r\n\t\tif (dataItems) {\r\n\t\t\t$object.each(dataItems, (_key, dataItem) => {\r\n\t\t\t\tconst bullets = dataItem.bullets;\r\n\t\t\t\tif (bullets) {\r\n\t\t\t\t\t$array.each(bullets, (bullet) => {\r\n\t\t\t\t\t\tconst sprite = bullet.get(\"sprite\");\r\n\t\t\t\t\t\tif (sprite) {\r\n\t\t\t\t\t\t\tsprite.show(0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _hideResizer(sprite?: Sprite) {\r\n\t\tconst spriteResizer = this._getStockChart().spriteResizer;\r\n\t\tif (spriteResizer) {\r\n\t\t\tconst resizerSprite = spriteResizer.get(\"sprite\");\r\n\t\t\tif (resizerSprite) {\r\n\t\t\t\tif (!sprite || sprite.dataItem != resizerSprite.dataItem) {\r\n\t\t\t\t\tspriteResizer.set(\"sprite\", undefined);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic startDragItem(event: ISpritePointerEvent, index: number) {\r\n\t\tconst stockChart = this._getStockChart();\r\n\t\tif (stockChart) {\r\n\t\t\tstockChart._dragStartDrawing(event);\r\n\t\t}\r\n\r\n\t\tif (this._selected.indexOf(index) == -1) {\r\n\t\t\tthis.unselectAllDrawings();\r\n\t\t}\r\n\r\n\t\tthis._handleFillDragStart(event, index);\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic stopDragItem(event: ISpritePointerEvent, index: number) {\r\n\t\tconst stockChart = this._getStockChart();\r\n\t\tif (stockChart) {\r\n\t\t\tstockChart._dragStopDrawing(event);\r\n\t\t}\r\n\t\tthis._handleFillDragStop(event, index);\r\n\t}\r\n\r\n\tprotected _handleFillDragStart(event: ISpritePointerEvent, index: number) {\r\n\t\tthis._hideResizer(event.target);\r\n\t\tthis._isPointerDown = false;\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\r\n\t\t\tthis._dragStartPX = xAxis.coordinateToPosition(point.x);\r\n\t\t\tconst valueXns = xAxis.positionToValue(this._dragStartPX);\r\n\t\t\tthis._dragStartY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)), valueXns);\r\n\r\n\t\t\tconst dataItems = this._di[index];\r\n\t\t\tthis._dvpX[index] = {};\r\n\t\t\tthis._dvY[index] = {};\r\n\r\n\t\t\tif (dataItems) {\r\n\t\t\t\t$object.each(dataItems, (key, dataItem) => {\r\n\t\t\t\t\tthis._dvpX[index][key] = xAxis.valueToPosition(dataItem.get(\"valueX\", 0));\r\n\t\t\t\t\tthis._dvY[index][key] = dataItem.get(\"valueY\");\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _dragStart(event: ISpritePointerEvent) {\r\n\t\t$array.each(this._selected, (index) => {\r\n\t\t\tthis._handleFillDragStart(event, index);\r\n\t\t})\r\n\t}\r\n\r\n\tpublic _dragStop(event: ISpritePointerEvent) {\r\n\t\t$array.each(this._selected, (index) => {\r\n\t\t\tthis._handleFillDragStop(event, index);\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _handleFillDragStop(event: ISpritePointerEvent, index: number) {\r\n\t\tthis._isPointerDown = false;\r\n\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst posX = xAxis.coordinateToPosition(point.x);\r\n\t\t\tconst valueXns = xAxis.positionToValue(xAxis.coordinateToPosition(point.x));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)), valueXns);\r\n\r\n\t\t\tconst dpx = posX - this._dragStartPX;\r\n\t\t\tconst dy = valueY - this._dragStartY;\r\n\r\n\t\t\tevent.target.setAll({\r\n\t\t\t\tx: 0, y: 0\r\n\t\t\t})\r\n\r\n\t\t\tconst dataItems = this._di[index];\r\n\r\n\t\t\tif (dataItems) {\r\n\t\t\t\t$object.each(dataItems, (key, dataItem) => {\r\n\t\t\t\t\tconst dvpx = this._dvpX[index][key];\r\n\t\t\t\t\tconst dvy = this._dvY[index][key];\r\n\r\n\t\t\t\t\tif ($type.isNumber(dvpx) && $type.isNumber(dvy)) {\r\n\t\t\t\t\t\tconst vpx = dvpx + dpx;\r\n\t\t\t\t\t\tconst vxns = xAxis.positionToValue(vpx);\r\n\t\t\t\t\t\tconst vx = this._getXValue(vxns);\r\n\r\n\t\t\t\t\t\tlet vy = dvy + dy;\r\n\t\t\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\t\t\t\t\t\tconst roundTo = yAxis.getPrivate(\"stepDecimalPlaces\", 0) + 1;\r\n\t\t\t\t\t\tvy = $math.round(vy, roundTo);\r\n\t\t\t\t\t\tvy = this._getYValue(vy, vxns, true);\r\n\r\n\t\t\t\t\t\tthis._setContext(dataItem, \"valueX\", vx)\r\n\t\t\t\t\t\tthis._setContext(dataItem, \"valueY\", vy, true);\r\n\r\n\t\t\t\t\t\tthis._setXLocation(dataItem, vx);\r\n\t\t\t\t\t\tthis._positionBullets(dataItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst stroke = this.strokes.getIndex(this._getStrokeIndex(index));\r\n\t\tif (stroke) {\r\n\t\t\tstroke.dragStop(event);\r\n\t\t}\r\n\r\n\t\tthis.markDirty();\r\n\t\tthis._updateSegment(index);\r\n\t}\r\n\r\n\tprotected _updateSegment(_index: number) {\r\n\t\tthis._updateElements();\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tthis._updateElements();\r\n\r\n\t\tif (this.isDirty(\"strokeColor\") || this.isDirty(\"strokeOpacity\") || this.isDirty(\"strokeDasharray\") || this.isDirty(\"strokeWidth\")) {\r\n\t\t\t$array.each(this._selected, (i) => {\r\n\r\n\t\t\t\tlet settings = {\r\n\t\t\t\t\tstroke: this.get(\"strokeColor\"),\r\n\t\t\t\t\tstrokeOpacity: this.get(\"strokeOpacity\"),\r\n\t\t\t\t\tstrokeDasharray: this.get(\"strokeDasharray\"),\r\n\t\t\t\t\tstrokeWidth: this.get(\"strokeWidth\")\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst stroke = this.strokes.getIndex(this._getStrokeIndex(i));\r\n\t\t\t\tif (stroke) {\r\n\t\t\t\t\tlet strokeTemplate: Template<any>;\r\n\t\t\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\t\tif (dataContext.index == i) {\r\n\t\t\t\t\t\t\tif (dataContext.stroke) {\r\n\t\t\t\t\t\t\t\tstrokeTemplate = dataContext.stroke;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tconst defaultState = stroke.states.lookup(\"default\")!;\r\n\t\t\t\t\t$object.each(settings, (key, value) => {\r\n\t\t\t\t\t\tstroke.set(key, value);\r\n\t\t\t\t\t\tdefaultState.set(key, value);\r\n\t\t\t\t\t\tif (strokeTemplate) {\r\n\t\t\t\t\t\t\tstrokeTemplate.set(key, value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.circles.each((circle) => {\r\n\t\t\t\t\tconst dataItem = circle.dataItem;\r\n\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\t\tif (dataContext) {\r\n\t\t\t\t\t\t\tif (dataContext.index == i) {\r\n\t\t\t\t\t\t\t\tcircle.set(\"stroke\", settings.stroke)\r\n\t\t\t\t\t\t\t\tcircle.states.lookup(\"default\")!.set(\"stroke\", settings.stroke);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tthis.outerCircles.each((circle) => {\r\n\t\t\t\t\tconst dataItem = circle.dataItem;\r\n\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\t\tif (dataContext) {\r\n\t\t\t\t\t\t\tif (dataContext.index == i) {\r\n\t\t\t\t\t\t\t\tcircle.set(\"stroke\", settings.stroke)\r\n\t\t\t\t\t\t\t\tcircle.states.lookup(\"default\")!.set(\"stroke\", settings.stroke);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\r\n\t\t\t\tthis._applySettings(i, settings);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"fillColor\") || this.isDirty(\"fillOpacity\")) {\r\n\t\t\t$array.each(this._selected, (i) => {\r\n\t\t\t\tconst fill = this.fills.getIndex(this._getStrokeIndex(i));\r\n\r\n\t\t\t\tlet settings = {\r\n\t\t\t\t\tfill: this.get(\"fillColor\"),\r\n\t\t\t\t\tfillOpacity: this.get(\"fillOpacity\")\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (fill) {\r\n\t\t\t\t\tlet fillTemplate: Template<any>;\r\n\t\t\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\t\tif (dataContext.index == i) {\r\n\t\t\t\t\t\t\tif (dataContext.fill) {\r\n\t\t\t\t\t\t\t\tfillTemplate = dataContext.fill;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tconst defaultState = fill.states.lookup(\"default\")!;\r\n\t\t\t\t\t$object.each(settings, (key, value) => {\r\n\t\t\t\t\t\tfill.set(key, value);\r\n\t\t\t\t\t\tdefaultState.set(key, value);\r\n\t\t\t\t\t\tif (fillTemplate) {\r\n\t\t\t\t\t\t\tfillTemplate.set(key, value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._applySettings(i, settings);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this._valuesDirty) {\r\n\t\t\tthis.markDirtyDrawings();\r\n\t\t}\r\n\r\n\t\tsuper._updateChildren();\r\n\t\tthis._updateSelectors();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic isDrawing(value: boolean) {\r\n\t\tthis._isDrawing = value;\r\n\t\tconst stockChart = this._getStockChart();\r\n\t\tif (stockChart) {\r\n\t\t\tif (value) {\r\n\t\t\t\tstockChart._selectionWasOn = stockChart.get(\"drawingSelectionEnabled\", false);\r\n\t\t\t\tstockChart.set(\"drawingSelectionEnabled\", false);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _applySettings(_index: number, _settings?: { [index: string]: any }) {\r\n\t\tthis.markDirtyDrawings();\r\n\t}\r\n\r\n\tprotected _updateElements() {\r\n\r\n\t}\r\n\r\n\tpublic markDirtyDrawings() {\r\n\t\tconst stockChart = this._getStockChart();\r\n\t\tif (stockChart) {\r\n\t\t\tstockChart.markDirtyDrawings();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getFillTemplate(): Template<any> {\r\n\t\tconst fillTemplate: any = {};\r\n\r\n\t\tconst fillColor = this.get(\"fillColor\");\r\n\t\tif (fillColor != null) {\r\n\t\t\tfillTemplate.fill = fillColor;\r\n\t\t}\r\n\r\n\t\tconst fillOpacity = this.get(\"fillOpacity\");\r\n\t\tif (fillOpacity != null) {\r\n\t\t\tfillTemplate.fillOpacity = fillOpacity;\r\n\t\t}\r\n\r\n\t\treturn Template.new(fillTemplate);\r\n\t}\r\n\r\n\tprotected _getStrokeTemplate(): Template<any> {\r\n\t\tconst strokeTemplate: any = {};\r\n\r\n\t\tconst strokeColor = this.get(\"strokeColor\");\r\n\t\tif (strokeColor != null) {\r\n\t\t\tstrokeTemplate.stroke = strokeColor;\r\n\t\t}\r\n\r\n\t\tconst strokeOpacity = this.get(\"strokeOpacity\");\r\n\t\tif (strokeOpacity != null) {\r\n\t\t\tstrokeTemplate.strokeOpacity = strokeOpacity;\r\n\t\t}\r\n\r\n\t\tconst strokeDasharray = this.get(\"strokeDasharray\");\r\n\t\tif (strokeDasharray != null) {\r\n\t\t\tstrokeTemplate.strokeDasharray = strokeDasharray;\r\n\t\t}\r\n\r\n\t\tconst strokeWidth = this.get(\"strokeWidth\");\r\n\t\tif (strokeWidth != null) {\r\n\t\t\tstrokeTemplate.strokeWidth = strokeWidth;\r\n\t\t}\r\n\r\n\t\treturn Template.new(strokeTemplate);\r\n\t}\r\n\r\n\tprotected _tweakBullet(_container: Container, _dataItem: DataItem<IDrawingSeriesDataItem>) {\r\n\r\n\t}\r\n\r\n\tprotected _dispatchStockEvent(type: any, drawingId?: string, index?: number) {\r\n\t\tconst stockChart = this._getStockChart();\r\n\r\n\t\tif (type == \"drawingadded\") {\r\n\t\t\tif (stockChart._selectionWasOn) {\r\n\t\t\t\tstockChart.set(\"drawingSelectionEnabled\", true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (stockChart && stockChart.events.isEnabled(type)) {\r\n\t\t\tstockChart.events.dispatch(type, { drawingId: drawingId, series: this, target: stockChart, index: index });\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addBulletInteraction(sprite: Sprite) {\r\n\t\tsprite.events.on(\"dragged\", (e) => {\r\n\t\t\tthis._handleBulletDragged(e);\r\n\t\t\tthis._isDragging = true;\r\n\t\t})\r\n\r\n\t\tsprite.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._handleBulletDragStart(e);\r\n\t\t})\r\n\r\n\t\tsprite.events.on(\"dragstop\", (e) => {\r\n\t\t\tthis._handleBulletDragStop(e);\r\n\t\t\tthis.setTimeout(() => {\r\n\t\t\t\tthis._isDragging = false;\r\n\t\t\t}, 100)\r\n\t\t})\r\n\r\n\t\tsprite.events.on(\"click\", (e) => {\r\n\t\t\tconst dataItem = e.target.dataItem;\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\t\tif (dataContext) {\r\n\t\t\t\t\t\tthis._disposeIndex(dataContext.index);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (!this._isDrawing) {\r\n\t\t\t\t\t\tthis._selectDrawing(dataContext.index, (e.originalEvent as any).ctrlKey);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis._handlePointerClick(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tpublic _increaseIndex() {\r\n\t\tthis._index++;\r\n\t\tthis._drawingId = this._generateId();\r\n\t}\r\n\r\n\tpublic _generateId(): string {\r\n\t\treturn \"\" + new Date().getTime() + Math.round(Math.random() * 10000 + 10000);\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (this._drawingEnabled) {\r\n\t\t\tconst chart = this.chart;\r\n\t\t\tif (chart) {\r\n\t\t\t\tthis._clickPointerPoint = chart.plotContainer.toLocal(event.point)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// need this in order bullets not to be placed to the charts bullets container\r\n\tpublic _placeBulletsContainer() {\r\n\t\tthis.children.moveValue(this.bulletsContainer);\r\n\t\tthis.enableDrawing();\r\n\t\tthis.disableDrawing();\r\n\t}\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tconst dataItem = event.target.dataItem as DataItem<this[\"_dataItemSettings\"]>;\r\n\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst target = event.target;\r\n\t\t\tconst point = { x: target.x(), y: target.y() };\r\n\t\t\tthis._handleBulletDraggedReal(dataItem, point);\r\n\t\t}\r\n\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tthis._updateSegment(index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletDraggedReal(dataItem: DataItem<this[\"_dataItemSettings\"]>, point: IPoint) {\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\tconst valueXns = xAxis.positionToValue(xAxis.coordinateToPosition(point.x));\r\n\t\tconst valueX = this._getXValue(valueXns);\r\n\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)), valueXns);\r\n\r\n\t\tthis._setContext(dataItem, \"valueX\", valueX);\r\n\t\tthis._setContext(dataItem, \"valueY\", valueY, true);\r\n\t\tthis._setXLocation(dataItem, valueX);\r\n\r\n\t\tthis._positionBullets(dataItem);\r\n\t}\r\n\r\n\tprotected _handleBulletDragStart(_event: ISpritePointerEvent) {\r\n\t\tthis._hideResizer();\r\n\t\tthis.unselectAllDrawings();\r\n\t}\r\n\r\n\tprotected _handleBulletDragStop(_event: ISpritePointerEvent) {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerOver() {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerOut() {\r\n\r\n\t}\r\n\r\n\tpublic enableDrawing() {\r\n\t\tconst chart = this.chart;\r\n\t\tthis._erasingEnabled = false;\r\n\t\tthis._drawingEnabled = true;\r\n\t\tif (chart) {\r\n\t\t\tif (!this._clickDp) {\r\n\t\t\t\tthis._clickDp = chart.plotContainer.events.on(\"click\", (e) => {\r\n\t\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\t\tif (!originalEvent.button && !this._erasingEnabled) {\r\n\t\t\t\t\t\tthis._handlePointerClick(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._downDp) {\r\n\t\t\t\tthis._downDp = chart.plotContainer.events.on(\"pointerdown\", (e) => {\r\n\t\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\t\tif (!originalEvent.button && !this._erasingEnabled) {\r\n\t\t\t\t\t\tthis._handlePointerDown(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._upDp) {\r\n\t\t\t\tthis._upDp = chart.plotContainer.events.on(\"globalpointerup\", (e) => {\r\n\t\t\t\t\tconst originalEvent = e.originalEvent as any;\r\n\t\t\t\t\tif (!originalEvent.button && !this._erasingEnabled) {\r\n\t\t\t\t\t\tthis._handlePointerUp(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._moveDp) {\r\n\t\t\t\tthis._moveDp = chart.plotContainer.events.on(\"globalpointermove\", (e) => {\r\n\t\t\t\t\tif (!this._erasingEnabled) {\r\n\t\t\t\t\t\tif (e.point.x != this._movePoint.x || e.point.y != this._movePoint.y) {\r\n\t\t\t\t\t\t\tthis._handlePointerMove(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic enableErasing() {\r\n\t\tthis._erasingEnabled = true;\r\n\t\tthis.setInteractive(true);\r\n\t}\r\n\r\n\tpublic disableErasing() {\r\n\t\tthis._erasingEnabled = false;\r\n\t\tif (!this._getStockChart().get(\"drawingSelectionEnabled\")) {\r\n\t\t\tthis.setInteractive(false);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic disableDrawing() {\r\n\t\tthis._erasingEnabled = false;\r\n\t\tthis._drawingEnabled = false;\r\n\t\tthis.isDrawing(false);\r\n\r\n\t\tif (this._clickDp) {\r\n\t\t\tthis._clickDp.dispose();\r\n\t\t\tthis._clickDp = undefined;\r\n\t\t}\r\n\r\n\t\tif (this._downDp) {\r\n\t\t\tthis._downDp.dispose();\r\n\t\t\tthis._downDp = undefined;\r\n\t\t}\r\n\r\n\t\tif (this._upDp) {\r\n\t\t\tthis._upDp.dispose();\r\n\t\t\tthis._upDp = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic toggleDrawing(enabled?: boolean) {\r\n\t\tif(this._getStockChart().get(\"hideDrawingGrips\")){\r\n\t\t\tthis.root.events.once(\"frameended\", () => {\r\n\t\t\t\tthis.circles.each((circle) => {\r\n\t\t\t\t\tcircle.set(\"forceHidden\", !enabled);\r\n\t\t\t\t})\r\n\t\t\t\tthis.grips.each((grip) => {\r\n\t\t\t\t\tgrip.set(\"forceInactive\", !enabled);\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tthis._movePointerPoint = chart.plotContainer.toLocal(event.point)\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerDown(_event: ISpritePointerEvent) {\r\n\t\tthis._isPointerDown = true;\r\n\t}\r\n\r\n\tprotected _handlePointerUp(_event: ISpritePointerEvent) {\r\n\t\tthis._isPointerDown = false;\r\n\t}\r\n\r\n\tpublic startIndex(): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tpublic endIndex(): number {\r\n\t\treturn this.dataItems.length;\r\n\t}\r\n\r\n\tprotected _setXLocation(dataItem: DataItem<this[\"_dataItemSettings\"]>, value: number) {\r\n\t\tif (!this.get(\"snapToData\")) {\r\n\t\t\tthis._setXLocationReal(dataItem, value);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdataItem.set(\"locationX\", undefined);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setXLocationReal(dataItem: DataItem<this[\"_dataItemSettings\"]>, value: number) {\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst baseInterval = xAxis.getPrivate(\"baseInterval\");\r\n\t\tconst root = this._root;\r\n\t\tconst firstDayOfWeek = root.locale.firstDayOfWeek;\r\n\t\tconst open = $time.round(new Date(value), baseInterval.timeUnit, baseInterval.count, firstDayOfWeek, root.utc, undefined, root.timezone).getTime();\r\n\t\tlet close = open + $time.getDuration(baseInterval.timeUnit, baseInterval.count * 1.05);\r\n\t\tclose = $time.round(new Date(close), baseInterval.timeUnit, baseInterval.count, firstDayOfWeek, root.utc, undefined, root.timezone).getTime();\r\n\t\tconst locationX = (value - open) / (close - open);\r\n\t\tdataItem.set(\"locationX\", locationX);\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\r\n\t\t\tthis.markDirtyValues();\r\n\r\n\t\t\tconst dataItems = this._di[index];\r\n\r\n\t\t\tif (dataItems) {\r\n\t\t\t\t$object.each(dataItems, (_key, dataItem) => {\r\n\t\t\t\t\tsuper.disposeDataItem(dataItem);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tdelete this._di[index];\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprotected _getYValue(value: number, valueX: number, doNotConvert?: boolean): number {\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\r\n\t\tif (this.get(\"snapToData\") && series) {\r\n\t\t\tconst field = this.get(\"field\", \"value\") + \"Y\";\r\n\t\t\treturn this._snap(valueX, value, field, series);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (!doNotConvert && this.get(\"valueYShow\") == \"valueYChangeSelectionPercent\") {\r\n\t\t\t\tconst baseValueSeries = this.getPrivate(\"baseValueSeries\");\r\n\t\t\t\tif (baseValueSeries) {\r\n\t\t\t\t\tconst baseValue = baseValueSeries._getBase(\"valueY\");\r\n\t\t\t\t\tvalue = value / 100 * baseValue + baseValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\t\t\tconst roundTo = yAxis.getPrivate(\"stepDecimalPlaces\", 0) + 1;\r\n\t\t\treturn $math.round(value, roundTo);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getXValue(value: number): number {\r\n\t\tconst series = this.get(\"series\");\r\n\t\tif (this.get(\"snapToData\") && series) {\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\tconst min = xAxis.getPrivate(\"min\", 0) + 1;\r\n\t\t\tconst max = xAxis.getPrivate(\"max\", 1) - 1;\r\n\r\n\t\t\tvalue = $math.fitToRange(value, min, max);\r\n\t\t\tvalue = this._snap(value, value, \"valueX\", series) + 1; // important!\r\n\t\t\treturn value\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn Math.round(value);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _setContext(dataItem: DataItem<IDrawingSeriesDataItem>, key: any, value: any, working?: boolean) {\r\n\t\tdataItem.set(key, value);\r\n\t\tif (working) {\r\n\t\t\tdataItem.set(key + \"Working\" as any, value);\r\n\t\t}\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\tconst field = this.get(key + \"Field\" as any);\r\n\t\tif (field) {\r\n\t\t\tdataContext[field] = value;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _snap(value: number, realValue: number, key: string, series: XYSeries): number {\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst dataItem = xAxis.getSeriesItem(series, Math.max(0, xAxis.valueToPosition(value)), 0.5, true);\r\n\t\tif (dataItem) {\r\n\t\t\treturn dataItem.get(key as any)!;\r\n\t\t}\r\n\t\treturn realValue;\r\n\t}\r\n\r\n\tprotected _getStockChart(): StockChart {\r\n\t\treturn (this.get(\"series\") as any).chart.getPrivate(\"stockChart\");\r\n\t}\r\n\r\n\r\n\tprotected _getSprite(sprites: ListTemplate<any>, index: number): Graphics | undefined {\r\n\t\tfor (let i = 0, len = sprites.length; i < len; i++) {\r\n\t\t\tlet sprite = sprites.getIndex(i);\r\n\t\t\tif (sprite && sprite.get(\"userData\") == index) {\r\n\t\t\t\treturn sprite;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tpublic _selectDrawing(index: number, keepSelection?: boolean, force?: boolean) {\r\n\t\tif (this._getStockChart().get(\"drawingSelectionEnabled\") || force) {\r\n\r\n\t\t\tthis._isSelecting = true;\r\n\r\n\t\t\tif (this._selected.indexOf(index) != -1) {\r\n\t\t\t\tif (!keepSelection) {\r\n\t\t\t\t\tthis.unselectAllDrawings();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._unselectDrawing(index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!keepSelection) {\r\n\t\t\t\t\tthis._hideResizer();\r\n\t\t\t\t\tthis.unselectAllDrawings();\r\n\t\t\t\t}\r\n\t\t\t\tlet selector = this._getSprite(this.selectors, index);\r\n\t\t\t\tif (!selector) {\r\n\t\t\t\t\tselector = this.selectorContainer.children.push(this.selectors.make() as Rectangle);\r\n\t\t\t\t\tthis.selectors.push(selector as Rectangle);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tselector.show(0);\r\n\r\n\t\t\t\tselector.set(\"userData\", index);\r\n\t\t\t\t$array.move(this._selected, index);\r\n\r\n\t\t\t\tthis._dispatchStockEvent(\"drawingselected\", this.indexToDrawingId(index), index);\r\n\t\t\t\tthis.markDirty();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _unselectDrawing(index: number) {\r\n\t\tconst selector = this._getSprite(this.selectors, index);\r\n\t\tif (selector) {\r\n\t\t\tselector.hide(0);\r\n\t\t\t$array.remove(this._selected, index);\r\n\t\t\tthis._dispatchStockEvent(\"drawingunselected\", this.indexToDrawingId(index), index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateSelectors() {\r\n\t\tthis.selectors.each((selector) => {\r\n\t\t\tconst index = selector.get(\"userData\")\r\n\t\t\tthis._updateSelector(selector, index);\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _updateSelector(selector: Graphics, index: number) {\r\n\t\tlet l!: number;\r\n\t\tlet r!: number;\r\n\t\tlet t!: number;\r\n\t\tlet b!: number;\r\n\r\n\t\tconst selectorPadding = this.get(\"selectorPadding\", 5);\r\n\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext) {\r\n\t\t\t\tif (dataContext.index == index) {\r\n\t\t\t\t\tlet point = dataItem.get(\"point\");\r\n\t\t\t\t\tif (point) {\r\n\t\t\t\t\t\tif (l == null) {\r\n\t\t\t\t\t\t\tl = point.x;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tl = Math.min(l, point.x);\r\n\r\n\t\t\t\t\t\tif (r == null) {\r\n\t\t\t\t\t\t\tr = point.x;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tr = Math.max(r, point.x);\r\n\r\n\t\t\t\t\t\tif (t == null) {\r\n\t\t\t\t\t\t\tt = point.y;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tt = Math.min(t, point.y);\r\n\r\n\t\t\t\t\t\tif (b == null) {\r\n\t\t\t\t\t\t\tb = point.y;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tb = Math.max(b, point.y);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tif (r != null && l != null && t != null && b != null) {\r\n\t\t\tselector.setAll({\r\n\t\t\t\twidth: r - l + selectorPadding * 2,\r\n\t\t\t\theight: b - t + selectorPadding * 2,\r\n\t\t\t\tx: l - selectorPadding,\r\n\t\t\t\ty: t - selectorPadding\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param index returns drawingId\r\n\t * @returns\r\n\t */\r\n\tpublic indexToDrawingId(index: number): string | undefined {\r\n\t\tlet id: string | undefined;\r\n\t\t$array.eachContinue(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext.index == index) {\r\n\t\t\t\tid = dataContext.drawingId;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t})\r\n\t\treturn id;\r\n\t}\r\n\r\n\tprotected _getContext(index: number): any {\r\n\t\tlet context: any;\r\n\t\t$array.eachContinue(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext.index == index && dataContext.sprite) {\r\n\t\t\t\tcontext = dataContext;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t})\r\n\t\treturn context;\r\n\t}\r\n\r\n\tpublic getContext(id: string) {\r\n\t\tconst index = this.getIndex(id);\r\n\t\tif (index != null) {\r\n\t\t\treturn this._getContext(index);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unselects all currently selected drawings on this series.\r\n\t *\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic unselectAllDrawings(): number {\r\n\t\tconst chart = this._getStockChart();\r\n\t\tif (chart) {\r\n\t\t\treturn chart.unselectDrawings();\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Unselects all currently selected drawings of this series.\r\n\t *\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic unselectDrawings(): number {\r\n\t\tlet count = 0;\r\n\t\tfor (let i = this._selected.length - 1; i >= 0; i--) {\r\n\t\t\tthis._unselectDrawing(this._selected[i]);\r\n\t\t\tcount++;\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\r\n\t/**\r\n\t * Selects series' drawing by its ID.\r\n\t *\r\n\t * @param  id             Drawing ID\r\n\t * @param  keepSelection  Keep existing selections\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic selectDrawing(id: string, keepSelection?: boolean) {\r\n\t\tconst index = this.getIndex(id);\r\n\t\tif (index != null) {\r\n\t\t\tthis._selectDrawing(index, keepSelection);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unselects series' drawing by its ID.\r\n\t *\r\n\t * @param  id  Drawing ID\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic unselectDrawing(id: string) {\r\n\t\tconst index = this.getIndex(id);\r\n\t\tif (index != null) {\r\n\t\t\tthis._unselectDrawing(index);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes all currently selected drawings on this series.\r\n\t *\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic deleteSelected() {\r\n\t\tfor (let i = this._selected.length - 1; i >= 0; i--) {\r\n\t\t\tthis.disposeIndex(this._selected[i]);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes a series' drawing by ids ID.\r\n\t *\r\n\t * @param  id  Drawing ID\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic deleteDrawing(id: string) {\r\n\t\tconst index = this.getIndex(id);\r\n\t\tif (index != null) {\r\n\t\t\tthis.disposeIndex(index);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Cancels current drawing\r\n\t *\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic cancelDrawing() {\r\n\t\tif (this._isDrawing) {\r\n\t\t\tthis._disposeIndex(this._index);\r\n\t\t}\r\n\r\n\t\tthis.isDrawing(false);\r\n\t}\r\n}\r\n","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\n\r\nimport { Line } from \"../../../core/render/Line\";\r\nimport { color } from \"../../../core/util/Color\";\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IPolylineSeriesDataItem extends IDrawingSeriesDataItem {\r\n}\r\n\r\nexport interface IPolylineSeriesSettings extends IDrawingSeriesSettings {\r\n\r\n\t/**\r\n\t * Show a closed color-filled shape instead of polyline.\r\n\t * \r\n\t * @default false\r\n\t * @since 5.9.0\r\n\t */\r\n\tfillShape?: boolean;\r\n\r\n\t/**\r\n\t * Number of pre-defined points in a shape.\r\n\t *\r\n\t * The shape will finish drawing once number is reached.\r\n\t * @since 5.9.0\r\n\t */\r\n\tpointCount?: number;\r\n}\r\n\r\nexport interface IPolylineSeriesPrivate extends IDrawingSeriesPrivate {\r\n}\r\n\r\n/**\r\n * Draws a multi-point line (polyline).\r\n */\r\nexport class PolylineSeries extends DrawingSeries {\r\n\tpublic static className: string = \"PolylineSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([PolylineSeries.className]);\r\n\r\n\tdeclare public _settings: IPolylineSeriesSettings;\r\n\tdeclare public _privateSettings: IPolylineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IPolylineSeriesDataItem;\r\n\r\n\tprotected _tag = \"polyline\";\r\n\r\n\tprotected _drawingLine: Line = this.mainContainer.children.push(Line.new(this._root, { forceInactive: true }));\r\n\r\n\tpublic _prepareChildren(): void {\r\n\t\tsuper._prepareChildren();\r\n\r\n\t\tthis.strokes.template.setAll({\r\n\t\t\tfill: color(0xffffff),\r\n\t\t\tfillOpacity: 0\r\n\t\t})\r\n\r\n\t\tif (this.isDirty(\"fillShape\")) {\r\n\t\t\tif (this.get(\"fillShape\")) {\r\n\t\t\t\tthis.fills.template.setAll({\r\n\t\t\t\t\tvisible: true,\r\n\t\t\t\t\tforceHidden: false,\r\n\t\t\t\t\tfillOpacity: this.get(\"fillOpacity\"),\r\n\t\t\t\t\tfill: this.get(\"fillColor\")\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.fills.template.setAll({\r\n\t\t\t\t\tvisible: false\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (this._drawingEnabled) {\r\n\t\t\tsuper._handlePointerClick(event);\r\n\r\n\t\t\tif (event.target.get(\"userData\") == \"grip\") {\r\n\t\t\t\tthis._endPolyline(event.target.dataItem as DataItem<this[\"_dataItemSettings\"]>);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!this._isDragging) {\r\n\t\t\t\t\tthis.isDrawing(true);\r\n\t\t\t\t\tthis._hideResizer(event.target);\r\n\t\t\t\t\tif (this.unselectAllDrawings() == 0) {\r\n\t\t\t\t\t\t// for consistency with other series\r\n\t\t\t\t\t\tif (this._index == 0) {\r\n\t\t\t\t\t\t\tthis._index = 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._pIndex == 0) {\r\n\t\t\t\t\t\t\tthis._increaseIndex();\r\n\t\t\t\t\t\t\tconst context = { stroke: this._getStrokeTemplate(), fill: this._getFillTemplate(), index: this._index, corner: \"e\", drawingId: this._drawingId };\r\n\t\t\t\t\t\t\tthis._setContextSprite(context);\r\n\t\t\t\t\t\t\tthis.data.push(context);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._drawingLine.show();\r\n\t\t\t\t\t\tthis._addPoint(event);\r\n\r\n\t\t\t\t\t\t// add one more if fill\r\n\t\t\t\t\t\tif (this.get(\"fillShape\")) {\r\n\t\t\t\t\t\t\tif (this._pIndex == 1) {\r\n\t\t\t\t\t\t\t\tthis._addPoint(event, true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (this._pIndex > 1) {\r\n\t\t\t\t\t\t\t\tthis.data.moveValue(this.data.getIndex(this.data.length - 1), this.data.length - 2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._pIndex - 1 == this.get(\"pointCount\", 1000)) {\r\n\t\t\t\t\t\t\tthis._endPolyline();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._drawingLine.set(\"stroke\", this.get(\"strokeColor\"));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setContextSprite(context: any) {\r\n\t\tcontext.sprite = this.mainContainer;\r\n\t}\r\n\r\n\tpublic disableDrawing() {\r\n\t\tsuper.disableDrawing();\r\n\t\tthis._endPolyline();\r\n\t}\r\n\r\n\tpublic clearDrawings(): void {\r\n\t\tsuper.clearDrawings();\r\n\t\tthis._drawingLine.hide();\r\n\t}\r\n\r\n\tprotected _addPoint(event: ISpritePointerEvent, closing?: boolean) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\r\n\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(point.x)));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)), valueX);\r\n\r\n\t\t\tconst dataItems = this.dataItems;\r\n\t\t\tconst len = dataItems.length;\r\n\r\n\t\t\tthis.data.push({ valueY: valueY, valueX: valueX, index: this._index, corner: this._pIndex, drawingId: this._drawingId, closing: closing });\r\n\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\r\n\t\t\tconst dataItem = dataItems[len];\r\n\t\t\tthis._positionBullets(dataItem);\r\n\t\t\tthis._setXLocation(dataItem, valueX);\r\n\r\n\t\t\tthis._pIndex++;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _endPolyline(dataItem?: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tif (!dataItem) {\r\n\t\t\tdataItem = this.dataItems[this.dataItems.length - 1];\r\n\t\t}\r\n\r\n\t\tif (dataItem) {\r\n\t\t\tthis._pIndex = 0;\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\t\tconst index = dataContext.index;\r\n\r\n\t\t\tif (dataContext.corner == 0) {\r\n\t\t\t\tthis.data.push({ valueX: dataItem.get(\"valueX\"), valueY: dataItem.get(\"valueY\"), index: index, corner: \"c\", closing: true, drawingId: this._drawingId })\r\n\r\n\t\t\t\tconst dataItems = this.dataItems;\r\n\t\t\t\tconst len = dataItems.length - 1;\r\n\r\n\t\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\r\n\t\t\t\tdataItem = dataItems[len];\r\n\t\t\t\tthis._positionBullets(dataItem);\r\n\t\t\t\tthis._setXLocation(dataItem, dataItem.get(\"valueX\", 0));\r\n\t\t\t}\r\n\r\n\t\t\tthis._drawingLine.hide();\r\n\r\n\t\t\tthis.isDrawing(false);\r\n\t\t\tthis._dispatchAdded();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispatchAdded(): void {\r\n\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerMove(event);\r\n\t\tif (this._isDrawing) {\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (movePoint) {\r\n\t\t\t\tconst dataItems = this.dataItems;\r\n\t\t\t\tconst len = dataItems.length;\r\n\t\t\t\tif (len > 0) {\r\n\t\t\t\t\tconst lastItem = dataItems[len - 1];\r\n\t\t\t\t\tconst points: Array<IPoint> = [];\r\n\r\n\t\t\t\t\tconst point = lastItem.get(\"point\");\r\n\t\t\t\t\tif (point) {\r\n\t\t\t\t\t\tpoints.push(point);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpoints.push(movePoint);\r\n\r\n\t\t\t\t\tif (this.get(\"fillShape\")) {\r\n\t\t\t\t\t\tconst bLastItem = dataItems[len - 2];\r\n\t\t\t\t\t\tif (bLastItem) {\r\n\t\t\t\t\t\t\tconst bPoint = bLastItem.get(\"point\");\r\n\t\t\t\t\t\t\tif (bPoint) {\r\n\t\t\t\t\t\t\t\tpoints.push(bPoint);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (points.length > 1) {\r\n\t\t\t\t\t\tthis._drawingLine.set(\"points\", points);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateElements() {\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext) {\r\n\t\t\t\tconst closing = dataContext.closing;\r\n\t\t\t\tif (closing) {\r\n\t\t\t\t\tif (this._di[dataContext.index]) {\r\n\t\t\t\t\t\tconst closingDataItem = this._di[dataContext.index][0];\r\n\t\t\t\t\t\tconst valueX = closingDataItem.get(\"valueX\", 0);\r\n\t\t\t\t\t\tconst valueY = closingDataItem.get(\"valueY\");\r\n\r\n\t\t\t\t\t\tthis._setContext(dataItem, \"valueX\", valueX);\r\n\t\t\t\t\t\tthis._setContext(dataItem, \"valueY\", valueY, true);\r\n\r\n\t\t\t\t\t\tthis._setXLocation(dataItem, valueX);\r\n\t\t\t\t\t\tthis._positionBullets(dataItem);\r\n\r\n\t\t\t\t\t\tconst bullets = dataItem.bullets;\r\n\t\t\t\t\t\tif (bullets) {\r\n\t\t\t\t\t\t\t$array.each(bullets, (bullet) => {\r\n\t\t\t\t\t\t\t\tconst sprite = bullet.get(\"sprite\");\r\n\t\t\t\t\t\t\t\tif (sprite) {\r\n\t\t\t\t\t\t\t\t\tsprite.set(\"forceHidden\", true);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * Cancels current drawing\r\n\t *\r\n\t * @since 5.9.0\r\n\t */\r\n\tpublic cancelDrawing() {\r\n\t\tsuper.cancelDrawing();\r\n\t\tthis._drawingLine.hide(0);\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\n\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\nimport { Line } from \"../../../core/render/Line\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport * as $math from \"../../../core/util/Math\";\r\n\r\n\r\nexport interface ISimpleLineSeriesDataItem extends IDrawingSeriesDataItem {\r\n}\r\n\r\nexport interface ISimpleLineSeriesSettings extends IDrawingSeriesSettings {\r\n\r\n\t/**\r\n\t * Show a dotted line extending from both ends of the drawn line.\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tshowExtension?: boolean;\r\n}\r\n\r\nexport interface ISimpleLineSeriesPrivate extends IDrawingSeriesPrivate {\r\n}\r\n\r\nexport class SimpleLineSeries extends DrawingSeries {\r\n\tpublic static className: string = \"SimpleLineSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([SimpleLineSeries.className]);\r\n\r\n\tdeclare public _settings: ISimpleLineSeriesSettings;\r\n\tdeclare public _privateSettings: ISimpleLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ISimpleLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"line\";\r\n\tprotected _updateExtension = false;\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeLine(): Line {\r\n\t\tconst line = this.lines.make();\r\n\t\tthis.mainContainer.children.push(line);\r\n\t\tthis.lines.push(line);\r\n\t\treturn line;\r\n\t}\r\n\r\n\tpublic readonly lines: ListTemplate<Line> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Line._new(this._root, {}, [this.lines.template])\r\n\t));\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeHitLine(): Line {\r\n\t\tconst line = this.hitLines.make();\r\n\t\tline.addTag(\"hit\");\r\n\t\tthis.mainContainer.children.push(line);\r\n\t\tthis.hitLines.push(line);\r\n\t\treturn line;\r\n\t}\r\n\r\n\tpublic readonly hitLines: ListTemplate<Line> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Line._new(this._root, {}, [this.hitLines.template])\r\n\t));\r\n\r\n\tprotected _di: Array<{ [index: string]: DataItem<ISimpleLineSeriesDataItem> }> = [];\r\n\tprotected _lines: Array<Line> = [];\r\n\tprotected _hitLines: Array<Line> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tconst lineTemplate = this.lines.template;\r\n\t\tlineTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tthis._showSegmentBullets(e.target.get(\"userData\"));\r\n\t\t})\r\n\r\n\t\tthis.strokes.template.set(\"forceInactive\", true);\r\n\r\n\t\tlineTemplate.events.on(\"pointerout\", (e) => {\r\n\t\t\t//this._hideAllBullets();\r\n\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\r\n\t\t\tconst line = this._lines[index];\r\n\t\t\tif (line) {\r\n\t\t\t\tline.unhover();\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.unhover();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tconst hitTemplate = this.hitLines.template;\r\n\t\thitTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\t\t\tthis._showSegmentBullets(index);\r\n\r\n\t\t\tconst line = this._lines[index];\r\n\r\n\t\t\tif (line) {\r\n\t\t\t\tline.hover();\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.hover();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\thitTemplate.events.on(\"click\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tthis._disposeIndex(index);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._selectDrawing(index, (e.originalEvent as any).ctrlKey);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\thitTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\t\t\tconst line = this._lines[index];\r\n\r\n\t\t\tif (line) {\r\n\t\t\t\tline.dragStart(e);\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.dragStart(e);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\thitTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\r\n\t\t\tthis.markDirtyValues();\r\n\t\t\te.target.setAll({ x: 0, y: 0 });\r\n\t\t\tconst line = this._lines[index];\r\n\r\n\t\t\tif (line) {\r\n\t\t\t\tline.dragStop(e);\r\n\t\t\t\tline.setAll({ x: 0, y: 0 });\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.dragStop(e);\r\n\t\t\t\tstroke.setAll({ x: 0, y: 0 });\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\thitTemplate.events.on(\"pointerout\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\t\t\t//this._hideAllBullets();\r\n\r\n\t\t\tconst line = this._lines[index];\r\n\r\n\t\t\tif (line) {\r\n\t\t\t\tline.unhover();\r\n\t\t\t}\r\n\r\n\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\tif (stroke) {\r\n\t\t\t\tstroke.unhover();\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tprotected _updateElements() {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst s = Math.max(chart.plotContainer.width(), chart.plotContainer.height()) * 2;\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\r\n\t\t\t\t\tif (diP1 && diP2) {\r\n\r\n\t\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\t\tconst len = Math.max(Math.abs(s - p1.x), Math.abs(s - p2.x), Math.abs(s - p1.y), Math.abs(s - p2.y), Math.abs(p1.x), Math.abs(p2.x), Math.abs(p1.y), Math.abs(p2.y))\r\n\t\t\t\t\t\t\tlet angle = $math.getAngle(p2, p1);\r\n\r\n\t\t\t\t\t\t\tconst p11 = { x: p1.x + len * $math.cos(angle), y: p1.y + len * $math.sin(angle) };\r\n\t\t\t\t\t\t\tconst p22 = { x: p2.x - len * $math.cos(angle), y: p2.y - len * $math.sin(angle) };\r\n\r\n\t\t\t\t\t\t\tthis._updateLine(i, p11, p22, p1, p2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateLine(index: number, p11: IPoint, p22: IPoint, p1: IPoint, p2: IPoint) {\r\n\t\tconst line = this._lines[index];\r\n\t\tconst hitLine = this._hitLines[index];\r\n\r\n\t\tlet segments = [[[p11, p1]], [[p2, p22]]];\r\n\t\tlet hitSegments = [[[p11, p22]]];\r\n\r\n\t\tline.set(\"segments\", segments);\r\n\t\thitLine.set(\"segments\", hitSegments);\r\n\t}\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (!this._isDragging && !this._isSelecting) {\r\n\r\n\t\t\tif (!this._isDrawing) {\r\n\t\t\t\tif (this.unselectAllDrawings() == 0) {\r\n\t\t\t\t\tthis.isDrawing(true);\r\n\t\t\t\t\tthis._increaseIndex();\r\n\t\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t\t}\r\n\t\t\t\tthis._hideResizer(event.target);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.isDrawing(false);\r\n\t\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (this._drawingEnabled) {\r\n\t\t\tsuper._handlePointerClick(event);\r\n\t\t\tthis._handlePointerClickReal(event);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerMove(event);\r\n\t\tthis._handlePointerMoveReal(event);\r\n\t}\r\n\r\n\r\n\tprotected _handlePointerMoveReal(_event: ISpritePointerEvent) {\r\n\t\tif (this._isDrawing) {\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\t\t\tconst index = this._index;\r\n\t\t\tconst dataItems = this._di[index];\r\n\r\n\t\t\tif (movePoint && dataItems) {\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\t\tconst valueXns = xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)); // not snapped\r\n\r\n\t\t\t\tconst valueX = this._getXValue(valueXns);\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)), valueXns);\r\n\r\n\t\t\t\tconst diP1 = dataItems[\"p1\"];\r\n\t\t\t\tconst diP2 = dataItems[\"p2\"];\r\n\r\n\t\t\t\tif (diP1 && diP2) {\r\n\t\t\t\t\tthis._setContext(diP2, \"valueX\", valueX, true);\r\n\t\t\t\t\tthis._setContext(diP2, \"valueY\", valueY, true);\r\n\t\t\t\t\tthis._setXLocation(diP1, diP1.get(\"valueX\", 0));\r\n\t\t\t\t\tthis._setXLocation(diP2, valueX);\r\n\t\t\t\t\tthis._updateSegment(index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _createElements(index: number) {\r\n\t\tif (!this._lines[index]) {\r\n\t\t\tconst line = this.makeLine();\r\n\t\t\tthis._lines[index] = line;\r\n\r\n\t\t\tconst hitLine = this.makeHitLine();\r\n\t\t\tthis._hitLines[index] = hitLine;\r\n\r\n\t\t\tconst dataContext = this.dataItems[this.dataItems.length - 1].dataContext as any;\r\n\t\t\tdataContext.sprite = line;\r\n\r\n\t\t\tlet showExtension = this.get(\"showExtension\", true);\r\n\r\n\t\t\tlet color = this.get(\"strokeColor\", this.get(\"stroke\"));\r\n\r\n\t\t\tconst strokeTemplate = dataContext.stroke;\r\n\t\t\tif (strokeTemplate) {\r\n\t\t\t\tcolor = strokeTemplate.get(\"stroke\");\r\n\t\t\t}\r\n\r\n\t\t\tif (dataContext) {\r\n\t\t\t\tshowExtension = dataContext.showExtension;\r\n\t\t\t}\r\n\r\n\t\t\tline.setPrivate(\"visible\", showExtension);\r\n\r\n\t\t\tconst settings = { stroke: color, userData: index };\r\n\t\t\tline.setAll(settings);\r\n\t\t\thitLine.setAll(settings);\r\n\r\n\t\t\tthis._updateSegment(index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addTemplates(index: number) {\r\n\t\tthis.data.push({ stroke: this._getStrokeTemplate(), fill: this._getFillTemplate(), index: index, showExtension: this.get(\"showExtension\", true), corner: \"e\", drawingId: this._drawingId });\r\n\t}\r\n\r\n\tpublic addPoints(point: IPoint, index: number) {\r\n\t\tconst chart = this.chart!;\r\n\t\tthis._addTemplates(index);\r\n\t\tpoint = chart.plotContainer.toLocal(point);\r\n\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\tconst valueYns = xAxis.positionToValue(xAxis.coordinateToPosition(point.x));\r\n\t\tconst valueX = this._getXValue(valueYns);\r\n\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)), valueYns);\r\n\r\n\t\tthis._addPointsReal(valueX, valueY, index);\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number) {\r\n\t\tthis.addPoints(event.point, index);\r\n\t}\r\n\r\n\tprotected _addPointsReal(valueX: number, valueY: number, index: number) {\r\n\t\tthis._addPoint(valueX, valueY, \"p1\", index);\r\n\t\tthis._addPoint(valueX, valueY, \"p2\", index);\r\n\t}\r\n\r\n\tprotected _addPoint(valueX: number, valueY: number, corner: string, index: number) {\r\n\t\tthis.data.push({ valueY: valueY, valueX: valueX, corner: corner, index: index, drawingId: this._drawingId });\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst line = this._lines[index];\r\n\t\t\tif (line) {\r\n\t\t\t\tthis.lines.removeValue(line);\r\n\t\t\t\tdelete (this._lines[index]);\r\n\t\t\t\tline.dispose();\r\n\t\t\t}\r\n\t\t\tconst hitLine = this._hitLines[index];\r\n\t\t\tif (hitLine) {\r\n\t\t\t\tthis.hitLines.removeValue(hitLine);\r\n\t\t\t\tdelete (this._hitLines[index]);\r\n\t\t\t\thitLine.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setInteractive(value: boolean) {\r\n\t\tsuper.setInteractive(value);\r\n\t\tthis.hitLines.template.set(\"forceInactive\", !value);\r\n\t\tthis.lines.template.set(\"forceInactive\", !value);\r\n\t}\r\n\r\n\tpublic enableDrawingSelection(value: boolean) {\r\n\t\tsuper.enableDrawingSelection(value);\r\n\t\tthis.hitLines.template.set(\"forceInactive\", !value);\r\n\t\tthis.lines.template.set(\"forceInactive\", !value);\r\n\t\tthis.strokes.template.set(\"forceInactive\", true);\r\n\t}\r\n\r\n\tprotected _applySettings(index: number, settings?: { [index: string]: any }) {\r\n\t\tsuper._applySettings(index, settings);\r\n\t\tlet context = this._getContext(index);\r\n\r\n\t\tif (context) {\r\n\t\t\tlet line = context.sprite;\r\n\r\n\t\t\tif (line && settings && settings.stroke) {\r\n\t\t\t\tline.set(\"stroke\", settings.stroke)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a line drawing.\r\n\t *\r\n\t * Supported tools: `\"Horizontal Line\"`, `\"Horizontal Ray\"`, `\"Vertical Line\"`.\r\n\t *\r\n\t * @param  point Point\r\n\t * @since 5.10.2\r\n\t */\r\n\tpublic addLine(point: IPoint): void {\r\n\t\tthis._increaseIndex();\r\n\t\tthis.addPoints(point, this._index);\r\n\t\tthis._updateSegment(this._index);\r\n\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t}\r\n}\r\n","import type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Graphics } from \"../../../core/render/Graphics\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IRectangleSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IRectangleSeriesSettings extends ISimpleLineSeriesSettings {\r\n}\r\n\r\nexport interface IRectangleSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class RectangleSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"RectangleSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([RectangleSeries.className]);\r\n\r\n\tdeclare public _settings: IRectangleSeriesSettings;\r\n\tdeclare public _privateSettings: IRectangleSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IRectangleSeriesDataItem;\r\n\r\n\tprotected _di: Array<{ [index: string]: DataItem<IRectangleSeriesDataItem> }> = []\r\n\r\n\tprotected _tag = \"rectangle\";\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\r\n\t\tif (series && diP1 && diP2) {\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tlet y1 = diP1.get(field as any);\r\n\t\t\tlet y2 = diP2.get(field as any);\r\n\r\n\t\t\tthis._setContext(diP1, \"valueY\", y1, true);\r\n\t\t\tthis._setContext(diP2, \"valueY\", y2, true);\r\n\r\n\t\t\tthis._positionBullets(diP1);\r\n\t\t\tthis._positionBullets(diP2);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setXLocation(dataItem: DataItem<this[\"_dataItemSettings\"]>, value: number) {\r\n\t\tif (!this.get(\"snapToData\")) {\r\n\t\t\tthis._setXLocationReal(dataItem, value);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdataItem.set(\"locationX\", 0);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\t\tconst chart = this.chart;\r\n\t\tthis.fills.clear();\r\n\t\tif (chart) {\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\t\t\t\t\tconst di = this._di[i][\"e\"];\r\n\r\n\t\t\t\t\tconst dataContext = di.dataContext as any;\r\n\t\t\t\t\tconst fillGraphics = this.makeFill(this.fills);\r\n\r\n\t\t\t\t\tconst index = this.dataItems.indexOf(diP1);\r\n\t\t\t\t\tfor (let j = index; j >= 0; j--) {\r\n\t\t\t\t\t\tconst dataContext = this.dataItems[j].dataContext as any;\r\n\t\t\t\t\t\tconst template = dataContext.fill;\r\n\t\t\t\t\t\tif (template) {\r\n\t\t\t\t\t\t\tfillGraphics.template = template;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst userData = [this.dataItems.indexOf(diP1), this.dataItems.indexOf(diP2)];\r\n\r\n\t\t\t\t\tlet fillColor = this.get(\"fillColor\", this.get(\"fill\"));\r\n\r\n\t\t\t\t\tconst fillTemplate = dataContext.fill;\r\n\r\n\t\t\t\t\tif (fillTemplate) {\r\n\t\t\t\t\t\tfillColor = fillTemplate.get(\"fill\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst settings = { userData: userData, fill: fillColor };\r\n\t\t\t\t\tfillGraphics.setAll(settings);\r\n\r\n\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\tfillGraphics.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p1.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p1.x, p2.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p1.x, p1.y);\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tconst strokeGraphics = this.strokes.getIndex(this._getStrokeIndex(i));\r\n\r\n\t\t\t\t\t\tif (strokeGraphics) {\r\n\t\t\t\t\t\t\tstrokeGraphics.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p1.y);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p1.x, p2.y);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p1.x, p1.y);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._updateOthers(i, fillGraphics, p1, p2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateOthers(_index: number, _fillGraphics: Graphics, _p1: IPoint, _p2: IPoint) {\r\n\r\n\t}\r\n\r\n\tprotected _drawFill() {\r\n\r\n\t}\r\n\r\n\tprotected _updateLine() {\r\n\r\n\t}\r\n}","import type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Graphics } from \"../../../core/render/Graphics\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\nimport type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IParallelChannelSeriesDataItem extends ISimpleLineSeriesDataItem { }\r\n\r\nexport interface IParallelChannelSeriesSettings extends ISimpleLineSeriesSettings { }\r\n\r\nexport interface IParallelChannelSeriesPrivate extends ISimpleLineSeriesPrivate { }\r\n\r\nexport class ParallelChannelSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"ParallelChannelSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([ParallelChannelSeries.className]);\r\n\r\n\tdeclare public _settings: IParallelChannelSeriesSettings;\r\n\tdeclare public _privateSettings: IParallelChannelSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IParallelChannelSeriesDataItem;\r\n\r\n\tprotected _di: Array<{ [index: string]: DataItem<IParallelChannelSeriesDataItem> }> = []\r\n\tprotected _tag = \"parallelchannel\";\r\n\r\n\tprotected _firstClick: boolean = false;\r\n\r\n\tprotected _addPointsReal(valueX: number, valueY: number, index: number) {\r\n\t\tthis._addPoint(valueX, valueY, \"p1\", index);\r\n\t\tthis._addPoint(valueX, valueY, \"p2\", index);\r\n\t\tthis._addPoint(valueX, valueY, \"p3\", index);\r\n\t\tthis._addPoint(valueX, valueY, \"p4\", index);\r\n\r\n\t\tthis._addPoint(valueX, valueY, \"m1\", index);\r\n\t\tthis._addPoint(valueX, valueY, \"m2\", index);\r\n\t}\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (!this._isDragging) {\r\n\t\t\tif (!this._isDrawing) {\r\n\t\t\t\tif (!this._firstClick) {\r\n\t\t\t\t\tif(this.unselectDrawings() == 0){\r\n\t\t\t\t\t\tthis.isDrawing(true);\r\n\t\t\t\t\t\tthis._hideResizer(event.target);\r\n\t\t\t\t\t\tthis._increaseIndex();\r\n\t\t\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t\t\t\tthis._firstClick = true;\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!this._firstClick) {\r\n\t\t\t\t\tthis.isDrawing(false);\r\n\t\t\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId);\r\n\t\t\t\t}\r\n\t\t\t\tthis._firstClick = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprotected _handlePointerMoveReal(_event: ISpritePointerEvent) {\r\n\t\tif (this._isDrawing) {\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (movePoint) {\r\n\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)), valueX);\r\n\r\n\t\t\t\tconst index = this._index;\r\n\r\n\t\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\t\t\tconst diP3 = this._di[index][\"p3\"];\r\n\t\t\t\tconst diP4 = this._di[index][\"p4\"];\r\n\r\n\t\t\t\tconst diM1 = this._di[index][\"m1\"];\r\n\t\t\t\tconst diM2 = this._di[index][\"m2\"];\r\n\r\n\t\t\t\tif (diP1 && diP2) {\r\n\t\t\t\t\tif (this._firstClick) {\r\n\t\t\t\t\t\tthis._setContext(diP2, \"valueX\", valueX);\r\n\t\t\t\t\t\tthis._setContext(diP2, \"valueY\", valueY, true);\r\n\t\t\t\t\t\tthis._setXLocation(diP1, diP1.get(\"valueX\", 0));\r\n\t\t\t\t\t\tthis._setXLocation(diP3, diP3.get(\"valueX\", 0));\r\n\t\t\t\t\t\tthis._setXLocation(diP2, valueX);\r\n\r\n\t\t\t\t\t\tthis._setContext(diP4, \"valueX\", valueX);\r\n\t\t\t\t\t\tthis._setContext(diP4, \"valueY\", valueY, true);\r\n\t\t\t\t\t\tthis._setXLocation(diP4, valueX);\r\n\r\n\t\t\t\t\t\tthis._setContext(diM1, \"valueX\", valueX);\r\n\t\t\t\t\t\tthis._setContext(diM1, \"valueY\", valueY, true);\r\n\t\t\t\t\t\tthis._setXLocation(diM1, valueX);\r\n\r\n\t\t\t\t\t\tthis._setContext(diM2, \"valueX\", valueX);\r\n\t\t\t\t\t\tthis._setContext(diM2, \"valueY\", valueY, true);\r\n\t\t\t\t\t\tthis._setXLocation(diM2, valueX);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis._setContext(diP4, \"valueY\", valueY, true);\r\n\t\t\t\t\t\tthis._setContext(diP3, \"valueY\", diP1.get(\"valueY\", 0) + valueY - diP2.get(\"valueY\", 0), true);\r\n\r\n\t\t\t\t\t\tthis._updateMiddlePoints(index);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._updateSegment(index);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateMiddlePoints(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst diP3 = this._di[index][\"p3\"];\r\n\t\tconst diP4 = this._di[index][\"p4\"];\r\n\r\n\t\tconst diM1 = this._di[index][\"m1\"];\r\n\t\tconst diM2 = this._di[index][\"m2\"];\r\n\r\n\t\tconst valueX1 = diP1.get(\"valueX\", 0);\r\n\t\tconst valueX2 = diP2.get(\"valueX\", 0);\r\n\t\tconst valueX3 = diP3.get(\"valueX\", 0);\r\n\t\tconst valueX4 = diP4.get(\"valueX\", 0);\r\n\r\n\t\tconst valueY1 = diP1.get(\"valueY\", 0);\r\n\t\tconst valueY2 = diP2.get(\"valueY\", 0);\r\n\t\tconst valueY3 = diP3.get(\"valueY\", 0);\r\n\t\tconst valueY4 = diP4.get(\"valueY\", 0);\r\n\r\n\t\tconst xM1 = Math.round(valueX1 + (valueX2 - valueX1) / 2);\r\n\r\n\t\tthis._setContext(diM1, \"valueY\", valueY1 + (valueY2 - valueY1) / 2, true);\r\n\t\tthis._setContext(diM1, \"valueX\", xM1, true);\r\n\t\tthis._setXLocation(diM1, xM1);\r\n\r\n\t\tconst xM2 = valueX3 + (valueX4 - valueX3) / 2;\r\n\t\tthis._setContext(diM2, \"valueY\", valueY3 + (valueY4 - valueY3) / 2, true);\r\n\t\tthis._setContext(diM2, \"valueX\", xM2, true);\r\n\t\tthis._setXLocation(diM2, xM2);\r\n\r\n\t\tif (diM1.bullets) {\r\n\t\t\tconst mBullet = diM1.bullets[0].get(\"sprite\");\r\n\t\t\tif (mBullet) {\r\n\t\t\t\tconst point1 = diP1.get(\"point\");\r\n\t\t\t\tconst point2 = diP2.get(\"point\");\r\n\t\t\t\tif (point1 && point2) {\r\n\t\t\t\t\tmBullet.set(\"x\", point1.x + (point2.x - point1.x) / 2);\r\n\t\t\t\t\tmBullet.set(\"y\", point1.y + (point2.y - point1.y) / 2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (diM2.bullets) {\r\n\t\t\tconst mBullet = diM2.bullets[0].get(\"sprite\");\r\n\t\t\tif (mBullet) {\r\n\t\t\t\tconst point1 = diP3.get(\"point\");\r\n\t\t\t\tconst point2 = diP4.get(\"point\");\r\n\t\t\t\tif (point1 && point2) {\r\n\t\t\t\t\tmBullet.set(\"x\", point1.x + (point2.x - point1.x) / 2);\r\n\t\t\t\t\tmBullet.set(\"y\", point1.y + (point2.y - point1.y) / 2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\t\tconst chart = this.chart;\r\n\t\tthis.fills.clear();\r\n\t\tif (chart) {\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\t\t\t\t\tconst diP3 = this._di[i][\"p3\"];\r\n\t\t\t\t\tconst diP4 = this._di[i][\"p4\"];\r\n\t\t\t\t\tconst di = this._di[i][\"e\"];\r\n\r\n\t\t\t\t\tconst dataContext = di.dataContext as any;\r\n\t\t\t\t\tconst fillGraphics = this.makeFill(this.fills);\r\n\r\n\t\t\t\t\tconst index = this.dataItems.indexOf(diP1);\r\n\t\t\t\t\tfor (let j = index; j >= 0; j--) {\r\n\t\t\t\t\t\tconst dataContext = this.dataItems[j].dataContext as any;\r\n\t\t\t\t\t\tconst template = dataContext.fill;\r\n\t\t\t\t\t\tif (template) {\r\n\t\t\t\t\t\t\tfillGraphics.template = template;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst userData = [this.dataItems.indexOf(diP1), this.dataItems.indexOf(diP2)];\r\n\r\n\t\t\t\t\tlet fillColor = this.get(\"fillColor\", this.get(\"fill\"));\r\n\r\n\t\t\t\t\tconst fillTemplate = dataContext.fill;\r\n\r\n\t\t\t\t\tif (fillTemplate) {\r\n\t\t\t\t\t\tfillColor = fillTemplate.get(\"fill\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst settings = { userData: userData, fill: fillColor };\r\n\t\t\t\t\tfillGraphics.setAll(settings);\r\n\r\n\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\t\t\t\t\tconst p3 = diP3.get(\"point\");\r\n\t\t\t\t\tconst p4 = diP4.get(\"point\");\r\n\r\n\t\t\t\t\tif (p1 && p2 && p3 && p4) {\r\n\t\t\t\t\t\tfillGraphics.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p4.x, p4.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p3.x, p3.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p1.x, p1.y);\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tconst strokeGraphics = this.strokes.getIndex(this._getStrokeIndex(i));\r\n\r\n\t\t\t\t\t\tif (strokeGraphics) {\r\n\t\t\t\t\t\t\tstrokeGraphics.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y);\r\n\r\n\t\t\t\t\t\t\t\tdisplay.moveTo(p3.x, p3.y);\r\n\t\t\t\t\t\t\t\tdisplay.lineTo(p4.x, p4.y);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tline.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y + (p3.y - p1.y) / 2);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y + (p4.y - p2.y) / 2);\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tthis._updateOthers(i, fillGraphics, p1, p2);\r\n\t\t\t\t\t\tthis._updateMiddlePoints(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletDraggedReal(dataItem: DataItem<this[\"_dataItemSettings\"]>, point: IPoint) {\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tconst index = dataContext.index;\r\n\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\t\tconst diP3 = this._di[index][\"p3\"];\r\n\t\tconst diP4 = this._di[index][\"p4\"];\r\n\t\tconst diM1 = this._di[index][\"m1\"];\r\n\t\tconst diM2 = this._di[index][\"m2\"];\r\n\r\n\t\tif (diP1 && diP2 && diP3 && diP4) {\r\n\r\n\t\t\tconst dy = diP3.get(\"valueY\", 0) - diP1.get(\"valueY\", 0);\r\n\t\t\tconst dy1 = diP2.get(\"valueY\", 0) - diP1.get(\"valueY\", 0);\r\n\t\t\tconst dy2 = diP4.get(\"valueY\", 0) - diP3.get(\"valueY\", 0);\r\n\r\n\t\t\tconst vx = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(point.x)));\r\n\t\t\tconst vy = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)), vx);\r\n\r\n\t\t\tthis._setContext(dataItem, \"valueX\", vx);\r\n\t\t\tthis._setContext(dataItem, \"valueY\", vy, true);\r\n\t\t\tthis._setXLocation(dataItem, vx);\r\n\r\n\t\t\tconst corner = dataContext.corner;\r\n\r\n\t\t\tif (corner == \"p1\") {\r\n\t\t\t\tthis._setContext(diP3, \"valueX\", vx);\r\n\t\t\t\tthis._setContext(diP3, \"valueY\", vy + dy, true);\r\n\t\t\t\tthis._setXLocation(diP3, vx);\r\n\t\t\t}\r\n\t\t\telse if (corner == \"p3\") {\r\n\t\t\t\tthis._setContext(diP1, \"valueX\", vx);\r\n\t\t\t\tthis._setContext(diP1, \"valueY\", vy - dy, true);\r\n\t\t\t\tthis._setXLocation(diP1, vx);\r\n\t\t\t}\r\n\t\t\telse if (corner == \"p2\") {\r\n\t\t\t\tthis._setContext(diP4, \"valueX\", vx);\r\n\t\t\t\tthis._setContext(diP4, \"valueY\", vy + dy, true);\r\n\t\t\t\tthis._setXLocation(diP4, vx);\r\n\t\t\t}\r\n\t\t\telse if (corner == \"p4\") {\r\n\t\t\t\tthis._setContext(diP2, \"valueX\", vx);\r\n\t\t\t\tthis._setContext(diP2, \"valueY\", vy - dy, true);\r\n\t\t\t\tthis._setXLocation(diP2, vx);\r\n\t\t\t}\r\n\t\t\telse if (corner == \"m1\") {\r\n\t\t\t\tthis._setContext(diP1, \"valueY\", vy - dy1 / 2, true);\r\n\t\t\t\tthis._setContext(diP2, \"valueY\", vy + dy1 / 2, true);\r\n\t\t\t}\r\n\t\t\telse if (corner == \"m2\") {\r\n\t\t\t\tthis._setContext(diP3, \"valueY\", vy - dy2 / 2, true);\r\n\t\t\t\tthis._setContext(diP4, \"valueY\", vy + dy2 / 2, true);\r\n\t\t\t}\r\n\t\t\tthis._updateMiddlePoints(index);\r\n\t\t}\r\n\t\tthis._positionBullets(diP1);\r\n\t\tthis._positionBullets(diP2);\r\n\t\tthis._positionBullets(diP3);\r\n\t\tthis._positionBullets(diP4);\r\n\t\tthis._positionBullets(diM1);\r\n\t\tthis._positionBullets(diM2);\r\n\t}\r\n\r\n\tprotected _updateOthers(_index: number, _fillGraphics: Graphics, _p1: IPoint, _p2: IPoint) {\r\n\r\n\t}\r\n\r\n\tprotected _drawFill() {\r\n\r\n\t}\r\n\r\n\tprotected _updateLine() {\r\n\r\n\t}\r\n}","import { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\nimport { Triangle } from \"../../../core/render/Triangle\";\r\nimport { Template } from \"../../../core/util/Template\";\r\nimport { Bullet } from \"../../../core/render/Bullet\";\r\n\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\nimport type { Container } from \"../../../core/render/Container\";\r\nimport type { DataItem } from \"../../../..\";\r\n\r\nimport * as $math from \"../../../core/util/Math\";\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $object from \"../../../core/util/Object\";\r\n\r\n\r\nexport interface ILineArrowSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface ILineArrowSeriesSettings extends ISimpleLineSeriesSettings {\r\n\r\n\t/**\r\n\t * Show a dotted line extending from both ends of the drawn line.\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tshowExtension?: boolean;\r\n}\r\n\r\nexport interface ILineArrowSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\n/**\r\n * Used for Line Arrow drawing tool in [[StockChart]].\r\n *\r\n * @since 5.10.5\r\n */\r\n\r\nexport class LineArrowSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"LineArrowSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([LineArrowSeries.className]);\r\n\r\n\tdeclare public _settings: ILineArrowSeriesSettings;\r\n\tdeclare public _privateSettings: ILineArrowSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ILineArrowSeriesDataItem;\r\n\r\n\tprotected _arrows: Array<Triangle> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.lines.template.set(\"forceHidden\", true);\r\n\r\n\t\tthis.bullets.push((_root, _series, dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext.corner == \"p2\") {\r\n\r\n\t\t\t\tconst index = dataContext.index;\r\n\t\t\t\tconst di = this._di[index][\"e\"] as DataItem<ILineArrowSeriesDataItem>;\r\n\t\t\t\tlet color = this.get(\"strokeColor\", this.get(\"stroke\"));\r\n\r\n\t\t\t\tif (di) {\r\n\t\t\t\t\tconst dc = di.dataContext as any;\r\n\t\t\t\t\tif (dc) {\r\n\t\t\t\t\t\tconst strokeTemplate = dc.stroke;\r\n\t\t\t\t\t\tif (strokeTemplate) {\r\n\t\t\t\t\t\t\tcolor = strokeTemplate.get(\"stroke\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tconst bullets = dataItem.bullets;\r\n\t\t\t\tif (bullets) {\r\n\t\t\t\t\tconst bullet = bullets[0];\r\n\t\t\t\t\tif (bullet) {\r\n\t\t\t\t\t\tconst container = bullet.get(\"sprite\") as Container;\r\n\t\t\t\t\t\tif (container) {\r\n\t\t\t\t\t\t\tconst child = container.children.getIndex(0);\r\n\t\t\t\t\t\t\tif (child) {\r\n\t\t\t\t\t\t\t\tchild.set(\"scale\", .1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst arrow = this.makeArrow();\r\n\r\n\t\t\t\tarrow.setAll({\r\n\t\t\t\t\tforceInactive: true,\r\n\t\t\t\t\tfill: color,\r\n\t\t\t\t\tuserData: dataContext.index\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn Bullet.new(this._root, {\r\n\t\t\t\t\tsprite: arrow,\r\n\t\t\t\t\tlocationX: undefined\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tpublic clearDrawings(): void {\r\n\t\tsuper.clearDrawings();\r\n\t\tthis.arrows.clear();\r\n\t}\r\n\r\n\tpublic _changed() {\r\n\t\tsuper._changed();\r\n\t\tthis.arrows.each((arrow) => {\r\n\t\t\tconst index = arrow.get(\"userData\");\r\n\t\t\tconst di = this._di[index];\r\n\t\t\tif (di) {\r\n\t\t\t\tconst di1 = this._di[index][\"p1\"];\r\n\t\t\t\tconst di2 = this._di[index][\"p2\"];\r\n\r\n\t\t\t\tconst p1 = di1.get(\"point\");\r\n\t\t\t\tconst p2 = di2.get(\"point\");\r\n\r\n\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t// rotate arrow\r\n\t\t\t\t\tconst angle = $math.getAngle(p1, p2) + 90;\r\n\t\t\t\t\tarrow.set(\"rotation\", angle);\r\n\r\n\t\t\t\t\tconst w = arrow.width();\r\n\r\n\t\t\t\t\tconst strokeIndex = this._getStrokeIndex(index);\r\n\t\t\t\t\tconst stroke = this.strokes.getIndex(strokeIndex);\r\n\t\t\t\t\tif (stroke) {\r\n\t\t\t\t\t\tarrow.set(\"scale\", (w + stroke.get(\"strokeWidth\", 2) * 2) / w);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _applySettings(index: number, settings: { [index: string]: any }) {\r\n\t\tsuper._applySettings(index, settings);\r\n\t\tlet template!: Template<any>;\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext.index == index) {\r\n\t\t\t\tif (dataContext.settings) {\r\n\t\t\t\t\ttemplate = dataContext.settings;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tconst settings2 = $object.copy(settings);\r\n\r\n\t\tif (settings.stroke != undefined) {\r\n\t\t\tsettings2.fill = settings.stroke;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelete settings2.fill;\r\n\t\t}\r\n\t\tif (settings.strokeOpacity != undefined) {\r\n\t\t\tsettings2.fillOpacity = settings.strokeOpacity;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelete settings2.fillOpacity;\r\n\t\t}\r\n\r\n\t\tsettings2.strokeOpacity = 0;\r\n\r\n\t\tconst arrow = this._getSprite(this.arrows, index);\r\n\t\tif (arrow) {\r\n\t\t\tconst defaultState = arrow.states.lookup(\"default\")!;\r\n\t\t\t$object.each(settings2, (key, value) => {\r\n\t\t\t\tarrow.set(key as any, value);\r\n\t\t\t\tdefaultState.set(key as any, value);\r\n\t\t\t\tif (template) {\r\n\t\t\t\t\ttemplate.set(key, value);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeArrow(): Triangle {\r\n\t\tconst arrow = this.arrows.make();\r\n\t\tthis.arrows.push(arrow);\r\n\t\treturn arrow;\r\n\t}\r\n\r\n\tpublic readonly arrows: ListTemplate<Triangle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Triangle._new(this._root, { themeTags: [\"arrow\"] }, [this.arrows.template])\r\n\t));\r\n\r\n\r\n\tprotected _updateLine(index: number, p11: IPoint, p22: IPoint, p1: IPoint, p2: IPoint) {\r\n\t\tsuper._updateLine(index, p11, p22, p1, p2);\r\n\t}\r\n}\r\n","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IHorizontalLineSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IHorizontalLineSeriesSettings extends ISimpleLineSeriesSettings {\r\n}\r\n\r\nexport interface IHorizontalLineSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class HorizontalLineSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"HorizontalLineSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([HorizontalLineSeries.className]);\r\n\r\n\tdeclare public _settings: IHorizontalLineSeriesSettings;\r\n\tdeclare public _privateSettings: IHorizontalLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IHorizontalLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"horizontal\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.lines.template.set(\"forceHidden\", true);\r\n\t}\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tsuper._handleBulletDragged(event);\r\n\r\n\t\tconst dataItem = event.target.dataItem as DataItem<IHorizontalLineSeriesDataItem>;\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\t\t\tconst diP3 = this._di[index][\"p3\"];\r\n\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (diP1 && diP2 && diP3 && movePoint) {\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)), valueX);\r\n\r\n\t\t\t\tconst min = xAxis.getPrivate(\"min\", 0);\r\n\t\t\t\tconst max = xAxis.getPrivate(\"max\", 1);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueY\", valueY, true);\r\n\t\t\t\tthis._setContext(diP2, \"valueY\", valueY, true);\r\n\t\t\t\tthis._setContext(diP3, \"valueY\", valueY, true);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueX\", min - (max - min));\r\n\t\t\t\tthis._setContext(diP2, \"valueX\", valueX);\r\n\t\t\t\tthis._setContext(diP3, \"valueX\", max + (max - min));\r\n\r\n\t\t\t\tthis._setXLocation(diP2, diP2.get(\"valueX\", 0));\r\n\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMoveReal() {\r\n\r\n\t}\r\n\r\n\tpublic _prepareChildren(): void {\r\n\t\tsuper._prepareChildren();\r\n\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\tconst min = xAxis.getPrivate(\"min\", 0);\r\n\t\tconst max = xAxis.getPrivate(\"max\", 1);\r\n\r\n\t\t$array.each(this._di, (di) => {\r\n\t\t\tif(di){\r\n\t\t\t\tthis._setContext(di[\"p1\"], \"valueX\", min - (max - min), true);\r\n\t\t\t\tthis._setContext(di[\"p3\"], \"valueX\", max + (max - min), true);\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tif (this._di[index]) {\r\n\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\tconst diP3 = this._di[index][\"p3\"];\r\n\r\n\t\t\tif (diP1 && diP3) {\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\t\tconst min = xAxis.getPrivate(\"min\", 0);\r\n\t\t\t\tconst max = xAxis.getPrivate(\"max\", 1);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueX\", min - (max - min), true);\r\n\t\t\t\tthis._setContext(diP3, \"valueX\", max + (max - min), true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (this._drawingEnabled) {\r\n\t\t\tif (!this._isDragging) {\r\n\t\t\t\tif(this.unselectAllDrawings() == 0){\r\n\t\t\t\t\tthis._increaseIndex();\r\n\t\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t\t\tthis.isDrawing(false);\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis._updateSegment(this._index);\r\n\t\t\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPointsReal(valueX: number, valueY: number, index: number) {\r\n\t\tsuper._addPointsReal(valueX, valueY, index);\r\n\t\tthis._addPoint(valueX, valueY, \"p3\", index);\r\n\t}\r\n\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IVerticalLineSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IVerticalLineSeriesSettings extends ISimpleLineSeriesSettings {\r\n}\r\n\r\nexport interface IVerticalLineSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class VerticalLineSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"VerticalLineSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([VerticalLineSeries.className]);\r\n\r\n\tdeclare public _settings: IVerticalLineSeriesSettings;\r\n\tdeclare public _privateSettings: IVerticalLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IVerticalLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"vertical\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.lines.template.set(\"forceHidden\", true);\r\n\t}\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tsuper._handleBulletDragged(event);\r\n\r\n\t\tconst dataItem = event.target.dataItem as DataItem<IVerticalLineSeriesDataItem>;\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\t\t\tconst diP3 = this._di[index][\"p3\"];\r\n\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (diP1 && diP2 && diP3 && movePoint) {\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)), valueX);\r\n\r\n\t\t\t\tconst min = yAxis.getPrivate(\"min\", 0);\r\n\t\t\t\tconst max = yAxis.getPrivate(\"max\", 1);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueY\", min - (max - min) * 10, true);\r\n\t\t\t\tthis._setContext(diP2, \"valueY\", valueY, true);\r\n\t\t\t\tthis._setContext(diP3, \"valueY\", max + (max - min) * 10, true);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueX\", valueX);\r\n\t\t\t\tthis._setContext(diP2, \"valueX\", valueX);\r\n\t\t\t\tthis._setContext(diP3, \"valueX\", valueX);\r\n\r\n\t\t\t\tthis._setXLocation(diP1, valueX);\r\n\t\t\t\tthis._setXLocation(diP2, valueX);\r\n\t\t\t\tthis._setXLocation(diP3, valueX);\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t\tthis._positionBullets(diP3);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tif (this._di[index]) {\r\n\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\tconst diP3 = this._di[index][\"p3\"];\r\n\t\t\tif (diP1 && diP3) {\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\t\t\t\tconst min = yAxis.getPrivate(\"min\", 0);\r\n\t\t\t\tconst max = yAxis.getPrivate(\"max\", 1);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueY\", min - (max - min) * 10, true);\r\n\t\t\t\tthis._setContext(diP3, \"valueY\", max + (max - min) * 10, true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMoveReal() {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (this._drawingEnabled) {\r\n\t\t\tif (!this._isDragging) {\r\n\t\t\t\tif (this.unselectAllDrawings() == 0) {\r\n\t\t\t\t\tthis._increaseIndex();\r\n\t\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t\t\tthis.isDrawing(false);\r\n\t\t\t\t\tthis._hideResizer();\r\n\r\n\t\t\t\t\tthis._updateSegment(this._index);\r\n\t\t\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPointsReal(valueX: number, valueY: number, index: number) {\r\n\t\tsuper._addPointsReal(valueX, valueY, index);\r\n\t\tthis._addPoint(valueX, valueY, \"p3\", index);\r\n\t}\r\n}","import { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IAverageSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IAverageSeriesSettings extends ISimpleLineSeriesSettings {\r\n}\r\n\r\nexport interface IAverageSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class AverageSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"AverageSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([AverageSeries.className]);\r\n\r\n\tdeclare public _settings: IAverageSeriesSettings;\r\n\tdeclare public _privateSettings: IAverageSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IAverageSeriesDataItem;\r\n\r\n\tprotected _tag = \"average\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.setPrivate(\"allowChangeSnap\", false);\r\n\t\tthis.set(\"snapToData\", true);\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst dataPoints = this._di[index];\r\n\t\tif (dataPoints) {\r\n\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\t\tconst series = this.get(\"series\");\r\n\t\t\tif (series && diP1 && diP2) {\r\n\r\n\t\t\t\tlet x1 = this._getXValue(diP1.get(\"valueX\" as any));\r\n\t\t\t\tlet x2 = this._getXValue(diP2.get(\"valueX\" as any));\r\n\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\t\tconst di1 = xAxis.getSeriesItem(series, Math.max(0, xAxis.valueToPosition(x1)));\r\n\t\t\t\tconst di2 = xAxis.getSeriesItem(series, Math.min(1, xAxis.valueToPosition(x2)));\r\n\r\n\t\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\t\tif (di1 && di2) {\r\n\t\t\t\t\tlet i1 = series.dataItems.indexOf(di1);\r\n\t\t\t\t\tlet i2 = series.dataItems.indexOf(di2);\r\n\r\n\t\t\t\t\tif (i1 > i2) {\r\n\t\t\t\t\t\t[i1, i2] = [i2, i1];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet sum = 0;\r\n\t\t\t\t\tlet count = 0;\r\n\r\n\t\t\t\t\tfor (let i = i1; i <= i2; i++) {\r\n\t\t\t\t\t\tconst di = series.dataItems[i];\r\n\t\t\t\t\t\tconst value = di.get(field as any);\r\n\t\t\t\t\t\tif (value != null) {\r\n\t\t\t\t\t\t\tsum += value;\r\n\t\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst average = sum / count;\r\n\r\n\t\t\t\t\tdiP1.set(\"valueX\", x1);\r\n\t\t\t\t\tdiP2.set(\"valueX\", x2);\r\n\r\n\t\t\t\t\tthis._setContext(diP1, \"valueX\", x1);\r\n\t\t\t\t\tthis._setContext(diP2, \"valueX\", x2);\r\n\t\t\t\t\tthis._setContext(diP1, \"valueY\", average, true);\r\n\t\t\t\t\tthis._setContext(diP2, \"valueY\", average, true);\r\n\r\n\t\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._updateElements();\r\n\t\t}\r\n\t}\r\n}","import type { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nfunction round(number: number, precision: number): number {\r\n\tconst factor = 10 ** precision;\r\n\treturn Math.round(number * factor) / factor;\r\n}\r\n\r\n// Modified from the regression npm package (under the MIT license)\r\nfunction linear(data: Array<[number, number]>, precision: number = 2): Array<[number, number]> {\r\n\tconst sum = [0, 0, 0, 0, 0];\r\n\tlet len = 0;\r\n\r\n\tfor (let n = 0; n < data.length; n++) {\r\n\t\tif (data[n][1] !== null) {\r\n\t\t\tlen++;\r\n\t\t\tsum[0] += data[n][0];\r\n\t\t\tsum[1] += data[n][1];\r\n\t\t\tsum[2] += data[n][0] * data[n][0];\r\n\t\t\tsum[3] += data[n][0] * data[n][1];\r\n\t\t\tsum[4] += data[n][1] * data[n][1];\r\n\t\t}\r\n\t}\r\n\r\n\tconst run = ((len * sum[2]) - (sum[0] * sum[0]));\r\n\tconst rise = ((len * sum[3]) - (sum[0] * sum[1]));\r\n\tconst gradient = run === 0 ? 0 : round(rise / run, precision);\r\n\tconst intercept = round((sum[1] / len) - ((gradient * sum[0]) / len), precision);\r\n\r\n\tfunction predict(x: number): [number, number] {\r\n\t\treturn [\r\n\t\t\tround(x, precision),\r\n\t\t\tround((gradient * x) + intercept, precision)\r\n\t\t];\r\n\t}\r\n\r\n\treturn data.map(point => predict(point[0]));\r\n}\r\n\r\nexport interface IRegressionSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IRegressionSeriesSettings extends ISimpleLineSeriesSettings {\r\n\r\n}\r\n\r\nexport interface IRegressionSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class RegressionSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"RegressionSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([RegressionSeries.className]);\r\n\r\n\tdeclare public _settings: IRegressionSeriesSettings;\r\n\tdeclare public _privateSettings: IRegressionSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IRegressionSeriesDataItem;\r\n\r\n\tprotected _tag = \"regression\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.setPrivate(\"allowChangeSnap\", false);\r\n\t\tthis.set(\"snapToData\", true);\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\t\tif (series && diP1 && diP2) {\r\n\t\t\tconst xAxis = series.get(\"xAxis\") as ValueAxis<AxisRenderer>;\r\n\r\n\t\t\tlet x1 = this._getXValue(diP1.get(\"valueX\" as any));\r\n\t\t\tlet x2 = this._getXValue(diP2.get(\"valueX\" as any));\r\n\r\n\t\t\tconst di1 = xAxis.getSeriesItem(series, xAxis.valueToPosition(x1));\r\n\t\t\tconst di2 = xAxis.getSeriesItem(series, xAxis.valueToPosition(x2));\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tif (di1 && di2) {\r\n\t\t\t\tconst dataItems = series.dataItems;\r\n\r\n\t\t\t\tlet startIndex = dataItems.indexOf(di1);\r\n\t\t\t\tlet endIndex = dataItems.indexOf(di2);\r\n\r\n\t\t\t\tlet inversed = false;\r\n\t\t\t\tif (startIndex > endIndex) {\r\n\t\t\t\t\tinversed = true;\r\n\t\t\t\t\t[startIndex, endIndex] = [endIndex, startIndex];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst points: Array<[number, number]> = []\r\n\t\t\t\tlet ii = 0;\r\n\t\t\t\tfor (let i = startIndex; i <= endIndex; i++) {\r\n\t\t\t\t\tconst dataItem = dataItems[i];\r\n\t\t\t\t\tpoints.push([ii, dataItem.get(field as any) as any]);\r\n\t\t\t\t\tii++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst resultPoints = linear(points);\r\n\t\t\t\tconst len = resultPoints.length;\r\n\r\n\t\t\t\tif (len > 1) {\r\n\t\t\t\t\tconst p1 = resultPoints[0];\r\n\t\t\t\t\tconst p2 = resultPoints[resultPoints.length - 1];\r\n\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\tlet y1 = p1[1];\r\n\t\t\t\t\t\tlet y2 = p2[1];\r\n\r\n\t\t\t\t\t\tif (inversed) {\r\n\t\t\t\t\t\t\t[y1, y2] = [y2, y1];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis._setContext(diP1, \"valueY\", y1, true);\r\n\t\t\t\t\t\tthis._setContext(diP2, \"valueY\", y2, true);\r\n\r\n\t\t\t\t\t\tthis._setContext(diP1, \"valueX\", x1);\r\n\t\t\t\t\t\tthis._setContext(diP2, \"valueX\", x2);\r\n\r\n\t\t\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\nimport { color } from \"../../../core/util/Color\";\r\n\r\nexport interface IDoodleSeriesDataItem extends IDrawingSeriesDataItem {\r\n}\r\n\r\nexport interface IDoodleSeriesSettings extends IDrawingSeriesSettings {\r\n}\r\n\r\nexport interface IDoodleSeriesPrivate extends IDrawingSeriesPrivate {\r\n}\r\n\r\nexport class DoodleSeries extends DrawingSeries {\r\n\tpublic static className: string = \"DoodleSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([DoodleSeries.className]);\r\n\r\n\tdeclare public _settings: IDoodleSeriesSettings;\r\n\tdeclare public _privateSettings: IDoodleSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IDoodleSeriesDataItem;\r\n\r\n\tprotected _panX?: boolean;\r\n\tprotected _panY?: boolean;\r\n\r\n\t// point index in segment\r\n\tprotected _pIndex: number = 0;\r\n\r\n\tprotected _tag = \"doodle\";\r\n\r\n\tprotected _down: boolean = false;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.setPrivate(\"allowChangeSnap\", false);\r\n\t\tthis.bullets.clear();\r\n\r\n\t\tthis.strokes.template.setAll({\r\n\t\t\tfill: color(0xffffff),\r\n\t\t\tfillOpacity: 0\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerMove(event);\r\n\r\n\t\tif (this._drawingEnabled && this._isPointerDown) {\r\n\t\t\tthis._handleBulletPosition(event);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletPosition(event: ISpritePointerEvent) {\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\r\n\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(point.x)));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)), valueX);\r\n\r\n\t\t\tconst index = this._index;\r\n\t\t\tthis.data.push({ valueY: valueY, valueX: valueX, index: index, corner: this._pIndex, drawingId: this._drawingId });\r\n\t\t\tconst len = this.dataItems.length;\r\n\r\n\t\t\tconst dataItem = this.dataItems[len - 1];\r\n\t\t\tthis._setXLocation(dataItem, valueX);\r\n\r\n\t\t\tthis._pIndex++;\r\n\r\n\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerDown(event: ISpritePointerEvent) {\r\n\t\t\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart) {\t\t\t\r\n\t\t\tif (this.unselectAllDrawings() == 0) {\r\n\t\t\t\tsuper._handlePointerDown(event);\r\n\t\t\t\tthis._increaseIndex();\r\n\t\t\t\tthis._pIndex = 0;\r\n\r\n\t\t\t\tthis._panX = chart.get(\"panX\");\r\n\t\t\t\tthis._panY = chart.get(\"panY\");\r\n\r\n\t\t\t\tchart.set(\"panX\", false);\r\n\t\t\t\tchart.set(\"panY\", false);\r\n\r\n\t\t\t\tconst cursor = chart.get(\"cursor\");\r\n\t\t\t\tif (cursor) {\r\n\t\t\t\t\tcursor.setPrivate(\"visible\", false);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._down = true;\r\n\r\n\t\t\t\tthis.data.push({ stroke: this._getStrokeTemplate(), sprite: this.mainContainer, index: this._index, corner: this._pIndex, drawingId: this._drawingId });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerUp(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerUp(event);\r\n\t\tconst chart = this.chart;\r\n\t\tif (chart && this._down) {\r\n\t\t\tthis._down = false;\r\n\t\t\tthis.setTimeout(() => {\r\n\t\t\t\tchart.set(\"panX\", this._panX);\r\n\t\t\t\tchart.set(\"panY\", this._panY);\r\n\t\t\t\tconst cursor = chart.get(\"cursor\");\r\n\t\t\t\tif (cursor) {\r\n\t\t\t\t\tcursor.setPrivate(\"visible\", true);\r\n\t\t\t\t}\r\n\t\t\t}, 100)\r\n\r\n\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t\t}\r\n\t}\r\n}","import type { Percent } from \"../../../core/util/Percent\";\r\nimport type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { SpriteResizer } from \"../../../core/render/SpriteResizer\";\r\n\r\nimport { PolylineSeries, IPolylineSeriesSettings, IPolylineSeriesPrivate, IPolylineSeriesDataItem } from \"./PolylineSeries\";\r\nimport { Bullet } from \"../../../core/render/Bullet\";\r\nimport { Graphics } from \"../../../core/render/Graphics\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $object from \"../../../core/util/Object\";\r\n\r\nexport interface IIconSeriesDataItem extends IPolylineSeriesDataItem {\r\n\r\n\t/**\r\n\t * An SVG path of the icon.\r\n\t */\r\n\tsvgPath: string;\r\n}\r\n\r\nexport interface IIconSeriesSettings extends IPolylineSeriesSettings {\r\n\r\n\t/**\r\n\t * An SVG path of the icon.\r\n\t */\r\n\ticonSvgPath: string;\r\n\r\n\t/**\r\n\t * Scale (0-X).\r\n\t */\r\n\ticonScale?: number;\r\n\r\n\t/**\r\n\t * Relative horizontal center.\r\n\t */\r\n\ticonCenterX?: Percent;\r\n\r\n\t/**\r\n\t * Relative vertical center.\r\n\t */\r\n\ticonCenterY?: Percent;\r\n\r\n\t/**\r\n\t * Should icon snap to closest data item?\r\n\t */\r\n\tsnapToData?: boolean;\r\n}\r\n\r\nexport interface IIconSeriesPrivate extends IPolylineSeriesPrivate {\r\n}\r\n\r\nexport class IconSeries extends PolylineSeries {\r\n\tpublic static className: string = \"IconSeries\";\r\n\tpublic static classNames: Array<string> = PolylineSeries.classNames.concat([IconSeries.className]);\r\n\r\n\tdeclare public _settings: IIconSeriesSettings;\r\n\tdeclare public _privateSettings: IIconSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IIconSeriesDataItem;\r\n\r\n\tpublic spriteResizer!: SpriteResizer;\r\n\r\n\tprotected _tag = \"icon\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.spriteResizer = this._getStockChart().spriteResizer;\r\n\r\n\t\tthis.bullets.clear();\r\n\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t\tthis.fills.template.set(\"visible\", false);\r\n\r\n\t\tthis.bullets.push((root, _series, dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tconst template = dataContext.settings;\r\n\t\t\tif (template) {\r\n\t\t\t\tconst sprite = Graphics.new(root, {\r\n\t\t\t\t\tdraggable: true,\r\n\t\t\t\t\tthemeTags: [\"icon\"]\r\n\t\t\t\t}, template);\r\n\r\n\t\t\t\tdataContext.sprite = sprite;\r\n\r\n\t\t\t\tthis._addBulletInteraction(sprite);\r\n\r\n\t\t\t\tsprite.events.on(\"click\", (_e) => {\r\n\t\t\t\t\tconst spriteResizer = this.spriteResizer;\r\n\t\t\t\t\tif (spriteResizer.get(\"sprite\") == sprite) {\r\n\t\t\t\t\t\tspriteResizer.set(\"sprite\", undefined);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tspriteResizer.set(\"sprite\", sprite);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsprite.events.on(\"pointerover\", () => {\r\n\t\t\t\t\tthis._isHover = true;\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsprite.events.on(\"pointerout\", () => {\r\n\t\t\t\t\tthis._isHover = false;\r\n\t\t\t\t})\r\n\r\n\t\t\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\r\n\t\t\t\tsprite.on(\"scale\", (scale) => {\r\n\t\t\t\t\ttemplate.set(\"scale\", scale)\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsprite.on(\"rotation\", (rotation) => {\r\n\t\t\t\t\ttemplate.set(\"rotation\", rotation)\r\n\t\t\t\t})\r\n\r\n\t\t\t\treturn Bullet.new(this._root, {\r\n\t\t\t\t\tlocationX: undefined,\r\n\t\t\t\t\tsprite: sprite\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setContextSprite(_context: any) { }\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (this._selected.length > 0) {\r\n\t\t\tthis._hideResizer();\r\n\t\t\tthis.unselectAllDrawings();\r\n\t\t}\r\n\t\telse if (this._drawingEnabled) {\r\n\t\t\tif (!this._isHover) {\r\n\t\t\t\tsuper._handlePointerClick(event);\r\n\r\n\t\t\t\tconst dataObject = this.data.getIndex(this.data.length - 1) as any;\r\n\t\t\t\tdataObject.settings = this._getIconTemplate();\r\n\r\n\t\t\t\tthis._increaseIndex();\r\n\t\t\t\tthis._di[this._index] = {};\r\n\r\n\t\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isDrawing(false);\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\t\tthis._isHover = false;\r\n\t}\r\n\r\n\tprotected _applySettings(index: number, settings?: { [index: string]: any }) {\r\n\t\tsuper._applySettings(index, settings);\r\n\t\tlet template: Template<any>;\r\n\t\tlet sprite!: Graphics;\r\n\r\n\t\tlet context = this._getContext(index);\r\n\t\tif (context) {\r\n\t\t\tsprite = context.sprite;\r\n\t\t\ttemplate = context.settings;\r\n\r\n\t\t\tif (sprite) {\r\n\r\n\t\t\t\tconst svgPath = this.get(\"iconSvgPath\");\r\n\t\t\t\tconst centerX = this.get(\"iconCenterX\");\r\n\t\t\t\tconst centerY = this.get(\"iconCenterY\");\r\n\r\n\t\t\t\tsprite.set(\"svgPath\", svgPath);\r\n\t\t\t\tsprite.set(\"centerX\", centerX);\r\n\t\t\t\tsprite.set(\"centerY\", centerY);\r\n\r\n\t\t\t\tconst defaultState = sprite.states.lookup(\"default\")!;\r\n\t\t\t\tdefaultState.set(\"svgPath\", svgPath);\r\n\t\t\t\tdefaultState.set(\"centerX\", centerX);\r\n\t\t\t\tdefaultState.set(\"centerY\", centerY);\r\n\r\n\t\t\t\tif (template) {\r\n\t\t\t\t\ttemplate.set(\"svgPath\", svgPath);\r\n\t\t\t\t\ttemplate.set(\"centerX\", centerX);\r\n\t\t\t\t\ttemplate.set(\"centerY\", centerY);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (settings) {\r\n\t\t\t\t\t$object.each(settings, (key, value) => {\r\n\t\t\t\t\t\tsprite.set(key as any, value);\r\n\t\t\t\t\t\tdefaultState.set(key as any, value);\r\n\t\t\t\t\t\tif (template) {\r\n\t\t\t\t\t\t\ttemplate.set(key, value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispatchAdded(): void {\r\n\r\n\t}\r\n\r\n\tprotected _getIconTemplate(): Template<any> {\r\n\t\tconst template: any = {};\r\n\r\n\t\tconst iconSvgPath = this.get(\"iconSvgPath\");\r\n\t\tif (iconSvgPath != null) {\r\n\t\t\ttemplate.svgPath = iconSvgPath;\r\n\t\t}\r\n\r\n\t\tconst iconScale = this.get(\"iconScale\");\r\n\t\tif (iconScale != null) {\r\n\t\t\ttemplate.scale = iconScale;\r\n\t\t}\r\n\r\n\t\tconst iconCenterX = this.get(\"iconCenterX\");\r\n\t\tif (iconCenterX != null) {\r\n\t\t\ttemplate.centerX = iconCenterX;\r\n\t\t}\r\n\r\n\t\tconst iconCenterY = this.get(\"iconCenterY\");\r\n\t\tif (iconCenterY != null) {\r\n\t\t\ttemplate.centerY = iconCenterY;\r\n\t\t}\r\n\r\n\t\tconst strokeColor = this.get(\"strokeColor\");\r\n\t\tif (strokeColor != null) {\r\n\t\t\ttemplate.stroke = strokeColor;\r\n\t\t}\r\n\r\n\t\tconst strokeOpacity = this.get(\"strokeOpacity\");\r\n\t\tif (strokeOpacity != null) {\r\n\t\t\ttemplate.strokeOpacity = strokeOpacity;\r\n\t\t}\r\n\r\n\t\tconst fillColor = this.get(\"fillColor\");\r\n\t\tif (fillColor != null) {\r\n\t\t\ttemplate.fill = fillColor;\r\n\t\t}\r\n\r\n\t\tconst fillOpacity = this.get(\"fillOpacity\");\r\n\t\tif (fillOpacity != null) {\r\n\t\t\ttemplate.fillOpacity = fillOpacity;\r\n\t\t}\r\n\r\n\t\treturn Template.new(template);\r\n\t}\r\n\r\n\tpublic setInteractive(value: boolean) {\r\n\t\tsuper.setInteractive(value)\r\n\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst bullets = dataItem.bullets;\r\n\t\t\tif (bullets) {\r\n\t\t\t\t$array.each(bullets, (bullet) => {\r\n\t\t\t\t\tconst sprite = bullet.get(\"sprite\");\r\n\t\t\t\t\tif (sprite) {\r\n\t\t\t\t\t\tsprite.set(\"forceInactive\", !value);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tsuper._prepareChildren();\r\n\t\tif (this.isDirty(\"iconSvgPath\")) {\r\n\r\n\t\t\t$array.each(this._selected, (i) => {\r\n\t\t\t\tthis._applySettings(i);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateSelector(selector: Graphics, index: number) {\r\n\t\tconst context = this._getContext(index);\r\n\t\tif (context) {\r\n\t\t\tconst sprite = context.sprite;\r\n\r\n\t\t\tif (sprite) {\r\n\t\t\t\tif (sprite.dataItem == this.spriteResizer.get(\"sprite\")?.dataItem) {\r\n\t\t\t\t\tselector.hide(0);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (this._selected.indexOf(index) != -1) {\r\n\t\t\t\t\t\tselector.show(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst selectorPadding = this.get(\"selectorPadding\", 5);\r\n\r\n\t\t\t\tlet bounds = sprite.bounds();\r\n\r\n\t\t\t\tlet w = (bounds.right - bounds.left) + selectorPadding * 2;\r\n\t\t\t\tlet h = (bounds.bottom - bounds.top) + selectorPadding * 2;\r\n\r\n\t\t\t\tselector.setAll({\r\n\t\t\t\t\twidth: w,\r\n\t\t\t\t\theight: h,\r\n\t\t\t\t\tx: bounds.left - selectorPadding,\r\n\t\t\t\t\ty: bounds.top - selectorPadding\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic toggleDrawing(enabled: boolean) {\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst bullets = dataItem.bullets;\r\n\t\t\tif (bullets) {\r\n\t\t\t\t$array.each(bullets, (bullet) => {\r\n\t\t\t\t\tconst sprite = bullet.get(\"sprite\");\r\n\t\t\t\t\tif (sprite) {\r\n\t\t\t\t\t\tsprite.set(\"forceInactive\", !enabled);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tprotected _handleBulletDragStart(event: ISpritePointerEvent) {\r\n\t\t// don't call super\r\n\t\tthis._hideResizer(event.target);\r\n\t\tconst stockChart = this._getStockChart();\r\n\t\tif (stockChart) {\r\n\t\t\tstockChart._dragStartDrawing(event);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletDragStop(event: ISpritePointerEvent) {\r\n\t\tconst stockChart = this._getStockChart();\r\n\t\tif (stockChart) {\r\n\t\t\tstockChart._dragStopDrawing(event);\r\n\t\t}\r\n\t\tthis._root.events.once(\"frameended\", () => {\r\n\t\t\tthis._positionBullets(event.target.dataItem as DataItem<IIconSeriesDataItem>);\r\n\t\t})\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { Container } from \"../../../core/render/Container\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { SpriteResizer } from \"../../../core/render/SpriteResizer\";\r\nimport type { Graphics } from \"../../../core/render/Graphics\";\r\nimport type { IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\n\r\nimport { PolylineSeries, IPolylineSeriesSettings, IPolylineSeriesPrivate, IPolylineSeriesDataItem } from \"./PolylineSeries\";\r\nimport { EditableLabel } from \"../../../core/render/EditableLabel\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $object from \"../../../core/util/Object\";\r\n\r\nexport interface ILabelSeriesDataItem extends IPolylineSeriesDataItem {\r\n}\r\n\r\nexport interface ILabelSeriesSettings extends IPolylineSeriesSettings {\r\n\r\n\t/**\r\n\t * Label font size.\r\n\t */\r\n\tlabelFontSize?: number | string | undefined;\r\n\r\n\t/**\r\n\t * Label font damily.\r\n\t */\r\n\tlabelFontFamily?: string;\r\n\r\n\t/**\r\n\t * Font weight.\r\n\t */\r\n\tlabelFontWeight?: \"normal\" | \"bold\" | \"bolder\" | \"lighter\" | \"100\" | \"200\" | \"300\" | \"400\" | \"500\" | \"600\" | \"700\" | \"800\" | \"900\";\r\n\r\n\t/**\r\n\t * Font style.\r\n\t */\r\n\tlabelFontStyle?: \"normal\" | \"italic\" | \"oblique\";\r\n\r\n\t/**\r\n\t * Label color.\r\n\t */\r\n\tlabelFill?: Color;\r\n\r\n}\r\n\r\nexport interface ILabelSeriesPrivate extends IPolylineSeriesPrivate {\r\n\tinputContainer: HTMLDivElement;\r\n\tinput: HTMLTextAreaElement;\r\n\tlabel: EditableLabel;\r\n}\r\n\r\nexport class LabelSeries extends PolylineSeries {\r\n\tpublic static className: string = \"LabelSeries\";\r\n\tpublic static classNames: Array<string> = PolylineSeries.classNames.concat([LabelSeries.className]);\r\n\r\n\tdeclare public _settings: ILabelSeriesSettings;\r\n\tdeclare public _privateSettings: ILabelSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ILabelSeriesDataItem;\r\n\r\n\tpublic spriteResizer!: SpriteResizer;\r\n\r\n\tprotected _tag = \"label\";\r\n\r\n\tprotected _isEditing: boolean = false;\r\n\r\n\tprotected _isSelected: boolean = false;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.spriteResizer = this._getStockChart().spriteResizer;\r\n\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t\tthis.fills.template.set(\"visible\", false);\r\n\r\n\t\tthis.addTag(this._tag);\r\n\t}\r\n\r\n\tprotected _dispatchAdded(): void {\r\n\r\n\t}\r\n\r\n\tprotected _setContextSprite(_context: any) { }\r\n\r\n\tprotected _tweakBullet(container: Container, dataItem: DataItem<ILabelSeriesDataItem>) {\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tconst text = dataContext.text;\r\n\t\tconst template = dataContext.settings;\r\n\r\n\t\tif (template) {\r\n\t\t\tconst label = container.children.push(EditableLabel.new(this._root, {\r\n\t\t\t\tthemeTags: [\"label\"],\r\n\t\t\t\ttext: text,\r\n\t\t\t\teditOn: \"none\"\r\n\t\t\t}, template));\r\n\r\n\t\t\tlabel.on(\"text\", (text) => {\r\n\t\t\t\tdataContext.text = text;\r\n\t\t\t});\r\n\r\n\t\t\tthis.setPrivate(\"label\", label);\r\n\r\n\t\t\tlabel.on(\"active\", () => {\r\n\t\t\t\tthis.setTimeout(() => {\r\n\t\t\t\t\tthis._isEditing = label.get(\"active\", false);\r\n\t\t\t\t}, 200)\r\n\r\n\t\t\t\tif (!label.get(\"active\")) {\r\n\t\t\t\t\tthis.setTimeout(() => {\r\n\t\t\t\t\t\tif (label) {\r\n\t\t\t\t\t\t\tif (label.get(\"text\") == \"\") {\r\n\t\t\t\t\t\t\t\tthis._disposeIndex(dataContext.index);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 100);\r\n\r\n\t\t\t\t\t// Trigger a drawing updated event so that updated text is saved if\r\n\t\t\t\t\t// necessary\r\n\t\t\t\t\tconst stockChart = this._getStockChart();\r\n\t\t\t\t\tconst type = \"drawingsupdated\";\r\n\t\t\t\t\tif (stockChart.events.isEnabled(type)) {\r\n\t\t\t\t\t\tstockChart.events.dispatch(type, { type: type, target: stockChart });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tcontainer.events.on(\"click\", (e) => {\r\n\t\t\t\tconst spriteResizer = this.spriteResizer;\r\n\t\t\t\tif (spriteResizer.get(\"sprite\") == label) {\r\n\t\t\t\t\tthis._isEditing = true;\r\n\t\t\t\t\tlabel.set(\"active\", true);\r\n\t\t\t\t\tthis._selectDrawing(dataContext.index, (e.originalEvent as any).ctrlKey, true);\r\n\t\t\t\t\tspriteResizer.set(\"sprite\", undefined);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._isEditing = false;\r\n\t\t\t\t\tthis._isSelected = true;\r\n\t\t\t\t\tspriteResizer.set(\"sprite\", label);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tcontainer.events.on(\"pointerover\", () => {\r\n\t\t\t\tthis._isHover = true;\r\n\t\t\t})\r\n\r\n\t\t\tcontainer.events.on(\"pointerout\", () => {\r\n\t\t\t\tthis._isHover = false;\r\n\t\t\t})\r\n\r\n\t\t\tlabel.on(\"scale\", (scale) => {\r\n\t\t\t\ttemplate.set(\"scale\", scale);\r\n\t\t\t})\r\n\r\n\t\t\tlabel.on(\"rotation\", (rotation) => {\r\n\t\t\t\ttemplate.set(\"rotation\", rotation)\r\n\t\t\t})\r\n\r\n\t\t\tlabel.events.on(\"boundschanged\", () => {\r\n\t\t\t\tthis.markDirty();\r\n\t\t\t})\r\n\r\n\t\t\tdataContext.sprite = container;\r\n\t\t\tdataContext.label = label;\r\n\r\n\t\t\tthis._tweakBullet2(label, dataItem);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _tweakBullet2(_label: EditableLabel, _dataItem: DataItem<ILabelSeriesDataItem>) {\r\n\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (this._isEditing) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this._selected.length > 0 || this._isSelected) {\r\n\t\t\tthis._isSelected = false;\r\n\t\t\tthis._hideResizer();\r\n\t\t\tthis.unselectAllDrawings();\r\n\t\t}\r\n\t\telse if (this._drawingEnabled) {\r\n\t\t\tif (!this._isHover) {\r\n\t\t\t\tthis.isDrawing(true);\r\n\t\t\t\tthis._increaseIndex();\r\n\t\t\t\tthis._di[this._index] = {};\r\n\r\n\t\t\t\tthis._addPoint(event);\r\n\r\n\t\t\t\tconst dataContext = this.data.getIndex(this.data.length - 1) as any;\r\n\t\t\t\tdataContext.text = \"\";\r\n\t\t\t\tdataContext.index = this._index;\r\n\t\t\t\tdataContext.corner = 0;\r\n\t\t\t\tdataContext.settings = this._getLabelTemplate();\r\n\t\t\t\tthis._afterTextSave(dataContext);\r\n\r\n\t\t\t\tthis._root.events.once(\"frameended\", () => {\r\n\t\t\t\t\tdataContext.label.set(\"active\", true);\r\n\t\t\t\t\tthis._isEditing = true;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\r\n\t\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.isDrawing(false);\r\n\t}\r\n\r\n\tprotected _afterTextSave(_dataContext: any) {\r\n\r\n\t}\r\n\r\n\tprotected _getLabelTemplate(): Template<any> {\r\n\t\tconst template: any = {};\r\n\r\n\t\tconst labelFontSize = this.get(\"labelFontSize\");\r\n\t\tif (labelFontSize != null) {\r\n\t\t\ttemplate.fontSize = labelFontSize;\r\n\t\t}\r\n\r\n\t\tconst labelFontFamily = this.get(\"labelFontFamily\");\r\n\t\tif (labelFontFamily != null) {\r\n\t\t\ttemplate.fontFamily = labelFontFamily;\r\n\t\t}\r\n\r\n\t\tconst labelFontWeight = this.get(\"labelFontWeight\");\r\n\t\tif (labelFontWeight != null) {\r\n\t\t\ttemplate.fontWeight = labelFontWeight;\r\n\t\t}\r\n\r\n\t\tconst labelFontStyle = this.get(\"labelFontStyle\");\r\n\t\tif (labelFontStyle != null) {\r\n\t\t\ttemplate.fontStyle = labelFontStyle;\r\n\t\t}\r\n\r\n\t\tconst labelFill = this.get(\"labelFill\");\r\n\t\tif (labelFill != null) {\r\n\t\t\ttemplate.fill = labelFill;\r\n\t\t}\r\n\r\n\t\treturn Template.new(template);\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tthis.spriteResizer.set(\"sprite\", undefined);\r\n\t\tthis._isHover = false;\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\r\n\t}\r\n\r\n\tprotected _updateSelector(selector: Graphics, index: number) {\r\n\t\tconst context = this._getContext(index);\r\n\t\tif (context) {\r\n\t\t\tconst sprite = context.sprite;\r\n\r\n\t\t\tif (sprite) {\r\n\t\t\t\tif (sprite.dataItem == this.spriteResizer.get(\"sprite\")?.dataItem) {\r\n\t\t\t\t\tselector.hide(0);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (this._selected.indexOf(index) != -1) {\r\n\t\t\t\t\t\tselector.show(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst selectorPadding = this.get(\"selectorPadding\", 5);\r\n\r\n\t\t\t\tlet bounds = sprite.bounds();\r\n\r\n\t\t\t\tlet w = (bounds.right - bounds.left) + selectorPadding * 2;\r\n\t\t\t\tlet h = (bounds.bottom - bounds.top) + selectorPadding * 2;\r\n\r\n\t\t\t\tselector.setAll({\r\n\t\t\t\t\twidth: w,\r\n\t\t\t\t\theight: h,\r\n\t\t\t\t\tx: bounds.left - selectorPadding,\r\n\t\t\t\t\ty: bounds.top - selectorPadding\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _prepareChildren() {\r\n\t\tsuper._prepareChildren();\r\n\t\tif (this.isDirty(\"labelFontSize\") || this.isDirty(\"labelFontFamily\") || this.isDirty(\"labelFontWeight\") || this.isDirty(\"labelFontStyle\") || this.isDirty(\"labelFill\")) {\r\n\t\t\t$array.each(this._selected, (i) => {\r\n\t\t\t\tthis._applySettings(i);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _applySettings(index: number, settings?: { [index: string]: any }) {\r\n\t\tsuper._applySettings(index, settings);\r\n\t\tlet context = this._getContext(index);\r\n\r\n\t\tif (context) {\r\n\t\t\tlet label = context.label;\r\n\r\n\t\t\tif (label) {\r\n\t\t\t\tlet template = context.settings;\r\n\r\n\t\t\t\tconst labelSettings = {\r\n\t\t\t\t\tfontSize: this.get(\"labelFontSize\"),\r\n\t\t\t\t\tfontFamily: this.get(\"labelFontFamily\"),\r\n\t\t\t\t\tfontWeight: this.get(\"labelFontWeight\"),\r\n\t\t\t\t\tfontStyle: this.get(\"labelFontStyle\"),\r\n\t\t\t\t\tfill: this.get(\"labelFill\"),\r\n\t\t\t\t\tfillColor: this.get(\"fillColor\")\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst defaultState = label.states.lookup(\"default\")!;\r\n\t\t\t\tif (labelSettings) {\r\n\t\t\t\t\t$object.each(labelSettings, (key, value) => {\r\n\t\t\t\t\t\tlabel.set(key as any, value);\r\n\t\t\t\t\t\tdefaultState.set(key as any, value);\r\n\t\t\t\t\t\tif (template) {\r\n\t\t\t\t\t\t\ttemplate.set(key, value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletDragStart(event: ISpritePointerEvent) {\r\n\t\t// don't call super\t\t\r\n\t\tconst stockChart = this._getStockChart();\r\n\t\tif (stockChart) {\r\n\t\t\tstockChart._dragStartDrawing(event);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleBulletDragStop(event: ISpritePointerEvent) {\r\n\t\tconst stockChart = this._getStockChart();\r\n\t\tif (stockChart) {\r\n\t\t\tstockChart._dragStopDrawing(event);\r\n\t\t}\r\n\r\n\t\tthis._root.events.once(\"frameended\", () => {\r\n\t\t\tthis._positionBullets(event.target.dataItem as DataItem<IDrawingSeriesDataItem>);\r\n\t\t})\r\n\t}\r\n\r\n\tpublic toggleDrawing(enabled?: boolean) {\r\n\t\tthis.grips.each((grip) => {\r\n\t\t\tgrip.set(\"forceInactive\", !enabled);\r\n\t\t})\r\n\t}\r\n}","import type { Label } from \"../../../core/render/Label\";\r\nimport type { Container } from \"../../../core/render/Container\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { LabelSeries, ILabelSeriesSettings, ILabelSeriesPrivate, ILabelSeriesDataItem } from \"./LabelSeries\";\r\nimport { PointedRectangle } from \"../../../core/render/PointedRectangle\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport * as $ease from \"../../../core/util/Ease\";\r\n\r\n\r\nexport interface ICalloutSeriesDataItem extends ILabelSeriesDataItem {\r\n}\r\n\r\nexport interface ICalloutSeriesSettings extends ILabelSeriesSettings {\r\n}\r\n\r\nexport interface ICalloutSeriesPrivate extends ILabelSeriesPrivate {\r\n}\r\n\r\nexport class CalloutSeries extends LabelSeries {\r\n\tpublic static className: string = \"CalloutSeries\";\r\n\tpublic static classNames: Array<string> = LabelSeries.classNames.concat([CalloutSeries.className]);\r\n\r\n\tdeclare public _settings: ICalloutSeriesSettings;\r\n\tdeclare public _privateSettings: ICalloutSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ICalloutSeriesDataItem;\r\n\r\n\tprotected _tag = \"callout\";\r\n\r\n\tprotected _tweakBullet2(label: Label, dataItem: DataItem<ICalloutSeriesDataItem>) {\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tconst background = label.set(\"background\", PointedRectangle.new(this._root, { themeTags: [\"callout\"] }, dataContext.bgSettings));\r\n\t\tdataContext.background = background;\r\n\t}\r\n\r\n\tprotected _tweakBullet(container: Container, dataItem: DataItem<ICalloutSeriesDataItem>) {\r\n\t\tsuper._tweakBullet(container, dataItem);\r\n\r\n\t\tcontainer.events.off(\"click\");\r\n\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tconst template = dataContext.settings;\r\n\r\n\t\tif (template) {\r\n\t\t\tconst label = this.getPrivate(\"label\");\r\n\t\t\tif (label) {\r\n\t\t\t\tlabel.events.on(\"positionchanged\", () => {\r\n\t\t\t\t\tthis._root.events.once(\"frameended\", () => {\r\n\t\t\t\t\t\tthis._updatePointer(label);\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\r\n\t\t\t\tlabel.events.on(\"click\", (e) => {\r\n\t\t\t\t\tconst spriteResizer = this.spriteResizer;\r\n\t\t\t\t\tif (spriteResizer.get(\"sprite\") == label) {\r\n\t\t\t\t\t\tthis._isEditing = true;\r\n\t\t\t\t\t\tlabel.set(\"active\", true);\r\n\t\t\t\t\t\tthis._selectDrawing(dataContext.index, (e.originalEvent as any).ctrlKey, true);\r\n\t\t\t\t\t\tspriteResizer.set(\"sprite\", undefined);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis._isEditing = false;\r\n\t\t\t\t\t\tthis._isSelected = true;\r\n\t\t\t\t\t\tthis._selectDrawing(dataContext.index, (e.originalEvent as any).ctrlKey, true);\r\n\t\t\t\t\t\tspriteResizer.set(\"sprite\", label);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\t\t\tthis._disposeIndex(dataContext.index);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tlabel.on(\"scale\", () => {\r\n\t\t\t\t\tthis._updatePointer(label);\r\n\t\t\t\t})\r\n\r\n\t\t\t\tlabel.on(\"rotation\", () => {\r\n\t\t\t\t\tthis._updatePointer(label);\r\n\t\t\t\t})\r\n\r\n\t\t\t\tlabel.setAll({ draggable: true });\r\n\r\n\t\t\t\tlabel.on(\"x\", (x) => {\r\n\t\t\t\t\ttemplate.set(\"x\", x);\r\n\t\t\t\t})\r\n\r\n\t\t\t\tlabel.on(\"y\", (y) => {\r\n\t\t\t\t\ttemplate.set(\"y\", y);\r\n\t\t\t\t})\r\n\r\n\t\t\t\tconst defaultState = label.states.lookup(\"default\")!;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tlabel.animate({ key: \"y\", to: -label.height() / 2 - 10, from: 0, duration: defaultState.get(\"stateAnimationDuration\", 500), easing: defaultState.get(\"stateAnimationEasing\", $ease.out($ease.cubic)) })\r\n\t\t\t\t}, 50)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updatePointer(label: Label) {\r\n\t\tconst background = label.get(\"background\");\r\n\t\tif (background instanceof PointedRectangle) {\r\n\t\t\tconst parent = label.parent;\r\n\t\t\tif (parent) {\r\n\t\t\t\tlet point = parent.toGlobal({ x: 0, y: 0 });\r\n\t\t\t\tpoint = background.toLocal(point);\r\n\t\t\t\tbackground.setAll({ pointerX: point.x, pointerY: point.y });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.markDirty();\r\n\t}\r\n\r\n\tprotected _afterTextSave(dataContext: any) {\r\n\t\tdataContext.bgSettings = this._getBgTemplate();\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\r\n\t}\r\n\r\n\tprotected _getBgTemplate(): Template<any> {\r\n\t\tconst template: any = {};\r\n\r\n\t\tconst fill = this.get(\"fillColor\");\r\n\t\tif (fill != null) {\r\n\t\t\ttemplate.fill = fill;\r\n\t\t}\r\n\r\n\t\tconst fillOpacity = this.get(\"fillOpacity\");\r\n\t\tif (fillOpacity != null) {\r\n\t\t\ttemplate.fillOpacity = fillOpacity;\r\n\t\t}\r\n\r\n\t\tconst strokeOpacity = this.get(\"strokeOpacity\");\r\n\t\tif (strokeOpacity != null) {\r\n\t\t\ttemplate.strokeOpacity = strokeOpacity;\r\n\t\t}\r\n\r\n\t\tconst stroke = this.get(\"strokeColor\");\r\n\t\tif (stroke != null) {\r\n\t\t\ttemplate.stroke = stroke;\r\n\t\t}\r\n\r\n\t\treturn Template.new(template);\r\n\t}\r\n\r\n\tprotected _applySettings(index: number, settings?: { [index: string]: any }) {\r\n\t\tsuper._applySettings(index, settings);\r\n\r\n\t\tconst context = this._getContext(index);\r\n\t\tif (context && settings) {\r\n\t\t\tconst background = context.background;\r\n\r\n\t\t\tif (background) {\r\n\t\t\t\tlet template = context.bgSettings;\r\n\r\n\t\t\t\tif (settings.fill != undefined) {\r\n\t\t\t\t\tbackground.set(\"fill\", settings.fill);\r\n\t\t\t\t\ttemplate.set(\"fill\", settings.fill);\r\n\t\t\t\t}\r\n\t\t\t\tif (settings.fillOpacity != undefined) {\r\n\t\t\t\t\tbackground.set(\"fillOpacity\", settings.fillOpacity);\r\n\t\t\t\t\ttemplate.set(\"fillOpacity\", settings.fillOpacity);\r\n\t\t\t\t}\r\n\t\t\t\tif (settings.strokeOpacity != undefined) {\r\n\t\t\t\t\tbackground.set(\"strokeOpacity\", settings.strokeOpacity);\r\n\t\t\t\t\ttemplate.set(\"strokeOpacity\", settings.strokeOpacity);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (settings.stroke != undefined) {\r\n\t\t\t\t\tbackground.set(\"stroke\", settings.stroke);\r\n\t\t\t\t\ttemplate.set(\"stroke\", settings.stroke);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\n\r\nimport { DrawingSeries, IDrawingSeriesSettings, IDrawingSeriesPrivate, IDrawingSeriesDataItem } from \"./DrawingSeries\";\r\nimport { Ellipse } from \"../../../core/render/Ellipse\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $object from \"../../../core/util/Object\";\r\n\r\nexport interface IEllipseSeriesDataItem extends IDrawingSeriesDataItem {\r\n}\r\n\r\nexport interface IEllipseSeriesSettings extends IDrawingSeriesSettings {\r\n}\r\n\r\nexport interface IEllipseSeriesPrivate extends IDrawingSeriesPrivate {\r\n}\r\n\r\nexport class EllipseSeries extends DrawingSeries {\r\n\tpublic static className: string = \"EllipseSeries\";\r\n\tpublic static classNames: Array<string> = DrawingSeries.classNames.concat([EllipseSeries.className]);\r\n\r\n\tdeclare public _settings: IEllipseSeriesSettings;\r\n\tdeclare public _privateSettings: IEllipseSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IEllipseSeriesDataItem;\r\n\r\n\tprotected _ellipses: Array<Ellipse> = [];\r\n\r\n\tprotected _tag = \"ellipse\";\r\n\tprotected _clickPX: number = 0;\r\n\tprotected _clickVY: number = 0;\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeEllipse(): Ellipse {\r\n\t\tconst ellipse = this.ellipses.make();\r\n\t\tthis.mainContainer.children.push(ellipse);\r\n\t\tthis.ellipses.push(ellipse);\r\n\t\treturn ellipse;\r\n\t}\r\n\r\n\tpublic readonly ellipses: ListTemplate<Ellipse> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({ radiusX: 0, radiusY: 0 }),\r\n\t\t() => Ellipse._new(this._root, { radiusX: 0, radiusY: 0, templateField: \"settings\" }, [this.ellipses.template])\r\n\t));\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.setPrivate(\"allowChangeSnap\", false);\r\n\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t\tthis.fills.template.set(\"visible\", false);\r\n\r\n\t\tconst ellipseTemplate = this.ellipses.template;\r\n\t\tellipseTemplate.events.on(\"pointerover\", (e) => {\r\n\t\t\tthis._showSegmentBullets(e.target.get(\"userData\"));\r\n\t\t})\r\n\r\n\t\t/*\r\n\t\tellipseTemplate.events.on(\"pointerout\", () => {\r\n\t\t\tthis._hideAllBullets();\r\n\t\t})\r\n\t\t*/\r\n\r\n\t\tellipseTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis.startDragItem(e, e.target.get(\"userData\"));\r\n\t\t})\r\n\r\n\t\tellipseTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tthis.stopDragItem(e, e.target.get(\"userData\"));\r\n\t\t})\r\n\r\n\t\tellipseTemplate.events.on(\"click\", (e) => {\r\n\t\t\tconst index = e.target.get(\"userData\");\r\n\t\t\tif (this._erasingEnabled) {\r\n\t\t\t\tthis._disposeIndex(index);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._selectDrawing(index, (e.originalEvent as any).ctrlKey);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _applySettings(index: number, settings: { [index: string]: any }) {\r\n\t\tsuper._applySettings(index, settings);\r\n\t\tlet template: Template<any>;\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tif (dataContext.index == index) {\r\n\t\t\t\tif (dataContext.settings) {\r\n\t\t\t\t\ttemplate = dataContext.settings;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tconst ellipse = this._getSprite(this.ellipses, index);\r\n\t\tif (ellipse) {\r\n\t\t\tconst defaultState = ellipse.states.lookup(\"default\")!;\r\n\t\t\t$object.each(settings, (key, value) => {\r\n\t\t\t\tellipse.set(key as any, value);\r\n\t\t\t\tdefaultState.set(key as any, value);\r\n\t\t\t\tif (template) {\r\n\t\t\t\t\ttemplate.set(key, value);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleFillDragStop(event: ISpritePointerEvent, index: number) {\r\n\t\tsuper._handleFillDragStop(event, index);\r\n\r\n\t\tconst items = this._di[index];\r\n\t\tconst bDI = items[\"b\"];\r\n\t\tconst tDI = items[\"t\"];\r\n\t\tconst rDI = items[\"r\"];\r\n\t\tconst lDI = items[\"l\"];\r\n\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\tif (bDI && tDI && rDI && lDI) {\r\n\t\t\tconst positionL = xAxis.valueToPosition(lDI.get(\"valueX\", 0));\r\n\t\t\tconst positionR = xAxis.valueToPosition(rDI.get(\"valueX\", 0));\r\n\r\n\t\t\tlet mx = this._getXValue(xAxis.positionToValue(positionL + (positionR - positionL) / 2));\r\n\t\t\tthis._setContext(tDI, \"valueX\", mx);\r\n\t\t\tthis._setContext(bDI, \"valueX\", mx);\r\n\r\n\t\t\tthis._setXLocation(tDI, mx);\r\n\t\t\tthis._setXLocation(bDI, mx);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tconst dataItem = event.target.dataItem as DataItem<IEllipseSeriesDataItem>;\r\n\r\n\t\tconst valueXReal = dataItem.get(\"valueX\");\r\n\t\tconst locationXReal = dataItem.get(\"locationX\");\r\n\t\tconst valueYReal = dataItem.get(\"valueY\");\r\n\r\n\t\tsuper._handleBulletDragged(event);\r\n\r\n\t\tconst movePoint = this._movePointerPoint;\r\n\t\tif (dataItem && movePoint) {\r\n\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst corner = dataContext.corner;\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)), valueX);\r\n\r\n\t\t\tconst vx = \"valueX\"\r\n\t\t\tconst vy = \"valueY\"\r\n\t\t\tconst vwy = \"valueYWorking\";\r\n\r\n\t\t\tconst items = this._di[index];\r\n\t\t\tconst bDI = items[\"b\"];\r\n\t\t\tconst tDI = items[\"t\"];\r\n\t\t\tconst rDI = items[\"r\"];\r\n\t\t\tconst lDI = items[\"l\"];\r\n\r\n\r\n\t\t\tif (bDI && tDI && rDI && lDI) {\r\n\t\t\t\tif (corner == \"b\") {\r\n\t\t\t\t\tconst valueY0 = tDI.get(vwy, 0)\r\n\t\t\t\t\tthis._setContext(bDI, vy, valueY, true);\r\n\r\n\t\t\t\t\tlet my = valueY0 + (valueY - valueY0) / 2;\r\n\r\n\t\t\t\t\tthis._setContext(rDI, vy, my, true);\r\n\t\t\t\t\tthis._setContext(lDI, vy, my, true);\r\n\t\t\t\t\tthis._setContext(bDI, vx, valueXReal);\r\n\r\n\t\t\t\t\tbDI.set(\"locationX\", locationXReal);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (corner == \"t\") {\r\n\t\t\t\t\tconst valueY0 = bDI.get(vwy, 0)\r\n\r\n\t\t\t\t\tthis._setContext(tDI, vy, valueY, true);\r\n\r\n\t\t\t\t\tlet my = valueY0 + (valueY - valueY0) / 2;\r\n\r\n\t\t\t\t\tthis._setContext(rDI, vy, my, true);\r\n\t\t\t\t\tthis._setContext(lDI, vy, my, true);\r\n\t\t\t\t\tthis._setContext(tDI, vx, valueXReal);\r\n\r\n\t\t\t\t\ttDI.set(\"locationX\", locationXReal);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (corner == \"l\") {\r\n\t\t\t\t\tconst valueX0 = rDI.get(vx, 0)\r\n\t\t\t\t\tconst positionX0 = xAxis.valueToPosition(valueX0);\r\n\t\t\t\t\tconst positionX = xAxis.valueToPosition(valueX);\r\n\r\n\t\t\t\t\tthis._setContext(lDI, vx, valueX);\r\n\t\t\t\t\tthis._setXLocation(lDI, valueX);\r\n\r\n\t\t\t\t\tlet mpos = positionX0 + (positionX - positionX0) / 2;\r\n\t\t\t\t\tlet mx = this._getXValue(xAxis.positionToValue(mpos));\r\n\t\t\t\t\tthis._setContext(tDI, vx, mx);\r\n\t\t\t\t\tthis._setContext(bDI, vx, mx);\r\n\r\n\t\t\t\t\tthis._setXLocation(tDI, mx);\r\n\t\t\t\t\tthis._setXLocation(bDI, mx);\r\n\r\n\t\t\t\t\tthis._setContext(lDI, vy, valueYReal, true);\r\n\t\t\t\t}\r\n\t\t\t\tif (corner == \"r\") {\r\n\t\t\t\t\tconst valueX0 = lDI.get(vx, 0)\r\n\t\t\t\t\tconst positionX0 = xAxis.valueToPosition(valueX0);\r\n\t\t\t\t\tconst positionX = xAxis.valueToPosition(valueX);\r\n\r\n\t\t\t\t\tthis._setContext(rDI, vx, valueX);\r\n\t\t\t\t\tthis._setXLocation(rDI, valueX);\r\n\r\n\t\t\t\t\tlet mpos = positionX0 + (positionX - positionX0) / 2;\r\n\t\t\t\t\tlet mx = this._getXValue(xAxis.positionToValue(mpos));\r\n\r\n\t\t\t\t\tthis._setContext(tDI, vx, mx);\r\n\t\t\t\t\tthis._setContext(bDI, vx, mx);\r\n\r\n\t\t\t\t\tthis._setXLocation(tDI, mx);\r\n\t\t\t\t\tthis._setXLocation(bDI, mx);\r\n\r\n\t\t\t\t\tthis._setContext(rDI, vy, valueYReal, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._positionBullets(dataItem);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerClick(event: ISpritePointerEvent) {\r\n\t\tif (this._drawingEnabled) {\r\n\t\t\tsuper._handlePointerClick(event);\r\n\r\n\t\t\tif (!this._isDragging) {\r\n\t\t\t\tif (!this._isDrawing) {\r\n\t\t\t\t\tif (this.unselectAllDrawings() == 0) {\r\n\t\t\t\t\t\tthis._increaseIndex();\r\n\t\t\t\t\t\tthis.isDrawing(true);\r\n\t\t\t\t\t\tthis._hideResizer(event.target);\r\n\t\t\t\t\t\tthis.bulletsContainer.show();\r\n\t\t\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.isDrawing(false);\r\n\t\t\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _createElements(index: number, dataItem?: DataItem<IDrawingSeriesDataItem>) {\r\n\t\tif (!this._ellipses[index]) {\r\n\t\t\tconst ellipse = this.makeEllipse();\r\n\t\t\tellipse._setDataItem(dataItem);\r\n\t\t\tthis._ellipses[index] = ellipse;\r\n\t\t\tellipse.setAll({ userData: index });\r\n\t\t\t(dataItem?.dataContext as any).sprite = ellipse;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handlePointerMove(event: ISpritePointerEvent) {\r\n\t\tsuper._handlePointerMove(event);\r\n\t\tif (this._isDrawing) {\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (movePoint) {\r\n\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\t\tconst index = this._index;\r\n\t\t\t\tconst dataItems = this._di[index];\r\n\r\n\t\t\t\tif (dataItems) {\r\n\t\t\t\t\tconst diT = this._di[index][\"t\"];\r\n\t\t\t\t\tconst diB = this._di[index][\"b\"];\r\n\t\t\t\t\tconst diL = this._di[index][\"l\"];\r\n\t\t\t\t\tconst diR = this._di[index][\"r\"];\r\n\r\n\t\t\t\t\tconst valueY0 = this._clickVY;\r\n\r\n\t\t\t\t\tconst positionX = xAxis.coordinateToPosition(movePoint.x);\r\n\t\t\t\t\tconst positionX0 = this._clickPX;\r\n\r\n\t\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)), valueX);\r\n\r\n\t\t\t\t\tif (diB && diL && diR && diT) {\r\n\t\t\t\t\t\tthis._setContext(diB, \"valueY\", valueY, true);\r\n\r\n\t\t\t\t\t\tconst my = valueY0 + (valueY - valueY0) / 2;\r\n\t\t\t\t\t\tconst mx = this._getXValue(xAxis.positionToValue(positionX0 + (positionX - positionX0) / 2))\r\n\r\n\t\t\t\t\t\tthis._setContext(diR, \"valueY\", my, true);\r\n\t\t\t\t\t\tthis._setContext(diL, \"valueY\", my, true);\r\n\r\n\t\t\t\t\t\tthis._setContext(diB, \"valueX\", mx);\r\n\t\t\t\t\t\tthis._setContext(diT, \"valueX\", mx);\r\n\r\n\t\t\t\t\t\tthis._setXLocation(diB, mx);\r\n\t\t\t\t\t\tthis._setXLocation(diT, mx);\r\n\r\n\t\t\t\t\t\tthis._setContext(diR, \"valueX\", valueX);\r\n\t\t\t\t\t\tthis._setXLocation(diR, valueX);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoints(event: ISpritePointerEvent, index: number) {\r\n\t\tconst chart = this.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tthis.data.push({ settings: this._getEllipseTemplate(), stroke: this._getStrokeTemplate(), index: index, corner: \"e\", drawingId: this._drawingId });\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tconst point = chart.plotContainer.toLocal(event.point);\r\n\t\t\tthis._clickPX = xAxis.coordinateToPosition(point.x);\r\n\r\n\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(this._clickPX));\r\n\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(point.y)), valueX);\r\n\r\n\t\t\tthis._clickVY = valueY;\r\n\r\n\t\t\tthis._di[index] = {};\r\n\r\n\t\t\tthis._addPoint(valueX, valueY, \"l\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"t\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"b\", index);\r\n\t\t\tthis._addPoint(valueX, valueY, \"r\", index);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _addPoint(valueX: number, valueY: number, corner: string, index: number) {\r\n\t\tthis.data.push({ valueY: valueY, valueX: valueX, index: index, corner: corner, drawingId: this._drawingId });\r\n\t\tconst len = this.dataItems.length;\r\n\t\tconst dataItem = this.dataItems[len - 1];\r\n\t\tif (dataItem) {\r\n\t\t\tthis._setXLocation(dataItem, valueX);\r\n\t\t\tthis.setPrivate(\"startIndex\", 0);\r\n\t\t\tthis.setPrivate(\"endIndex\", len);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tlet index = 0;\r\n\t\t$array.each(this._di, (dataItems) => {\r\n\t\t\tif (dataItems) {\r\n\t\t\t\tconst diT = dataItems[\"t\"];\r\n\t\t\t\tconst diB = dataItems[\"b\"];\r\n\t\t\t\tconst diL = dataItems[\"l\"];\r\n\t\t\t\tconst diR = dataItems[\"r\"];\r\n\t\t\t\tif (diT && diB && diL && diR) {\r\n\t\t\t\t\tconst pt = diT.get(\"point\");\r\n\t\t\t\t\tconst pb = diB.get(\"point\");\r\n\t\t\t\t\tconst pr = diR.get(\"point\");\r\n\t\t\t\t\tconst pl = diL.get(\"point\");\r\n\r\n\t\t\t\t\tif (pt && pb && pr && pl) {\r\n\t\t\t\t\t\tconst rx = (pr.x - pl.x) / 2;\r\n\t\t\t\t\t\tconst ry = (pb.y - pt.y) / 2;\r\n\t\t\t\t\t\tconst x = pl.x + rx;\r\n\t\t\t\t\t\tconst y = pt.y + ry;\r\n\t\t\t\t\t\tconst ellipse = this._ellipses[index];\r\n\t\t\t\t\t\tif (ellipse) {\r\n\t\t\t\t\t\t\tellipse.setAll({ x: x, y: y, radiusX: rx, radiusY: ry });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tindex++;\r\n\t\t})\r\n\t}\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst ellipse = this._ellipses[index];\r\n\t\t\tif (ellipse) {\r\n\t\t\t\tdelete (this._ellipses[index]);\r\n\t\t\t\tthis.ellipses.removeValue(ellipse);\r\n\t\t\t\tellipse.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getEllipseTemplate(): Template<any> {\r\n\t\tconst template = this._getStrokeTemplate();\r\n\r\n\t\tconst fillColor = this.get(\"fillColor\");\r\n\t\tif (fillColor != null) {\r\n\t\t\ttemplate.set(\"fill\", fillColor);\r\n\t\t}\r\n\r\n\t\tconst fillOpacity = this.get(\"fillOpacity\");\r\n\t\tif (fillOpacity != null) {\r\n\t\t\ttemplate.set(\"fillOpacity\", fillOpacity);\r\n\t\t}\r\n\r\n\t\treturn template;\r\n\t}\r\n\r\n\tpublic setInteractive(value: boolean) {\r\n\t\tsuper.setInteractive(value);\r\n\t\tthis.ellipses.template.set(\"forceInactive\", !value);\r\n\t}\r\n\r\n\tpublic enableDrawingSelection(value: boolean) {\r\n\t\tsuper.enableDrawingSelection(value);\r\n\t\tthis.ellipses.template.set(\"forceInactive\", !value);\r\n\t}\r\n}\r\n","import { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface ITrendLineSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface ITrendLineSeriesSettings extends ISimpleLineSeriesSettings {\r\n}\r\n\r\nexport interface ITrendLineSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class TrendLineSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"TrendLineSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([TrendLineSeries.className]);\r\n\r\n\tdeclare public _settings: ITrendLineSeriesSettings;\r\n\tdeclare public _privateSettings: ITrendLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: ITrendLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"trendline\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.setPrivate(\"allowChangeSnap\", false);\r\n\t\tthis.set(\"snapToData\", true);\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\t\tif (series && diP1 && diP2) {\r\n\r\n\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\tlet x1 = this._getXValue(diP1.get(\"valueX\" as any));\r\n\t\t\tlet x2 = this._getXValue(diP2.get(\"valueX\" as any));\r\n\r\n\t\t\tconst di1 = xAxis.getSeriesItem(series, Math.max(0, xAxis.valueToPosition(x1)));\r\n\t\t\tconst di2 = xAxis.getSeriesItem(series, Math.min(1, xAxis.valueToPosition(x2)));\r\n\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tif (di1 && di2) {\r\n\t\t\t\tlet y1 = di1.get(field as any);\r\n\t\t\t\tlet y2 = di2.get(field as any);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueY\", y1, true);\r\n\t\t\t\tthis._setContext(diP2, \"valueY\", y2, true);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueX\", x1);\r\n\t\t\t\tthis._setContext(diP2, \"valueX\", x2);\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t\tthis._positionBullets(diP2);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IQuadrantLineSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IQuadrantLineSeriesSettings extends ISimpleLineSeriesSettings {\r\n}\r\n\r\nexport interface IQuadrantLineSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class QuadrantLineSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"QuadrantLineSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([QuadrantLineSeries.className]);\r\n\r\n\tdeclare public _settings: IQuadrantLineSeriesSettings;\r\n\tdeclare public _privateSettings: IQuadrantLineSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IQuadrantLineSeriesDataItem;\r\n\r\n\tprotected _tag = \"quadrant\";\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.strokes.template.set(\"visible\", false);\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\r\n\t\tif (series && diP1 && diP2) {\r\n\t\t\tlet x1 = this._getXValue(diP1.get(\"valueX\" as any));\r\n\t\t\tlet x2 = this._getXValue(diP2.get(\"valueX\" as any));\r\n\r\n\t\t\tconst field = this.get(\"field\") + \"Y\";\r\n\r\n\t\t\tlet y1 = this._getYValue(diP1.get(field as any), x1, true);\r\n\t\t\tlet y2 = this._getYValue(diP2.get(field as any), x2, true);\r\n\r\n\t\t\tthis._setContext(diP1, \"valueY\", y1, true);\r\n\t\t\tthis._setContext(diP2, \"valueY\", y2, true);\r\n\r\n\t\t\tthis._positionBullets(diP1);\r\n\t\t\tthis._positionBullets(diP2);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tconst chart = this.chart;\r\n\t\tthis.fills.clear();\r\n\t\tif (chart) {\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\t\t\t\t\tconst di = this._di[i][\"e\"];\r\n\t\t\t\t\tconst dataContext = di.dataContext as any;\r\n\r\n\t\t\t\t\tconst fill1 = this.makeFill(this.fills);\r\n\t\t\t\t\tconst fill2 = this.makeFill(this.fills);\r\n\r\n\t\t\t\t\tconst index = this.dataItems.indexOf(diP1);\r\n\t\t\t\t\tfor (let j = index; j >= 0; j--) {\r\n\t\t\t\t\t\tconst dataContext = this.dataItems[j].dataContext as any;\r\n\t\t\t\t\t\tconst template = dataContext.fill;\r\n\t\t\t\t\t\tif (template) {\r\n\t\t\t\t\t\t\tfill1.template = template;\r\n\t\t\t\t\t\t\tfill2.template = template;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst userData = [this.dataItems.indexOf(diP1), this.dataItems.indexOf(diP2)];\r\n\r\n\t\t\t\t\tlet fillColor = this.get(\"fillColor\", this.get(\"fill\"));\r\n\r\n\t\t\t\t\tconst fillTemplate = dataContext.fill;\r\n\r\n\t\t\t\t\tif (fillTemplate) {\r\n\t\t\t\t\t\tfillColor = fillTemplate.get(\"fill\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst settings = { userData: userData, fill: fillColor };\r\n\t\t\t\t\tfill1.setAll(settings);\r\n\t\t\t\t\tfill2.setAll(settings);\r\n\t\t\t\t\tfill2.set(\"forceInactive\", true);\r\n\r\n\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\tconst dy = (p2.y - p1.y) / 4;\r\n\t\t\t\t\t\tconst m1y = p1.y + dy;\r\n\t\t\t\t\t\tconst m2y = p1.y + dy * 2;\r\n\t\t\t\t\t\tconst m3y = p1.y + dy * 3;\r\n\r\n\t\t\t\t\t\tline.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p1.y);\r\n\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, m1y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, m1y);\r\n\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, m2y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, m2y);\r\n\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, m3y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, m3y);\r\n\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, p2.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y);\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tfill1.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, p1.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p1.y);\r\n\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, p2.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p1.x, p2.y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p1.x, p1.y);\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tfill2.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\tdisplay.moveTo(p1.x, m1y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, m1y);\r\n\r\n\t\t\t\t\t\t\tdisplay.lineTo(p2.x, m3y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p1.x, m3y);\r\n\t\t\t\t\t\t\tdisplay.lineTo(p1.x, m1y);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _drawFill() {\r\n\r\n\t}\r\n\r\n\tprotected _updateLine() {\r\n\r\n\t}\r\n}","import type { Graphics } from \"../../../core/render/Graphics\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\nimport type { Sprite } from \"../../../core/render/Sprite\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\nimport { Label } from \"../../../core/render/Label\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IFibonacciSeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IFibonacciSeriesSettings extends ISimpleLineSeriesSettings {\r\n\r\n\t/**\r\n\t * Sequence.\r\n\t */\r\n\tsequence?: Array<number>;\r\n\r\n\t/**\r\n\t * Array of colors to use for bands.\r\n\t */\r\n\tcolors?: Array<Color>\r\n\r\n}\r\n\r\nexport interface IFibonacciSeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class FibonacciSeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"FibonacciSeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([FibonacciSeries.className]);\r\n\r\n\tdeclare public _settings: IFibonacciSeriesSettings;\r\n\tdeclare public _privateSettings: IFibonacciSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IFibonacciSeriesDataItem;\r\n\r\n\tprotected _tag = \"fibonacci\";\r\n\tprotected _labels: Array<Array<Label>> = [];\r\n\tprotected _fills: Array<Array<Graphics>> = [];\r\n\tprotected _strokes: Array<Array<Graphics>> = [];\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeLabel(): Label {\r\n\t\tconst label = this.labels.make();\r\n\t\tthis.bulletsContainer.children.push(label);\r\n\t\tthis.labels.push(label);\r\n\t\treturn label;\r\n\t}\r\n\r\n\t/**\r\n\t * A list of labels.\r\n\t *\r\n\t * `labels.template` can be used to configure axis labels.\r\n\t *\r\n\t * @default new ListTemplate<Label>\r\n\t */\r\n\tpublic readonly labels: ListTemplate<Label> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Label._new(this._root, {}, [this.labels.template])\r\n\t));\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\t\tthis._updateChildrenReal();\r\n\t}\r\n\r\n\tprotected _getIndex(sprite: Sprite): number {\r\n\t\treturn sprite.get(\"userData\");\r\n\t}\r\n\r\n\tprotected _updateChildrenReal() {\r\n\t\tconst chart = this.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\r\n\t\t\t\t\tif (diP1 && diP2) {\r\n\r\n\t\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\t\tconst sequence = this.get(\"sequence\", []);\r\n\t\t\t\t\t\t\tlet prevValue = 0;\r\n\r\n\t\t\t\t\t\t\tconst labels = this._labels[i];\r\n\t\t\t\t\t\t\tconst strokes = this._strokes[i];\r\n\t\t\t\t\t\t\tconst fills = this._fills[i];\r\n\r\n\t\t\t\t\t\t\tfor (let i = 0; i < sequence.length; i++) {\r\n\t\t\t\t\t\t\t\tconst value = sequence[i] - 1;\r\n\r\n\t\t\t\t\t\t\t\tconst label = labels[i];\r\n\r\n\t\t\t\t\t\t\t\tconst fill = fills[i];\r\n\t\t\t\t\t\t\t\tconst stroke = strokes[i];\r\n\r\n\t\t\t\t\t\t\t\tlet fillColor = this.get(\"colors\", [])[i];\r\n\t\t\t\t\t\t\t\tlet strokeColor = fillColor;\r\n\r\n\t\t\t\t\t\t\t\tfill.set(\"fill\", fillColor);\r\n\t\t\t\t\t\t\t\tfill.set(\"fillOpacity\", this.get(\"fillOpacity\", 0));\r\n\t\t\t\t\t\t\t\tstroke.set(\"stroke\", strokeColor);\r\n\t\t\t\t\t\t\t\tstroke.set(\"strokeOpacity\", this.get(\"strokeOpacity\", 0));\r\n\r\n\t\t\t\t\t\t\t\tconst y1 = p1.y + (p2.y - p1.y) * prevValue;\r\n\t\t\t\t\t\t\t\tconst y2 = p1.y + (p2.y - p1.y) * -value;\r\n\r\n\t\t\t\t\t\t\t\tconst realValue = yAxis.positionToValue(yAxis.coordinateToPosition(y2));\r\n\r\n\t\t\t\t\t\t\t\tfill.setPrivate(\"visible\", true);\r\n\t\t\t\t\t\t\t\tstroke.setPrivate(\"visible\", true);\r\n\r\n\t\t\t\t\t\t\t\tfill.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\t\tdisplay.moveTo(p1.x, y1);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, y1);\r\n\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, y2);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(p1.x, y2);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(p1.x, y1);\r\n\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\tstroke.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\t\tdisplay.moveTo(p1.x, y2);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(p2.x, y2);\r\n\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\tconst dataItem = label.dataItem;\r\n\t\t\t\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\t\t\t\tdataItem.set(\"value\" as any, realValue);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlabel.setAll({ x: p2.x, y: y2, fill: fillColor });\r\n\t\t\t\t\t\t\t\tlabel.text.markDirtyText();\r\n\r\n\t\t\t\t\t\t\t\tprevValue = -value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _createElements(index: number) {\r\n\t\tsuper._createElements(index);\r\n\r\n\t\tif (!this._fills[index]) {\r\n\r\n\t\t\tconst labelArr = [];\r\n\t\t\tconst fillsArr = [];\r\n\t\t\tconst strokesArr = [];\r\n\r\n\t\t\tconst sequence = this.get(\"sequence\", []);\r\n\r\n\t\t\tfor (let i = 0; i < sequence.length; i++) {\r\n\t\t\t\tconst label = this.makeLabel();\r\n\t\t\t\tconst dataItem = this.makeDataItem({});\r\n\t\t\t\tdataItem.set(\"sequence\" as any, sequence[i]);\r\n\t\t\t\tlabel._setDataItem(dataItem);\r\n\t\t\t\tlabelArr.push(label);\r\n\r\n\t\t\t\tconst fill = this.makeFill(this.fills);\r\n\t\t\t\tfillsArr.push(fill);\r\n\t\t\t\tfill.set(\"userData\", index);\r\n\t\t\t\tfill.states.remove(\"hover\");\r\n\r\n\t\t\t\tconst stroke = this.makeStroke(this.strokes);\r\n\t\t\t\tstroke.set(\"userData\", index);\r\n\t\t\t\tstrokesArr.push(stroke);\r\n\t\t\t}\r\n\r\n\t\t\tthis._labels[index] = labelArr;\r\n\t\t\tthis._fills[index] = fillsArr;\r\n\t\t\tthis._strokes[index] = strokesArr;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _drawFill() {\r\n\r\n\t}\r\n\r\n\tprotected _drawStroke() {\r\n\r\n\t}\r\n\r\n\tprotected _updateLine() {\r\n\r\n\t}\r\n\r\n\tprotected _clearGraphics() {\r\n\r\n\t}\r\n\r\n\t/*\r\n\tpublic enableDrawing() {\r\n\t\tsuper.enableDrawing();\r\n\t\tthis.showAllBullets();\r\n\t}\r\n\r\n\tpublic enableErasing() {\r\n\t\tsuper.enableErasing();\r\n\t\tthis.showAllBullets();\r\n\t}\r\n\r\n\tprotected _hideAllBullets() {\r\n\t\tif (this._drawingEnabled || this._erasingEnabled) {\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsuper._hideAllBullets();\r\n\t\t}\r\n\t}*/\r\n\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst labels = this._labels[index];\r\n\t\t\tconst fills = this._fills[index];\r\n\t\t\tconst strokes = this._strokes[index];\r\n\r\n\t\t\tif (labels) {\r\n\t\t\t\t$array.each(labels, (item) => {\r\n\t\t\t\t\titem.dispose();\r\n\t\t\t\t\tthis.labels.removeValue(item);\r\n\t\t\t\t})\r\n\r\n\t\t\t\tdelete (this._labels[index]);\r\n\t\t\t}\r\n\t\t\tif (fills) {\r\n\t\t\t\t$array.each(fills, (item) => {\r\n\t\t\t\t\tthis.fills.removeValue(item);\r\n\t\t\t\t\titem.dispose();\r\n\t\t\t\t})\r\n\t\t\t\tdelete (this._fills[index]);\r\n\t\t\t}\r\n\t\t\tif (strokes) {\r\n\t\t\t\t$array.each(strokes, (item) => {\r\n\t\t\t\t\tthis.strokes.removeValue(item);\r\n\t\t\t\t\titem.dispose();\r\n\t\t\t\t})\r\n\t\t\t\tdelete (this._strokes[index]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import { FibonacciSeries, IFibonacciSeriesSettings, IFibonacciSeriesPrivate, IFibonacciSeriesDataItem } from \"./FibonacciSeries\";\r\nimport { color } from \"../../../core/util/Color\";\r\n\r\nexport interface IFibonacciTimezoneSeriesDataItem extends IFibonacciSeriesDataItem {\r\n}\r\n\r\nexport interface IFibonacciTimezoneSeriesSettings extends IFibonacciSeriesSettings {\r\n}\r\n\r\nexport interface IFibonacciTimezoneSeriesPrivate extends IFibonacciSeriesPrivate {\r\n}\r\n\r\nexport class FibonacciTimezoneSeries extends FibonacciSeries {\r\n\tpublic static className: string = \"FibonacciTimezoneSeries\";\r\n\tpublic static classNames: Array<string> = FibonacciSeries.classNames.concat([FibonacciTimezoneSeries.className]);\r\n\r\n\tdeclare public _settings: IFibonacciTimezoneSeriesSettings;\r\n\tdeclare public _privateSettings: IFibonacciTimezoneSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IFibonacciTimezoneSeriesDataItem;\r\n\r\n\tprotected _tag = \"fibonaccitimezone\";\r\n\r\n\tprotected _updateSegmentReal(index: number) {\r\n\t\tconst dataItems = this._di[index];\r\n\r\n\t\tif (dataItems) {\r\n\t\t\tconst diP1 = dataItems[\"p1\"];\r\n\t\t\tconst diP2 = dataItems[\"p2\"];\r\n\t\t\tif (diP1 && diP2) {\r\n\t\t\t\tthis._setContext(diP2, \"valueY\", diP1.get(\"valueY\", 0), true);\r\n\t\t\t\tdiP1.setRaw(\"locationX\", 0);\r\n\t\t\t\tdiP2.setRaw(\"locationX\", 0);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tsuper._updateSegment(index);\r\n\t\tthis._updateSegmentReal(index);\r\n\t}\r\n\r\n\tpublic _updateChildrenReal() {\r\n\t\tconst chart = this.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\t\tconst line = this._lines[i];\r\n\t\t\t\tif (line) {\r\n\t\t\t\t\tconst diP1 = this._di[i][\"p1\"];\r\n\t\t\t\t\tconst diP2 = this._di[i][\"p2\"];\r\n\t\t\t\t\tconst di = this._di[i][\"e\"];\r\n\r\n\t\t\t\t\tconst p1 = diP1.get(\"point\");\r\n\t\t\t\t\tconst p2 = diP2.get(\"point\");\r\n\r\n\t\t\t\t\tconst open1 = diP1[\"open\"];\r\n\t\t\t\t\tconst open2 = diP2[\"open\"];\r\n\r\n\t\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\t\t\tif (open1 && open2 && di) {\r\n\t\t\t\t\t\tconst valueX1 = open1[\"valueX\"]\r\n\t\t\t\t\t\tconst valueX2 = open2[\"valueX\"]\r\n\t\t\t\t\t\tconst diff = valueX2 - valueX1;\r\n\r\n\t\t\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\t\t\tconst dataContext = di.dataContext as any;\r\n\r\n\t\t\t\t\t\t\tconst sequence = this.get(\"sequence\", []);\r\n\t\t\t\t\t\t\tconst labels = this._labels[i];\r\n\t\t\t\t\t\t\tconst fills = this._fills[i];\r\n\t\t\t\t\t\t\tconst strokes = this._strokes[i];\r\n\r\n\t\t\t\t\t\t\tfor (let i = 0; i < sequence.length; i++) {\r\n\t\t\t\t\t\t\t\tconst value = sequence[i];\r\n\t\t\t\t\t\t\t\tconst label = labels[i];\r\n\t\t\t\t\t\t\t\tconst fill = fills[i];\r\n\t\t\t\t\t\t\t\tconst stroke = strokes[i];\r\n\r\n\t\t\t\t\t\t\t\tthis.mainContainer.children.moveValue(fill, 0);\r\n\r\n\t\t\t\t\t\t\t\tconst endValue = valueX1 + diff * value;\r\n\t\t\t\t\t\t\t\tconst x1 = p1.x;\r\n\t\t\t\t\t\t\t\tconst x2 = xAxis.get(\"renderer\").positionToCoordinate(xAxis.valueToPosition(endValue));\r\n\r\n\t\t\t\t\t\t\t\tconst y1 = 0;\r\n\t\t\t\t\t\t\t\tconst y2 = chart.plotContainer.height();\r\n\r\n\t\t\t\t\t\t\t\tfill.setPrivate(\"visible\", true);\r\n\t\t\t\t\t\t\t\tstroke.setPrivate(\"visible\", true);\r\n\r\n\t\t\t\t\t\t\t\tconst fillTemplate = dataContext.fill;\r\n\t\t\t\t\t\t\t\tlet fillColor = this.get(\"colors\", [])[i];\r\n\t\t\t\t\t\t\t\tlet strokeColor = fillColor;\r\n\r\n\t\t\t\t\t\t\t\tfill.set(\"fillOpacity\", this.get(\"fillOpacity\", 0) * 0.2);\r\n\t\t\t\t\t\t\t\tstroke.set(\"strokeOpacity\", this.get(\"strokeOpacity\", 0));\r\n\r\n\t\t\t\t\t\t\t\tif (!fillColor) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (fillTemplate) {\r\n\t\t\t\t\t\t\t\t\t\tfillColor = fillTemplate.get(\"fill\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (!fillColor) {\r\n\t\t\t\t\t\t\t\t\t\tfillColor = this.get(\"fillColor\", this.get(\"fill\", color(0x000000)));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (!strokeColor) {\r\n\t\t\t\t\t\t\t\t\tconst strokeTemplate = dataContext.stroke;\r\n\t\t\t\t\t\t\t\t\tif (strokeTemplate) {\r\n\t\t\t\t\t\t\t\t\t\tstrokeColor = strokeTemplate.get(\"stroke\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (!strokeColor) {\r\n\t\t\t\t\t\t\t\t\t\tstrokeColor = this.get(\"strokeColor\", this.get(\"stroke\", color(0x000000)));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tfill.set(\"fill\", fillColor);\r\n\t\t\t\t\t\t\t\tstroke.set(\"stroke\", strokeColor);\r\n\r\n\r\n\t\t\t\t\t\t\t\tfill.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\t\tdisplay.moveTo(x1, y1);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x2, y1);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x2, y2);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x1, y2);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x1, y1);\r\n\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\tstroke.set(\"draw\", (display) => {\r\n\t\t\t\t\t\t\t\t\tdisplay.moveTo(x2, y1);\r\n\t\t\t\t\t\t\t\t\tdisplay.lineTo(x2, y2);\r\n\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\tconst dataItem = label.dataItem;\r\n\t\t\t\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\t\t\t\tdataItem.set(\"value\" as any, value);\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tlabel.setAll({ x: x2, y: y2, dy: -20 });\r\n\t\t\t\t\t\t\t\tlabel.text.markDirtyText();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { ISpritePointerEvent } from \"../../../core/render/Sprite\";\r\nimport type { DataItem } from \"../../../core/render/Component\";\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nimport { SimpleLineSeries, ISimpleLineSeriesSettings, ISimpleLineSeriesPrivate, ISimpleLineSeriesDataItem } from \"./SimpleLineSeries\";\r\n\r\nexport interface IHorizontalRaySeriesDataItem extends ISimpleLineSeriesDataItem {\r\n}\r\n\r\nexport interface IHorizontalRaySeriesSettings extends ISimpleLineSeriesSettings {\r\n}\r\n\r\nexport interface IHorizontalRaySeriesPrivate extends ISimpleLineSeriesPrivate {\r\n}\r\n\r\nexport class HorizontalRaySeries extends SimpleLineSeries {\r\n\tpublic static className: string = \"HorizontalRaySeries\";\r\n\tpublic static classNames: Array<string> = SimpleLineSeries.classNames.concat([HorizontalRaySeries.className]);\r\n\r\n\tdeclare public _settings: IHorizontalRaySeriesSettings;\r\n\tdeclare public _privateSettings: IHorizontalRaySeriesPrivate;\r\n\tdeclare public _dataItemSettings: IHorizontalRaySeriesDataItem;\r\n\r\n\tprotected _tag = \"ray\";\r\n\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.lines.template.set(\"forceHidden\", true);\r\n\t}\r\n\r\n\tprotected _handleBulletDragged(event: ISpritePointerEvent) {\r\n\t\tsuper._handleBulletDragged(event);\r\n\r\n\t\tconst dataItem = event.target.dataItem as DataItem<IHorizontalRaySeriesDataItem>;\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\tif (dataContext) {\r\n\t\t\tconst index = dataContext.index;\r\n\t\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\t\tconst movePoint = this._movePointerPoint;\r\n\r\n\t\t\tif (diP1 && diP2 && movePoint) {\r\n\t\t\t\tconst yAxis = this.get(\"yAxis\");\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\t\t\tconst valueX = this._getXValue(xAxis.positionToValue(xAxis.coordinateToPosition(movePoint.x)));\r\n\t\t\t\tconst valueY = this._getYValue(yAxis.positionToValue(yAxis.coordinateToPosition(movePoint.y)), valueX);\r\n\r\n\t\t\t\tconst min = xAxis.getPrivate(\"min\", 0);\r\n\t\t\t\tconst max = xAxis.getPrivate(\"max\", 1);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueY\", valueY, true);\r\n\t\t\t\tthis._setContext(diP2, \"valueY\", valueY, true);\r\n\r\n\t\t\t\tthis._setContext(diP1, \"valueX\", valueX);\r\n\t\t\t\tthis._setContext(diP2, \"valueX\", max + (max - min));\r\n\r\n\t\t\t\tthis._setXLocation(diP1, diP1.get(\"valueX\", 0));\r\n\r\n\t\t\t\tthis._positionBullets(diP1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _prepareChildren(): void {\r\n\t\tsuper._prepareChildren();\r\n\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\r\n\t\tconst min = xAxis.getPrivate(\"min\", 0);\r\n\t\tconst max = xAxis.getPrivate(\"max\", 1);\r\n\r\n\t\t$array.each(this._di, (di) => {\r\n\t\t\tif(di){\r\n\t\t\t\tthis._setContext(di[\"p2\"], \"valueX\", max + (max - min), true);\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _handlePointerMoveReal() {\r\n\r\n\t}\r\n\r\n\tprotected _updateSegment(index: number) {\r\n\t\tif (this._di[index]) {\r\n\t\t\tconst diP2 = this._di[index][\"p2\"];\r\n\r\n\t\t\tif (diP2) {\r\n\t\t\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\t\t\tconst min = xAxis.getPrivate(\"min\", 0);\r\n\t\t\t\tconst max = xAxis.getPrivate(\"max\", 1);\r\n\r\n\r\n\t\t\t\tthis._setContext(diP2, \"valueX\", max + (max - min), true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\r\n\tprotected _handlePointerClickReal(event: ISpritePointerEvent) {\r\n\t\tif (this._drawingEnabled) {\r\n\t\t\tif (!this._isDragging) {\r\n\t\t\t\tif (this.unselectAllDrawings() == 0) {\r\n\t\t\t\t\tthis._increaseIndex();\r\n\t\t\t\t\tthis._addPoints(event, this._index);\r\n\t\t\t\t\tthis.isDrawing(false);\r\n\t\t\t\t\tthis._hideResizer();\r\n\r\n\t\t\t\t\tthis._updateSegment(this._index);\r\n\t\t\t\t\tthis._dispatchStockEvent(\"drawingadded\", this._drawingId, this._index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import type { IPoint } from \"../../../core/util/IPoint\";\r\nimport type { Line } from \"../../../core/render/Line\";\r\nimport type { XYSeries } from \"../../xy/series/XYSeries\";\r\nimport type { StockPanel } from \"../StockPanel\";\r\nimport type { Graphics } from \"../../../core/render/Graphics\";\r\n\r\nimport { RectangleSeries, IRectangleSeriesSettings, IRectangleSeriesPrivate, IRectangleSeriesDataItem } from \"./RectangleSeries\";\r\nimport { Template } from \"../../../core/util/Template\";\r\nimport { ListTemplate } from \"../../../core/util/List\";\r\nimport { Label } from \"../../../core/render/Label\";\r\nimport { DataItem } from \"../../../core/render/Component\";\r\nimport { RoundedRectangle } from \"../../../core/render/RoundedRectangle\";\r\n\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IMeasureDataItem extends IRectangleSeriesDataItem {\r\n}\r\n\r\nexport interface IMeasureSettings extends IRectangleSeriesSettings {\r\n\tlabelText?: string;\r\n\tlabelVolumeText?: string;\r\n}\r\n\r\nexport interface IMeasurePrivate extends IRectangleSeriesPrivate {\r\n}\r\n\r\nexport class Measure extends RectangleSeries {\r\n\tpublic static className: string = \"Measure\";\r\n\tpublic static classNames: Array<string> = RectangleSeries.classNames.concat([Measure.className]);\r\n\r\n\tdeclare public _settings: IMeasureSettings;\r\n\tdeclare public _privateSettings: IMeasurePrivate;\r\n\tdeclare public _dataItemSettings: IMeasureDataItem;\r\n\r\n\tprotected _lines: Array<Line> = [];\r\n\tprotected _labels: Array<Label> = [];\r\n\r\n\tprotected _tag = \"measure\";\r\n\r\n\tpublic _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis.set(\"snapToData\", true);\r\n\t\tthis.strokes.template.set(\"templateField\", undefined);\r\n\t\tthis.fills.template.set(\"templateField\", undefined);\r\n\t}\r\n\r\n\t/**\r\n\t * A list of labels.\r\n\t *\r\n\t * `labels.template` can be used to configure axis labels.\r\n\t *\r\n\t * @default new ListTemplate<Label>\r\n\t */\r\n\tpublic readonly labels: ListTemplate<Label> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Label._new(this._root, {}, [this.labels.template])\r\n\t));\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeLabel(): Label {\r\n\t\tconst label = this.labels.make();\r\n\t\tthis.bulletsContainer.children.push(label);\r\n\t\tlabel.setAll({\r\n\t\t\tpopulateText: true,\r\n\t\t\tbackground: RoundedRectangle.new(this._root, { themeTags: [\"background\"] })\r\n\t\t});\r\n\t\tlabel._setDataItem(new DataItem(this, {}, {}));\r\n\t\tthis.labels.push(label);\r\n\t\treturn label;\r\n\t}\r\n\r\n\tprotected _createElements(index: number) {\r\n\t\tsuper._createElements(index);\r\n\t\tif (!this._labels[index]) {\r\n\t\t\tconst label = this.makeLabel();\r\n\t\t\tthis._labels[index] = label;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _disposeIndex(index: number) {\r\n\t\tsuper._disposeIndex(index);\r\n\t\tconst label = this._labels[index];\r\n\t\tif (label) {\r\n\t\t\tlabel.dispose();\r\n\t\t\tdelete (this._labels[index]);\r\n\t\t}\r\n\r\n\t\tconst line = this._lines[index];\r\n\t\tif (line) {\r\n\t\t\tline.dispose();\r\n\t\t\tdelete (this._lines[index]);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateOthers(index: number, fillGraphics: Graphics, p1: IPoint, p2: IPoint) {\r\n\t\tconst xAxis = this.get(\"xAxis\");\r\n\t\tconst panel = xAxis.chart as StockPanel;\r\n\t\tconst line = this._lines[index];\r\n\r\n\t\tlet positiveColor = this._root.interfaceColors.get(\"positive\");\r\n\t\tlet negativeColor = this._root.interfaceColors.get(\"negative\");\r\n\r\n\t\tconst stockChart = panel.getPrivate(\"stockChart\");\r\n\r\n\t\tlet volumeSeries: XYSeries | undefined;\r\n\r\n\t\tif (stockChart) {\r\n\t\t\tpositiveColor = stockChart.get(\"stockPositiveColor\", positiveColor);\r\n\t\t\tnegativeColor = stockChart.get(\"stockNegativeColor\", negativeColor);\r\n\t\t\tvolumeSeries = stockChart.get(\"volumeSeries\");\r\n\t\t}\r\n\r\n\t\tlet ix = 1;\r\n\t\tif (p1.x > p2.x) {\r\n\t\t\tix = -1;\r\n\t\t}\r\n\r\n\t\tconst label = this._labels[index];\r\n\t\tconst labelBg = label.get(\"background\")!;\r\n\r\n\t\tconst diP1 = this._di[index][\"p1\"];\r\n\t\tconst diP2 = this._di[index][\"p2\"];\r\n\t\tlet color = positiveColor;\r\n\t\tlet iy = 1;\r\n\t\tif (p1.y > p2.y) {\r\n\t\t\tiy = -1;\r\n\t\t\tcolor = negativeColor;\r\n\t\t}\r\n\r\n\t\tfillGraphics.set(\"fill\", color);\r\n\t\tfillGraphics.set(\"fillOpacity\", 0.2);\r\n\t\tline.set(\"stroke\", color);\r\n\t\tlabelBg.set(\"fill\", color);\r\n\r\n\t\tthis.outerCircles.each((outerCircle) => {\r\n\t\t\touterCircle.set(\"stroke\", color);\r\n\t\t})\r\n\r\n\t\tconst mx = p1.x + (p2.x - p1.x) / 2;\r\n\t\tconst my = p1.y + (p2.y - p1.y) / 2;\r\n\r\n\t\tline.set(\"segments\", [[[{ x: mx, y: p1.y }, { x: mx, y: p2.y }]], [[{ x: mx - 5, y: p2.y - 5 * iy }, { x: mx, y: p2.y }, { x: mx + 5, y: p2.y - 5 * iy }]], [[{ x: p1.x, y: my }, { x: p2.x, y: my }]], [[{ x: p2.x - 5 * ix, y: my - 5 }, { x: p2.x, y: my }, { x: p2.x - 5 * ix, y: my + 5 }]]]);\r\n\r\n\t\tconst value1 = diP1.get(\"valueY\", 0);\r\n\t\tconst value2 = diP2.get(\"valueY\", 0);\r\n\r\n\t\tconst numberFormatter = this.getNumberFormatter();\r\n\t\tconst value = numberFormatter.format((value2 - value1));\r\n\t\tconst percent = numberFormatter.format((value2 - value1) / value1 * 100) + \"%\";\r\n\t\tconst baseInterval = xAxis.getPrivate(\"baseInterval\");\r\n\r\n\t\tconst time1 = diP1.get(\"valueX\", 0);\r\n\t\tconst time2 = diP2.get(\"valueX\", 0);\r\n\r\n\t\tconst series = this.get(\"series\");\r\n\r\n\t\tlet count = 0;\r\n\t\tif (series) {\r\n\t\t\tconst di1 = xAxis.getSeriesItem(series, xAxis.valueToPosition(time1));\r\n\t\t\tconst di2 = xAxis.getSeriesItem(series, xAxis.valueToPosition(time2));\r\n\t\t\tif (di1 && di2) {\r\n\t\t\t\tcount = series.dataItems.indexOf(di2) - series.dataItems.indexOf(di1) + 1;\r\n\r\n\t\t\t\tif (this.get(\"snapToData\")) {\r\n\t\t\t\t\tcount--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet intervalCount = Math.ceil((time2 - time1) / xAxis.baseDuration() * baseInterval.count);\r\n\t\tif (intervalCount < count) {\r\n\t\t\tintervalCount = count;\r\n\t\t}\r\n\r\n\r\n\t\tlet volume = 0;\r\n\t\tif (volumeSeries) {\r\n\t\t\tconst div1 = xAxis.getSeriesItem(volumeSeries, xAxis.valueToPosition(time1));\r\n\t\t\tconst div2 = xAxis.getSeriesItem(volumeSeries, xAxis.valueToPosition(time2));\r\n\r\n\t\t\tif (div1 && div2) {\r\n\t\t\t\tconst dataItems = volumeSeries.dataItems;\r\n\t\t\t\tlet i1 = dataItems.indexOf(div1);\r\n\t\t\t\tlet i2 = dataItems.indexOf(div2);\r\n\r\n\t\t\t\tif (i1 > i2) {\r\n\t\t\t\t\t[i1, i2] = [i2, i1];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let i = i1; i < i2; i++) {\r\n\t\t\t\t\tconst dataItem = dataItems[i];\r\n\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\tconst value = dataItem.get(\"valueY\");\r\n\t\t\t\t\t\tif ($type.isNumber(value)) {\r\n\t\t\t\t\t\t\tvolume += value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tlet text = this.get(\"labelText\", \"\");\r\n\t\tif (volume > 0) {\r\n\t\t\ttext += this.get(\"labelVolumeText\");\r\n\t\t}\r\n\r\n\t\tconst unitNames = {\r\n\t\t\tmillisecond: \"ms\",\r\n\t\t\tsecond: \"s\",\r\n\t\t\tminute: \"m\",\r\n\t\t\thour: \"h\",\r\n\t\t\tday: \"d\",\r\n\t\t\tweek: \"wk\",\r\n\t\t\tmonth: \"mo\",\r\n\t\t\tyear: \"y\"\r\n\t\t}\r\n\r\n\t\tlabel.dataItem!.dataContext = {\r\n\t\t\tvalue: value,\r\n\t\t\tpercent: percent,\r\n\t\t\tcount: count,\r\n\t\t\tintervalCount: intervalCount,\r\n\t\t\tintervalUnit: this._root.language.translateAny(unitNames[baseInterval.timeUnit]),\r\n\t\t\tvolume: volume\r\n\t\t};\r\n\r\n\t\tlabel.setAll({\r\n\t\t\ttext: text,\r\n\t\t\tx: mx,\r\n\t\t\ty: my\r\n\t\t});\r\n\r\n\t\tlabel.text.markDirtyText();\r\n\t}\r\n\r\n}\r\n","import type { IDisposer } from \"../../../core/util/Disposer\";\r\nimport type { StockChart } from \"../StockChart\";\r\nimport type { StockControl } from \"./StockControl\";\r\n\r\nimport { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"../../../core/util/Entity\"\r\nimport StockToolbarCSS from \"./StockToolbarCSS\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n//import * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IStockToolbarSettings extends IEntitySettings {\r\n\r\n\t/**\r\n\t * A [[StockChart]] the toolbar is for.\r\n\t */\r\n\tstockChart: StockChart;\r\n\r\n\t/**\r\n\t * A reference to an element in the document to place tools in.\r\n\t */\r\n\tcontainer: HTMLElement;\r\n\r\n\t/**\r\n\t * A list of tools to show in toolbar.\r\n\t */\r\n\tcontrols?: StockControl[];\r\n\r\n\t/**\r\n\t * If set to `false` the toolbar will not load default CSS.\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tuseDefaultCSS?: boolean;\r\n\r\n\t/**\r\n\t * Menu will disable all interactions for the underlying chart when using\r\n\t * tools.\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tdeactivateRoot?: boolean;\r\n\r\n\t/**\r\n\t * Setting this to `true` will essentially enable accessibility for the\r\n\t * toolbar items.\r\n\t *\r\n\t * E.g. buttons will be focusable using TAB key. Lists navigable using arrow\r\n\t * keys, etc.\r\n\t *\r\n\t * @default false\r\n\t */\r\n\tfocusable?: boolean;\r\n\r\n}\r\n\r\nexport interface IStockToolbarPrivate extends IEntityPrivate {\r\n}\r\n\r\nexport interface IStockToolbarEvents extends IEntityEvents {\r\n\tcreated: {}\r\n}\r\n\r\n/**\r\n * Builds a toolbar for [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/} for more info\r\n */\r\nexport class StockToolbar extends Entity {\r\n\tpublic static className: string = \"StockToolbar\";\r\n\tpublic static classNames: Array<string> = Entity.classNames.concat([StockToolbar.className]);\r\n\r\n\tdeclare public _settings: IStockToolbarSettings;\r\n\tdeclare public _privateSettings: IStockToolbarPrivate;\r\n\tdeclare public _events: IStockToolbarEvents;\r\n\r\n\tprivate _cssDisposer?: IDisposer;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Inherit default themes from chart\r\n\t\tthis._defaultThemes = this.get(\"stockChart\")._defaultThemes;\r\n\t\tsuper._afterNewApplyThemes();\r\n\r\n\t\tthis._initControls();\r\n\t\tthis.loadDefaultCSS();\r\n\r\n\t\tthis._root.addDisposer(this);\r\n\r\n\t\tthis.events.dispatch(\"created\", {\r\n\t\t\ttype: \"created\",\r\n\t\t\ttarget: this\r\n\t\t});\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\r\n\t\tif (this.isDirty(\"container\")) {\r\n\t\t\t// TODO\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"useDefaultCSS\")) {\r\n\t\t\tif (this.get(\"useDefaultCSS\")) {\r\n\t\t\t\tthis.loadDefaultCSS();\r\n\t\t\t}\r\n\t\t\telse if (this._cssDisposer) {\r\n\t\t\t\tthis._cssDisposer.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"controls\")) {\r\n\t\t\tthis._initControls();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\r\n\t\tif (this._cssDisposer) {\r\n\t\t\tthis._cssDisposer.dispose();\r\n\t\t}\r\n\r\n\t\tconst controls = this.get(\"controls\", []);\r\n\t\t$array.each(controls, (control, _index) => {\r\n\t\t\tcontrol.dispose();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _initControls(): void {\r\n\t\tconst controls = this.get(\"controls\", []);\r\n\t\t$array.each(controls, (control, _index) => {\r\n\t\t\tif (!control.getPrivate(\"toolbar\")) {\r\n\t\t\t\t// @todo insert at specific index\r\n\t\t\t\tcontrol.setPrivate(\"toolbar\", this);\r\n\t\t\t\tthis.get(\"container\")!.appendChild(control.getPrivate(\"button\")!);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Loads the default CSS.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic loadDefaultCSS(): void {\r\n\t\tconst disposer = StockToolbarCSS($utils.getShadowRoot(this._root.dom), this._root);\r\n\t\tthis._disposers.push(disposer);\r\n\t\tthis._cssDisposer = disposer;\r\n\t}\r\n\r\n}","import { Dropdown, IDropdownSettings, IDropdownPrivate, IDropdownEvents } from \"./Dropdown\"\r\n//import type { IDisposer } from \"../../../core/util/Disposer\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IDropdownListItem {\r\n\tid: string;\r\n\tlabel: string;\r\n\tsubLabel?: string;\r\n\tclassName?: string;\r\n\ticon?: SVGElement;\r\n\tform?: \"radio\" | \"checkbox\";\r\n\tvalue?: string;\r\n\tchecked?: boolean;\r\n\toptions?: IDropdownListItem[];\r\n\tdisabled?: boolean;\r\n}\r\n\r\nexport interface IDropdownListSettings extends IDropdownSettings {\r\n\r\n\t/**\r\n\t * A list of items in the dropdown.\r\n\t */\r\n\titems?: IDropdownListItem[];\r\n\r\n\t/**\r\n\t * Maximum search items to show.\r\n\t */\r\n\tmaxSearchItems?: number;\r\n\r\n\t/**\r\n\t * Is the list searchable? If `true` shows search field and\r\n\t * calls `searchCallback` function for a list of items.\r\n\t */\r\n\tsearchable?: boolean;\r\n\r\n\t/**\r\n\t * A callback function which returns a list of items based on a search query.\r\n\t */\r\n\tsearchCallback?: (query: string) => Promise<IDropdownListItem[]>;\r\n\r\n\t/**\r\n\t * An array of item IDs to now show in the list.\r\n\t *\r\n\t * @since 5.7.0\r\n\t */\r\n\texclude?: string[];\r\n\r\n}\r\n\r\nexport interface IDropdownListPrivate extends IDropdownPrivate {\r\n\tlist?: HTMLUListElement;\r\n\tsearch?: HTMLDivElement;\r\n\tcurrentId?: string;\r\n}\r\n\r\nexport interface IDropdownListEvents extends IDropdownEvents {\r\n\tinvoked: {\r\n\t\titem: IDropdownListItem;\r\n\t};\r\n\r\n\tchanged: {\r\n\t\titem: IDropdownListItem;\r\n\t\tvalue: string | boolean;\r\n\t}\r\n}\r\n\r\n/**\r\n * A dropdown control for [[StockToolbar]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/dropdown-list-control/} for more info\r\n */\r\nexport class DropdownList extends Dropdown {\r\n\tpublic static className: string = \"DropdownList\";\r\n\tpublic static classNames: Array<string> = Dropdown.classNames.concat([DropdownList.className]);\r\n\r\n\tdeclare public _settings: IDropdownListSettings;\r\n\tdeclare public _privateSettings: IDropdownListPrivate;\r\n\tdeclare public _events: IDropdownListEvents;\r\n\r\n\tprivate _currentSelectedIndex?: number;\r\n\r\n\t// private _itemDisposers: Array<IDisposer> = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\t\tthis._setupKeyboardNav();\r\n\t\tthis._root.addDisposer(this);\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\r\n\t\t// Create container\r\n\t\tconst container = this.getPrivate(\"container\")!;\r\n\r\n\t\t// Init search\r\n\t\tif (this.get(\"searchable\")) {\r\n\t\t\tthis._initSearch();\r\n\t\t}\r\n\r\n\t\t// Create list\r\n\t\tconst list = document.createElement(\"ul\");\r\n\t\tlist.className = \"am5stock-control-list\";\r\n\r\n\t\tcontainer.appendChild(list);\r\n\t\tthis.setPrivate(\"list\", list);\r\n\r\n\t\tthis._initItems();\r\n\t}\r\n\r\n\tprotected _sizeItems(): void {\r\n\t\tconst list = this.getPrivate(\"list\");\r\n\t\tif (list) {\r\n\t\t\tlist.style.maxHeight = (this.root.container.height() - 100) + \"px\";\r\n\t\t\tlist.style.overflow = \"auto\";\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Rebuilds the list.\r\n\t * \r\n\t * Useful when changing item data within item list.\r\n\t *\r\n\t * @since 5.7.0\r\n\t */\r\n\tpublic rebuildList(): void {\r\n\t\tthis._initItems();\r\n\t}\r\n\r\n\tprotected _initItems(items?: IDropdownListItem[]): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tlist.innerHTML = \"\";\r\n\r\n\t\tif (!items) {\r\n\t\t\titems = this.get(\"items\", []);\r\n\t\t}\r\n\r\n\t\tconst exclude: any = this.get(\"exclude\", []);\r\n\t\t$array.each(items, (item) => {\r\n\t\t\tif (exclude.indexOf(item.id) == -1) {\r\n\t\t\t\tthis.addItem(item);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (this.get(\"scrollable\")) {\r\n\t\t\tthis._sizeItems();\r\n\t\t}\r\n\r\n\t\tthis._maybeMakeAccessible();\r\n\t}\r\n\r\n\tprotected _initSearch(): void {\r\n\t\tlet searchBox = this.getPrivate(\"search\");\r\n\t\tif (this.get(\"searchable\")) {\r\n\t\t\tif (!searchBox) {\r\n\t\t\t\tconst container = this.getPrivate(\"container\")!;\r\n\t\t\t\tsearchBox = document.createElement(\"div\");\r\n\t\t\t\tsearchBox.className = \"am5stock-list-search\";\r\n\t\t\t\tcontainer.appendChild(searchBox);\r\n\t\t\t\tthis.setPrivate(\"search\", searchBox);\r\n\r\n\t\t\t\tconst input = document.createElement(\"input\");\r\n\t\t\t\tinput.type = \"text\";\r\n\t\t\t\tinput.placeholder = this._root.language.translateAny(\"Search\");\r\n\t\t\t\tsearchBox.appendChild(input);\r\n\r\n\t\t\t\tthis._disposers.push($utils.addEventListener(input, \"input\", (_ev) => {\r\n\t\t\t\t\tthis._filterItems(input.value);\r\n\t\t\t\t}));\r\n\r\n\t\t\t\tthis._disposers.push($utils.addEventListener(input, \"focus\", (_ev) => {\r\n\t\t\t\t\tthis._currentSelectedIndex = undefined;\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (searchBox) {\r\n\t\t\tsearchBox.style.display = \"none\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"items\")) {\r\n\t\t\tthis._initItems();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"searchable\")) {\r\n\t\t\tthis._initSearch();\r\n\t\t}\r\n\r\n\t\tif (this.isPrivateDirty(\"currentId\")) {\r\n\t\t\t// @todo\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"control\")) {\r\n\t\t\tthis._maybeMakeAccessible();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\r\n\t\t// $array.each(this._itemDisposers, (x) => {\r\n\t\t// \tx.dispose();\r\n\t\t// });\r\n\t}\r\n\r\n\tprotected async _filterItems(search?: string) {\r\n\t\tconst searchCallback = this.get(\"searchCallback\");\r\n\t\tif (search == \"\") {\r\n\t\t\tthis._initItems(this.get(\"items\"));\r\n\t\t}\r\n\t\telse if (searchCallback && search) {\r\n\t\t\tconst maxItems = this.get(\"maxSearchItems\", 1000);\r\n\t\t\tlet items = await searchCallback.call(this, search);\r\n\t\t\tif (maxItems && (items.length > maxItems)) {\r\n\t\t\t\titems = items.slice(0, maxItems - 1);\r\n\t\t\t\titems.push({\r\n\t\t\t\t\tid: \"\",\r\n\t\t\t\t\tclassName: \"am5stock-list-info\",\r\n\t\t\t\t\tlabel: this._root.language.translateAny(\"Search results are limited to %1.\", undefined, \"\" + maxItems)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis._initItems(items);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst list = this.getPrivate(\"list\");\r\n\t\t\tif (list) {\r\n\t\t\t\tconst items = list.getElementsByTagName(\"li\");\r\n\t\t\t\t$array.each(items, (item) => {\r\n\t\t\t\t\tconst regex = new RegExp(search || \"\", \"i\");\r\n\t\t\t\t\tif (!search || item.innerText.match(regex)) {\r\n\t\t\t\t\t\titem.style.display = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\titem.style.display = \"none\";\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addItem(info: IDropdownListItem): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst item = document.createElement(\"li\");\r\n\t\titem.className = \"am5stock-list-item\";\r\n\t\titem.setAttribute(\"title\", info.subLabel || info.label);\r\n\r\n\t\tif (info.className) {\r\n\t\t\titem.className += \" \" + info.className;\r\n\t\t}\r\n\r\n\t\tif (info.icon) {\r\n\t\t\titem.appendChild(info.icon);\r\n\t\t}\r\n\r\n\t\tlet inputId: string | undefined;\r\n\t\tif (info.form) {\r\n\t\t\tconst input: HTMLInputElement = document.createElement(\"input\");\r\n\t\t\tinputId = \"am5stock-list-\" + info.id;\r\n\t\t\tinput.type = info.form;\r\n\t\t\tinput.setAttribute(\"tabindex\", \"-1\");\r\n\t\t\tif (info.value) {\r\n\t\t\t\tinput.value = info.value;\r\n\t\t\t}\r\n\t\t\tif (info.form == \"radio\") {\r\n\t\t\t\tinput.name = info.id;\r\n\t\t\t\tinputId += \"-\" + info.value;\r\n\t\t\t}\r\n\t\t\tif (info.checked) {\r\n\t\t\t\tinput.checked = true;\r\n\t\t\t}\r\n\r\n\t\t\tinput.id = inputId;\r\n\r\n\t\t\tthis._disposers.push($utils.addEventListener(item, \"click\", (ev) => {\r\n\t\t\t\t//ev.preventDefault();\r\n\t\t\t\tif (ev.target !== input) {\r\n\t\t\t\t\tinput.checked = !input.checked;\r\n\t\t\t\t}\r\n\t\t\t\tthis.events.dispatch(\"changed\", {\r\n\t\t\t\t\ttype: \"changed\",\r\n\t\t\t\t\titem: info,\r\n\t\t\t\t\tvalue: input.checked,\r\n\t\t\t\t\tchecked: input.checked,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}));\r\n\r\n\t\t\titem.appendChild(input);\r\n\t\t}\r\n\r\n\t\tconst label = document.createElement(\"label\");\r\n\t\tlabel.innerHTML = info.label;\r\n\t\tif (info.label == \"\") {\r\n\t\t\tlabel.style.display = \"none\";\r\n\t\t}\r\n\t\titem.appendChild(label);\r\n\r\n\t\tif (info.subLabel) {\r\n\t\t\tconst subLabel = document.createElement(\"label\");\r\n\t\t\tsubLabel.className = \"am5stock-list-sub\";\r\n\t\t\tsubLabel.innerHTML = info.subLabel;\r\n\t\t\titem.appendChild(subLabel);\r\n\t\t}\r\n\r\n\t\tif (info.id == \"separator\") {\r\n\t\t\titem.innerHTML = \"<hr>\";\r\n\t\t}\r\n\r\n\t\tlist.appendChild(item);\r\n\r\n\t\t// Add click event\r\n\t\tif (info.disabled) {\r\n\t\t\titem.className += \" am5stock-disabled\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._disposers.push($utils.addEventListener(item, \"click\", (_ev) => {\r\n\t\t\t\tthis.hide();\r\n\t\t\t\tthis.events.dispatch(\"invoked\", {\r\n\t\t\t\t\ttype: \"invoked\",\r\n\t\t\t\t\titem: info,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tsuper.hide();\r\n\t\tthis._filterItems();\r\n\t\tlet searchBox = this.getPrivate(\"search\");\r\n\t\tif (searchBox) {\r\n\t\t\tconst inputs = searchBox.getElementsByTagName(\"input\");\r\n\t\t\tlet isCustomSearch = false;\r\n\t\t\t$array.each(inputs, (input) => {\r\n\t\t\t\tif (input.value !== \"\") {\r\n\t\t\t\t\tisCustomSearch = true;\r\n\t\t\t\t\tinput.value = \"\";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (this.get(\"searchCallback\") && isCustomSearch) {\r\n\t\t\t\tthis._initItems();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._currentSelectedIndex = undefined;\r\n\t}\r\n\r\n\tprotected _setupKeyboardNav(): void {\r\n\t\tif ($utils.supports(\"keyboardevents\")) {\r\n\t\t\tconst button = this.get(\"control\").getPrivate(\"button\")!;\r\n\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\r\n\t\t\t\tif (this.isAccessible()) {\r\n\t\t\t\t\tif (document.activeElement && (document.activeElement === button || $utils.contains(button, document.activeElement))) {\r\n\t\t\t\t\t\tif (ev.keyCode == 13) {\r\n\t\t\t\t\t\t\t// ENTER\r\n\t\t\t\t\t\t\tif (document.activeElement !== button) {\r\n\t\t\t\t\t\t\t\t(document.activeElement as HTMLElement).click();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (ev.keyCode == 38 || ev.keyCode == 40) {\r\n\t\t\t\t\t\t\tconst dir = ev.keyCode == 38 ? -1 : 1;\r\n\t\t\t\t\t\t\tlet index: number | undefined = this._currentSelectedIndex;\r\n\t\t\t\t\t\t\tif (index === undefined) {\r\n\t\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tindex += dir;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst items = this._getActiveItems();\r\n\t\t\t\t\t\t\tif (index < 0) {\r\n\t\t\t\t\t\t\t\tindex = items.length - 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (index >= items.length) {\r\n\t\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis.setTimeout(() => {\r\n\t\t\t\t\t\t\t\t$utils.focus(items.item(index!) as HTMLElement);\r\n\t\t\t\t\t\t\t\tthis._currentSelectedIndex = index;\r\n\t\t\t\t\t\t\t}, 15);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _maybeMakeAccessible(): void {\r\n\t\tsuper._maybeMakeAccessible();\r\n\t\tif (this.isAccessible()) {\r\n\t\t\t//const tabindex = this._root.tabindex.toString();\r\n\t\t\t//const list = this.getPrivate(\"list\")!;\r\n\t\t\tconst items = this._getActiveItems();\r\n\t\t\titems.forEach((item) => {\r\n\t\t\t\t(item as HTMLElement).setAttribute(\"tabindex\", \"-1\");\r\n\t\t\t\t(item as HTMLElement).setAttribute(\"aria-label\", (item as HTMLElement).getAttribute(\"title\") || \"\");\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getActiveItems(): NodeList {\r\n\t\treturn this.getPrivate(\"list\")!.querySelectorAll(\".am5stock-list-item:not(.am5stock-list-info, .am5stock-list-heading, .am5stock-disabled)\");\r\n\t}\r\n\r\n}","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport type DrawingTools = \"Arrows &amp; Icons\" | \"Average\" | \"Callout\" | \"Doodle\" | \"Ellipse\" | \"Fibonacci\" | \"Fibonacci Timezone\" | \"Horizontal Line\" | \"Horizontal Ray\" | \"Label\" | \"Line\" | \"Line Arrow\"  | \"Measure\" | \"Parallel Channel\" | \"Polyline\" | \"Polyfill\" | \"Quadrant Line\" | \"Rectangle\" | \"Regression\" | \"Trend Line\" | \"Triangle\" | \"Vertical Line\";\r\n\r\nexport interface IDrawingToolControlSettings extends IStockControlSettings {\r\n\ttools: DrawingTools[];\r\n\r\n\t/**\r\n\t * If set to `true`, the dropdown will fix the height to fit within chart's\r\n\t * area, with scroll if the contents do not fit.\r\n\t *\r\n\t * @since 5.9.5\r\n\t */\r\n\tscrollable?: boolean;\r\n}\r\n\r\nexport interface IDrawingToolControlPrivate extends IStockControlPrivate {\r\n\tlist?: DropdownList;\r\n}\r\n\r\nexport interface IDrawingToolControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\ttool: DrawingTools\r\n\t}\r\n}\r\n\r\n/**\r\n * Control which allows selecting drawing tool.\r\n *\r\n * Should not be instantiated directly. Use [[DrawingControl]] instead.\r\n */\r\nexport class DrawingToolControl extends StockControl {\r\n\tpublic static className: string = \"DrawingToolControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DrawingToolControl.className]);\r\n\r\n\tdeclare public _settings: IDrawingToolControlSettings;\r\n\tdeclare public _privateSettings: IDrawingToolControlPrivate;\r\n\tdeclare public _events: IDrawingToolControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst list = DropdownList.new(this._root, {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tscrollable: this.get(\"scrollable\", false)\r\n\t\t});\r\n\t\tthis.setPrivate(\"list\", list);\r\n\r\n\t\tlist.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tlist.events.on(\"invoked\", (ev) => {\r\n\t\t\tthis.setTool(<DrawingTools>ev.item.label);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\ttool: <DrawingTools>ev.item.id,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => list.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlist.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\r\n\t\tthis._initTools();\r\n\t}\r\n\r\n\tpublic setTool(tool: DrawingTools): void {\r\n\t\tthis.getPrivate(\"icon\")!.innerHTML = \"\";\r\n\t\tthis.getPrivate(\"icon\")!.appendChild(this._getToolIcon(tool));\r\n\t\t//this.getPrivate(\"label\")!.innerHTML = tool;\r\n\t\tthis._setLabel(this._root.language.translateAny(tool));\r\n\t}\r\n\r\n\tprotected _initTools(): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst tools = this.get(\"tools\");\r\n\t\tconst items: IDropdownListItem[] = [];\r\n\t\t$array.each(tools, (tool: DrawingTools) => {\r\n\t\t\titems.push({\r\n\t\t\t\tid: tool,\r\n\t\t\t\tlabel: this._root.language.translateAny(tool),\r\n\t\t\t\ticon: this._getToolIcon(tool)\r\n\t\t\t});\r\n\t\t})\r\n\t\tlist.set(\"items\", items);\r\n\t}\r\n\r\n\tprotected _getToolIcon(tool: DrawingTools): SVGElement {\r\n\t\treturn StockIcons.getIcon(tool);\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\r\n\t\tif (this.isDirty(\"tools\")) {\r\n\t\t\tthis._initTools();\r\n\t\t}\r\n\r\n\t\t// if (this.isDirty(\"name\")) {\r\n\t\t// \tthis.getPrivate(\"label\")!.innerHTML = this.get(\"name\", \"\");\r\n\t\t// }\r\n\r\n\t\t// todo icon\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\r\n\t\t// $array.each(this._itemDisposers, (x) => {\r\n\t\t// \tx.dispose();\r\n\t\t// });\r\n\t}\r\n\r\n\r\n}\r\n","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $type from \"../../../core/util/Type\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IDropdownListControlSettings extends IStockControlSettings {\r\n\r\n\t/**\r\n\t * Currently selected item.\r\n\t */\r\n\tcurrentItem?: string | IDropdownListItem;\r\n\r\n\t/**\r\n\t * Label does not change when item is selected in the list.\r\n\t */\r\n\tfixedLabel?: boolean;\r\n\r\n\t/**\r\n\t * A list of items in the dropdown.\r\n\t */\r\n\titems?: Array<string | IDropdownListItem>;\r\n\r\n\t/**\r\n\t * If set to `true`, the dropdown will fix the height to fit within chart's\r\n\t * area, with scroll if the contents do not fit.\r\n\t */\r\n\tscrollable?: boolean;\r\n\r\n\t/**\r\n\t * Maximum search items to show.\r\n\t */\r\n\tmaxSearchItems?: number,\r\n\r\n\t/**\r\n\t * Is the list searchable? If `true` shows search field and\r\n\t * calls `searchCallback` function for a list of items.\r\n\t */\r\n\tsearchable?: boolean;\r\n\r\n\t/**\r\n\t * A callback function which returns a list of items based on a search query.\r\n\t */\r\n\tsearchCallback?: (query: string) => IDropdownListItem[];\r\n\r\n\t/**\r\n\t * An array of item IDs to now show in the list.\r\n\t *\r\n\t * @since 5.7.0\r\n\t */\r\n\texclude?: string[];\r\n\r\n}\r\n\r\nexport interface IDropdownListControlPrivate extends IStockControlPrivate {\r\n\tdropdown?: DropdownList;\r\n}\r\n\r\nexport interface IDropdownListControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\titem: string | IDropdownListItem;\r\n\t};\r\n}\r\n\r\n/**\r\n * A generic control which creates a searchable list of items in a dropdown.\r\n *\r\n * Can be used in a [[StockToolbar]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/dropdown-list-control/} for more info\r\n */\r\nexport class DropdownListControl extends StockControl {\r\n\tpublic static className: string = \"DropdownListControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DropdownListControl.className]);\r\n\r\n\tdeclare public _settings: IDropdownListControlSettings;\r\n\tdeclare public _privateSettings: IDropdownListControlPrivate;\r\n\tdeclare public _events: IDropdownListControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\t// @todo still needed?\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\r\n\t\t// Disable icon\r\n\t\t//this.getPrivate(\"icon\")!.style.display = \"none\";\r\n\r\n\t\t// Create list\r\n\t\tconst dropdownSettings: any = {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tsearchable: this.get(\"searchable\", false),\r\n\t\t\tscrollable: this.get(\"scrollable\", false),\r\n\t\t\titems: [],\r\n\t\t\texclude: this.get(\"exclude\")\r\n\t\t}\r\n\r\n\t\tconst maxSearchItems = this.get(\"maxSearchItems\");\r\n\t\tif (maxSearchItems) {\r\n\t\t\tdropdownSettings.maxSearchItems = maxSearchItems;\r\n\t\t}\r\n\r\n\t\tconst searchCallback = this.get(\"searchCallback\");\r\n\t\tif (searchCallback) {\r\n\t\t\tdropdownSettings.searchCallback = searchCallback;\r\n\t\t}\r\n\r\n\t\tconst items = this.get(\"items\");\r\n\t\tlet currentItem = this.get(\"currentItem\");\r\n\t\tif (items) {\r\n\t\t\t$array.each(items, (item) => {\r\n\t\t\t\tconst itemObject = $type.isString(item) ? {\r\n\t\t\t\t\tid: item,\r\n\t\t\t\t\tlabel: item\r\n\t\t\t\t} : item;\r\n\t\t\t\tdropdownSettings.items.push(itemObject);\r\n\r\n\t\t\t\tif ($type.isString(currentItem) && currentItem == itemObject.id) {\r\n\t\t\t\t\tcurrentItem = itemObject;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst dropdown = DropdownList.new(this._root, dropdownSettings);\r\n\t\tthis.setPrivate(\"dropdown\", dropdown);\r\n\r\n\t\tif (currentItem) {\r\n\t\t\tthis.setItem(currentItem);\r\n\t\t}\r\n\r\n\t\tdropdown.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"invoked\", (ev) => {\r\n\t\t\tthis.setItem(ev.item);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\titem: ev.item,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\t//dropdown.setPrivate(\"currentId\", $type.numberToString(this.get(\"strokeWidth\")));\r\n\t\t\t\tthis.setTimeout(() => dropdown.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdropdown.hide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setItem(item: string | IDropdownListItem): void {\r\n\t\tif (this.get(\"fixedLabel\") !== true) {\r\n\t\t\tconst label = this.getPrivate(\"label\")!;\r\n\t\t\tif ($type.isString(item)) {\r\n\t\t\t\tlabel.innerHTML = item;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (item.icon) {\r\n\t\t\t\t\tconst icon = this.getPrivate(\"icon\")!;\r\n\t\t\t\t\ticon.innerHTML = \"\";\r\n\t\t\t\t\ticon.appendChild(item.icon.cloneNode(true));\r\n\t\t\t\t\ticon.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t//icon.style.display = \"none\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.label) {\r\n\t\t\t\t\tlabel.innerHTML = item.label;\r\n\t\t\t\t\tlabel.style.display = \"\";\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlabel.innerHTML = \"\";\r\n\t\t\t\t\tlabel.style.display = \"none\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Selects an item by its id.\r\n\t *\r\n\t * @since 5.9.0\r\n\t * @param  id  Item ID\r\n\t */\r\n\tpublic setItemById(id: string) {\r\n\t\tconst item = this.getItemById(id);\r\n\t\tif (item !== undefined) {\r\n\t\t\tthis.setItem(item);\r\n\t\t\t//this.set(\"currentItem\", item);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\titem: item,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns list item by ID.\r\n\t * \r\n\t * @since 5.9.0\r\n\t * @param  id  Item ID\r\n\t * @return     Dropdown item\r\n\t */\r\n\tpublic getItemById(id: string): IDropdownListItem | string | undefined {\r\n\t\tlet found: IDropdownListItem | string | undefined;\r\n\t\tconst items = this.get(\"items\", []);\r\n\t\t$array.eachContinue(items, (item) => {\r\n\t\t\tlet itemId = $type.isObject(item) ? item.id : item;\r\n\t\t\tif (itemId == id) {\r\n\t\t\t\tfound = item;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\treturn found;\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t\tif (this.isDirty(\"items\")) {\r\n\t\t\tconst dropdown = this.getPrivate(\"dropdown\");\r\n\t\t\tif (dropdown) {\r\n\t\t\t\tconst items = this.get(\"items\");\r\n\t\t\t\tconst dropdownItems: IDropdownListItem[] = [];\r\n\t\t\t\tlet currentItem = this.get(\"currentItem\");\r\n\t\t\t\tif (items) {\r\n\t\t\t\t\t$array.each(items, (item) => {\r\n\t\t\t\t\t\tconst itemObject = $type.isString(item) ? {\r\n\t\t\t\t\t\t\tid: item,\r\n\t\t\t\t\t\t\tlabel: item\r\n\t\t\t\t\t\t} : item;\r\n\t\t\t\t\t\tdropdownItems.push(itemObject);\r\n\r\n\t\t\t\t\t\tif ($type.isString(currentItem) && currentItem == itemObject.id) {\r\n\t\t\t\t\t\t\tcurrentItem = itemObject;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tdropdown.set(\"items\", dropdownItems);\r\n\t\t\t\t//console.log(this.className, this.isAccessible())\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\tprotected _maybeMakeAccessible(): void {\r\n\t\tsuper._maybeMakeAccessible();\r\n\t\tif (this.isAccessible()) {\r\n\t\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\t\tbutton.setAttribute(\"aria-label\", button.getAttribute(\"title\") + \"; \" + this._t(\"Press ENTER or use arrow keys to navigate\"));\r\n\r\n\t\t\tif ($utils.supports(\"keyboardevents\")) {\r\n\t\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\r\n\t\t\t\t\tif (document.activeElement == button) {\r\n\t\t\t\t\t\tif (ev.keyCode == 38 || ev.keyCode == 40) {\r\n\t\t\t\t\t\t\t// Open on arrows\r\n\t\t\t\t\t\t\tif (!this.get(\"active\")) {\r\n\t\t\t\t\t\t\t\tthis._handleClick();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n}\r\n","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { Dropdown } from \"./Dropdown\";\r\n\r\nexport interface IDropdownControlSettings extends IStockControlSettings {\r\n\tfixedLabel?: boolean;\r\n\tscrollable?: boolean;\r\n\thtml?: string;\r\n}\r\n\r\nexport interface IDropdownControlPrivate extends IStockControlPrivate {\r\n\tdropdown?: Dropdown;\r\n\tcontainer?: HTMLDivElement;\r\n}\r\n\r\nexport interface IDropdownControlEvents extends IStockControlEvents {\r\n}\r\n\r\n/**\r\n * A generic control which creates a searchable list of items in a dropdown.\r\n *\r\n * Can be used in a [[StockToolbar]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/dropdown-list-control/} for more info\r\n */\r\nexport class DropdownControl extends StockControl {\r\n\tpublic static className: string = \"DropdownControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DropdownControl.className]);\r\n\r\n\tdeclare public _settings: IDropdownControlSettings;\r\n\tdeclare public _privateSettings: IDropdownControlPrivate;\r\n\tdeclare public _events: IDropdownControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t\tif (this.isDirty(\"html\")) {\r\n\t\t\tconst container = this.getPrivate(\"container\");\r\n\t\t\tif (container) {\r\n\t\t\t\tthis.getPrivate(\"container\")!.innerHTML = this.get(\"html\", \"\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\r\n\t\t// Create list\r\n\t\tconst dropdownSettings: any = {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tscrollable: this.get(\"scrollable\", false)\r\n\t\t}\r\n\r\n\t\tconst dropdown = Dropdown.new(this._root, dropdownSettings);\r\n\t\tthis.setPrivate(\"dropdown\", dropdown);\r\n\r\n\t\tconst container = document.createElement(\"div\");\r\n\t\tcontainer.className = \"am5stock-control-list\";\r\n\r\n\t\tdropdown.getPrivate(\"container\")!.appendChild(container);\r\n\t\tthis.setPrivate(\"container\", container);\r\n\r\n\t\tconst html = this.get(\"html\", \"\");\r\n\t\tcontainer.innerHTML = html;\r\n\r\n\t\tdropdown.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => dropdown.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdropdown.hide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\r\n}\r\n","import type { Percent } from \"../../../core/util/Percent\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IIcon {\r\n\tsvgPath: string;\r\n\tscale?: number;\r\n\tcenterX?: Percent;\r\n\tcenterY?: Percent;\r\n\tfillDisabled?: boolean;\r\n}\r\n\r\nexport interface IIconControlSettings extends IStockControlSettings {\r\n\ticons: IIcon[];\r\n}\r\n\r\nexport interface IIconControlPrivate extends IStockControlPrivate {\r\n\tlist?: DropdownList;\r\n}\r\n\r\nexport interface IIconControlEvents extends IStockControlEvents {\r\n\tselected: {\r\n\t\ticon: IIcon\r\n\t}\r\n}\r\n\r\n/**\r\n * Shows selection of icons to choose from for annotating [[StockChart]].\r\n *\r\n * This class is instantiated automatically, and should not be used standalone.\r\n */\r\nexport class IconControl extends StockControl {\r\n\tpublic static className: string = \"IconControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([IconControl.className]);\r\n\r\n\tdeclare public _settings: IIconControlSettings;\r\n\tdeclare public _privateSettings: IIconControlPrivate;\r\n\tdeclare public _events: IIconControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst list = DropdownList.new(this._root, {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\"),\r\n\t\t\tsearchable: false\r\n\t\t});\r\n\t\tthis.setPrivate(\"list\", list);\r\n\t\tlist.getPrivate(\"list\")!.className = \"am5stock-control-icons\";\r\n\r\n\t\tlist.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tlist.events.on(\"invoked\", (ev) => {\r\n\t\t\tconst item = <IIcon>JSON.parse(ev.item.id);\r\n\t\t\tlet icon: IIcon | undefined;\r\n\t\t\tconst icons = this.get(\"icons\");\r\n\t\t\t$array.each(icons, (listIcon) => {\r\n\t\t\t\tif (item.svgPath == listIcon.svgPath) {\r\n\t\t\t\t\ticon = listIcon;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (icon) {\r\n\t\t\t\tthis.setIcon(icon);\r\n\t\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\t\ttype: \"selected\",\r\n\t\t\t\t\ticon: icon,\r\n\t\t\t\t\ttarget: this\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => list.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlist.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._initIcons();\r\n\t}\r\n\r\n\tpublic setIcon(icon: IIcon): void {\r\n\t\tthis.getPrivate(\"icon\")!.innerHTML = \"\";\r\n\t\tthis.getPrivate(\"icon\")!.appendChild(this._getDrawingIcon(icon));\r\n\t\t//this.getPrivate(\"label\")!.style.display = \"none\";\r\n\t}\r\n\r\n\t/**\r\n\t * Selects an icon by its SVG path.\r\n\t *\r\n\t * @since 5.9.0\r\n\t * @param  path  Item ID\r\n\t */\r\n\tpublic setIconByPath(path: string) {\r\n\t\tconst icon = this.getIconByPath(path);\r\n\t\tif (icon !== undefined) {\r\n\t\t\tthis.setIcon(icon);\r\n\t\t\t//this.set(\"currentItem\", item);\r\n\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\ttype: \"selected\",\r\n\t\t\t\ticon: icon,\r\n\t\t\t\ttarget: this\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns icon by its SVG path.\r\n\t * \r\n\t * @since 5.9.0\r\n\t * @param  id  Item ID\r\n\t * @return     Dropdown item\r\n\t */\r\n\tpublic getIconByPath(path: string): IIcon | undefined {\r\n\t\tlet found: IIcon | undefined;\r\n\t\tconst icons = this.get(\"icons\", []);\r\n\t\t$array.eachContinue(icons, (icon) => {\r\n\t\t\tif (icon.svgPath == path) {\r\n\t\t\t\tfound = icon;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\treturn found;\r\n\t}\r\n\r\n\tprotected _initIcons(): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst icons = this.get(\"icons\");\r\n\t\tconst items: IDropdownListItem[] = [];\r\n\t\t$array.each(icons, (icon: IIcon) => {\r\n\t\t\titems.push({\r\n\t\t\t\tid: JSON.stringify(icon),\r\n\t\t\t\tlabel: \"\",\r\n\t\t\t\ticon: this._getDrawingIcon(icon)\r\n\t\t\t});\r\n\t\t})\r\n\t\tlist.set(\"items\", items);\r\n\t}\r\n\r\n\tpublic _getDrawingIcon(icon: IIcon): SVGElement {\r\n\t\treturn StockIcons._getSVG({ viewbox: \"0 0 50 50\", path: icon.svgPath });\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\r\n\t\tif (this.isDirty(\"icons\")) {\r\n\t\t\tthis._initIcons();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t}\r\n\r\n\r\n}\r\n","import type { XYSeries } from \"../../xy/series/XYSeries\";\r\nimport type { Color } from \"../../../core/util/Color\";\r\nimport type { ColorSet } from \"../../../core/util/ColorSet\";\r\nimport type { IDropdownListItem } from \"./DropdownList\";\r\nimport type { StockPanel } from \"../StockPanel\";\r\nimport type { IPoint } from \"../../../core/util/IPoint\";\r\n\r\nimport { color } from \"../../../core/util/Color\";\r\nimport { Template } from \"../../../core/util/Template\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { DrawingToolControl, DrawingTools } from \"./DrawingToolControl\";\r\nimport { ColorControl } from \"./ColorControl\";\r\nimport { DropdownListControl } from \"./DropdownListControl\";\r\nimport { IconControl, IIcon } from \"./IconControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\nimport { DrawingSeries } from \"../drawing/DrawingSeries\";\r\n\r\nimport { AverageSeries } from \"../drawing/AverageSeries\";\r\nimport { CalloutSeries } from \"../drawing/CalloutSeries\";\r\nimport { EllipseSeries } from \"../drawing/EllipseSeries\";\r\nimport { DoodleSeries } from \"../drawing/DoodleSeries\";\r\nimport { FibonacciSeries } from \"../drawing/FibonacciSeries\";\r\nimport { FibonacciTimezoneSeries } from \"../drawing/FibonacciTimezoneSeries\";\r\nimport { HorizontalLineSeries } from \"../drawing/HorizontalLineSeries\";\r\nimport { HorizontalRaySeries } from \"../drawing/HorizontalRaySeries\";\r\nimport { IconSeries } from \"../drawing/IconSeries\";\r\nimport { LabelSeries } from \"../drawing/LabelSeries\";\r\nimport { SimpleLineSeries } from \"../drawing/SimpleLineSeries\";\r\nimport { LineArrowSeries } from \"../drawing/LineArrowSeries\";\r\nimport { PolylineSeries } from \"../drawing/PolylineSeries\";\r\nimport { QuadrantLineSeries } from \"../drawing/QuadrantLineSeries\";\r\nimport { RectangleSeries } from \"../drawing/RectangleSeries\";\r\nimport { ParallelChannelSeries } from \"../drawing/ParallelChannelSeries\";\r\nimport { RegressionSeries } from \"../drawing/RegressionSeries\";\r\nimport { TrendLineSeries } from \"../drawing/TrendLineSeries\";\r\nimport { VerticalLineSeries } from \"../drawing/VerticalLineSeries\";\r\nimport { Measure } from \"../drawing/Measure\";\r\nimport { JsonParser } from \"../../../plugins/json/Json\";\r\nimport { Serializer } from \"../../../plugins/json/Serializer\";\r\n\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $object from \"../../../core/util/Object\";\r\nimport * as $type from \"../../../core/util/Type\";\r\nimport * as $utils from \"../../../core/util/Utils\";\r\n\r\nexport interface IDrawingControlSettings extends IStockControlSettings {\r\n\r\n\t/**\r\n\t * List of tools available in drawing mode.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/#Tool_list} for more info\r\n\t */\r\n\ttools?: DrawingTools[];\r\n\r\n\t/**\r\n\t * Default tool.\r\n\t */\r\n\ttool?: DrawingTools,\r\n\r\n\t/**\r\n\t * If set to `true`, the dropdown will fix the height to fit within chart's\r\n\t * area, with scroll if the contents do not fit.\r\n\t *\r\n\t * @since 5.9.5\r\n\t */\r\n\tscrollable?: boolean;\r\n\r\n\t/**\r\n\t * Default settings for drawing tools.\r\n\t *\r\n\t * @since 5.5.2\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/#Tool_settings} for more info\r\n\t */\r\n\ttoolSettings?: { [index: string]: any };\r\n\r\n\t/**\r\n\t * Target series for drawing.\r\n\t */\r\n\tseries?: XYSeries[];\r\n\r\n\t/**\r\n\t * Colors to show in color pickers.\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/#Colors} for more info\r\n\t */\r\n\tcolors?: ColorSet;\r\n\r\n\t/**\r\n\t * Default color for lines/borders.\r\n\t */\r\n\tstrokeColor?: Color;\r\n\r\n\t/**\r\n\t * Default line/border width in pixels.\r\n\t */\r\n\tstrokeWidth?: number;\r\n\r\n\t/**\r\n\t * Available line widths for user to choose from.\r\n\t */\r\n\tstrokeWidths?: number[];\r\n\r\n\t/**\r\n\t * Default dasharray setting.\r\n\t */\r\n\tstrokeDasharray?: number[];\r\n\r\n\t/**\r\n\t * Available line dash settings for user to choose from.\r\n\t */\r\n\tstrokeDasharrays?: number[][];\r\n\r\n\t/**\r\n\t * Default line/border opacity.\r\n\t */\r\n\tstrokeOpacity?: number;\r\n\r\n\t/**\r\n\t * Show dotted/thin line extending from both ends of the drawn line?\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tshowExtension?: boolean;\r\n\r\n\t/**\r\n\t * Default fill color.\r\n\t */\r\n\tfillColor?: Color;\r\n\r\n\t/**\r\n\t * Default fill opacity.\r\n\t */\r\n\tfillOpacity?: number;\r\n\r\n\t/**\r\n\t * Default color for labels.\r\n\t */\r\n\tlabelFill?: Color;\r\n\r\n\t/**\r\n\t * Default label font size.\r\n\t */\r\n\tlabelFontSize?: number | string | undefined;\r\n\r\n\t/**\r\n\t * Available font sizes.\r\n\t */\r\n\tlabelFontSizes?: Array<number | string>;\r\n\r\n\t/**\r\n\t * Default label font.\r\n\t */\r\n\tlabelFontFamily?: string;\r\n\r\n\t/**\r\n\t * Available fonts for user to choose from.\r\n\t */\r\n\tlabelFontFamilies?: string[];\r\n\r\n\t/**\r\n\t * Default label font weight.\r\n\t */\r\n\tlabelFontWeight?: \"normal\" | \"bold\" | \"bolder\" | \"lighter\" | \"100\" | \"200\" | \"300\" | \"400\" | \"500\" | \"600\" | \"700\" | \"800\" | \"900\";\r\n\r\n\t/**\r\n\t * Default label style.\r\n\t */\r\n\tlabelFontStyle?: \"normal\" | \"italic\" | \"oblique\";\r\n\r\n\tdrawingIcon?: IIcon;\r\n\tdrawingIcons?: IIcon[];\r\n\r\n\t/**\r\n\t * Should drawings snap to the nearest data point?\r\n\t *\r\n\t * @default true\r\n\t */\r\n\tsnapToData?: boolean;\r\n\r\n}\r\n\r\n\r\nexport interface IDrawingControlPrivate extends IStockControlPrivate {\r\n\ttoolsContainer?: HTMLDivElement;\r\n\t// icon?: HTMLElement;\r\n\t// label?: HTMLDivElement;\r\n\ttoolControl?: DrawingToolControl;\r\n\teraserControl?: StockControl;\r\n\r\n\t/**\r\n\t * Selector mode toggler.\r\n\t *\r\n\t * @since 5.9.1\r\n\t */\r\n\tselectControl?: StockControl;\r\n\tclearControl?: StockControl;\r\n\r\n\tstrokeControl?: ColorControl;\r\n\tstrokeWidthControl?: DropdownListControl;\r\n\tstrokeDasharrayControl?: DropdownListControl;\r\n\tfillControl?: ColorControl;\r\n\textensionControl?: StockControl;\r\n\r\n\tlabelFillControl?: ColorControl;\r\n\tlabelFontSizeControl?: DropdownListControl;\r\n\tlabelFontFamilyControl?: DropdownListControl;\r\n\tboldControl?: StockControl;\r\n\titalicControl?: StockControl;\r\n\r\n\ticonControl?: IconControl;\r\n\tsnapControl?: StockControl;\r\n\r\n\ttoolTemplates?: { [index: string]: Template<any> };\r\n}\r\n\r\nexport interface IDrawingControlEvents extends IStockControlEvents {\r\n}\r\n\r\n/**\r\n * A drawing tools control for [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/drawing-control/} for more info\r\n */\r\nexport class DrawingControl extends StockControl {\r\n\tpublic static className: string = \"DrawingControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DrawingControl.className]);\r\n\r\n\tdeclare public _settings: IDrawingControlSettings;\r\n\tdeclare public _privateSettings: IDrawingControlPrivate;\r\n\tdeclare public _events: IDrawingControlEvents;\r\n\r\n\tprivate _drawingSeries: { [index: string]: DrawingSeries[] } = {};\r\n\tprivate _currentEnabledSeries: DrawingSeries[] = [];\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Init drawing toolbar\r\n\t\tif (this.getPrivate(\"toolbar\")) {\r\n\t\t\tthis._initToolbar();\r\n\t\t}\r\n\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.panels.events.onAll(() => this._updatePanelBindings());\r\n\r\n\t\tstockChart.events.on(\"drawingselected\", (ev) => {\r\n\t\t\t// Set tool\r\n\t\t\tconst tool = this._getSeriesTool(ev.series);\r\n\t\t\tthis.set(\"tool\", tool);\r\n\r\n\t\t\tif (!this._isInited()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Get context\r\n\t\t\tconst context = ev.series.getContext(ev.drawingId);\r\n\r\n\t\t\tif (tool == \"Label\" || tool == \"Callout\") {\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * --------------------------------------------------------------------\r\n\t\t\t\t * Labels and callouts\r\n\t\t\t\t * --------------------------------------------------------------------\r\n\t\t\t\t */\r\n\r\n\t\t\t\t// Set fill\r\n\t\t\t\tconst settings = context.settings;\r\n\t\t\t\tif (settings) {\r\n\t\t\t\t\tthis.getPrivate(\"labelFillControl\")!.setColor(settings.get(\"fill\"));\r\n\t\t\t\t\tthis.getPrivate(\"labelFontSizeControl\")!.setItemById(settings.get(\"fontSize\"));\r\n\t\t\t\t\tthis.getPrivate(\"boldControl\")!.set(\"active\", settings.get(\"fontWeight\") == \"bold\");\r\n\t\t\t\t\tthis.getPrivate(\"italicControl\")!.set(\"active\", settings.get(\"fontStyle\") == \"italic\");\r\n\t\t\t\t\tthis.getPrivate(\"labelFontFamilyControl\")!.setItemById(settings.get(\"fontFamily\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Callout background/outline\r\n\t\t\t\tconst bg = context.bgSettings;\r\n\t\t\t\tif (bg) {\r\n\t\t\t\t\tconst strokeControl = this.getPrivate(\"strokeControl\")!;\r\n\t\t\t\t\tstrokeControl.setColor(bg.get(\"stroke\"));\r\n\t\t\t\t\tstrokeControl.setOpacity(bg.get(\"strokeOpacity\"));\r\n\r\n\t\t\t\t\tconst fillControl = this.getPrivate(\"fillControl\")!;\r\n\t\t\t\t\tfillControl.setColor(bg.get(\"fill\"));\r\n\t\t\t\t\tfillControl.setOpacity(bg.get(\"fillOpacity\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * --------------------------------------------------------------------\r\n\t\t\t\t * The rest of the stuff\r\n\t\t\t\t * --------------------------------------------------------------------\r\n\t\t\t\t */\r\n\r\n\t\t\t\t// Set stroke\r\n\t\t\t\tconst stroke = context.stroke || context.settings;\r\n\t\t\t\tif (stroke) {\r\n\t\t\t\t\tconst strokeControl = this.getPrivate(\"strokeControl\")!;\r\n\t\t\t\t\tstrokeControl.setColor(stroke.get(\"stroke\"));\r\n\t\t\t\t\tstrokeControl.setOpacity(stroke.get(\"strokeOpacity\"));\r\n\t\t\t\t\tthis.getPrivate(\"strokeWidthControl\")!.setItemById(stroke.get(\"strokeWidth\") + \"px\");\r\n\t\t\t\t\tthis.getPrivate(\"strokeDasharrayControl\")!.setItemById(JSON.stringify(stroke.get(\"strokeDasharray\")));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Set fill\r\n\t\t\t\tconst fill = context.fill || context.settings;\r\n\t\t\t\tif (fill) {\r\n\t\t\t\t\tconst fillControl = this.getPrivate(\"fillControl\")!;\r\n\t\t\t\t\tfillControl.setColor(fill.get(\"fill\"));\r\n\t\t\t\t\tfillControl.setOpacity(fill.get(\"fillOpacity\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Handle icons\r\n\t\t\t\tconst sprite = context.settings || context.sprite;\r\n\t\t\t\tif (sprite && sprite.get(\"svgPath\")) {\r\n\t\t\t\t\tthis.getPrivate(\"iconControl\")!.setIconByPath(sprite.get(\"svgPath\"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprotected _initElements(): void {\r\n\t\tsuper._initElements();\r\n\t}\r\n\r\n\tprotected _isInited(): boolean {\r\n\t\treturn this.getPrivate(\"toolsContainer\") ? true : false;\r\n\t}\r\n\r\n\tprotected _resetControls(): void {\r\n\t\tthis.getPrivate(\"eraserControl\")!.set(\"active\", false);\r\n\t}\r\n\r\n\tprotected _initToolbar(): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst l = this._root.language;\r\n\r\n\t\t// Add additional container for drawing toolbar\r\n\t\tconst toolbar = this.getPrivate(\"toolbar\")!;\r\n\t\tconst toolsContainer = document.createElement(\"div\");\r\n\t\ttoolsContainer.className = \"am5stock-control-drawing-tools\";\r\n\t\ttoolsContainer.style.display = \"none\";\r\n\t\tthis.setPrivate(\"toolsContainer\", toolsContainer);\r\n\t\ttoolbar.get(\"container\").appendChild(toolsContainer);\r\n\r\n\t\t/**\r\n\t\t * Drawing tool selection control\r\n\t\t */\r\n\t\tconst toolControl = DrawingToolControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Drawing tool\"),\r\n\t\t\ttools: this.get(\"tools\")!,\r\n\t\t\tscrollable: this.get(\"scrollable\", false)\r\n\t\t});\r\n\r\n\t\ttoolControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\ttoolsContainer.appendChild(toolControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"toolControl\", toolControl);\r\n\r\n\t\ttoolControl.events.on(\"selected\", (ev) => {\r\n\t\t\teraserControl.set(\"active\", false);\r\n\t\t\tthis.set(\"tool\", ev.tool);\r\n\t\t});\r\n\r\n\t\ttoolControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Icon selection control\r\n\t\t */\r\n\t\tconst drawingIcons = this.get(\"drawingIcons\")!;\r\n\t\tconst iconControl = IconControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Arrows &amp; Icons\"),\r\n\t\t\ticons: drawingIcons\r\n\t\t});\r\n\r\n\t\ticonControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\ticonControl.setIcon(this.get(\"drawingIcon\", drawingIcons[0]));\r\n\t\ttoolsContainer.appendChild(iconControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"iconControl\", iconControl);\r\n\r\n\t\ticonControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"drawingIcon\", ev.icon);\r\n\t\t});\r\n\r\n\t\ticonControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Snap toggle control\r\n\t\t */\r\n\t\tconst snapControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Snap icon to data\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Snap\")\r\n\t\t});\r\n\r\n\t\tsnapControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\tsnapControl.hide();\r\n\t\ttoolsContainer.appendChild(snapControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"snapControl\", snapControl);\r\n\t\tif (this.get(\"snapToData\")) {\r\n\t\t\tsnapControl.set(\"active\", true);\r\n\t\t}\r\n\t\tsnapControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"snapToData\", snapControl.get(\"active\") == true);\r\n\t\t});\r\n\r\n\t\tsnapControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Stroke color control\r\n\t\t */\r\n\t\tconst strokeControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tdescription: l.translateAny(\"Line color\")\r\n\t\t});\r\n\r\n\t\tstrokeControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\tstrokeControl.hide();\r\n\t\tstrokeControl.setPrivate(\"color\", this.get(\"strokeColor\", color(0x000000)));\r\n\t\tstrokeControl.setPrivate(\"opacity\", this.get(\"strokeOpacity\", 1));\r\n\t\ttoolsContainer.appendChild(strokeControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeControl\", strokeControl);\r\n\t\tstrokeControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeColor\", ev.color);\r\n\t\t});\r\n\t\tstrokeControl.events.on(\"selectedOpacity\", (ev) => {\r\n\t\t\tthis.set(\"strokeOpacity\", ev.opacity);\r\n\t\t});\r\n\r\n\t\tstrokeControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Stroke width control\r\n\t\t */\r\n\t\tconst strokeWidths: string[] = [];\r\n\t\t$array.each(this.get(\"strokeWidths\", []), (width) => {\r\n\t\t\tstrokeWidths.push(width + \"px\");\r\n\t\t});\r\n\t\tconst strokeWidthControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Line thickness\"),\r\n\t\t\tcurrentItem: this.get(\"strokeWidth\", \"12\") + \"px\",\r\n\t\t\titems: strokeWidths\r\n\t\t});\r\n\r\n\t\tstrokeWidthControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\tstrokeWidthControl.hide();\r\n\t\t//strokeWidthControl.setItem(this.get(\"strokeWidth\", \"12\") + \"px\");\r\n\t\tstrokeWidthControl.getPrivate(\"icon\")!.style.display = \"none\";\r\n\t\ttoolsContainer.appendChild(strokeWidthControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeWidthControl\", strokeWidthControl);\r\n\t\tstrokeWidthControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeWidth\", $type.toNumber($type.isString(ev.item) ? ev.item : ev.item.id));\r\n\t\t});\r\n\r\n\t\tstrokeWidthControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Stroke dash cofiguration control\r\n\t\t */\r\n\t\tconst strokeDasharrays: IDropdownListItem[] = [];\r\n\t\tlet currentStrokeDasharray: SVGElement | undefined;\r\n\t\tconst strokeDasharray = this.get(\"strokeDasharray\", []);\r\n\t\t$array.each(this.get(\"strokeDasharrays\", []), (dasharray) => {\r\n\t\t\tconst icon = StockIcons.getIcon(\"Dash\");\r\n\t\t\tconst id = JSON.stringify(dasharray);\r\n\t\t\ticon.setAttribute(\"stroke\", \"#000\");\r\n\t\t\ticon.setAttribute(\"stroke-dasharray\", dasharray.join(\",\"));\r\n\t\t\ticon.setAttribute(\"class\", \"am5stock-icon-wide\");\r\n\t\t\tstrokeDasharrays.push({\r\n\t\t\t\tid: id,\r\n\t\t\t\tlabel: \"\",\r\n\t\t\t\ticon: icon\r\n\t\t\t});\r\n\r\n\t\t\tif (id == JSON.stringify(strokeDasharray)) {\r\n\t\t\t\tcurrentStrokeDasharray = StockIcons.getIcon(\"Dash\");\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"stroke\", \"#000\");\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"stroke-dasharray\", dasharray.join(\",\"));\r\n\t\t\t\tcurrentStrokeDasharray.setAttribute(\"class\", \"am5stock-icon-wide\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst strokeDasharrayControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Line style\"),\r\n\t\t\titems: strokeDasharrays\r\n\t\t});\r\n\r\n\t\tstrokeDasharrayControl.setPrivate(\"toolbar\", toolbar);\r\n\r\n\t\tstrokeDasharrayControl.hide();\r\n\t\tif (currentStrokeDasharray) {\r\n\t\t\tstrokeDasharrayControl.setItem({\r\n\t\t\t\tid: \"\",\r\n\t\t\t\ticon: currentStrokeDasharray,\r\n\t\t\t\tlabel: \"\"\r\n\t\t\t});\r\n\t\t}\r\n\t\tstrokeDasharrayControl.getPrivate(\"icon\")!.setAttribute(\"class\", \"am5stock-control-icon am5stock-icon-wide\")\r\n\t\ttoolsContainer.appendChild(strokeDasharrayControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"strokeDasharrayControl\", strokeDasharrayControl);\r\n\t\tstrokeDasharrayControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"strokeDasharray\", JSON.parse((<IDropdownListItem>ev.item).id));\r\n\t\t});\r\n\r\n\t\tstrokeDasharrayControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Fill color control\r\n\t\t */\r\n\t\tconst fillControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tname: l.translateAny(\"Fill\"),\r\n\t\t\tdescription: l.translateAny(\"Fill color\"),\r\n\t\t});\r\n\t\tfillControl.hide();\r\n\t\tfillControl.setPrivate(\"toolbar\", toolbar);\r\n\t\tfillControl.setPrivate(\"color\", this.get(\"fillColor\", color(0x000000)));\r\n\t\tfillControl.setPrivate(\"opacity\", this.get(\"fillOpacity\", 1));\r\n\t\ttoolsContainer.appendChild(fillControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"fillControl\", fillControl);\r\n\t\tfillControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"fillColor\", ev.color);\r\n\t\t});\r\n\t\tfillControl.events.on(\"selectedOpacity\", (ev) => {\r\n\t\t\tthis.set(\"fillOpacity\", ev.opacity);\r\n\t\t});\r\n\r\n\t\tfillControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Label color control\r\n\t\t */\r\n\t\tconst labelFillControl = ColorControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tcolors: this.get(\"colors\"),\r\n\t\t\tname: l.translateAny(\"Text\"),\r\n\t\t\tdescription: l.translateAny(\"Text color\"),\r\n\t\t\tuseOpacity: false\r\n\t\t});\r\n\t\tlabelFillControl.hide();\r\n\t\tlabelFillControl.setPrivate(\"toolbar\", toolbar);\r\n\t\tlabelFillControl.setPrivate(\"color\", this.get(\"labelFill\", color(0x000000)));\r\n\t\ttoolsContainer.appendChild(labelFillControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFillControl\", labelFillControl);\r\n\t\tlabelFillControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFill\", ev.color);\r\n\t\t});\r\n\r\n\t\tlabelFillControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Font size control\r\n\t\t */\r\n\t\tconst fontSizes: string[] = [];\r\n\t\t$array.each(this.get(\"labelFontSizes\", []), (size) => {\r\n\t\t\tfontSizes.push(size + \"\");\r\n\t\t});\r\n\t\tconst fontSizeControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Label font size\"),\r\n\t\t\tcurrentItem: this.get(\"labelFontSize\", \"12px\") + \"\",\r\n\t\t\titems: fontSizes,\r\n\t\t\ticon: \"none\"\r\n\t\t});\r\n\t\tfontSizeControl.hide();\r\n\t\tfontSizeControl.setPrivate(\"toolbar\", toolbar);\r\n\t\t//fontSizeControl.setItem(this.get(\"labelFontSize\", \"12px\") + \"\");\r\n\t\ttoolsContainer.appendChild(fontSizeControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFontSizeControl\", fontSizeControl);\r\n\t\tfontSizeControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFontSize\", $type.isString(ev.item) ? ev.item : ev.item.id);\r\n\t\t});\r\n\r\n\t\tfontSizeControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Bold control\r\n\t\t */\r\n\t\tconst boldControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Bold\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Bold\")\r\n\t\t});\r\n\t\tboldControl.hide();\r\n\t\tboldControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(boldControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"boldControl\", boldControl);\r\n\t\tboldControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"labelFontWeight\", boldControl.get(\"active\") ? \"bold\" : \"normal\");\r\n\t\t});\r\n\r\n\t\tboldControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Italic control\r\n\t\t */\r\n\t\tconst italicControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Italic\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Italic\")\r\n\t\t});\r\n\t\titalicControl.hide();\r\n\t\titalicControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(italicControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"italicControl\", italicControl);\r\n\t\titalicControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"labelFontStyle\", italicControl.get(\"active\") ? \"italic\" : \"normal\");\r\n\t\t});\r\n\r\n\t\titalicControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Font family control\r\n\t\t */\r\n\t\tconst fontFamilies: string[] = [];\r\n\t\t$array.each(this.get(\"labelFontFamilies\", []), (size) => {\r\n\t\t\tfontFamilies.push(size + \"\");\r\n\t\t});\r\n\t\tconst fontFamilyControl = DropdownListControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Label font family\"),\r\n\t\t\tcurrentItem: this.get(\"labelFontFamily\", \"Arial\"),\r\n\t\t\titems: fontFamilies,\r\n\t\t\ticon: \"none\"\r\n\t\t});\r\n\t\tfontFamilyControl.hide();\r\n\t\tfontFamilyControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(fontFamilyControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"labelFontFamilyControl\", fontFamilyControl);\r\n\t\tfontFamilyControl.events.on(\"selected\", (ev) => {\r\n\t\t\tthis.set(\"labelFontFamily\", $type.isString(ev.item) ? ev.item : ev.item.id);\r\n\t\t});\r\n\r\n\t\tfontFamilyControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Line extension control\r\n\t\t */\r\n\t\tconst extensionControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Show line extension\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Show Extension\")\r\n\t\t});\r\n\t\textensionControl.hide();\r\n\t\textensionControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(extensionControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"extensionControl\", extensionControl);\r\n\t\tif (this.get(\"showExtension\")) {\r\n\t\t\textensionControl.set(\"active\", true);\r\n\t\t}\r\n\t\textensionControl.on(\"active\", (_ev) => {\r\n\t\t\tthis.set(\"showExtension\", extensionControl.get(\"active\") == true);\r\n\t\t});\r\n\r\n\t\textensionControl.events.on(\"click\", this._resetControls, this);\r\n\r\n\t\t/**\r\n\t\t * Select control\r\n\t\t */\r\n\t\tconst selectControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Select\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Select\"),\r\n\t\t\tactive: stockChart.get(\"drawingSelectionEnabled\", false)\r\n\t\t});\r\n\t\tthis._disposers.push(stockChart.on(\"drawingSelectionEnabled\", (active) => {\r\n\t\t\tselectControl.set(\"active\", active);\r\n\t\t}));\r\n\r\n\t\tselectControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(selectControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"selectControl\", selectControl);\r\n\t\tselectControl.on(\"active\", (_ev) => {\r\n\t\t\tconst active = selectControl.get(\"active\", false);\r\n\t\t\tstockChart.set(\"drawingSelectionEnabled\", active);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Eraser control\r\n\t\t */\r\n\t\tconst eraserControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tdescription: l.translateAny(\"Eraser\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Eraser\")\r\n\t\t});\r\n\r\n\t\tthis._disposers.push(stockChart.on(\"erasingEnabled\", (active) => {\r\n\t\t\teraserControl.set(\"active\", active);\r\n\t\t}));\r\n\r\n\t\teraserControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(eraserControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"eraserControl\", eraserControl);\r\n\t\teraserControl.on(\"active\", (_ev) => {\r\n\t\t\tconst active = eraserControl.get(\"active\", false);\r\n\t\t\tthis.setEraser(active);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Clear all drawings control\r\n\t\t */\r\n\t\tconst clearControl = StockControl.new(this._root, {\r\n\t\t\tstockChart: stockChart,\r\n\t\t\tname: l.translateAny(\"Clear\"),\r\n\t\t\tdescription: l.translateAny(\"Clear all drawings\"),\r\n\t\t\ticon: StockIcons.getIcon(\"Clear\"),\r\n\t\t\ttogglable: false\r\n\t\t});\r\n\t\tclearControl.setPrivate(\"toolbar\", toolbar);\r\n\t\ttoolsContainer.appendChild(clearControl.getPrivate(\"button\")!);\r\n\t\tthis.setPrivate(\"clearControl\", clearControl);\r\n\t\tthis._disposers.push($utils.addEventListener(clearControl.getPrivate(\"button\")!, \"click\", (_ev) => {\r\n\t\t\teraserControl.set(\"active\", false);\r\n\t\t\tthis.clearDrawings();\r\n\t\t}));\r\n\r\n\t\t// Preset active tool\r\n\t\tif (this.get(\"active\")) {\r\n\t\t\tthis._setTool(this.get(\"tool\"));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Enables or disables eraser mode.\r\n\t *\r\n\t * @since 5.3.9\r\n\t * @param  active  Eraser active\r\n\t */\r\n\tpublic setEraser(active: boolean) {\r\n\t\tthis.get(\"stockChart\").set(\"erasingEnabled\", active);\r\n\t}\r\n\r\n\t/**\r\n\t * Clears all drawings.\r\n\t *\r\n\t * @since 5.3.9\r\n\t */\r\n\tpublic clearDrawings() {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\t//series.disableErasing();\r\n\t\t\t\tseries.clearDrawings();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t\tconst isInited = this._isInited();\r\n\r\n\t\tif (this.isDirty(\"tools\")) {\r\n\t\t\tconst toolControl = this.getPrivate(\"toolControl\");\r\n\t\t\tif (toolControl) {\r\n\t\t\t\ttoolControl.set(\"tools\", this.get(\"tools\")!);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isPrivateDirty(\"toolbar\")) {\r\n\t\t\tif (this.getPrivate(\"toolbar\")) {\r\n\t\t\t\tthis._initToolbar();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"active\")) {\r\n\t\t\tthis.get(\"stockChart\").toggleDrawing(this.get(\"active\"))\r\n\t\t\t\r\n\t\t\tif (this.get(\"active\")) {\t\t\t\t\r\n\t\t\t\tif (isInited) {\r\n\t\t\t\t\tthis.getPrivate(\"toolsContainer\")!.style.display = \"block\";\r\n\t\t\t\t}\r\n\t\t\t\tthis._setTool(this.get(\"tool\"));\r\n\t\t\t\tif (isInited) {\r\n\t\t\t\t\t$utils.focus(this.getPrivate(\"toolControl\")!.getPrivate(\"button\") as HTMLElement);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (isInited) {\r\n\t\t\t\t\tthis.getPrivate(\"toolsContainer\")!.style.display = \"none\";\r\n\t\t\t\t}\r\n\t\t\t\tthis._setTool();\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\r\n\r\n\t\tif (this.isDirty(\"tool\") && this.get(\"active\")) {\r\n\t\t\tthis._setTool(this.get(\"tool\"));\r\n\t\t}\r\n\r\n\t\tconst rootEvents = this._root.events;\r\n\t\tif (this.isDirty(\"strokeColor\") || this.isDirty(\"strokeWidth\") || this.isDirty(\"strokeOpacity\") || this.isDirty(\"strokeDasharray\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setStroke();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"fillColor\") || this.isDirty(\"fillOpacity\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setFill();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"labelFill\") || this.isDirty(\"labelFontSize\") || this.isDirty(\"labelFontFamily\") || this.isDirty(\"labelFontWeight\") || this.isDirty(\"labelFontStyle\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setLabel();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"showExtension\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setExtension();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"drawingIcon\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setDrawingIcon();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"snapToData\")) {\r\n\t\t\trootEvents.once(\"frameended\", () => {\r\n\t\t\t\tthis._setSnap();\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _setTool(tool?: DrawingTools): void {\r\n\t\tconst isInited = this._isInited();\r\n\r\n\t\t// Disable current drawing series\r\n\t\t$array.each(this._currentEnabledSeries, (series) => {\r\n\t\t\tseries.disableDrawing();\r\n\t\t});\r\n\t\tthis._currentEnabledSeries = [];\r\n\r\n\t\t// Disable editing\r\n\t\tif (!tool) {\r\n\t\t\tif (isInited) {\r\n\t\t\t\tthis.getPrivate(\"eraserControl\")!.set(\"active\", false);\r\n\t\t\t}\r\n\t\t\tthis.get(\"stockChart\").set(\"drawingSelectionEnabled\", false)\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Check if we need to create series\r\n\t\tthis._maybeInitToolSeries(tool);\r\n\t\tlet seriesList = this._drawingSeries[tool];\r\n\r\n\t\tlet prevPanel: StockPanel;\r\n\t\t$array.each(seriesList, (series) => {\r\n\t\t\tif (prevPanel !== series.chart) {\r\n\t\t\t\tseries.enableDrawing();\r\n\t\t\t\tthis._currentEnabledSeries.push(series);\r\n\t\t\t\tprevPanel = series.chart as StockPanel;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (isInited) {\r\n\t\t\tthis.getPrivate(\"toolControl\")!.setTool(tool);\r\n\r\n\t\t\t// Show/hide needed drawing property controls\r\n\t\t\tconst controls: any = {\r\n\t\t\t\tstrokeControl: [\"Average\", \"Callout\", \"Doodle\", \"Ellipse\", \"Fibonacci\", \"Fibonacci Timezone\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Line\", \"Line Arrow\", \"Parallel Channel\", \"Polyline\", \"Polyfill\", \"Triangle\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"],\r\n\t\t\t\tstrokeWidthControl: [\"Average\", \"Doodle\", \"Ellipse\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Line\", \"Line Arrow\", \"Polyline\", \"Polyfill\", \"Triangle\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\", \"Parallel Channel\"],\r\n\t\t\t\tstrokeDasharrayControl: [\"Average\", \"Doodle\", \"Ellipse\", \"Horizontal Line\", \"Horizontal Ray\", \"Arrows &amp; Icons\", \"Line\", \"Line Arrow\", \"Polyline\", \"Polyfill\", \"Triangle\", \"Quadrant Line\", \"Rectangle\", \"Regression\", \"Trend Line\", \"Vertical Line\"],\r\n\t\t\t\textensionControl: [\"Average\", \"Line\", \"Regression\", \"Trend Line\"],\r\n\t\t\t\tfillControl: [\"Callout\", \"Ellipse\", \"Quadrant Line\", \"Rectangle\", \"Parallel Channel\", \"Polyfill\", \"Triangle\", \"Polyfill\", \"Triangle\", \"Arrows &amp; Icons\", \"Fibonacci Timezone\"],\r\n\r\n\t\t\t\tlabelFillControl: [\"Callout\", \"Label\"],\r\n\t\t\t\tlabelFontSizeControl: [\"Callout\", \"Label\"],\r\n\t\t\t\tlabelFontFamilyControl: [\"Callout\", \"Label\"],\r\n\t\t\t\tboldControl: [\"Callout\", \"Label\"],\r\n\t\t\t\titalicControl: [\"Callout\", \"Label\"],\r\n\r\n\t\t\t\ticonControl: [\"Arrows &amp; Icons\"],\r\n\t\t\t\tsnapControl: [\"Callout\", \"Arrows &amp; Icons\", \"Line\", \"Line Arrow\", \"Polyline\", \"Polyfill\", \"Triangle\", \"Parallel Channel\", \"Label\", \"Callout\", \"Horizontal Line\", \"Horizontal Ray\", \"Vertical Line\", \"Quadrant Line\", \"Rectangle\", \"Measure\", \"Fibonacci\"],\r\n\t\t\t}\r\n\r\n\t\t\t$object.each(controls, (control, tools) => {\r\n\t\t\t\tconst controlElement = (<any>this).getPrivate(control);\r\n\t\t\t\tif (tools.indexOf(tool) == -1) {\r\n\t\t\t\t\tcontrolElement.hide();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tcontrolElement.show();\r\n\t\t\t\t}\r\n\t\t\t\t//controlElement!.getPrivate(\"button\").style.display = tools.indexOf(tool) == -1 ? \"none\" : \"\";\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _maybeInitToolSeries(tool: DrawingTools): void {\r\n\t\tlet seriesList = this._drawingSeries[tool];\r\n\t\tif (!seriesList) {\r\n\t\t\tseriesList = [];\r\n\t\t}\r\n\r\n\t\t// Get panels that are already initialized\r\n\t\tconst initializedPanels: StockPanel[] = [];\r\n\t\t$array.each(seriesList, (series: DrawingSeries) => {\r\n\t\t\tinitializedPanels.push(series.chart as StockPanel);\r\n\t\t});\r\n\r\n\t\t// Get target series\r\n\t\tconst chartSeries: XYSeries[] = this.get(\"series\", []);\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t// if (chartSeries.length == 0) {\r\n\t\t// \t// No target series set, take first series out of each chart\r\n\t\tstockChart.panels.each((panel) => {\r\n\t\t\tif (initializedPanels.indexOf(panel) == -1) {\r\n\t\t\t\tconst targetSeries = this._getPanelMainSeries(panel);\r\n\t\t\t\tif (targetSeries) {\r\n\t\t\t\t\tchartSeries.push(targetSeries);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t// }\r\n\r\n\t\tif (chartSeries.length > 0) {\r\n\t\t\tconst toolSettings: any = this.get(\"toolSettings\", {});\r\n\r\n\t\t\t// Populate the list\r\n\t\t\t$array.each(chartSeries, (chartSeries) => {\r\n\t\t\t\tlet series: DrawingSeries | undefined;\r\n\t\t\t\tconst xAxis = <any>chartSeries.get(\"xAxis\");\r\n\t\t\t\tconst yAxis = <any>chartSeries.get(\"yAxis\");\r\n\t\t\t\tconst panel = chartSeries.chart! as StockPanel;\r\n\t\t\t\tlet template: any;\r\n\t\t\t\tif (toolSettings[tool]) {\r\n\t\t\t\t\ttemplate = Template.new(toolSettings[tool]);\r\n\t\t\t\t\tconst toolTemplates: any = this.getPrivate(\"toolTemplates\", {});\r\n\t\t\t\t\ttoolTemplates[tool] = template;\r\n\t\t\t\t\tthis.setPrivate(\"toolTemplates\", toolTemplates);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch (tool) {\r\n\t\t\t\t\tcase \"Arrows &amp; Icons\":\r\n\t\t\t\t\t\tconst icon = this.get(\"drawingIcon\", this.get(\"drawingIcons\")![0]);\r\n\t\t\t\t\t\tseries = IconSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\ticonSvgPath: icon.svgPath,\r\n\t\t\t\t\t\t\ticonScale: icon.scale,\r\n\t\t\t\t\t\t\ticonCenterX: icon.centerX,\r\n\t\t\t\t\t\t\ticonCenterY: icon.centerY,\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Average\":\r\n\t\t\t\t\t\tseries = AverageSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Callout\":\r\n\t\t\t\t\t\tseries = CalloutSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Doodle\":\r\n\t\t\t\t\t\tseries = DoodleSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Ellipse\":\r\n\t\t\t\t\t\tseries = EllipseSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Fibonacci\":\r\n\t\t\t\t\t\tseries = FibonacciSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Fibonacci Timezone\":\r\n\t\t\t\t\t\tseries = FibonacciTimezoneSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\tcase \"Horizontal Line\":\r\n\t\t\t\t\t\tseries = HorizontalLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Horizontal Ray\":\r\n\t\t\t\t\t\tseries = HorizontalRaySeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Label\":\r\n\t\t\t\t\t\tseries = LabelSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Line\":\r\n\t\t\t\t\t\tseries = SimpleLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Line Arrow\":\r\n\t\t\t\t\t\tseries = LineArrowSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Measure\":\r\n\t\t\t\t\t\tseries = Measure.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Parallel Channel\":\r\n\t\t\t\t\t\tseries = ParallelChannelSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Polyline\":\r\n\t\t\t\t\t\tseries = PolylineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Polyfill\":\r\n\t\t\t\t\t\tseries = PolylineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfillShape: true\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Triangle\":\r\n\t\t\t\t\t\tseries = PolylineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis,\r\n\t\t\t\t\t\t\tfillShape: true,\r\n\t\t\t\t\t\t\tpointCount: 3\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tseries.fills.template.setAll({\r\n\t\t\t\t\t\t\tforceHidden: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Quadrant Line\":\r\n\t\t\t\t\t\tseries = QuadrantLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rectangle\":\r\n\t\t\t\t\t\tseries = RectangleSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Regression\":\r\n\t\t\t\t\t\tseries = RegressionSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Trend Line\":\r\n\t\t\t\t\t\tseries = TrendLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Vertical Line\":\r\n\t\t\t\t\t\tseries = VerticalLineSeries.new(this._root, {\r\n\t\t\t\t\t\t\tseries: chartSeries,\r\n\t\t\t\t\t\t\txAxis: xAxis,\r\n\t\t\t\t\t\t\tyAxis: yAxis\r\n\t\t\t\t\t\t}, template);\r\n\t\t\t\t\t\tbreak;\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif (series) {\r\n\t\t\t\t\tseriesList.push(series);\r\n\t\t\t\t\tpanel.drawings.push(series);\r\n\t\t\t\t\tseries.setPrivate(\"baseValueSeries\", chartSeries);\r\n\t\t\t\t\tseries.set(\"valueYShow\", stockChart.getSeriesDefault(chartSeries, \"valueYShow\"));\r\n\t\t\t\t\tseries.set(\"calculateAggregates\", true);\r\n\t\t\t\t\tif (stockChart.getPrivate(\"comparing\")) {\r\n\t\t\t\t\t\tstockChart.setPercentScale(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis._drawingSeries[tool] = seriesList;\r\n\r\n\t\t\tthis._setStroke();\r\n\t\t\tthis._setFill();\r\n\t\t\tthis._setLabel();\r\n\t\t\tthis._setDrawingIcon();\r\n\t\t\tthis._setSnap();\r\n\t\t\tthis._setExtension();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateSeriesBindings(panel: StockPanel): void {\r\n\t\tconst targetSeries = this._getPanelMainSeries(panel);\r\n\t\tif (targetSeries) {\r\n\t\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t\t$array.eachReverse(seriesList, (series) => {\r\n\t\t\t\t\tif (series.chart == panel) {\r\n\t\t\t\t\t\tif (panel.isDisposed()) {\r\n\t\t\t\t\t\t\t$array.remove(seriesList, series);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tseries.set(\"series\", targetSeries);\r\n\t\t\t\t\t\t\tseries.setPrivate(\"baseValueSeries\", targetSeries);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getPanelMainSeries(panel: StockPanel): XYSeries | undefined {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\tlet targetSeries: XYSeries | undefined;\r\n\t\tif (stockSeries && stockSeries.chart == panel) {\r\n\t\t\ttargetSeries = stockSeries;\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttargetSeries = panel.series.getIndex(0);\r\n\t\t}\r\n\t\treturn targetSeries;\r\n\t}\r\n\r\n\tprotected _updatePanelBindings(): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.panels.each((panel) => {\r\n\t\t\tpanel.series.events.onAll(() => this._updateSeriesBindings(panel));\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _setStroke(): void {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tseries.setAll({\r\n\t\t\t\t\tstrokeColor: this.get(\"strokeColor\"),\r\n\t\t\t\t\tstrokeWidth: this.get(\"strokeWidth\"),\r\n\t\t\t\t\tstrokeOpacity: this.get(\"strokeOpacity\"),\r\n\t\t\t\t\tstrokeDasharray: this.get(\"strokeDasharray\"),\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setFill(): void {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tseries.setAll({\r\n\t\t\t\t\tfillColor: this.get(\"fillColor\"),\r\n\t\t\t\t\tfillOpacity: this.get(\"fillOpacity\")\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setLabel(): void {\r\n\t\tconst labelTools = [\"Callout\", \"Label\"];\r\n\t\t$object.each(this._drawingSeries, (tool, seriesList) => {\r\n\t\t\tif (labelTools.indexOf(<string>tool) != -1) {\r\n\t\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\t\t(<LabelSeries>series).setAll({\r\n\t\t\t\t\t\tlabelFill: this.get(\"labelFill\"),\r\n\t\t\t\t\t\tlabelFontSize: this.get(\"labelFontSize\"),\r\n\t\t\t\t\t\tlabelFontFamily: this.get(\"labelFontFamily\"),\r\n\t\t\t\t\t\tlabelFontWeight: this.get(\"labelFontWeight\"),\r\n\t\t\t\t\t\tlabelFontStyle: this.get(\"labelFontStyle\")\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setExtension(): void {\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series instanceof SimpleLineSeries) {\r\n\t\t\t\t\tseries.setAll({\r\n\t\t\t\t\t\tshowExtension: this.get(\"showExtension\")\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setDrawingIcon(): void {\r\n\t\tif (!this._isInited()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst icon = this.get(\"drawingIcon\", this.get(\"drawingIcons\")![0]);\r\n\t\tconst fillControl = this.getPrivate(\"fillControl\")!;\r\n\t\tif (icon.fillDisabled) {\r\n\t\t\tfillControl.hide();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfillControl.show();\r\n\t\t}\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series instanceof IconSeries) {\r\n\t\t\t\t\tseries.setAll({\r\n\t\t\t\t\t\ticonSvgPath: icon.svgPath,\r\n\t\t\t\t\t\ticonScale: icon.scale,\r\n\t\t\t\t\t\ticonCenterX: icon.centerX,\r\n\t\t\t\t\t\ticonCenterY: icon.centerY,\r\n\t\t\t\t\t\tfillOpacity: icon.fillDisabled ? 0 : this.get(\"fillOpacity\")\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _setSnap(): void {\r\n\t\tconst snap = this.get(\"snapToData\", false);\r\n\t\t$object.each(this._drawingSeries, (_tool, seriesList) => {\r\n\t\t\t$array.each(seriesList, (series) => {\r\n\t\t\t\tif (series.getPrivate(\"allowChangeSnap\")) {\r\n\t\t\t\t\tseries.set(\"snapToData\", snap);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Draw\");\r\n\t}\r\n\r\n\tprotected _dispose(): void {\r\n\t\tsuper._dispose();\r\n\t\tconst toolsContainer = this.getPrivate(\"toolsContainer\");\r\n\t\tif (toolsContainer) {\r\n\t\t\t$utils.removeElement(toolsContainer);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getSeriesTool(series: DrawingSeries): DrawingTools | undefined {\r\n\t\tif (series instanceof DrawingSeries) {\r\n\t\t\tlet name = series.className;\r\n\t\t\tif (name == \"SimpleLineSeries\") {\r\n\t\t\t\treturn \"Line\";\r\n\t\t\t}\r\n\t\t\telse if (name == \"IconSeries\") {\r\n\t\t\t\treturn \"Arrows &amp; Icons\";\r\n\t\t\t}\r\n\t\t\telse if (name == \"PolylineSeries\" && (series as PolylineSeries).get(\"pointCount\") == 3) {\r\n\t\t\t\treturn \"Triangle\";\r\n\t\t\t}\r\n\t\t\telse if (name == \"PolylineSeries\" && (series as PolylineSeries).get(\"fillShape\")) {\r\n\t\t\t\treturn \"Polyfill\";\r\n\t\t\t}\r\n\t\t\tname = $utils.addSpacing(name.replace(\"Series\", \"\"));\r\n\t\t\treturn name as DrawingTools;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Serializes all drawings into an array of simple objects or JSON.\r\n\t *\r\n\t * `output` parameter can either be `\"object\"` or `\"string\"` (default).\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/serializing-indicators-annotations/} for more info\r\n\t * @since 5.3.0\r\n\t * @param   output Output format\r\n\t * @param   indent Line indent in JSON\r\n\t * @return         Serialized indicators\r\n\t */\r\n\tpublic serializeDrawings(output: \"object\" | \"string\" = \"string\", indent?: string): Array<unknown> | string {\r\n\t\tconst res: Array<any> = [];\r\n\t\tthis.get(\"stockChart\").panels.each((panel, panelIndex) => {\r\n\t\t\tpanel.series.each((series) => {\r\n\t\t\t\tif (series.isType<DrawingSeries>(\"DrawingSeries\")) {\r\n\t\t\t\t\tconst serializer = Serializer.new(this.root, {\r\n\t\t\t\t\t\tincludeSettings: [\"strokeColor\", \"fillColor\", \"strokeOpacity\", \"fillOpacity\", \"strokeWidth\", \"strokeDasharray\", \"field\", \"snapToData\", \"svgPath\", \"labelFontSize\", \"labelFontFamily\", \"labelFontWeight\", \"labelFontStyle\", \"labelFill\", \"showExtension\"],\r\n\t\t\t\t\t\t//includeSettings: [\"data\"],\r\n\t\t\t\t\t\tmaxDepth: 4\r\n\t\t\t\t\t});\r\n\t\t\t\t\tseries.data.values.map((row: any) => {\r\n\t\t\t\t\t\trow.__parse = true;\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconst json: any = {\r\n\t\t\t\t\t\t__tool: this._getSeriesTool(series),\r\n\t\t\t\t\t\t__panelIndex: panelIndex,\r\n\t\t\t\t\t\t__drawing: serializer.serialize(series.data.values, 0, true)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//json.__panelIndex = panelIndex;\r\n\t\t\t\t\tres.push(json);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn output == \"object\" ? res : JSON.stringify(res, undefined, indent);\r\n\t}\r\n\r\n\t/**\r\n\t * Parses data serialized with `serializeDrawings()` and adds drawings to the\r\n\t * chart.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/serializing-indicators-annotations/} for more info\r\n\t * @since 5.3.0\r\n\t * @param  data Serialized data\r\n\t */\r\n\tpublic unserializeDrawings(data: string | Array<any>): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tif ($type.isString(data)) {\r\n\t\t\tdata = JSON.parse(data);\r\n\t\t}\r\n\t\tif (!$type.isArray(data)) {\r\n\t\t\tdata = [data];\r\n\t\t}\r\n\t\t$array.each(data, (drawing) => {\r\n\t\t\t// Panel\r\n\t\t\tlet panel = stockChart.panels.getIndex(drawing.__panelIndex || 0)!;\r\n\r\n\t\t\tif (panel) {\r\n\t\t\t\tconst tool = drawing.__tool;\r\n\r\n\t\t\t\tthis._maybeInitToolSeries(tool);\r\n\r\n\t\t\t\t// Get series\r\n\t\t\t\tlet drawingSeries: DrawingSeries;\r\n\t\t\t\t$array.each(this._drawingSeries[tool] || [], (series) => {\r\n\t\t\t\t\tif (series.chart === panel) {\r\n\t\t\t\t\t\tdrawingSeries = series;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (!drawing.settings) {\r\n\t\t\t\t\tdrawing.settings = {};\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Parse\r\n\t\t\t\tJsonParser.new(this._root).parse(drawing.__drawing).then((drawingData: any) => {\r\n\t\t\t\t\tthis._updateDrawingIndexes(drawingData, drawingSeries._index, drawingSeries);\r\n\t\t\t\t\tdrawingSeries.data.pushAll(drawingData);\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Wait until panel becomes available\r\n\t\t\t\tstockChart.panels.events.once(\"push\", (ev) => {\r\n\t\t\t\t\tev.newValue.series.events.once(\"push\", (_ev) => {\r\n\t\t\t\t\t\tthis.unserializeDrawings(drawing);\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _updateDrawingIndexes(drawingData: any, index: number, drawingSeries: DrawingSeries): void {\r\n\t\tif ($type.isArray(drawingData)) {\r\n\t\t\t$array.each(drawingData, (item: any) => {\r\n\t\t\t\tthis._updateDrawingIndexes(item, index, drawingSeries);\r\n\t\t\t})\r\n\t\t}\r\n\t\telse if ($type.isObject(drawingData as any) && drawingData.index !== undefined) {\r\n\t\t\tdrawingData.index += index;\r\n\t\t\tdrawingSeries._index = drawingData.index;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns an object that holds all drawing series, arrange by tool (key).\r\n\t *\r\n\t * @since 5.8.0\r\n\t * @readonly\r\n\t */\r\n\tpublic get drawingSeries(): { [index: string]: DrawingSeries[] } {\r\n\t\treturn this._drawingSeries;\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a line drawing.\r\n\t *\r\n\t * Supported tools: `\"Horizontal Line\"`, `\"Horizontal Ray\"`, `\"Vertical Line\"`.\r\n\t * \r\n\t * @param  tool   Drawing tool\r\n\t * @param  panel  Panel\r\n\t * @param  point  Point\r\n\t * @since 5.10.2\r\n\t */\r\n\tpublic addLine(tool: \"Horizontal Line\" | \"Horizontal Ray\" | \"Vertical Line\", panel: StockPanel, point: IPoint): void {\r\n\t\tthis._maybeInitToolSeries(tool);\r\n\t\tconst seriesList = this._drawingSeries[tool];\r\n\t\tlet targetSeries: SimpleLineSeries | undefined;\r\n\t\t$array.each(seriesList, (series) => {\r\n\t\t\tif (panel === series.chart) {\r\n\t\t\t\ttargetSeries = series as SimpleLineSeries;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (targetSeries) {\r\n\t\t\ttargetSeries.addLine(point);\r\n\t\t}\r\n\t}\r\n}","import type { StockLegend } from \"../StockLegend\";\r\nimport type { StockPanel } from \"../StockPanel\";\r\n\r\nimport { Indicator } from \"../indicators/Indicator\";\r\nimport { AccelerationBands } from \"../indicators/AccelerationBands\";\r\nimport { AccumulationDistribution } from \"../indicators/AccumulationDistribution\";\r\nimport { AccumulativeSwingIndex } from \"../indicators/AccumulativeSwingIndex\";\r\nimport { Aroon } from \"../indicators/Aroon\";\r\nimport { AwesomeOscillator } from \"../indicators/AwesomeOscillator\";\r\nimport { BollingerBands } from \"../indicators/BollingerBands\";\r\nimport { BullBearPower } from \"../indicators/BullBearPower\";\r\nimport { ChaikinMoneyFlow } from \"../indicators/ChaikinMoneyFlow\";\r\nimport { ChaikinOscillator } from \"../indicators/ChaikinOscillator\";\r\nimport { CommodityChannelIndex } from \"../indicators/CommodityChannelIndex\";\r\nimport { DisparityIndex } from \"../indicators/DisparityIndex\";\r\nimport { MACD } from \"../indicators/MACD\";\r\nimport { MACross } from \"../indicators/MACross\";\r\nimport { MovingAverage } from \"../indicators/MovingAverage\";\r\nimport { MovingAverageDeviation } from \"../indicators/MovingAverageDeviation\";\r\nimport { MovingAverageEnvelope } from \"../indicators/MovingAverageEnvelope\";\r\nimport { StandardDeviation } from \"../indicators/StandardDeviation\";\r\nimport { TypicalPrice } from \"../indicators/TypicalPrice\";\r\nimport { AverageTrueRange } from \"../indicators/AverageTrueRange\";\r\nimport { MedianPrice } from \"../indicators/MedianPrice\";\r\nimport { OnBalanceVolume } from \"../indicators/OnBalanceVolume\";\r\nimport { PVT } from \"../indicators/PVT\";\r\nimport { Momentum } from \"../indicators/Momentum\";\r\nimport { RelativeStrengthIndex } from \"../indicators/RelativeStrengthIndex\";\r\nimport { StochasticMomentumIndex } from \"../indicators/StochasticMomentumIndex\";\r\nimport { StochasticOscillator } from \"../indicators/StochasticOscillator\";\r\nimport { WilliamsR } from \"../indicators/WilliamsR\";\r\nimport { Trix } from \"../indicators/Trix\";\r\nimport { Volume } from \"../indicators/Volume\";\r\nimport { VolumeProfile } from \"../indicators/VolumeProfile\";\r\nimport { VWAP } from \"../indicators/VWAP\";\r\nimport { ZigZag } from \"../indicators/ZigZag\";\r\n\r\nimport { JsonParser } from \"../../../plugins/json/Json\";\r\nimport { Serializer } from \"../../../plugins/json/Serializer\";\r\n\r\n//import type { IDisposer } from \"../../../core/util/Disposer\";\r\nimport { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\nimport type { DropdownList, IDropdownListItem } from \"./DropdownList\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport type Indicators = \"Acceleration Bands\" | \"Accumulation Distribution\" | \"Accumulative Swing Index\" | \"Aroon\" | \"Average True Range\" | \"Awesome Oscillator\" | \"Bollinger Bands\" | \"Bull Bear Power\" | \"Chaikin Money Flow\" | \"Chaikin Oscillator\" | \"Commodity Channel Index\" | \"Disparity Index\" | \"MACD\" | \"Momentum\" | \"Moving Average\" | \"Moving Average Cross\" | \"Moving Average Deviation\" | \"Moving Average Envelope\" | \"On Balance Volume\" | \"Price Volume Trend\" | \"Relative Strength Index\" | \"Standard Deviation\" | \"Stochastic Oscillator\" | \"Stochastic Momentum Index\" | \"Trix\" | \"Typical Price\" | \"Volume\" | \"Volume Profile\" | \"VWAP\" | \"Williams R\" | \"Median Price\" | \"ZigZag\";\r\n\r\nexport interface IIndicator {\r\n\tid: string;\r\n\tname: string;\r\n\tcallback: () => Indicator;\r\n}\r\n\r\nexport interface IIndicatorControlSettings extends IDropdownListControlSettings {\r\n\tindicators?: Array<Indicators | IIndicator>;\r\n\tlegend?: StockLegend;\r\n}\r\n\r\nexport interface IIndicatorControlPrivate extends IDropdownListControlPrivate {\r\n\t/**\r\n\t * Here for backwards compatiblity befor [[IndicatorControl]] was\r\n\t * migrated to extend [[DropdownListControl]].\r\n\t *\r\n\t * @ignore\r\n\t */\r\n\tlist?: DropdownList;\r\n}\r\n\r\nexport interface IIndicatorControlEvents extends IDropdownListControlEvents {\r\n\tselected: {\r\n\t\titem: string | IDropdownListItem;\r\n\t\tindicator: Indicator | IIndicator;\r\n\t}\r\n}\r\n\r\n/**\r\n * A [[StockToolbar]] control for adding indicators to a [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/indicator-control/} for more info\r\n */\r\nexport class IndicatorControl extends DropdownListControl {\r\n\tpublic static className: string = \"IndicatorControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([IndicatorControl.className]);\r\n\r\n\tdeclare public _settings: IIndicatorControlSettings;\r\n\tdeclare public _privateSettings: IIndicatorControlPrivate;\r\n\tdeclare public _events: IIndicatorControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst list = this.getPrivate(\"dropdown\")!;\r\n\t\tthis.setPrivate(\"list\", list);\r\n\r\n\t\tlist.events.on(\"invoked\", (ev) => {\r\n\t\t\tconst indicator = this.addIndicator(<Indicators>ev.item.id);\r\n\t\t\tif (this.events.isEnabled(\"selected\") && indicator) {\r\n\t\t\t\tthis.events.dispatch(\"selected\", {\r\n\t\t\t\t\ttype: \"selected\",\r\n\t\t\t\t\ttarget: this,\r\n\t\t\t\t\tindicator: indicator,\r\n\t\t\t\t\titem: ev.item\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tlist.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => list.show(), 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlist.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\r\n\t\tthis._initList();\r\n\r\n\t\t// Re-nit list if volume series is added or removed so that we can show/hide\r\n\t\t// volume-dependent indicators\r\n\t\tthis.get(\"stockChart\").on(\"volumeSeries\", () => this._initList());\r\n\t}\r\n\r\n\tprotected _initList(): void {\r\n\t\tconst list = this.getPrivate(\"list\")!;\r\n\t\tconst indicators = this.get(\"indicators\")!;\r\n\t\tconst items: IDropdownListItem[] = [];\r\n\t\t$array.each(indicators, (indicator: Indicators | IIndicator) => {\r\n\t\t\tif ($type.isObject(indicator)) {\r\n\t\t\t\tif (this.supportsIndicator(indicator.id as Indicators)) {\r\n\t\t\t\t\titems.push({\r\n\t\t\t\t\t\tid: indicator.id,\r\n\t\t\t\t\t\tlabel: indicator.name\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (this.supportsIndicator(indicator as Indicators)) {\r\n\t\t\t\t\titems.push({\r\n\t\t\t\t\t\tid: indicator,\r\n\t\t\t\t\t\tlabel: this._root.language.translateAny(indicator)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tlist.set(\"items\", items);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns `true` if the indicator is supported in current chart setup.\r\n\t * \r\n\t * @param   indicatorId  Indicator ID\r\n\t * @return               Supported?\r\n\t */\r\n\tpublic supportsIndicator(indicatorId: Indicators): boolean {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst volumeIndicators = [\"Chaikin Money Flow\", \"Chaikin Oscillator\", \"On Balance Volume\", \"Price Volume Trend\", \"Volume\", \"Volume Profile\", \"VWAP\"];\r\n\t\treturn (stockChart.get(\"volumeSeries\") || volumeIndicators.indexOf(indicatorId) === -1) ? true : false;\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Indicator\");\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t\tif (this.isDirty(\"indicators\")) {\r\n\t\t\tthis._initList();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Removes all indicators from the stock chart.\r\n\t *\r\n\t * @since 5.9.3\r\n\t */\r\n\tpublic clearIndicators(): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.indicators.eachReverse((indicator) => {\r\n\t\t\tindicator.dispose();\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a specific indicator, adds it to chart, and returns the instance.\r\n\t * \r\n\t * @param   indicatorId  Indicator ID\r\n\t * @return               Indicator instance\r\n\t */\r\n\tpublic addIndicator(indicatorId: Indicators): Indicator | undefined {\r\n\r\n\t\tif (!this.supportsIndicator(indicatorId)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tlet indicator: Indicator | undefined;\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\")!;\r\n\t\tconst volumeSeries = stockChart.get(\"volumeSeries\")!;\r\n\t\tconst legend = this.get(\"legend\");\r\n\r\n\t\tswitch (indicatorId) {\r\n\t\t\tcase \"Acceleration Bands\":\r\n\t\t\t\tindicator = AccelerationBands.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"Accumulation Distribution\":\r\n\t\t\t\tindicator = AccumulationDistribution.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Accumulative Swing Index\":\r\n\t\t\t\tindicator = AccumulativeSwingIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Aroon\":\r\n\t\t\t\tindicator = Aroon.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Awesome Oscillator\":\r\n\t\t\t\tindicator = AwesomeOscillator.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Bollinger Bands\":\r\n\t\t\t\tindicator = BollingerBands.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Bull Bear Power\":\r\n\t\t\t\tindicator = BullBearPower.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Chaikin Money Flow\":\r\n\t\t\t\tindicator = ChaikinMoneyFlow.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Chaikin Oscillator\":\r\n\t\t\t\tindicator = ChaikinOscillator.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Commodity Channel Index\":\r\n\t\t\t\tindicator = CommodityChannelIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Disparity Index\":\r\n\t\t\t\tindicator = DisparityIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"MACD\":\r\n\t\t\t\tindicator = MACD.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Median Price\":\r\n\t\t\t\tindicator = MedianPrice.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Momentum\":\r\n\t\t\t\tindicator = Momentum.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Moving Average Cross\":\r\n\t\t\t\tindicator = MACross.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Moving Average\":\r\n\t\t\t\tindicator = MovingAverage.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Moving Average Deviation\":\r\n\t\t\t\tindicator = MovingAverageDeviation.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Moving Average Envelope\":\r\n\t\t\t\tindicator = MovingAverageEnvelope.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Standard Deviation\":\r\n\t\t\t\tindicator = StandardDeviation.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Trix\":\r\n\t\t\t\tindicator = Trix.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Typical Price\":\r\n\t\t\t\tindicator = TypicalPrice.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Average True Range\":\r\n\t\t\t\t\tindicator = AverageTrueRange.new(this.root, {\r\n\t\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\t\tlegend: legend\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\t\t\t\t\r\n\t\t\tcase \"On Balance Volume\":\r\n\t\t\t\tindicator = OnBalanceVolume.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Price Volume Trend\":\r\n\t\t\t\tindicator = PVT.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Relative Strength Index\":\r\n\t\t\t\tindicator = RelativeStrengthIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Stochastic Momentum Index\":\r\n\t\t\t\tindicator = StochasticMomentumIndex.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Stochastic Oscillator\":\r\n\t\t\t\tindicator = StochasticOscillator.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Williams R\":\r\n\t\t\t\tindicator = WilliamsR.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Volume\":\r\n\t\t\t\tindicator = Volume.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Volume Profile\":\r\n\t\t\t\tindicator = VolumeProfile.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"VWAP\":\r\n\t\t\t\tindicator = VWAP.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tvolumeSeries: volumeSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"ZigZag\":\r\n\t\t\t\tindicator = ZigZag.new(this.root, {\r\n\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\tstockSeries: stockSeries,\r\n\t\t\t\t\tlegend: legend\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (!indicator) {\r\n\t\t\t// Try searching in the list\r\n\t\t\t$array.eachContinue(this.get(\"indicators\", []), (item) => {\r\n\t\t\t\tif ($type.isObject(item) && item.id == indicatorId) {\r\n\t\t\t\t\tindicator = item.callback.call(this);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (indicator) {\r\n\t\t\tstockChart.indicators.push(indicator);\r\n\t\t\tif (indicator._editableSettings.length && indicator.get(\"autoOpenSettings\", true)) {\r\n\t\t\t\tconst modal = stockChart.getPrivate(\"settingsModal\");\r\n\t\t\t\tmodal.events.once(\"done\", (ev) => {\r\n\t\t\t\t\tif (indicator) {\r\n\t\t\t\t\t\tif (!ev.settings) {\r\n\t\t\t\t\t\t\tindicator.dispose();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tmodal.openIndicator(indicator);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn indicator;\r\n\t}\r\n\r\n\t/**\r\n\t * Serializes all available indicators into an array of simple objects or\r\n\t * JSON.\r\n\t *\r\n\t * `output` parameter can either be `\"object\"` or `\"string\"` (default).\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/serializing-indicators-annotations/} for more info\r\n\t * @since 5.3.0\r\n\t * @param   output Output format\r\n\t * @param   indent Line indent in JSON\r\n\t * @return         Serialized indicators\r\n\t */\r\n\tpublic serializeIndicators(output: \"object\" | \"string\" = \"string\", indent?: string): Array<unknown> | string {\r\n\t\tconst res: Array<any> = [];\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.indicators.each((indicator) => {\r\n\t\t\tconst serializer = Serializer.new(this._root, {\r\n\t\t\t\texcludeSettings: [\"stockChart\", \"stockSeries\", \"volumeSeries\", \"legend\"]\r\n\t\t\t});\r\n\r\n\t\t\t// Panel\r\n\t\t\tconst json: any = {};\r\n\r\n\t\t\t// Series and legend\r\n\t\t\tif (indicator.get(\"stockSeries\")) {\r\n\t\t\t\tjson.__stockSeries = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (indicator.get(\"volumeSeries\")) {\r\n\t\t\t\tjson.__volumeSeries = true;\r\n\t\t\t}\r\n\r\n\t\t\tconst legend = indicator.get(\"legend\");\r\n\t\t\tif (legend) {\r\n\t\t\t\tlegend._walkParents((parent) => {\r\n\t\t\t\t\tif (parent.isType(\"StockPanel\")) {\r\n\t\t\t\t\t\tjson.__legendIndex = stockChart.panels.indexOf(parent as StockPanel);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Serialize\r\n\t\t\tjson.__indicator = serializer.serialize(indicator, 0);\r\n\r\n\t\t\tres.push(json);\r\n\t\t});\r\n\t\treturn output == \"object\" ? res : JSON.stringify(res, undefined, indent);\r\n\t}\r\n\r\n\t/**\r\n\t * Parses data serialized with `serializeIndicators()` and adds indicators to\r\n\t * the chart.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/serializing-indicators-annotations/} for more info\r\n\t * @since 5.3.0\r\n\t * @param  data Serialized data\r\n\t */\r\n\tpublic unserializeIndicators(data: string | Array<any>): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tif ($type.isString(data)) {\r\n\t\t\tdata = JSON.parse(data);\r\n\t\t}\r\n\t\t$array.each(data, (indicator) => {\r\n\r\n\t\t\t// Populate\r\n\t\t\tif (!indicator.__indicator.settings) {\r\n\t\t\t\tindicator.__indicator.settings = {};\r\n\t\t\t}\r\n\t\t\tindicator.__indicator.settings.stockChart = stockChart;\r\n\r\n\t\t\tif (indicator.__stockSeries && !indicator.__indicator.settings.stockSeries) {\r\n\t\t\t\tindicator.__indicator.settings.stockSeries = stockChart.get(\"stockSeries\");\r\n\t\t\t}\r\n\r\n\t\t\tif (indicator.__volumeSeries && !indicator.__indicator.settings.volumeSeries) {\r\n\t\t\t\tindicator.__indicator.settings.volumeSeries = stockChart.get(\"volumeSeries\");\r\n\t\t\t}\r\n\r\n\t\t\tif (indicator.__legendIndex !== undefined && !indicator.__indicator.settings.legend) {\r\n\t\t\t\t// Find a legend\r\n\t\t\t\tconst panel = stockChart.panels.getIndex(indicator.__legendIndex);\r\n\t\t\t\tif (panel) {\r\n\t\t\t\t\tpanel.walkChildren((child) => {\r\n\t\t\t\t\t\tif (child.isType(\"StockLegend\")) {\r\n\t\t\t\t\t\t\tindicator.__indicator.settings.legend = child;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Parse\r\n\t\t\tJsonParser.new(this._root).parse(indicator.__indicator).then((indicator: any) => {\r\n\t\t\t\tif (indicator instanceof Indicator) {\r\n\t\t\t\t\tstockChart.indicators.push(indicator);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t}\r\n\r\n}","export var HOOKS = [\n    \"onChange\",\n    \"onClose\",\n    \"onDayCreate\",\n    \"onDestroy\",\n    \"onKeyDown\",\n    \"onMonthChange\",\n    \"onOpen\",\n    \"onParseConfig\",\n    \"onReady\",\n    \"onValueUpdate\",\n    \"onYearChange\",\n    \"onPreCalendarPosition\",\n];\nexport var defaults = {\n    _disable: [],\n    allowInput: false,\n    allowInvalidPreload: false,\n    altFormat: \"F j, Y\",\n    altInput: false,\n    altInputClass: \"form-control input\",\n    animate: typeof window === \"object\" &&\n        window.navigator.userAgent.indexOf(\"MSIE\") === -1,\n    ariaDateFormat: \"F j, Y\",\n    autoFillDefaultTime: true,\n    clickOpens: true,\n    closeOnSelect: true,\n    conjunction: \", \",\n    dateFormat: \"Y-m-d\",\n    defaultHour: 12,\n    defaultMinute: 0,\n    defaultSeconds: 0,\n    disable: [],\n    disableMobile: false,\n    enableSeconds: false,\n    enableTime: false,\n    errorHandler: function (err) {\n        return typeof console !== \"undefined\" && console.warn(err);\n    },\n    getWeek: function (givenDate) {\n        var date = new Date(givenDate.getTime());\n        date.setHours(0, 0, 0, 0);\n        date.setDate(date.getDate() + 3 - ((date.getDay() + 6) % 7));\n        var week1 = new Date(date.getFullYear(), 0, 4);\n        return (1 +\n            Math.round(((date.getTime() - week1.getTime()) / 86400000 -\n                3 +\n                ((week1.getDay() + 6) % 7)) /\n                7));\n    },\n    hourIncrement: 1,\n    ignoredFocusElements: [],\n    inline: false,\n    locale: \"default\",\n    minuteIncrement: 5,\n    mode: \"single\",\n    monthSelectorType: \"dropdown\",\n    nextArrow: \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>\",\n    noCalendar: false,\n    now: new Date(),\n    onChange: [],\n    onClose: [],\n    onDayCreate: [],\n    onDestroy: [],\n    onKeyDown: [],\n    onMonthChange: [],\n    onOpen: [],\n    onParseConfig: [],\n    onReady: [],\n    onValueUpdate: [],\n    onYearChange: [],\n    onPreCalendarPosition: [],\n    plugins: [],\n    position: \"auto\",\n    positionElement: undefined,\n    prevArrow: \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>\",\n    shorthandCurrentMonth: false,\n    showMonths: 1,\n    static: false,\n    time_24hr: false,\n    weekNumbers: false,\n    wrap: false,\n};\n","export var english = {\n    weekdays: {\n        shorthand: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n        longhand: [\n            \"Sunday\",\n            \"Monday\",\n            \"Tuesday\",\n            \"Wednesday\",\n            \"Thursday\",\n            \"Friday\",\n            \"Saturday\",\n        ],\n    },\n    months: {\n        shorthand: [\n            \"Jan\",\n            \"Feb\",\n            \"Mar\",\n            \"Apr\",\n            \"May\",\n            \"Jun\",\n            \"Jul\",\n            \"Aug\",\n            \"Sep\",\n            \"Oct\",\n            \"Nov\",\n            \"Dec\",\n        ],\n        longhand: [\n            \"January\",\n            \"February\",\n            \"March\",\n            \"April\",\n            \"May\",\n            \"June\",\n            \"July\",\n            \"August\",\n            \"September\",\n            \"October\",\n            \"November\",\n            \"December\",\n        ],\n    },\n    daysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],\n    firstDayOfWeek: 0,\n    ordinal: function (nth) {\n        var s = nth % 100;\n        if (s > 3 && s < 21)\n            return \"th\";\n        switch (s % 10) {\n            case 1:\n                return \"st\";\n            case 2:\n                return \"nd\";\n            case 3:\n                return \"rd\";\n            default:\n                return \"th\";\n        }\n    },\n    rangeSeparator: \" to \",\n    weekAbbreviation: \"Wk\",\n    scrollTitle: \"Scroll to increment\",\n    toggleTitle: \"Click to toggle\",\n    amPM: [\"AM\", \"PM\"],\n    yearAriaLabel: \"Year\",\n    monthAriaLabel: \"Month\",\n    hourAriaLabel: \"Hour\",\n    minuteAriaLabel: \"Minute\",\n    time_24hr: false,\n};\nexport default english;\n","export var pad = function (number, length) {\n    if (length === void 0) { length = 2; }\n    return (\"000\" + number).slice(length * -1);\n};\nexport var int = function (bool) { return (bool === true ? 1 : 0); };\nexport function debounce(fn, wait) {\n    var t;\n    return function () {\n        var _this = this;\n        var args = arguments;\n        clearTimeout(t);\n        t = setTimeout(function () { return fn.apply(_this, args); }, wait);\n    };\n}\nexport var arrayify = function (obj) {\n    return obj instanceof Array ? obj : [obj];\n};\n","export function toggleClass(elem, className, bool) {\n    if (bool === true)\n        return elem.classList.add(className);\n    elem.classList.remove(className);\n}\nexport function createElement(tag, className, content) {\n    var e = window.document.createElement(tag);\n    className = className || \"\";\n    content = content || \"\";\n    e.className = className;\n    if (content !== undefined)\n        e.textContent = content;\n    return e;\n}\nexport function clearNode(node) {\n    while (node.firstChild)\n        node.removeChild(node.firstChild);\n}\nexport function findParent(node, condition) {\n    if (condition(node))\n        return node;\n    else if (node.parentNode)\n        return findParent(node.parentNode, condition);\n    return undefined;\n}\nexport function createNumberInput(inputClassName, opts) {\n    var wrapper = createElement(\"div\", \"numInputWrapper\"), numInput = createElement(\"input\", \"numInput \" + inputClassName), arrowUp = createElement(\"span\", \"arrowUp\"), arrowDown = createElement(\"span\", \"arrowDown\");\n    if (navigator.userAgent.indexOf(\"MSIE 9.0\") === -1) {\n        numInput.type = \"number\";\n    }\n    else {\n        numInput.type = \"text\";\n        numInput.pattern = \"\\\\d*\";\n    }\n    if (opts !== undefined)\n        for (var key in opts)\n            numInput.setAttribute(key, opts[key]);\n    wrapper.appendChild(numInput);\n    wrapper.appendChild(arrowUp);\n    wrapper.appendChild(arrowDown);\n    return wrapper;\n}\nexport function getEventTarget(event) {\n    try {\n        if (typeof event.composedPath === \"function\") {\n            var path = event.composedPath();\n            return path[0];\n        }\n        return event.target;\n    }\n    catch (error) {\n        return event.target;\n    }\n}\n","import { int, pad } from \"../utils\";\nvar doNothing = function () { return undefined; };\nexport var monthToStr = function (monthNumber, shorthand, locale) { return locale.months[shorthand ? \"shorthand\" : \"longhand\"][monthNumber]; };\nexport var revFormat = {\n    D: doNothing,\n    F: function (dateObj, monthName, locale) {\n        dateObj.setMonth(locale.months.longhand.indexOf(monthName));\n    },\n    G: function (dateObj, hour) {\n        dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));\n    },\n    H: function (dateObj, hour) {\n        dateObj.setHours(parseFloat(hour));\n    },\n    J: function (dateObj, day) {\n        dateObj.setDate(parseFloat(day));\n    },\n    K: function (dateObj, amPM, locale) {\n        dateObj.setHours((dateObj.getHours() % 12) +\n            12 * int(new RegExp(locale.amPM[1], \"i\").test(amPM)));\n    },\n    M: function (dateObj, shortMonth, locale) {\n        dateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));\n    },\n    S: function (dateObj, seconds) {\n        dateObj.setSeconds(parseFloat(seconds));\n    },\n    U: function (_, unixSeconds) { return new Date(parseFloat(unixSeconds) * 1000); },\n    W: function (dateObj, weekNum, locale) {\n        var weekNumber = parseInt(weekNum);\n        var date = new Date(dateObj.getFullYear(), 0, 2 + (weekNumber - 1) * 7, 0, 0, 0, 0);\n        date.setDate(date.getDate() - date.getDay() + locale.firstDayOfWeek);\n        return date;\n    },\n    Y: function (dateObj, year) {\n        dateObj.setFullYear(parseFloat(year));\n    },\n    Z: function (_, ISODate) { return new Date(ISODate); },\n    d: function (dateObj, day) {\n        dateObj.setDate(parseFloat(day));\n    },\n    h: function (dateObj, hour) {\n        dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));\n    },\n    i: function (dateObj, minutes) {\n        dateObj.setMinutes(parseFloat(minutes));\n    },\n    j: function (dateObj, day) {\n        dateObj.setDate(parseFloat(day));\n    },\n    l: doNothing,\n    m: function (dateObj, month) {\n        dateObj.setMonth(parseFloat(month) - 1);\n    },\n    n: function (dateObj, month) {\n        dateObj.setMonth(parseFloat(month) - 1);\n    },\n    s: function (dateObj, seconds) {\n        dateObj.setSeconds(parseFloat(seconds));\n    },\n    u: function (_, unixMillSeconds) {\n        return new Date(parseFloat(unixMillSeconds));\n    },\n    w: doNothing,\n    y: function (dateObj, year) {\n        dateObj.setFullYear(2000 + parseFloat(year));\n    },\n};\nexport var tokenRegex = {\n    D: \"\",\n    F: \"\",\n    G: \"(\\\\d\\\\d|\\\\d)\",\n    H: \"(\\\\d\\\\d|\\\\d)\",\n    J: \"(\\\\d\\\\d|\\\\d)\\\\w+\",\n    K: \"\",\n    M: \"\",\n    S: \"(\\\\d\\\\d|\\\\d)\",\n    U: \"(.+)\",\n    W: \"(\\\\d\\\\d|\\\\d)\",\n    Y: \"(\\\\d{4})\",\n    Z: \"(.+)\",\n    d: \"(\\\\d\\\\d|\\\\d)\",\n    h: \"(\\\\d\\\\d|\\\\d)\",\n    i: \"(\\\\d\\\\d|\\\\d)\",\n    j: \"(\\\\d\\\\d|\\\\d)\",\n    l: \"\",\n    m: \"(\\\\d\\\\d|\\\\d)\",\n    n: \"(\\\\d\\\\d|\\\\d)\",\n    s: \"(\\\\d\\\\d|\\\\d)\",\n    u: \"(.+)\",\n    w: \"(\\\\d\\\\d|\\\\d)\",\n    y: \"(\\\\d{2})\",\n};\nexport var formats = {\n    Z: function (date) { return date.toISOString(); },\n    D: function (date, locale, options) {\n        return locale.weekdays.shorthand[formats.w(date, locale, options)];\n    },\n    F: function (date, locale, options) {\n        return monthToStr(formats.n(date, locale, options) - 1, false, locale);\n    },\n    G: function (date, locale, options) {\n        return pad(formats.h(date, locale, options));\n    },\n    H: function (date) { return pad(date.getHours()); },\n    J: function (date, locale) {\n        return locale.ordinal !== undefined\n            ? date.getDate() + locale.ordinal(date.getDate())\n            : date.getDate();\n    },\n    K: function (date, locale) { return locale.amPM[int(date.getHours() > 11)]; },\n    M: function (date, locale) {\n        return monthToStr(date.getMonth(), true, locale);\n    },\n    S: function (date) { return pad(date.getSeconds()); },\n    U: function (date) { return date.getTime() / 1000; },\n    W: function (date, _, options) {\n        return options.getWeek(date);\n    },\n    Y: function (date) { return pad(date.getFullYear(), 4); },\n    d: function (date) { return pad(date.getDate()); },\n    h: function (date) { return (date.getHours() % 12 ? date.getHours() % 12 : 12); },\n    i: function (date) { return pad(date.getMinutes()); },\n    j: function (date) { return date.getDate(); },\n    l: function (date, locale) {\n        return locale.weekdays.longhand[date.getDay()];\n    },\n    m: function (date) { return pad(date.getMonth() + 1); },\n    n: function (date) { return date.getMonth() + 1; },\n    s: function (date) { return date.getSeconds(); },\n    u: function (date) { return date.getTime(); },\n    w: function (date) { return date.getDay(); },\n    y: function (date) { return String(date.getFullYear()).substring(2); },\n};\n","import { tokenRegex, revFormat, formats, } from \"./formatting\";\nimport { defaults } from \"../types/options\";\nimport { english } from \"../l10n/default\";\nexport var createDateFormatter = function (_a) {\n    var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c, _d = _a.isMobile, isMobile = _d === void 0 ? false : _d;\n    return function (dateObj, frmt, overrideLocale) {\n        var locale = overrideLocale || l10n;\n        if (config.formatDate !== undefined && !isMobile) {\n            return config.formatDate(dateObj, frmt, locale);\n        }\n        return frmt\n            .split(\"\")\n            .map(function (c, i, arr) {\n            return formats[c] && arr[i - 1] !== \"\\\\\"\n                ? formats[c](dateObj, locale, config)\n                : c !== \"\\\\\"\n                    ? c\n                    : \"\";\n        })\n            .join(\"\");\n    };\n};\nexport var createDateParser = function (_a) {\n    var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c;\n    return function (date, givenFormat, timeless, customLocale) {\n        if (date !== 0 && !date)\n            return undefined;\n        var locale = customLocale || l10n;\n        var parsedDate;\n        var dateOrig = date;\n        if (date instanceof Date)\n            parsedDate = new Date(date.getTime());\n        else if (typeof date !== \"string\" &&\n            date.toFixed !== undefined)\n            parsedDate = new Date(date);\n        else if (typeof date === \"string\") {\n            var format = givenFormat || (config || defaults).dateFormat;\n            var datestr = String(date).trim();\n            if (datestr === \"today\") {\n                parsedDate = new Date();\n                timeless = true;\n            }\n            else if (config && config.parseDate) {\n                parsedDate = config.parseDate(date, format);\n            }\n            else if (/Z$/.test(datestr) ||\n                /GMT$/.test(datestr)) {\n                parsedDate = new Date(date);\n            }\n            else {\n                var matched = void 0, ops = [];\n                for (var i = 0, matchIndex = 0, regexStr = \"\"; i < format.length; i++) {\n                    var token = format[i];\n                    var isBackSlash = token === \"\\\\\";\n                    var escaped = format[i - 1] === \"\\\\\" || isBackSlash;\n                    if (tokenRegex[token] && !escaped) {\n                        regexStr += tokenRegex[token];\n                        var match = new RegExp(regexStr).exec(date);\n                        if (match && (matched = true)) {\n                            ops[token !== \"Y\" ? \"push\" : \"unshift\"]({\n                                fn: revFormat[token],\n                                val: match[++matchIndex],\n                            });\n                        }\n                    }\n                    else if (!isBackSlash)\n                        regexStr += \".\";\n                }\n                parsedDate =\n                    !config || !config.noCalendar\n                        ? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0)\n                        : new Date(new Date().setHours(0, 0, 0, 0));\n                ops.forEach(function (_a) {\n                    var fn = _a.fn, val = _a.val;\n                    return (parsedDate = fn(parsedDate, val, locale) || parsedDate);\n                });\n                parsedDate = matched ? parsedDate : undefined;\n            }\n        }\n        if (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {\n            config.errorHandler(new Error(\"Invalid date provided: \" + dateOrig));\n            return undefined;\n        }\n        if (timeless === true)\n            parsedDate.setHours(0, 0, 0, 0);\n        return parsedDate;\n    };\n};\nexport function compareDates(date1, date2, timeless) {\n    if (timeless === void 0) { timeless = true; }\n    if (timeless !== false) {\n        return (new Date(date1.getTime()).setHours(0, 0, 0, 0) -\n            new Date(date2.getTime()).setHours(0, 0, 0, 0));\n    }\n    return date1.getTime() - date2.getTime();\n}\nexport function compareTimes(date1, date2) {\n    return (3600 * (date1.getHours() - date2.getHours()) +\n        60 * (date1.getMinutes() - date2.getMinutes()) +\n        date1.getSeconds() -\n        date2.getSeconds());\n}\nexport var isBetween = function (ts, ts1, ts2) {\n    return ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);\n};\nexport var calculateSecondsSinceMidnight = function (hours, minutes, seconds) {\n    return hours * 3600 + minutes * 60 + seconds;\n};\nexport var parseSeconds = function (secondsSinceMidnight) {\n    var hours = Math.floor(secondsSinceMidnight / 3600), minutes = (secondsSinceMidnight - hours * 3600) / 60;\n    return [hours, minutes, secondsSinceMidnight - hours * 3600 - minutes * 60];\n};\nexport var duration = {\n    DAY: 86400000,\n};\nexport function getDefaultHours(config) {\n    var hours = config.defaultHour;\n    var minutes = config.defaultMinute;\n    var seconds = config.defaultSeconds;\n    if (config.minDate !== undefined) {\n        var minHour = config.minDate.getHours();\n        var minMinutes = config.minDate.getMinutes();\n        var minSeconds = config.minDate.getSeconds();\n        if (hours < minHour) {\n            hours = minHour;\n        }\n        if (hours === minHour && minutes < minMinutes) {\n            minutes = minMinutes;\n        }\n        if (hours === minHour && minutes === minMinutes && seconds < minSeconds)\n            seconds = config.minDate.getSeconds();\n    }\n    if (config.maxDate !== undefined) {\n        var maxHr = config.maxDate.getHours();\n        var maxMinutes = config.maxDate.getMinutes();\n        hours = Math.min(hours, maxHr);\n        if (hours === maxHr)\n            minutes = Math.min(maxMinutes, minutes);\n        if (hours === maxHr && minutes === maxMinutes)\n            seconds = config.maxDate.getSeconds();\n    }\n    return { hours: hours, minutes: minutes, seconds: seconds };\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { defaults as defaultOptions, HOOKS, } from \"./types/options\";\nimport English from \"./l10n/default\";\nimport { arrayify, debounce, int, pad } from \"./utils\";\nimport { clearNode, createElement, createNumberInput, findParent, toggleClass, getEventTarget, } from \"./utils/dom\";\nimport { compareDates, createDateParser, createDateFormatter, duration, isBetween, getDefaultHours, calculateSecondsSinceMidnight, parseSeconds, } from \"./utils/dates\";\nimport { tokenRegex, monthToStr } from \"./utils/formatting\";\nimport \"./utils/polyfills\";\nvar DEBOUNCED_CHANGE_MS = 300;\nfunction FlatpickrInstance(element, instanceConfig) {\n    var self = {\n        config: __assign(__assign({}, defaultOptions), flatpickr.defaultConfig),\n        l10n: English,\n    };\n    self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n    self._handlers = [];\n    self.pluginElements = [];\n    self.loadedPlugins = [];\n    self._bind = bind;\n    self._setHoursFromDate = setHoursFromDate;\n    self._positionCalendar = positionCalendar;\n    self.changeMonth = changeMonth;\n    self.changeYear = changeYear;\n    self.clear = clear;\n    self.close = close;\n    self.onMouseOver = onMouseOver;\n    self._createElement = createElement;\n    self.createDay = createDay;\n    self.destroy = destroy;\n    self.isEnabled = isEnabled;\n    self.jumpToDate = jumpToDate;\n    self.updateValue = updateValue;\n    self.open = open;\n    self.redraw = redraw;\n    self.set = set;\n    self.setDate = setDate;\n    self.toggle = toggle;\n    function setupHelperFunctions() {\n        self.utils = {\n            getDaysInMonth: function (month, yr) {\n                if (month === void 0) { month = self.currentMonth; }\n                if (yr === void 0) { yr = self.currentYear; }\n                if (month === 1 && ((yr % 4 === 0 && yr % 100 !== 0) || yr % 400 === 0))\n                    return 29;\n                return self.l10n.daysInMonth[month];\n            },\n        };\n    }\n    function init() {\n        self.element = self.input = element;\n        self.isOpen = false;\n        parseConfig();\n        setupLocale();\n        setupInputs();\n        setupDates();\n        setupHelperFunctions();\n        if (!self.isMobile)\n            build();\n        bindEvents();\n        if (self.selectedDates.length || self.config.noCalendar) {\n            if (self.config.enableTime) {\n                setHoursFromDate(self.config.noCalendar ? self.latestSelectedDateObj : undefined);\n            }\n            updateValue(false);\n        }\n        setCalendarWidth();\n        var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n        if (!self.isMobile && isSafari) {\n            positionCalendar();\n        }\n        triggerEvent(\"onReady\");\n    }\n    function getClosestActiveElement() {\n        var _a;\n        return (((_a = self.calendarContainer) === null || _a === void 0 ? void 0 : _a.getRootNode())\n            .activeElement || document.activeElement);\n    }\n    function bindToInstance(fn) {\n        return fn.bind(self);\n    }\n    function setCalendarWidth() {\n        var config = self.config;\n        if (config.weekNumbers === false && config.showMonths === 1) {\n            return;\n        }\n        else if (config.noCalendar !== true) {\n            window.requestAnimationFrame(function () {\n                if (self.calendarContainer !== undefined) {\n                    self.calendarContainer.style.visibility = \"hidden\";\n                    self.calendarContainer.style.display = \"block\";\n                }\n                if (self.daysContainer !== undefined) {\n                    var daysWidth = (self.days.offsetWidth + 1) * config.showMonths;\n                    self.daysContainer.style.width = daysWidth + \"px\";\n                    self.calendarContainer.style.width =\n                        daysWidth +\n                            (self.weekWrapper !== undefined\n                                ? self.weekWrapper.offsetWidth\n                                : 0) +\n                            \"px\";\n                    self.calendarContainer.style.removeProperty(\"visibility\");\n                    self.calendarContainer.style.removeProperty(\"display\");\n                }\n            });\n        }\n    }\n    function updateTime(e) {\n        if (self.selectedDates.length === 0) {\n            var defaultDate = self.config.minDate === undefined ||\n                compareDates(new Date(), self.config.minDate) >= 0\n                ? new Date()\n                : new Date(self.config.minDate.getTime());\n            var defaults = getDefaultHours(self.config);\n            defaultDate.setHours(defaults.hours, defaults.minutes, defaults.seconds, defaultDate.getMilliseconds());\n            self.selectedDates = [defaultDate];\n            self.latestSelectedDateObj = defaultDate;\n        }\n        if (e !== undefined && e.type !== \"blur\") {\n            timeWrapper(e);\n        }\n        var prevValue = self._input.value;\n        setHoursFromInputs();\n        updateValue();\n        if (self._input.value !== prevValue) {\n            self._debouncedChange();\n        }\n    }\n    function ampm2military(hour, amPM) {\n        return (hour % 12) + 12 * int(amPM === self.l10n.amPM[1]);\n    }\n    function military2ampm(hour) {\n        switch (hour % 24) {\n            case 0:\n            case 12:\n                return 12;\n            default:\n                return hour % 12;\n        }\n    }\n    function setHoursFromInputs() {\n        if (self.hourElement === undefined || self.minuteElement === undefined)\n            return;\n        var hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24, minutes = (parseInt(self.minuteElement.value, 10) || 0) % 60, seconds = self.secondElement !== undefined\n            ? (parseInt(self.secondElement.value, 10) || 0) % 60\n            : 0;\n        if (self.amPM !== undefined) {\n            hours = ampm2military(hours, self.amPM.textContent);\n        }\n        var limitMinHours = self.config.minTime !== undefined ||\n            (self.config.minDate &&\n                self.minDateHasTime &&\n                self.latestSelectedDateObj &&\n                compareDates(self.latestSelectedDateObj, self.config.minDate, true) ===\n                    0);\n        var limitMaxHours = self.config.maxTime !== undefined ||\n            (self.config.maxDate &&\n                self.maxDateHasTime &&\n                self.latestSelectedDateObj &&\n                compareDates(self.latestSelectedDateObj, self.config.maxDate, true) ===\n                    0);\n        if (self.config.maxTime !== undefined &&\n            self.config.minTime !== undefined &&\n            self.config.minTime > self.config.maxTime) {\n            var minBound = calculateSecondsSinceMidnight(self.config.minTime.getHours(), self.config.minTime.getMinutes(), self.config.minTime.getSeconds());\n            var maxBound = calculateSecondsSinceMidnight(self.config.maxTime.getHours(), self.config.maxTime.getMinutes(), self.config.maxTime.getSeconds());\n            var currentTime = calculateSecondsSinceMidnight(hours, minutes, seconds);\n            if (currentTime > maxBound && currentTime < minBound) {\n                var result = parseSeconds(minBound);\n                hours = result[0];\n                minutes = result[1];\n                seconds = result[2];\n            }\n        }\n        else {\n            if (limitMaxHours) {\n                var maxTime = self.config.maxTime !== undefined\n                    ? self.config.maxTime\n                    : self.config.maxDate;\n                hours = Math.min(hours, maxTime.getHours());\n                if (hours === maxTime.getHours())\n                    minutes = Math.min(minutes, maxTime.getMinutes());\n                if (minutes === maxTime.getMinutes())\n                    seconds = Math.min(seconds, maxTime.getSeconds());\n            }\n            if (limitMinHours) {\n                var minTime = self.config.minTime !== undefined\n                    ? self.config.minTime\n                    : self.config.minDate;\n                hours = Math.max(hours, minTime.getHours());\n                if (hours === minTime.getHours() && minutes < minTime.getMinutes())\n                    minutes = minTime.getMinutes();\n                if (minutes === minTime.getMinutes())\n                    seconds = Math.max(seconds, minTime.getSeconds());\n            }\n        }\n        setHours(hours, minutes, seconds);\n    }\n    function setHoursFromDate(dateObj) {\n        var date = dateObj || self.latestSelectedDateObj;\n        if (date && date instanceof Date) {\n            setHours(date.getHours(), date.getMinutes(), date.getSeconds());\n        }\n    }\n    function setHours(hours, minutes, seconds) {\n        if (self.latestSelectedDateObj !== undefined) {\n            self.latestSelectedDateObj.setHours(hours % 24, minutes, seconds || 0, 0);\n        }\n        if (!self.hourElement || !self.minuteElement || self.isMobile)\n            return;\n        self.hourElement.value = pad(!self.config.time_24hr\n            ? ((12 + hours) % 12) + 12 * int(hours % 12 === 0)\n            : hours);\n        self.minuteElement.value = pad(minutes);\n        if (self.amPM !== undefined)\n            self.amPM.textContent = self.l10n.amPM[int(hours >= 12)];\n        if (self.secondElement !== undefined)\n            self.secondElement.value = pad(seconds);\n    }\n    function onYearInput(event) {\n        var eventTarget = getEventTarget(event);\n        var year = parseInt(eventTarget.value) + (event.delta || 0);\n        if (year / 1000 > 1 ||\n            (event.key === \"Enter\" && !/[^\\d]/.test(year.toString()))) {\n            changeYear(year);\n        }\n    }\n    function bind(element, event, handler, options) {\n        if (event instanceof Array)\n            return event.forEach(function (ev) { return bind(element, ev, handler, options); });\n        if (element instanceof Array)\n            return element.forEach(function (el) { return bind(el, event, handler, options); });\n        element.addEventListener(event, handler, options);\n        self._handlers.push({\n            remove: function () { return element.removeEventListener(event, handler, options); },\n        });\n    }\n    function triggerChange() {\n        triggerEvent(\"onChange\");\n    }\n    function bindEvents() {\n        if (self.config.wrap) {\n            [\"open\", \"close\", \"toggle\", \"clear\"].forEach(function (evt) {\n                Array.prototype.forEach.call(self.element.querySelectorAll(\"[data-\" + evt + \"]\"), function (el) {\n                    return bind(el, \"click\", self[evt]);\n                });\n            });\n        }\n        if (self.isMobile) {\n            setupMobile();\n            return;\n        }\n        var debouncedResize = debounce(onResize, 50);\n        self._debouncedChange = debounce(triggerChange, DEBOUNCED_CHANGE_MS);\n        if (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))\n            bind(self.daysContainer, \"mouseover\", function (e) {\n                if (self.config.mode === \"range\")\n                    onMouseOver(getEventTarget(e));\n            });\n        bind(self._input, \"keydown\", onKeyDown);\n        if (self.calendarContainer !== undefined) {\n            bind(self.calendarContainer, \"keydown\", onKeyDown);\n        }\n        if (!self.config.inline && !self.config.static)\n            bind(window, \"resize\", debouncedResize);\n        if (window.ontouchstart !== undefined)\n            bind(window.document, \"touchstart\", documentClick);\n        else\n            bind(window.document, \"mousedown\", documentClick);\n        bind(window.document, \"focus\", documentClick, { capture: true });\n        if (self.config.clickOpens === true) {\n            bind(self._input, \"focus\", self.open);\n            bind(self._input, \"click\", self.open);\n        }\n        if (self.daysContainer !== undefined) {\n            bind(self.monthNav, \"click\", onMonthNavClick);\n            bind(self.monthNav, [\"keyup\", \"increment\"], onYearInput);\n            bind(self.daysContainer, \"click\", selectDate);\n        }\n        if (self.timeContainer !== undefined &&\n            self.minuteElement !== undefined &&\n            self.hourElement !== undefined) {\n            var selText = function (e) {\n                return getEventTarget(e).select();\n            };\n            bind(self.timeContainer, [\"increment\"], updateTime);\n            bind(self.timeContainer, \"blur\", updateTime, { capture: true });\n            bind(self.timeContainer, \"click\", timeIncrement);\n            bind([self.hourElement, self.minuteElement], [\"focus\", \"click\"], selText);\n            if (self.secondElement !== undefined)\n                bind(self.secondElement, \"focus\", function () { return self.secondElement && self.secondElement.select(); });\n            if (self.amPM !== undefined) {\n                bind(self.amPM, \"click\", function (e) {\n                    updateTime(e);\n                });\n            }\n        }\n        if (self.config.allowInput) {\n            bind(self._input, \"blur\", onBlur);\n        }\n    }\n    function jumpToDate(jumpDate, triggerChange) {\n        var jumpTo = jumpDate !== undefined\n            ? self.parseDate(jumpDate)\n            : self.latestSelectedDateObj ||\n                (self.config.minDate && self.config.minDate > self.now\n                    ? self.config.minDate\n                    : self.config.maxDate && self.config.maxDate < self.now\n                        ? self.config.maxDate\n                        : self.now);\n        var oldYear = self.currentYear;\n        var oldMonth = self.currentMonth;\n        try {\n            if (jumpTo !== undefined) {\n                self.currentYear = jumpTo.getFullYear();\n                self.currentMonth = jumpTo.getMonth();\n            }\n        }\n        catch (e) {\n            e.message = \"Invalid date supplied: \" + jumpTo;\n            self.config.errorHandler(e);\n        }\n        if (triggerChange && self.currentYear !== oldYear) {\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n        if (triggerChange &&\n            (self.currentYear !== oldYear || self.currentMonth !== oldMonth)) {\n            triggerEvent(\"onMonthChange\");\n        }\n        self.redraw();\n    }\n    function timeIncrement(e) {\n        var eventTarget = getEventTarget(e);\n        if (~eventTarget.className.indexOf(\"arrow\"))\n            incrementNumInput(e, eventTarget.classList.contains(\"arrowUp\") ? 1 : -1);\n    }\n    function incrementNumInput(e, delta, inputElem) {\n        var target = e && getEventTarget(e);\n        var input = inputElem ||\n            (target && target.parentNode && target.parentNode.firstChild);\n        var event = createEvent(\"increment\");\n        event.delta = delta;\n        input && input.dispatchEvent(event);\n    }\n    function build() {\n        var fragment = window.document.createDocumentFragment();\n        self.calendarContainer = createElement(\"div\", \"flatpickr-calendar\");\n        self.calendarContainer.tabIndex = -1;\n        if (!self.config.noCalendar) {\n            fragment.appendChild(buildMonthNav());\n            self.innerContainer = createElement(\"div\", \"flatpickr-innerContainer\");\n            if (self.config.weekNumbers) {\n                var _a = buildWeeks(), weekWrapper = _a.weekWrapper, weekNumbers = _a.weekNumbers;\n                self.innerContainer.appendChild(weekWrapper);\n                self.weekNumbers = weekNumbers;\n                self.weekWrapper = weekWrapper;\n            }\n            self.rContainer = createElement(\"div\", \"flatpickr-rContainer\");\n            self.rContainer.appendChild(buildWeekdays());\n            if (!self.daysContainer) {\n                self.daysContainer = createElement(\"div\", \"flatpickr-days\");\n                self.daysContainer.tabIndex = -1;\n            }\n            buildDays();\n            self.rContainer.appendChild(self.daysContainer);\n            self.innerContainer.appendChild(self.rContainer);\n            fragment.appendChild(self.innerContainer);\n        }\n        if (self.config.enableTime) {\n            fragment.appendChild(buildTime());\n        }\n        toggleClass(self.calendarContainer, \"rangeMode\", self.config.mode === \"range\");\n        toggleClass(self.calendarContainer, \"animate\", self.config.animate === true);\n        toggleClass(self.calendarContainer, \"multiMonth\", self.config.showMonths > 1);\n        self.calendarContainer.appendChild(fragment);\n        var customAppend = self.config.appendTo !== undefined &&\n            self.config.appendTo.nodeType !== undefined;\n        if (self.config.inline || self.config.static) {\n            self.calendarContainer.classList.add(self.config.inline ? \"inline\" : \"static\");\n            if (self.config.inline) {\n                if (!customAppend && self.element.parentNode)\n                    self.element.parentNode.insertBefore(self.calendarContainer, self._input.nextSibling);\n                else if (self.config.appendTo !== undefined)\n                    self.config.appendTo.appendChild(self.calendarContainer);\n            }\n            if (self.config.static) {\n                var wrapper = createElement(\"div\", \"flatpickr-wrapper\");\n                if (self.element.parentNode)\n                    self.element.parentNode.insertBefore(wrapper, self.element);\n                wrapper.appendChild(self.element);\n                if (self.altInput)\n                    wrapper.appendChild(self.altInput);\n                wrapper.appendChild(self.calendarContainer);\n            }\n        }\n        if (!self.config.static && !self.config.inline)\n            (self.config.appendTo !== undefined\n                ? self.config.appendTo\n                : window.document.body).appendChild(self.calendarContainer);\n    }\n    function createDay(className, date, _dayNumber, i) {\n        var dateIsEnabled = isEnabled(date, true), dayElement = createElement(\"span\", className, date.getDate().toString());\n        dayElement.dateObj = date;\n        dayElement.$i = i;\n        dayElement.setAttribute(\"aria-label\", self.formatDate(date, self.config.ariaDateFormat));\n        if (className.indexOf(\"hidden\") === -1 &&\n            compareDates(date, self.now) === 0) {\n            self.todayDateElem = dayElement;\n            dayElement.classList.add(\"today\");\n            dayElement.setAttribute(\"aria-current\", \"date\");\n        }\n        if (dateIsEnabled) {\n            dayElement.tabIndex = -1;\n            if (isDateSelected(date)) {\n                dayElement.classList.add(\"selected\");\n                self.selectedDateElem = dayElement;\n                if (self.config.mode === \"range\") {\n                    toggleClass(dayElement, \"startRange\", self.selectedDates[0] &&\n                        compareDates(date, self.selectedDates[0], true) === 0);\n                    toggleClass(dayElement, \"endRange\", self.selectedDates[1] &&\n                        compareDates(date, self.selectedDates[1], true) === 0);\n                    if (className === \"nextMonthDay\")\n                        dayElement.classList.add(\"inRange\");\n                }\n            }\n        }\n        else {\n            dayElement.classList.add(\"flatpickr-disabled\");\n        }\n        if (self.config.mode === \"range\") {\n            if (isDateInRange(date) && !isDateSelected(date))\n                dayElement.classList.add(\"inRange\");\n        }\n        if (self.weekNumbers &&\n            self.config.showMonths === 1 &&\n            className !== \"prevMonthDay\" &&\n            i % 7 === 6) {\n            self.weekNumbers.insertAdjacentHTML(\"beforeend\", \"<span class='flatpickr-day'>\" + self.config.getWeek(date) + \"</span>\");\n        }\n        triggerEvent(\"onDayCreate\", dayElement);\n        return dayElement;\n    }\n    function focusOnDayElem(targetNode) {\n        targetNode.focus();\n        if (self.config.mode === \"range\")\n            onMouseOver(targetNode);\n    }\n    function getFirstAvailableDay(delta) {\n        var startMonth = delta > 0 ? 0 : self.config.showMonths - 1;\n        var endMonth = delta > 0 ? self.config.showMonths : -1;\n        for (var m = startMonth; m != endMonth; m += delta) {\n            var month = self.daysContainer.children[m];\n            var startIndex = delta > 0 ? 0 : month.children.length - 1;\n            var endIndex = delta > 0 ? month.children.length : -1;\n            for (var i = startIndex; i != endIndex; i += delta) {\n                var c = month.children[i];\n                if (c.className.indexOf(\"hidden\") === -1 && isEnabled(c.dateObj))\n                    return c;\n            }\n        }\n        return undefined;\n    }\n    function getNextAvailableDay(current, delta) {\n        var givenMonth = current.className.indexOf(\"Month\") === -1\n            ? current.dateObj.getMonth()\n            : self.currentMonth;\n        var endMonth = delta > 0 ? self.config.showMonths : -1;\n        var loopDelta = delta > 0 ? 1 : -1;\n        for (var m = givenMonth - self.currentMonth; m != endMonth; m += loopDelta) {\n            var month = self.daysContainer.children[m];\n            var startIndex = givenMonth - self.currentMonth === m\n                ? current.$i + delta\n                : delta < 0\n                    ? month.children.length - 1\n                    : 0;\n            var numMonthDays = month.children.length;\n            for (var i = startIndex; i >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1); i += loopDelta) {\n                var c = month.children[i];\n                if (c.className.indexOf(\"hidden\") === -1 &&\n                    isEnabled(c.dateObj) &&\n                    Math.abs(current.$i - i) >= Math.abs(delta))\n                    return focusOnDayElem(c);\n            }\n        }\n        self.changeMonth(loopDelta);\n        focusOnDay(getFirstAvailableDay(loopDelta), 0);\n        return undefined;\n    }\n    function focusOnDay(current, offset) {\n        var activeElement = getClosestActiveElement();\n        var dayFocused = isInView(activeElement || document.body);\n        var startElem = current !== undefined\n            ? current\n            : dayFocused\n                ? activeElement\n                : self.selectedDateElem !== undefined && isInView(self.selectedDateElem)\n                    ? self.selectedDateElem\n                    : self.todayDateElem !== undefined && isInView(self.todayDateElem)\n                        ? self.todayDateElem\n                        : getFirstAvailableDay(offset > 0 ? 1 : -1);\n        if (startElem === undefined) {\n            self._input.focus();\n        }\n        else if (!dayFocused) {\n            focusOnDayElem(startElem);\n        }\n        else {\n            getNextAvailableDay(startElem, offset);\n        }\n    }\n    function buildMonthDays(year, month) {\n        var firstOfMonth = (new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;\n        var prevMonthDays = self.utils.getDaysInMonth((month - 1 + 12) % 12, year);\n        var daysInMonth = self.utils.getDaysInMonth(month, year), days = window.document.createDocumentFragment(), isMultiMonth = self.config.showMonths > 1, prevMonthDayClass = isMultiMonth ? \"prevMonthDay hidden\" : \"prevMonthDay\", nextMonthDayClass = isMultiMonth ? \"nextMonthDay hidden\" : \"nextMonthDay\";\n        var dayNumber = prevMonthDays + 1 - firstOfMonth, dayIndex = 0;\n        for (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {\n            days.appendChild(createDay(\"flatpickr-day \" + prevMonthDayClass, new Date(year, month - 1, dayNumber), dayNumber, dayIndex));\n        }\n        for (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {\n            days.appendChild(createDay(\"flatpickr-day\", new Date(year, month, dayNumber), dayNumber, dayIndex));\n        }\n        for (var dayNum = daysInMonth + 1; dayNum <= 42 - firstOfMonth &&\n            (self.config.showMonths === 1 || dayIndex % 7 !== 0); dayNum++, dayIndex++) {\n            days.appendChild(createDay(\"flatpickr-day \" + nextMonthDayClass, new Date(year, month + 1, dayNum % daysInMonth), dayNum, dayIndex));\n        }\n        var dayContainer = createElement(\"div\", \"dayContainer\");\n        dayContainer.appendChild(days);\n        return dayContainer;\n    }\n    function buildDays() {\n        if (self.daysContainer === undefined) {\n            return;\n        }\n        clearNode(self.daysContainer);\n        if (self.weekNumbers)\n            clearNode(self.weekNumbers);\n        var frag = document.createDocumentFragment();\n        for (var i = 0; i < self.config.showMonths; i++) {\n            var d = new Date(self.currentYear, self.currentMonth, 1);\n            d.setMonth(self.currentMonth + i);\n            frag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));\n        }\n        self.daysContainer.appendChild(frag);\n        self.days = self.daysContainer.firstChild;\n        if (self.config.mode === \"range\" && self.selectedDates.length === 1) {\n            onMouseOver();\n        }\n    }\n    function buildMonthSwitch() {\n        if (self.config.showMonths > 1 ||\n            self.config.monthSelectorType !== \"dropdown\")\n            return;\n        var shouldBuildMonth = function (month) {\n            if (self.config.minDate !== undefined &&\n                self.currentYear === self.config.minDate.getFullYear() &&\n                month < self.config.minDate.getMonth()) {\n                return false;\n            }\n            return !(self.config.maxDate !== undefined &&\n                self.currentYear === self.config.maxDate.getFullYear() &&\n                month > self.config.maxDate.getMonth());\n        };\n        self.monthsDropdownContainer.tabIndex = -1;\n        self.monthsDropdownContainer.innerHTML = \"\";\n        for (var i = 0; i < 12; i++) {\n            if (!shouldBuildMonth(i))\n                continue;\n            var month = createElement(\"option\", \"flatpickr-monthDropdown-month\");\n            month.value = new Date(self.currentYear, i).getMonth().toString();\n            month.textContent = monthToStr(i, self.config.shorthandCurrentMonth, self.l10n);\n            month.tabIndex = -1;\n            if (self.currentMonth === i) {\n                month.selected = true;\n            }\n            self.monthsDropdownContainer.appendChild(month);\n        }\n    }\n    function buildMonth() {\n        var container = createElement(\"div\", \"flatpickr-month\");\n        var monthNavFragment = window.document.createDocumentFragment();\n        var monthElement;\n        if (self.config.showMonths > 1 ||\n            self.config.monthSelectorType === \"static\") {\n            monthElement = createElement(\"span\", \"cur-month\");\n        }\n        else {\n            self.monthsDropdownContainer = createElement(\"select\", \"flatpickr-monthDropdown-months\");\n            self.monthsDropdownContainer.setAttribute(\"aria-label\", self.l10n.monthAriaLabel);\n            bind(self.monthsDropdownContainer, \"change\", function (e) {\n                var target = getEventTarget(e);\n                var selectedMonth = parseInt(target.value, 10);\n                self.changeMonth(selectedMonth - self.currentMonth);\n                triggerEvent(\"onMonthChange\");\n            });\n            buildMonthSwitch();\n            monthElement = self.monthsDropdownContainer;\n        }\n        var yearInput = createNumberInput(\"cur-year\", { tabindex: \"-1\" });\n        var yearElement = yearInput.getElementsByTagName(\"input\")[0];\n        yearElement.setAttribute(\"aria-label\", self.l10n.yearAriaLabel);\n        if (self.config.minDate) {\n            yearElement.setAttribute(\"min\", self.config.minDate.getFullYear().toString());\n        }\n        if (self.config.maxDate) {\n            yearElement.setAttribute(\"max\", self.config.maxDate.getFullYear().toString());\n            yearElement.disabled =\n                !!self.config.minDate &&\n                    self.config.minDate.getFullYear() === self.config.maxDate.getFullYear();\n        }\n        var currentMonth = createElement(\"div\", \"flatpickr-current-month\");\n        currentMonth.appendChild(monthElement);\n        currentMonth.appendChild(yearInput);\n        monthNavFragment.appendChild(currentMonth);\n        container.appendChild(monthNavFragment);\n        return {\n            container: container,\n            yearElement: yearElement,\n            monthElement: monthElement,\n        };\n    }\n    function buildMonths() {\n        clearNode(self.monthNav);\n        self.monthNav.appendChild(self.prevMonthNav);\n        if (self.config.showMonths) {\n            self.yearElements = [];\n            self.monthElements = [];\n        }\n        for (var m = self.config.showMonths; m--;) {\n            var month = buildMonth();\n            self.yearElements.push(month.yearElement);\n            self.monthElements.push(month.monthElement);\n            self.monthNav.appendChild(month.container);\n        }\n        self.monthNav.appendChild(self.nextMonthNav);\n    }\n    function buildMonthNav() {\n        self.monthNav = createElement(\"div\", \"flatpickr-months\");\n        self.yearElements = [];\n        self.monthElements = [];\n        self.prevMonthNav = createElement(\"span\", \"flatpickr-prev-month\");\n        self.prevMonthNav.innerHTML = self.config.prevArrow;\n        self.nextMonthNav = createElement(\"span\", \"flatpickr-next-month\");\n        self.nextMonthNav.innerHTML = self.config.nextArrow;\n        buildMonths();\n        Object.defineProperty(self, \"_hidePrevMonthArrow\", {\n            get: function () { return self.__hidePrevMonthArrow; },\n            set: function (bool) {\n                if (self.__hidePrevMonthArrow !== bool) {\n                    toggleClass(self.prevMonthNav, \"flatpickr-disabled\", bool);\n                    self.__hidePrevMonthArrow = bool;\n                }\n            },\n        });\n        Object.defineProperty(self, \"_hideNextMonthArrow\", {\n            get: function () { return self.__hideNextMonthArrow; },\n            set: function (bool) {\n                if (self.__hideNextMonthArrow !== bool) {\n                    toggleClass(self.nextMonthNav, \"flatpickr-disabled\", bool);\n                    self.__hideNextMonthArrow = bool;\n                }\n            },\n        });\n        self.currentYearElement = self.yearElements[0];\n        updateNavigationCurrentMonth();\n        return self.monthNav;\n    }\n    function buildTime() {\n        self.calendarContainer.classList.add(\"hasTime\");\n        if (self.config.noCalendar)\n            self.calendarContainer.classList.add(\"noCalendar\");\n        var defaults = getDefaultHours(self.config);\n        self.timeContainer = createElement(\"div\", \"flatpickr-time\");\n        self.timeContainer.tabIndex = -1;\n        var separator = createElement(\"span\", \"flatpickr-time-separator\", \":\");\n        var hourInput = createNumberInput(\"flatpickr-hour\", {\n            \"aria-label\": self.l10n.hourAriaLabel,\n        });\n        self.hourElement = hourInput.getElementsByTagName(\"input\")[0];\n        var minuteInput = createNumberInput(\"flatpickr-minute\", {\n            \"aria-label\": self.l10n.minuteAriaLabel,\n        });\n        self.minuteElement = minuteInput.getElementsByTagName(\"input\")[0];\n        self.hourElement.tabIndex = self.minuteElement.tabIndex = -1;\n        self.hourElement.value = pad(self.latestSelectedDateObj\n            ? self.latestSelectedDateObj.getHours()\n            : self.config.time_24hr\n                ? defaults.hours\n                : military2ampm(defaults.hours));\n        self.minuteElement.value = pad(self.latestSelectedDateObj\n            ? self.latestSelectedDateObj.getMinutes()\n            : defaults.minutes);\n        self.hourElement.setAttribute(\"step\", self.config.hourIncrement.toString());\n        self.minuteElement.setAttribute(\"step\", self.config.minuteIncrement.toString());\n        self.hourElement.setAttribute(\"min\", self.config.time_24hr ? \"0\" : \"1\");\n        self.hourElement.setAttribute(\"max\", self.config.time_24hr ? \"23\" : \"12\");\n        self.hourElement.setAttribute(\"maxlength\", \"2\");\n        self.minuteElement.setAttribute(\"min\", \"0\");\n        self.minuteElement.setAttribute(\"max\", \"59\");\n        self.minuteElement.setAttribute(\"maxlength\", \"2\");\n        self.timeContainer.appendChild(hourInput);\n        self.timeContainer.appendChild(separator);\n        self.timeContainer.appendChild(minuteInput);\n        if (self.config.time_24hr)\n            self.timeContainer.classList.add(\"time24hr\");\n        if (self.config.enableSeconds) {\n            self.timeContainer.classList.add(\"hasSeconds\");\n            var secondInput = createNumberInput(\"flatpickr-second\");\n            self.secondElement = secondInput.getElementsByTagName(\"input\")[0];\n            self.secondElement.value = pad(self.latestSelectedDateObj\n                ? self.latestSelectedDateObj.getSeconds()\n                : defaults.seconds);\n            self.secondElement.setAttribute(\"step\", self.minuteElement.getAttribute(\"step\"));\n            self.secondElement.setAttribute(\"min\", \"0\");\n            self.secondElement.setAttribute(\"max\", \"59\");\n            self.secondElement.setAttribute(\"maxlength\", \"2\");\n            self.timeContainer.appendChild(createElement(\"span\", \"flatpickr-time-separator\", \":\"));\n            self.timeContainer.appendChild(secondInput);\n        }\n        if (!self.config.time_24hr) {\n            self.amPM = createElement(\"span\", \"flatpickr-am-pm\", self.l10n.amPM[int((self.latestSelectedDateObj\n                ? self.hourElement.value\n                : self.config.defaultHour) > 11)]);\n            self.amPM.title = self.l10n.toggleTitle;\n            self.amPM.tabIndex = -1;\n            self.timeContainer.appendChild(self.amPM);\n        }\n        return self.timeContainer;\n    }\n    function buildWeekdays() {\n        if (!self.weekdayContainer)\n            self.weekdayContainer = createElement(\"div\", \"flatpickr-weekdays\");\n        else\n            clearNode(self.weekdayContainer);\n        for (var i = self.config.showMonths; i--;) {\n            var container = createElement(\"div\", \"flatpickr-weekdaycontainer\");\n            self.weekdayContainer.appendChild(container);\n        }\n        updateWeekdays();\n        return self.weekdayContainer;\n    }\n    function updateWeekdays() {\n        if (!self.weekdayContainer) {\n            return;\n        }\n        var firstDayOfWeek = self.l10n.firstDayOfWeek;\n        var weekdays = __spreadArrays(self.l10n.weekdays.shorthand);\n        if (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {\n            weekdays = __spreadArrays(weekdays.splice(firstDayOfWeek, weekdays.length), weekdays.splice(0, firstDayOfWeek));\n        }\n        for (var i = self.config.showMonths; i--;) {\n            self.weekdayContainer.children[i].innerHTML = \"\\n      <span class='flatpickr-weekday'>\\n        \" + weekdays.join(\"</span><span class='flatpickr-weekday'>\") + \"\\n      </span>\\n      \";\n        }\n    }\n    function buildWeeks() {\n        self.calendarContainer.classList.add(\"hasWeeks\");\n        var weekWrapper = createElement(\"div\", \"flatpickr-weekwrapper\");\n        weekWrapper.appendChild(createElement(\"span\", \"flatpickr-weekday\", self.l10n.weekAbbreviation));\n        var weekNumbers = createElement(\"div\", \"flatpickr-weeks\");\n        weekWrapper.appendChild(weekNumbers);\n        return {\n            weekWrapper: weekWrapper,\n            weekNumbers: weekNumbers,\n        };\n    }\n    function changeMonth(value, isOffset) {\n        if (isOffset === void 0) { isOffset = true; }\n        var delta = isOffset ? value : value - self.currentMonth;\n        if ((delta < 0 && self._hidePrevMonthArrow === true) ||\n            (delta > 0 && self._hideNextMonthArrow === true))\n            return;\n        self.currentMonth += delta;\n        if (self.currentMonth < 0 || self.currentMonth > 11) {\n            self.currentYear += self.currentMonth > 11 ? 1 : -1;\n            self.currentMonth = (self.currentMonth + 12) % 12;\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n        buildDays();\n        triggerEvent(\"onMonthChange\");\n        updateNavigationCurrentMonth();\n    }\n    function clear(triggerChangeEvent, toInitial) {\n        if (triggerChangeEvent === void 0) { triggerChangeEvent = true; }\n        if (toInitial === void 0) { toInitial = true; }\n        self.input.value = \"\";\n        if (self.altInput !== undefined)\n            self.altInput.value = \"\";\n        if (self.mobileInput !== undefined)\n            self.mobileInput.value = \"\";\n        self.selectedDates = [];\n        self.latestSelectedDateObj = undefined;\n        if (toInitial === true) {\n            self.currentYear = self._initialDate.getFullYear();\n            self.currentMonth = self._initialDate.getMonth();\n        }\n        if (self.config.enableTime === true) {\n            var _a = getDefaultHours(self.config), hours = _a.hours, minutes = _a.minutes, seconds = _a.seconds;\n            setHours(hours, minutes, seconds);\n        }\n        self.redraw();\n        if (triggerChangeEvent)\n            triggerEvent(\"onChange\");\n    }\n    function close() {\n        self.isOpen = false;\n        if (!self.isMobile) {\n            if (self.calendarContainer !== undefined) {\n                self.calendarContainer.classList.remove(\"open\");\n            }\n            if (self._input !== undefined) {\n                self._input.classList.remove(\"active\");\n            }\n        }\n        triggerEvent(\"onClose\");\n    }\n    function destroy() {\n        if (self.config !== undefined)\n            triggerEvent(\"onDestroy\");\n        for (var i = self._handlers.length; i--;) {\n            self._handlers[i].remove();\n        }\n        self._handlers = [];\n        if (self.mobileInput) {\n            if (self.mobileInput.parentNode)\n                self.mobileInput.parentNode.removeChild(self.mobileInput);\n            self.mobileInput = undefined;\n        }\n        else if (self.calendarContainer && self.calendarContainer.parentNode) {\n            if (self.config.static && self.calendarContainer.parentNode) {\n                var wrapper = self.calendarContainer.parentNode;\n                wrapper.lastChild && wrapper.removeChild(wrapper.lastChild);\n                if (wrapper.parentNode) {\n                    while (wrapper.firstChild)\n                        wrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);\n                    wrapper.parentNode.removeChild(wrapper);\n                }\n            }\n            else\n                self.calendarContainer.parentNode.removeChild(self.calendarContainer);\n        }\n        if (self.altInput) {\n            self.input.type = \"text\";\n            if (self.altInput.parentNode)\n                self.altInput.parentNode.removeChild(self.altInput);\n            delete self.altInput;\n        }\n        if (self.input) {\n            self.input.type = self.input._type;\n            self.input.classList.remove(\"flatpickr-input\");\n            self.input.removeAttribute(\"readonly\");\n        }\n        [\n            \"_showTimeInput\",\n            \"latestSelectedDateObj\",\n            \"_hideNextMonthArrow\",\n            \"_hidePrevMonthArrow\",\n            \"__hideNextMonthArrow\",\n            \"__hidePrevMonthArrow\",\n            \"isMobile\",\n            \"isOpen\",\n            \"selectedDateElem\",\n            \"minDateHasTime\",\n            \"maxDateHasTime\",\n            \"days\",\n            \"daysContainer\",\n            \"_input\",\n            \"_positionElement\",\n            \"innerContainer\",\n            \"rContainer\",\n            \"monthNav\",\n            \"todayDateElem\",\n            \"calendarContainer\",\n            \"weekdayContainer\",\n            \"prevMonthNav\",\n            \"nextMonthNav\",\n            \"monthsDropdownContainer\",\n            \"currentMonthElement\",\n            \"currentYearElement\",\n            \"navigationCurrentMonth\",\n            \"selectedDateElem\",\n            \"config\",\n        ].forEach(function (k) {\n            try {\n                delete self[k];\n            }\n            catch (_) { }\n        });\n    }\n    function isCalendarElem(elem) {\n        return self.calendarContainer.contains(elem);\n    }\n    function documentClick(e) {\n        if (self.isOpen && !self.config.inline) {\n            var eventTarget_1 = getEventTarget(e);\n            var isCalendarElement = isCalendarElem(eventTarget_1);\n            var isInput = eventTarget_1 === self.input ||\n                eventTarget_1 === self.altInput ||\n                self.element.contains(eventTarget_1) ||\n                (e.path &&\n                    e.path.indexOf &&\n                    (~e.path.indexOf(self.input) ||\n                        ~e.path.indexOf(self.altInput)));\n            var lostFocus = !isInput &&\n                !isCalendarElement &&\n                !isCalendarElem(e.relatedTarget);\n            var isIgnored = !self.config.ignoredFocusElements.some(function (elem) {\n                return elem.contains(eventTarget_1);\n            });\n            if (lostFocus && isIgnored) {\n                if (self.config.allowInput) {\n                    self.setDate(self._input.value, false, self.config.altInput\n                        ? self.config.altFormat\n                        : self.config.dateFormat);\n                }\n                if (self.timeContainer !== undefined &&\n                    self.minuteElement !== undefined &&\n                    self.hourElement !== undefined &&\n                    self.input.value !== \"\" &&\n                    self.input.value !== undefined) {\n                    updateTime();\n                }\n                self.close();\n                if (self.config &&\n                    self.config.mode === \"range\" &&\n                    self.selectedDates.length === 1)\n                    self.clear(false);\n            }\n        }\n    }\n    function changeYear(newYear) {\n        if (!newYear ||\n            (self.config.minDate && newYear < self.config.minDate.getFullYear()) ||\n            (self.config.maxDate && newYear > self.config.maxDate.getFullYear()))\n            return;\n        var newYearNum = newYear, isNewYear = self.currentYear !== newYearNum;\n        self.currentYear = newYearNum || self.currentYear;\n        if (self.config.maxDate &&\n            self.currentYear === self.config.maxDate.getFullYear()) {\n            self.currentMonth = Math.min(self.config.maxDate.getMonth(), self.currentMonth);\n        }\n        else if (self.config.minDate &&\n            self.currentYear === self.config.minDate.getFullYear()) {\n            self.currentMonth = Math.max(self.config.minDate.getMonth(), self.currentMonth);\n        }\n        if (isNewYear) {\n            self.redraw();\n            triggerEvent(\"onYearChange\");\n            buildMonthSwitch();\n        }\n    }\n    function isEnabled(date, timeless) {\n        var _a;\n        if (timeless === void 0) { timeless = true; }\n        var dateToCheck = self.parseDate(date, undefined, timeless);\n        if ((self.config.minDate &&\n            dateToCheck &&\n            compareDates(dateToCheck, self.config.minDate, timeless !== undefined ? timeless : !self.minDateHasTime) < 0) ||\n            (self.config.maxDate &&\n                dateToCheck &&\n                compareDates(dateToCheck, self.config.maxDate, timeless !== undefined ? timeless : !self.maxDateHasTime) > 0))\n            return false;\n        if (!self.config.enable && self.config.disable.length === 0)\n            return true;\n        if (dateToCheck === undefined)\n            return false;\n        var bool = !!self.config.enable, array = (_a = self.config.enable) !== null && _a !== void 0 ? _a : self.config.disable;\n        for (var i = 0, d = void 0; i < array.length; i++) {\n            d = array[i];\n            if (typeof d === \"function\" &&\n                d(dateToCheck))\n                return bool;\n            else if (d instanceof Date &&\n                dateToCheck !== undefined &&\n                d.getTime() === dateToCheck.getTime())\n                return bool;\n            else if (typeof d === \"string\") {\n                var parsed = self.parseDate(d, undefined, true);\n                return parsed && parsed.getTime() === dateToCheck.getTime()\n                    ? bool\n                    : !bool;\n            }\n            else if (typeof d === \"object\" &&\n                dateToCheck !== undefined &&\n                d.from &&\n                d.to &&\n                dateToCheck.getTime() >= d.from.getTime() &&\n                dateToCheck.getTime() <= d.to.getTime())\n                return bool;\n        }\n        return !bool;\n    }\n    function isInView(elem) {\n        if (self.daysContainer !== undefined)\n            return (elem.className.indexOf(\"hidden\") === -1 &&\n                elem.className.indexOf(\"flatpickr-disabled\") === -1 &&\n                self.daysContainer.contains(elem));\n        return false;\n    }\n    function onBlur(e) {\n        var isInput = e.target === self._input;\n        var valueChanged = self._input.value.trimEnd() !== getDateStr();\n        if (isInput &&\n            valueChanged &&\n            !(e.relatedTarget && isCalendarElem(e.relatedTarget))) {\n            self.setDate(self._input.value, true, e.target === self.altInput\n                ? self.config.altFormat\n                : self.config.dateFormat);\n        }\n    }\n    function onKeyDown(e) {\n        var eventTarget = getEventTarget(e);\n        var isInput = self.config.wrap\n            ? element.contains(eventTarget)\n            : eventTarget === self._input;\n        var allowInput = self.config.allowInput;\n        var allowKeydown = self.isOpen && (!allowInput || !isInput);\n        var allowInlineKeydown = self.config.inline && isInput && !allowInput;\n        if (e.keyCode === 13 && isInput) {\n            if (allowInput) {\n                self.setDate(self._input.value, true, eventTarget === self.altInput\n                    ? self.config.altFormat\n                    : self.config.dateFormat);\n                self.close();\n                return eventTarget.blur();\n            }\n            else {\n                self.open();\n            }\n        }\n        else if (isCalendarElem(eventTarget) ||\n            allowKeydown ||\n            allowInlineKeydown) {\n            var isTimeObj = !!self.timeContainer &&\n                self.timeContainer.contains(eventTarget);\n            switch (e.keyCode) {\n                case 13:\n                    if (isTimeObj) {\n                        e.preventDefault();\n                        updateTime();\n                        focusAndClose();\n                    }\n                    else\n                        selectDate(e);\n                    break;\n                case 27:\n                    e.preventDefault();\n                    focusAndClose();\n                    break;\n                case 8:\n                case 46:\n                    if (isInput && !self.config.allowInput) {\n                        e.preventDefault();\n                        self.clear();\n                    }\n                    break;\n                case 37:\n                case 39:\n                    if (!isTimeObj && !isInput) {\n                        e.preventDefault();\n                        var activeElement = getClosestActiveElement();\n                        if (self.daysContainer !== undefined &&\n                            (allowInput === false ||\n                                (activeElement && isInView(activeElement)))) {\n                            var delta_1 = e.keyCode === 39 ? 1 : -1;\n                            if (!e.ctrlKey)\n                                focusOnDay(undefined, delta_1);\n                            else {\n                                e.stopPropagation();\n                                changeMonth(delta_1);\n                                focusOnDay(getFirstAvailableDay(1), 0);\n                            }\n                        }\n                    }\n                    else if (self.hourElement)\n                        self.hourElement.focus();\n                    break;\n                case 38:\n                case 40:\n                    e.preventDefault();\n                    var delta = e.keyCode === 40 ? 1 : -1;\n                    if ((self.daysContainer &&\n                        eventTarget.$i !== undefined) ||\n                        eventTarget === self.input ||\n                        eventTarget === self.altInput) {\n                        if (e.ctrlKey) {\n                            e.stopPropagation();\n                            changeYear(self.currentYear - delta);\n                            focusOnDay(getFirstAvailableDay(1), 0);\n                        }\n                        else if (!isTimeObj)\n                            focusOnDay(undefined, delta * 7);\n                    }\n                    else if (eventTarget === self.currentYearElement) {\n                        changeYear(self.currentYear - delta);\n                    }\n                    else if (self.config.enableTime) {\n                        if (!isTimeObj && self.hourElement)\n                            self.hourElement.focus();\n                        updateTime(e);\n                        self._debouncedChange();\n                    }\n                    break;\n                case 9:\n                    if (isTimeObj) {\n                        var elems = [\n                            self.hourElement,\n                            self.minuteElement,\n                            self.secondElement,\n                            self.amPM,\n                        ]\n                            .concat(self.pluginElements)\n                            .filter(function (x) { return x; });\n                        var i = elems.indexOf(eventTarget);\n                        if (i !== -1) {\n                            var target = elems[i + (e.shiftKey ? -1 : 1)];\n                            e.preventDefault();\n                            (target || self._input).focus();\n                        }\n                    }\n                    else if (!self.config.noCalendar &&\n                        self.daysContainer &&\n                        self.daysContainer.contains(eventTarget) &&\n                        e.shiftKey) {\n                        e.preventDefault();\n                        self._input.focus();\n                    }\n                    break;\n                default:\n                    break;\n            }\n        }\n        if (self.amPM !== undefined && eventTarget === self.amPM) {\n            switch (e.key) {\n                case self.l10n.amPM[0].charAt(0):\n                case self.l10n.amPM[0].charAt(0).toLowerCase():\n                    self.amPM.textContent = self.l10n.amPM[0];\n                    setHoursFromInputs();\n                    updateValue();\n                    break;\n                case self.l10n.amPM[1].charAt(0):\n                case self.l10n.amPM[1].charAt(0).toLowerCase():\n                    self.amPM.textContent = self.l10n.amPM[1];\n                    setHoursFromInputs();\n                    updateValue();\n                    break;\n            }\n        }\n        if (isInput || isCalendarElem(eventTarget)) {\n            triggerEvent(\"onKeyDown\", e);\n        }\n    }\n    function onMouseOver(elem, cellClass) {\n        if (cellClass === void 0) { cellClass = \"flatpickr-day\"; }\n        if (self.selectedDates.length !== 1 ||\n            (elem &&\n                (!elem.classList.contains(cellClass) ||\n                    elem.classList.contains(\"flatpickr-disabled\"))))\n            return;\n        var hoverDate = elem\n            ? elem.dateObj.getTime()\n            : self.days.firstElementChild.dateObj.getTime(), initialDate = self.parseDate(self.selectedDates[0], undefined, true).getTime(), rangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()), rangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime());\n        var containsDisabled = false;\n        var minRange = 0, maxRange = 0;\n        for (var t = rangeStartDate; t < rangeEndDate; t += duration.DAY) {\n            if (!isEnabled(new Date(t), true)) {\n                containsDisabled =\n                    containsDisabled || (t > rangeStartDate && t < rangeEndDate);\n                if (t < initialDate && (!minRange || t > minRange))\n                    minRange = t;\n                else if (t > initialDate && (!maxRange || t < maxRange))\n                    maxRange = t;\n            }\n        }\n        var hoverableCells = Array.from(self.rContainer.querySelectorAll(\"*:nth-child(-n+\" + self.config.showMonths + \") > .\" + cellClass));\n        hoverableCells.forEach(function (dayElem) {\n            var date = dayElem.dateObj;\n            var timestamp = date.getTime();\n            var outOfRange = (minRange > 0 && timestamp < minRange) ||\n                (maxRange > 0 && timestamp > maxRange);\n            if (outOfRange) {\n                dayElem.classList.add(\"notAllowed\");\n                [\"inRange\", \"startRange\", \"endRange\"].forEach(function (c) {\n                    dayElem.classList.remove(c);\n                });\n                return;\n            }\n            else if (containsDisabled && !outOfRange)\n                return;\n            [\"startRange\", \"inRange\", \"endRange\", \"notAllowed\"].forEach(function (c) {\n                dayElem.classList.remove(c);\n            });\n            if (elem !== undefined) {\n                elem.classList.add(hoverDate <= self.selectedDates[0].getTime()\n                    ? \"startRange\"\n                    : \"endRange\");\n                if (initialDate < hoverDate && timestamp === initialDate)\n                    dayElem.classList.add(\"startRange\");\n                else if (initialDate > hoverDate && timestamp === initialDate)\n                    dayElem.classList.add(\"endRange\");\n                if (timestamp >= minRange &&\n                    (maxRange === 0 || timestamp <= maxRange) &&\n                    isBetween(timestamp, initialDate, hoverDate))\n                    dayElem.classList.add(\"inRange\");\n            }\n        });\n    }\n    function onResize() {\n        if (self.isOpen && !self.config.static && !self.config.inline)\n            positionCalendar();\n    }\n    function open(e, positionElement) {\n        if (positionElement === void 0) { positionElement = self._positionElement; }\n        if (self.isMobile === true) {\n            if (e) {\n                e.preventDefault();\n                var eventTarget = getEventTarget(e);\n                if (eventTarget) {\n                    eventTarget.blur();\n                }\n            }\n            if (self.mobileInput !== undefined) {\n                self.mobileInput.focus();\n                self.mobileInput.click();\n            }\n            triggerEvent(\"onOpen\");\n            return;\n        }\n        else if (self._input.disabled || self.config.inline) {\n            return;\n        }\n        var wasOpen = self.isOpen;\n        self.isOpen = true;\n        if (!wasOpen) {\n            self.calendarContainer.classList.add(\"open\");\n            self._input.classList.add(\"active\");\n            triggerEvent(\"onOpen\");\n            positionCalendar(positionElement);\n        }\n        if (self.config.enableTime === true && self.config.noCalendar === true) {\n            if (self.config.allowInput === false &&\n                (e === undefined ||\n                    !self.timeContainer.contains(e.relatedTarget))) {\n                setTimeout(function () { return self.hourElement.select(); }, 50);\n            }\n        }\n    }\n    function minMaxDateSetter(type) {\n        return function (date) {\n            var dateObj = (self.config[\"_\" + type + \"Date\"] = self.parseDate(date, self.config.dateFormat));\n            var inverseDateObj = self.config[\"_\" + (type === \"min\" ? \"max\" : \"min\") + \"Date\"];\n            if (dateObj !== undefined) {\n                self[type === \"min\" ? \"minDateHasTime\" : \"maxDateHasTime\"] =\n                    dateObj.getHours() > 0 ||\n                        dateObj.getMinutes() > 0 ||\n                        dateObj.getSeconds() > 0;\n            }\n            if (self.selectedDates) {\n                self.selectedDates = self.selectedDates.filter(function (d) { return isEnabled(d); });\n                if (!self.selectedDates.length && type === \"min\")\n                    setHoursFromDate(dateObj);\n                updateValue();\n            }\n            if (self.daysContainer) {\n                redraw();\n                if (dateObj !== undefined)\n                    self.currentYearElement[type] = dateObj.getFullYear().toString();\n                else\n                    self.currentYearElement.removeAttribute(type);\n                self.currentYearElement.disabled =\n                    !!inverseDateObj &&\n                        dateObj !== undefined &&\n                        inverseDateObj.getFullYear() === dateObj.getFullYear();\n            }\n        };\n    }\n    function parseConfig() {\n        var boolOpts = [\n            \"wrap\",\n            \"weekNumbers\",\n            \"allowInput\",\n            \"allowInvalidPreload\",\n            \"clickOpens\",\n            \"time_24hr\",\n            \"enableTime\",\n            \"noCalendar\",\n            \"altInput\",\n            \"shorthandCurrentMonth\",\n            \"inline\",\n            \"static\",\n            \"enableSeconds\",\n            \"disableMobile\",\n        ];\n        var userConfig = __assign(__assign({}, JSON.parse(JSON.stringify(element.dataset || {}))), instanceConfig);\n        var formats = {};\n        self.config.parseDate = userConfig.parseDate;\n        self.config.formatDate = userConfig.formatDate;\n        Object.defineProperty(self.config, \"enable\", {\n            get: function () { return self.config._enable; },\n            set: function (dates) {\n                self.config._enable = parseDateRules(dates);\n            },\n        });\n        Object.defineProperty(self.config, \"disable\", {\n            get: function () { return self.config._disable; },\n            set: function (dates) {\n                self.config._disable = parseDateRules(dates);\n            },\n        });\n        var timeMode = userConfig.mode === \"time\";\n        if (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {\n            var defaultDateFormat = flatpickr.defaultConfig.dateFormat || defaultOptions.dateFormat;\n            formats.dateFormat =\n                userConfig.noCalendar || timeMode\n                    ? \"H:i\" + (userConfig.enableSeconds ? \":S\" : \"\")\n                    : defaultDateFormat + \" H:i\" + (userConfig.enableSeconds ? \":S\" : \"\");\n        }\n        if (userConfig.altInput &&\n            (userConfig.enableTime || timeMode) &&\n            !userConfig.altFormat) {\n            var defaultAltFormat = flatpickr.defaultConfig.altFormat || defaultOptions.altFormat;\n            formats.altFormat =\n                userConfig.noCalendar || timeMode\n                    ? \"h:i\" + (userConfig.enableSeconds ? \":S K\" : \" K\")\n                    : defaultAltFormat + (\" h:i\" + (userConfig.enableSeconds ? \":S\" : \"\") + \" K\");\n        }\n        Object.defineProperty(self.config, \"minDate\", {\n            get: function () { return self.config._minDate; },\n            set: minMaxDateSetter(\"min\"),\n        });\n        Object.defineProperty(self.config, \"maxDate\", {\n            get: function () { return self.config._maxDate; },\n            set: minMaxDateSetter(\"max\"),\n        });\n        var minMaxTimeSetter = function (type) { return function (val) {\n            self.config[type === \"min\" ? \"_minTime\" : \"_maxTime\"] = self.parseDate(val, \"H:i:S\");\n        }; };\n        Object.defineProperty(self.config, \"minTime\", {\n            get: function () { return self.config._minTime; },\n            set: minMaxTimeSetter(\"min\"),\n        });\n        Object.defineProperty(self.config, \"maxTime\", {\n            get: function () { return self.config._maxTime; },\n            set: minMaxTimeSetter(\"max\"),\n        });\n        if (userConfig.mode === \"time\") {\n            self.config.noCalendar = true;\n            self.config.enableTime = true;\n        }\n        Object.assign(self.config, formats, userConfig);\n        for (var i = 0; i < boolOpts.length; i++)\n            self.config[boolOpts[i]] =\n                self.config[boolOpts[i]] === true ||\n                    self.config[boolOpts[i]] === \"true\";\n        HOOKS.filter(function (hook) { return self.config[hook] !== undefined; }).forEach(function (hook) {\n            self.config[hook] = arrayify(self.config[hook] || []).map(bindToInstance);\n        });\n        self.isMobile =\n            !self.config.disableMobile &&\n                !self.config.inline &&\n                self.config.mode === \"single\" &&\n                !self.config.disable.length &&\n                !self.config.enable &&\n                !self.config.weekNumbers &&\n                /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n        for (var i = 0; i < self.config.plugins.length; i++) {\n            var pluginConf = self.config.plugins[i](self) || {};\n            for (var key in pluginConf) {\n                if (HOOKS.indexOf(key) > -1) {\n                    self.config[key] = arrayify(pluginConf[key])\n                        .map(bindToInstance)\n                        .concat(self.config[key]);\n                }\n                else if (typeof userConfig[key] === \"undefined\")\n                    self.config[key] = pluginConf[key];\n            }\n        }\n        if (!userConfig.altInputClass) {\n            self.config.altInputClass =\n                getInputElem().className + \" \" + self.config.altInputClass;\n        }\n        triggerEvent(\"onParseConfig\");\n    }\n    function getInputElem() {\n        return self.config.wrap\n            ? element.querySelector(\"[data-input]\")\n            : element;\n    }\n    function setupLocale() {\n        if (typeof self.config.locale !== \"object\" &&\n            typeof flatpickr.l10ns[self.config.locale] === \"undefined\")\n            self.config.errorHandler(new Error(\"flatpickr: invalid locale \" + self.config.locale));\n        self.l10n = __assign(__assign({}, flatpickr.l10ns.default), (typeof self.config.locale === \"object\"\n            ? self.config.locale\n            : self.config.locale !== \"default\"\n                ? flatpickr.l10ns[self.config.locale]\n                : undefined));\n        tokenRegex.D = \"(\" + self.l10n.weekdays.shorthand.join(\"|\") + \")\";\n        tokenRegex.l = \"(\" + self.l10n.weekdays.longhand.join(\"|\") + \")\";\n        tokenRegex.M = \"(\" + self.l10n.months.shorthand.join(\"|\") + \")\";\n        tokenRegex.F = \"(\" + self.l10n.months.longhand.join(\"|\") + \")\";\n        tokenRegex.K = \"(\" + self.l10n.amPM[0] + \"|\" + self.l10n.amPM[1] + \"|\" + self.l10n.amPM[0].toLowerCase() + \"|\" + self.l10n.amPM[1].toLowerCase() + \")\";\n        var userConfig = __assign(__assign({}, instanceConfig), JSON.parse(JSON.stringify(element.dataset || {})));\n        if (userConfig.time_24hr === undefined &&\n            flatpickr.defaultConfig.time_24hr === undefined) {\n            self.config.time_24hr = self.l10n.time_24hr;\n        }\n        self.formatDate = createDateFormatter(self);\n        self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n    }\n    function positionCalendar(customPositionElement) {\n        if (typeof self.config.position === \"function\") {\n            return void self.config.position(self, customPositionElement);\n        }\n        if (self.calendarContainer === undefined)\n            return;\n        triggerEvent(\"onPreCalendarPosition\");\n        var positionElement = customPositionElement || self._positionElement;\n        var calendarHeight = Array.prototype.reduce.call(self.calendarContainer.children, (function (acc, child) { return acc + child.offsetHeight; }), 0), calendarWidth = self.calendarContainer.offsetWidth, configPos = self.config.position.split(\" \"), configPosVertical = configPos[0], configPosHorizontal = configPos.length > 1 ? configPos[1] : null, inputBounds = positionElement.getBoundingClientRect(), distanceFromBottom = window.innerHeight - inputBounds.bottom, showOnTop = configPosVertical === \"above\" ||\n            (configPosVertical !== \"below\" &&\n                distanceFromBottom < calendarHeight &&\n                inputBounds.top > calendarHeight);\n        var top = window.pageYOffset +\n            inputBounds.top +\n            (!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);\n        toggleClass(self.calendarContainer, \"arrowTop\", !showOnTop);\n        toggleClass(self.calendarContainer, \"arrowBottom\", showOnTop);\n        if (self.config.inline)\n            return;\n        var left = window.pageXOffset + inputBounds.left;\n        var isCenter = false;\n        var isRight = false;\n        if (configPosHorizontal === \"center\") {\n            left -= (calendarWidth - inputBounds.width) / 2;\n            isCenter = true;\n        }\n        else if (configPosHorizontal === \"right\") {\n            left -= calendarWidth - inputBounds.width;\n            isRight = true;\n        }\n        toggleClass(self.calendarContainer, \"arrowLeft\", !isCenter && !isRight);\n        toggleClass(self.calendarContainer, \"arrowCenter\", isCenter);\n        toggleClass(self.calendarContainer, \"arrowRight\", isRight);\n        var right = window.document.body.offsetWidth -\n            (window.pageXOffset + inputBounds.right);\n        var rightMost = left + calendarWidth > window.document.body.offsetWidth;\n        var centerMost = right + calendarWidth > window.document.body.offsetWidth;\n        toggleClass(self.calendarContainer, \"rightMost\", rightMost);\n        if (self.config.static)\n            return;\n        self.calendarContainer.style.top = top + \"px\";\n        if (!rightMost) {\n            self.calendarContainer.style.left = left + \"px\";\n            self.calendarContainer.style.right = \"auto\";\n        }\n        else if (!centerMost) {\n            self.calendarContainer.style.left = \"auto\";\n            self.calendarContainer.style.right = right + \"px\";\n        }\n        else {\n            var doc = getDocumentStyleSheet();\n            if (doc === undefined)\n                return;\n            var bodyWidth = window.document.body.offsetWidth;\n            var centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);\n            var centerBefore = \".flatpickr-calendar.centerMost:before\";\n            var centerAfter = \".flatpickr-calendar.centerMost:after\";\n            var centerIndex = doc.cssRules.length;\n            var centerStyle = \"{left:\" + inputBounds.left + \"px;right:auto;}\";\n            toggleClass(self.calendarContainer, \"rightMost\", false);\n            toggleClass(self.calendarContainer, \"centerMost\", true);\n            doc.insertRule(centerBefore + \",\" + centerAfter + centerStyle, centerIndex);\n            self.calendarContainer.style.left = centerLeft + \"px\";\n            self.calendarContainer.style.right = \"auto\";\n        }\n    }\n    function getDocumentStyleSheet() {\n        var editableSheet = null;\n        for (var i = 0; i < document.styleSheets.length; i++) {\n            var sheet = document.styleSheets[i];\n            if (!sheet.cssRules)\n                continue;\n            try {\n                sheet.cssRules;\n            }\n            catch (err) {\n                continue;\n            }\n            editableSheet = sheet;\n            break;\n        }\n        return editableSheet != null ? editableSheet : createStyleSheet();\n    }\n    function createStyleSheet() {\n        var style = document.createElement(\"style\");\n        document.head.appendChild(style);\n        return style.sheet;\n    }\n    function redraw() {\n        if (self.config.noCalendar || self.isMobile)\n            return;\n        buildMonthSwitch();\n        updateNavigationCurrentMonth();\n        buildDays();\n    }\n    function focusAndClose() {\n        self._input.focus();\n        if (window.navigator.userAgent.indexOf(\"MSIE\") !== -1 ||\n            navigator.msMaxTouchPoints !== undefined) {\n            setTimeout(self.close, 0);\n        }\n        else {\n            self.close();\n        }\n    }\n    function selectDate(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        var isSelectable = function (day) {\n            return day.classList &&\n                day.classList.contains(\"flatpickr-day\") &&\n                !day.classList.contains(\"flatpickr-disabled\") &&\n                !day.classList.contains(\"notAllowed\");\n        };\n        var t = findParent(getEventTarget(e), isSelectable);\n        if (t === undefined)\n            return;\n        var target = t;\n        var selectedDate = (self.latestSelectedDateObj = new Date(target.dateObj.getTime()));\n        var shouldChangeMonth = (selectedDate.getMonth() < self.currentMonth ||\n            selectedDate.getMonth() >\n                self.currentMonth + self.config.showMonths - 1) &&\n            self.config.mode !== \"range\";\n        self.selectedDateElem = target;\n        if (self.config.mode === \"single\")\n            self.selectedDates = [selectedDate];\n        else if (self.config.mode === \"multiple\") {\n            var selectedIndex = isDateSelected(selectedDate);\n            if (selectedIndex)\n                self.selectedDates.splice(parseInt(selectedIndex), 1);\n            else\n                self.selectedDates.push(selectedDate);\n        }\n        else if (self.config.mode === \"range\") {\n            if (self.selectedDates.length === 2) {\n                self.clear(false, false);\n            }\n            self.latestSelectedDateObj = selectedDate;\n            self.selectedDates.push(selectedDate);\n            if (compareDates(selectedDate, self.selectedDates[0], true) !== 0)\n                self.selectedDates.sort(function (a, b) { return a.getTime() - b.getTime(); });\n        }\n        setHoursFromInputs();\n        if (shouldChangeMonth) {\n            var isNewYear = self.currentYear !== selectedDate.getFullYear();\n            self.currentYear = selectedDate.getFullYear();\n            self.currentMonth = selectedDate.getMonth();\n            if (isNewYear) {\n                triggerEvent(\"onYearChange\");\n                buildMonthSwitch();\n            }\n            triggerEvent(\"onMonthChange\");\n        }\n        updateNavigationCurrentMonth();\n        buildDays();\n        updateValue();\n        if (!shouldChangeMonth &&\n            self.config.mode !== \"range\" &&\n            self.config.showMonths === 1)\n            focusOnDayElem(target);\n        else if (self.selectedDateElem !== undefined &&\n            self.hourElement === undefined) {\n            self.selectedDateElem && self.selectedDateElem.focus();\n        }\n        if (self.hourElement !== undefined)\n            self.hourElement !== undefined && self.hourElement.focus();\n        if (self.config.closeOnSelect) {\n            var single = self.config.mode === \"single\" && !self.config.enableTime;\n            var range = self.config.mode === \"range\" &&\n                self.selectedDates.length === 2 &&\n                !self.config.enableTime;\n            if (single || range) {\n                focusAndClose();\n            }\n        }\n        triggerChange();\n    }\n    var CALLBACKS = {\n        locale: [setupLocale, updateWeekdays],\n        showMonths: [buildMonths, setCalendarWidth, buildWeekdays],\n        minDate: [jumpToDate],\n        maxDate: [jumpToDate],\n        positionElement: [updatePositionElement],\n        clickOpens: [\n            function () {\n                if (self.config.clickOpens === true) {\n                    bind(self._input, \"focus\", self.open);\n                    bind(self._input, \"click\", self.open);\n                }\n                else {\n                    self._input.removeEventListener(\"focus\", self.open);\n                    self._input.removeEventListener(\"click\", self.open);\n                }\n            },\n        ],\n    };\n    function set(option, value) {\n        if (option !== null && typeof option === \"object\") {\n            Object.assign(self.config, option);\n            for (var key in option) {\n                if (CALLBACKS[key] !== undefined)\n                    CALLBACKS[key].forEach(function (x) { return x(); });\n            }\n        }\n        else {\n            self.config[option] = value;\n            if (CALLBACKS[option] !== undefined)\n                CALLBACKS[option].forEach(function (x) { return x(); });\n            else if (HOOKS.indexOf(option) > -1)\n                self.config[option] = arrayify(value);\n        }\n        self.redraw();\n        updateValue(true);\n    }\n    function setSelectedDate(inputDate, format) {\n        var dates = [];\n        if (inputDate instanceof Array)\n            dates = inputDate.map(function (d) { return self.parseDate(d, format); });\n        else if (inputDate instanceof Date || typeof inputDate === \"number\")\n            dates = [self.parseDate(inputDate, format)];\n        else if (typeof inputDate === \"string\") {\n            switch (self.config.mode) {\n                case \"single\":\n                case \"time\":\n                    dates = [self.parseDate(inputDate, format)];\n                    break;\n                case \"multiple\":\n                    dates = inputDate\n                        .split(self.config.conjunction)\n                        .map(function (date) { return self.parseDate(date, format); });\n                    break;\n                case \"range\":\n                    dates = inputDate\n                        .split(self.l10n.rangeSeparator)\n                        .map(function (date) { return self.parseDate(date, format); });\n                    break;\n                default:\n                    break;\n            }\n        }\n        else\n            self.config.errorHandler(new Error(\"Invalid date supplied: \" + JSON.stringify(inputDate)));\n        self.selectedDates = (self.config.allowInvalidPreload\n            ? dates\n            : dates.filter(function (d) { return d instanceof Date && isEnabled(d, false); }));\n        if (self.config.mode === \"range\")\n            self.selectedDates.sort(function (a, b) { return a.getTime() - b.getTime(); });\n    }\n    function setDate(date, triggerChange, format) {\n        if (triggerChange === void 0) { triggerChange = false; }\n        if (format === void 0) { format = self.config.dateFormat; }\n        if ((date !== 0 && !date) || (date instanceof Array && date.length === 0))\n            return self.clear(triggerChange);\n        setSelectedDate(date, format);\n        self.latestSelectedDateObj =\n            self.selectedDates[self.selectedDates.length - 1];\n        self.redraw();\n        jumpToDate(undefined, triggerChange);\n        setHoursFromDate();\n        if (self.selectedDates.length === 0) {\n            self.clear(false);\n        }\n        updateValue(triggerChange);\n        if (triggerChange)\n            triggerEvent(\"onChange\");\n    }\n    function parseDateRules(arr) {\n        return arr\n            .slice()\n            .map(function (rule) {\n            if (typeof rule === \"string\" ||\n                typeof rule === \"number\" ||\n                rule instanceof Date) {\n                return self.parseDate(rule, undefined, true);\n            }\n            else if (rule &&\n                typeof rule === \"object\" &&\n                rule.from &&\n                rule.to)\n                return {\n                    from: self.parseDate(rule.from, undefined),\n                    to: self.parseDate(rule.to, undefined),\n                };\n            return rule;\n        })\n            .filter(function (x) { return x; });\n    }\n    function setupDates() {\n        self.selectedDates = [];\n        self.now = self.parseDate(self.config.now) || new Date();\n        var preloadedDate = self.config.defaultDate ||\n            ((self.input.nodeName === \"INPUT\" ||\n                self.input.nodeName === \"TEXTAREA\") &&\n                self.input.placeholder &&\n                self.input.value === self.input.placeholder\n                ? null\n                : self.input.value);\n        if (preloadedDate)\n            setSelectedDate(preloadedDate, self.config.dateFormat);\n        self._initialDate =\n            self.selectedDates.length > 0\n                ? self.selectedDates[0]\n                : self.config.minDate &&\n                    self.config.minDate.getTime() > self.now.getTime()\n                    ? self.config.minDate\n                    : self.config.maxDate &&\n                        self.config.maxDate.getTime() < self.now.getTime()\n                        ? self.config.maxDate\n                        : self.now;\n        self.currentYear = self._initialDate.getFullYear();\n        self.currentMonth = self._initialDate.getMonth();\n        if (self.selectedDates.length > 0)\n            self.latestSelectedDateObj = self.selectedDates[0];\n        if (self.config.minTime !== undefined)\n            self.config.minTime = self.parseDate(self.config.minTime, \"H:i\");\n        if (self.config.maxTime !== undefined)\n            self.config.maxTime = self.parseDate(self.config.maxTime, \"H:i\");\n        self.minDateHasTime =\n            !!self.config.minDate &&\n                (self.config.minDate.getHours() > 0 ||\n                    self.config.minDate.getMinutes() > 0 ||\n                    self.config.minDate.getSeconds() > 0);\n        self.maxDateHasTime =\n            !!self.config.maxDate &&\n                (self.config.maxDate.getHours() > 0 ||\n                    self.config.maxDate.getMinutes() > 0 ||\n                    self.config.maxDate.getSeconds() > 0);\n    }\n    function setupInputs() {\n        self.input = getInputElem();\n        if (!self.input) {\n            self.config.errorHandler(new Error(\"Invalid input element specified\"));\n            return;\n        }\n        self.input._type = self.input.type;\n        self.input.type = \"text\";\n        self.input.classList.add(\"flatpickr-input\");\n        self._input = self.input;\n        if (self.config.altInput) {\n            self.altInput = createElement(self.input.nodeName, self.config.altInputClass);\n            self._input = self.altInput;\n            self.altInput.placeholder = self.input.placeholder;\n            self.altInput.disabled = self.input.disabled;\n            self.altInput.required = self.input.required;\n            self.altInput.tabIndex = self.input.tabIndex;\n            self.altInput.type = \"text\";\n            self.input.setAttribute(\"type\", \"hidden\");\n            if (!self.config.static && self.input.parentNode)\n                self.input.parentNode.insertBefore(self.altInput, self.input.nextSibling);\n        }\n        if (!self.config.allowInput)\n            self._input.setAttribute(\"readonly\", \"readonly\");\n        updatePositionElement();\n    }\n    function updatePositionElement() {\n        self._positionElement = self.config.positionElement || self._input;\n    }\n    function setupMobile() {\n        var inputType = self.config.enableTime\n            ? self.config.noCalendar\n                ? \"time\"\n                : \"datetime-local\"\n            : \"date\";\n        self.mobileInput = createElement(\"input\", self.input.className + \" flatpickr-mobile\");\n        self.mobileInput.tabIndex = 1;\n        self.mobileInput.type = inputType;\n        self.mobileInput.disabled = self.input.disabled;\n        self.mobileInput.required = self.input.required;\n        self.mobileInput.placeholder = self.input.placeholder;\n        self.mobileFormatStr =\n            inputType === \"datetime-local\"\n                ? \"Y-m-d\\\\TH:i:S\"\n                : inputType === \"date\"\n                    ? \"Y-m-d\"\n                    : \"H:i:S\";\n        if (self.selectedDates.length > 0) {\n            self.mobileInput.defaultValue = self.mobileInput.value = self.formatDate(self.selectedDates[0], self.mobileFormatStr);\n        }\n        if (self.config.minDate)\n            self.mobileInput.min = self.formatDate(self.config.minDate, \"Y-m-d\");\n        if (self.config.maxDate)\n            self.mobileInput.max = self.formatDate(self.config.maxDate, \"Y-m-d\");\n        if (self.input.getAttribute(\"step\"))\n            self.mobileInput.step = String(self.input.getAttribute(\"step\"));\n        self.input.type = \"hidden\";\n        if (self.altInput !== undefined)\n            self.altInput.type = \"hidden\";\n        try {\n            if (self.input.parentNode)\n                self.input.parentNode.insertBefore(self.mobileInput, self.input.nextSibling);\n        }\n        catch (_a) { }\n        bind(self.mobileInput, \"change\", function (e) {\n            self.setDate(getEventTarget(e).value, false, self.mobileFormatStr);\n            triggerEvent(\"onChange\");\n            triggerEvent(\"onClose\");\n        });\n    }\n    function toggle(e) {\n        if (self.isOpen === true)\n            return self.close();\n        self.open(e);\n    }\n    function triggerEvent(event, data) {\n        if (self.config === undefined)\n            return;\n        var hooks = self.config[event];\n        if (hooks !== undefined && hooks.length > 0) {\n            for (var i = 0; hooks[i] && i < hooks.length; i++)\n                hooks[i](self.selectedDates, self.input.value, self, data);\n        }\n        if (event === \"onChange\") {\n            self.input.dispatchEvent(createEvent(\"change\"));\n            self.input.dispatchEvent(createEvent(\"input\"));\n        }\n    }\n    function createEvent(name) {\n        var e = document.createEvent(\"Event\");\n        e.initEvent(name, true, true);\n        return e;\n    }\n    function isDateSelected(date) {\n        for (var i = 0; i < self.selectedDates.length; i++) {\n            var selectedDate = self.selectedDates[i];\n            if (selectedDate instanceof Date &&\n                compareDates(selectedDate, date) === 0)\n                return \"\" + i;\n        }\n        return false;\n    }\n    function isDateInRange(date) {\n        if (self.config.mode !== \"range\" || self.selectedDates.length < 2)\n            return false;\n        return (compareDates(date, self.selectedDates[0]) >= 0 &&\n            compareDates(date, self.selectedDates[1]) <= 0);\n    }\n    function updateNavigationCurrentMonth() {\n        if (self.config.noCalendar || self.isMobile || !self.monthNav)\n            return;\n        self.yearElements.forEach(function (yearElement, i) {\n            var d = new Date(self.currentYear, self.currentMonth, 1);\n            d.setMonth(self.currentMonth + i);\n            if (self.config.showMonths > 1 ||\n                self.config.monthSelectorType === \"static\") {\n                self.monthElements[i].textContent =\n                    monthToStr(d.getMonth(), self.config.shorthandCurrentMonth, self.l10n) + \" \";\n            }\n            else {\n                self.monthsDropdownContainer.value = d.getMonth().toString();\n            }\n            yearElement.value = d.getFullYear().toString();\n        });\n        self._hidePrevMonthArrow =\n            self.config.minDate !== undefined &&\n                (self.currentYear === self.config.minDate.getFullYear()\n                    ? self.currentMonth <= self.config.minDate.getMonth()\n                    : self.currentYear < self.config.minDate.getFullYear());\n        self._hideNextMonthArrow =\n            self.config.maxDate !== undefined &&\n                (self.currentYear === self.config.maxDate.getFullYear()\n                    ? self.currentMonth + 1 > self.config.maxDate.getMonth()\n                    : self.currentYear > self.config.maxDate.getFullYear());\n    }\n    function getDateStr(specificFormat) {\n        var format = specificFormat ||\n            (self.config.altInput ? self.config.altFormat : self.config.dateFormat);\n        return self.selectedDates\n            .map(function (dObj) { return self.formatDate(dObj, format); })\n            .filter(function (d, i, arr) {\n            return self.config.mode !== \"range\" ||\n                self.config.enableTime ||\n                arr.indexOf(d) === i;\n        })\n            .join(self.config.mode !== \"range\"\n            ? self.config.conjunction\n            : self.l10n.rangeSeparator);\n    }\n    function updateValue(triggerChange) {\n        if (triggerChange === void 0) { triggerChange = true; }\n        if (self.mobileInput !== undefined && self.mobileFormatStr) {\n            self.mobileInput.value =\n                self.latestSelectedDateObj !== undefined\n                    ? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr)\n                    : \"\";\n        }\n        self.input.value = getDateStr(self.config.dateFormat);\n        if (self.altInput !== undefined) {\n            self.altInput.value = getDateStr(self.config.altFormat);\n        }\n        if (triggerChange !== false)\n            triggerEvent(\"onValueUpdate\");\n    }\n    function onMonthNavClick(e) {\n        var eventTarget = getEventTarget(e);\n        var isPrevMonth = self.prevMonthNav.contains(eventTarget);\n        var isNextMonth = self.nextMonthNav.contains(eventTarget);\n        if (isPrevMonth || isNextMonth) {\n            changeMonth(isPrevMonth ? -1 : 1);\n        }\n        else if (self.yearElements.indexOf(eventTarget) >= 0) {\n            eventTarget.select();\n        }\n        else if (eventTarget.classList.contains(\"arrowUp\")) {\n            self.changeYear(self.currentYear + 1);\n        }\n        else if (eventTarget.classList.contains(\"arrowDown\")) {\n            self.changeYear(self.currentYear - 1);\n        }\n    }\n    function timeWrapper(e) {\n        e.preventDefault();\n        var isKeyDown = e.type === \"keydown\", eventTarget = getEventTarget(e), input = eventTarget;\n        if (self.amPM !== undefined && eventTarget === self.amPM) {\n            self.amPM.textContent =\n                self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n        }\n        var min = parseFloat(input.getAttribute(\"min\")), max = parseFloat(input.getAttribute(\"max\")), step = parseFloat(input.getAttribute(\"step\")), curValue = parseInt(input.value, 10), delta = e.delta ||\n            (isKeyDown ? (e.which === 38 ? 1 : -1) : 0);\n        var newValue = curValue + step * delta;\n        if (typeof input.value !== \"undefined\" && input.value.length === 2) {\n            var isHourElem = input === self.hourElement, isMinuteElem = input === self.minuteElement;\n            if (newValue < min) {\n                newValue =\n                    max +\n                        newValue +\n                        int(!isHourElem) +\n                        (int(isHourElem) && int(!self.amPM));\n                if (isMinuteElem)\n                    incrementNumInput(undefined, -1, self.hourElement);\n            }\n            else if (newValue > max) {\n                newValue =\n                    input === self.hourElement ? newValue - max - int(!self.amPM) : min;\n                if (isMinuteElem)\n                    incrementNumInput(undefined, 1, self.hourElement);\n            }\n            if (self.amPM &&\n                isHourElem &&\n                (step === 1\n                    ? newValue + curValue === 23\n                    : Math.abs(newValue - curValue) > step)) {\n                self.amPM.textContent =\n                    self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n            }\n            input.value = pad(newValue);\n        }\n    }\n    init();\n    return self;\n}\nfunction _flatpickr(nodeList, config) {\n    var nodes = Array.prototype.slice\n        .call(nodeList)\n        .filter(function (x) { return x instanceof HTMLElement; });\n    var instances = [];\n    for (var i = 0; i < nodes.length; i++) {\n        var node = nodes[i];\n        try {\n            if (node.getAttribute(\"data-fp-omit\") !== null)\n                continue;\n            if (node._flatpickr !== undefined) {\n                node._flatpickr.destroy();\n                node._flatpickr = undefined;\n            }\n            node._flatpickr = FlatpickrInstance(node, config || {});\n            instances.push(node._flatpickr);\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n    return instances.length === 1 ? instances[0] : instances;\n}\nif (typeof HTMLElement !== \"undefined\" &&\n    typeof HTMLCollection !== \"undefined\" &&\n    typeof NodeList !== \"undefined\") {\n    HTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr = function (config) {\n        return _flatpickr(this, config);\n    };\n    HTMLElement.prototype.flatpickr = function (config) {\n        return _flatpickr([this], config);\n    };\n}\nvar flatpickr = function (selector, config) {\n    if (typeof selector === \"string\") {\n        return _flatpickr(window.document.querySelectorAll(selector), config);\n    }\n    else if (selector instanceof Node) {\n        return _flatpickr([selector], config);\n    }\n    else {\n        return _flatpickr(selector, config);\n    }\n};\nflatpickr.defaultConfig = {};\nflatpickr.l10ns = {\n    en: __assign({}, English),\n    default: __assign({}, English),\n};\nflatpickr.localize = function (l10n) {\n    flatpickr.l10ns.default = __assign(__assign({}, flatpickr.l10ns.default), l10n);\n};\nflatpickr.setDefaults = function (config) {\n    flatpickr.defaultConfig = __assign(__assign({}, flatpickr.defaultConfig), config);\n};\nflatpickr.parseDate = createDateParser({});\nflatpickr.formatDate = createDateFormatter({});\nflatpickr.compareDates = compareDates;\nif (typeof jQuery !== \"undefined\" && typeof jQuery.fn !== \"undefined\") {\n    jQuery.fn.flatpickr = function (config) {\n        return _flatpickr(this, config);\n    };\n}\nDate.prototype.fp_incr = function (days) {\n    return new Date(this.getFullYear(), this.getMonth(), this.getDate() + (typeof days === \"string\" ? parseInt(days, 10) : days));\n};\nif (typeof window !== \"undefined\") {\n    window.flatpickr = flatpickr;\n}\nexport default flatpickr;\n","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { Dropdown } from \"./Dropdown\";\r\nimport { StockIcons } from \"./StockIcons\";\r\nimport { StyleSheet } from \"../../../core/util/Utils\";\r\nimport flatpickr from \"flatpickr\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\";\r\nimport * as $type from \"../../../core/util/Type\";\r\n\r\nexport interface IDateRangeSelectorSettings extends IStockControlSettings {\r\n\r\n\t/**\r\n\t * Date format to use for date input fields.\r\n\t *\r\n\t * Will use global date format if not set.\r\n\t */\r\n\tdateFormat?: string;\r\n\r\n\t/**\r\n\t * If set to `false` the control will not load default CSS for Flatpickr\r\n\t * component. This would mean it would be unstyled, and would require\r\n\t * custom CSS present on the page.\r\n\t *\r\n\t * @default true\r\n\t * @since 5.2.4\r\n\t */\r\n\tuseDefaultCSS?: boolean;\r\n\r\n\t/**\r\n\t * Minimum date to allow for selection.\r\n\t *\r\n\t * Accepts either a `Date` object or `\"auto\"` (smallest date available in\r\n\t * chart).\r\n\t *\r\n\t * @default \"auto\"\r\n\t * @since 5.3.7\r\n\t */\r\n\tminDate?: Date | \"auto\" | null;\r\n\r\n\t/**\r\n\t * Maximum date to allow for selection.\r\n\t *\r\n\t * Accepts either a `Date` object or `\"auto\"` (latest date available in\r\n\t * chart).\r\n\t *\r\n\t * @default \"auto\"\r\n\t * @since 5.3.7\r\n\t */\r\n\tmaxDate?: Date | \"auto\" | null;\r\n\r\n}\r\n\r\nexport interface IDateRangeSelectorPrivate extends IStockControlPrivate {\r\n\tdropdown: Dropdown;\r\n\r\n\tfromField: HTMLInputElement;\r\n\tfromPicker: any;\r\n\tfromDate?: Date;\r\n\r\n\ttoField: HTMLInputElement;\r\n\ttoPicker: any;\r\n\ttoDate?: Date;\r\n}\r\n\r\nexport interface IDateRangeSelectorEvents extends IStockControlEvents {\r\n\t/**\r\n\t * Invoked when user selects certain date range via control.\r\n\t *\r\n\t * @from 5.8.5\r\n\t */\r\n\trangeselected: {\r\n\t\tfromDate: Date;\r\n\t\ttoDate: Date;\r\n\t}\r\n}\r\n\r\n/**\r\n * Date range selector control for [[StockChart]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/date-range-selector/} for more info\r\n */\r\nexport class DateRangeSelector extends StockControl {\r\n\tpublic static className: string = \"DateRangeSelector\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([DateRangeSelector.className]);\r\n\r\n\tdeclare public _settings: IDateRangeSelectorSettings;\r\n\tdeclare public _privateSettings: IDateRangeSelectorPrivate;\r\n\tdeclare public _events: IDateRangeSelectorEvents;\r\n\r\n\tprotected _afterNew() {\r\n\r\n\t\t// Do parent stuff\r\n\t\tsuper._afterNew();\r\n\r\n\t\t// Create list of tools\r\n\t\tconst dropdown = Dropdown.new(this._root, {\r\n\t\t\tcontrol: this,\r\n\t\t\tparent: this.getPrivate(\"button\")\r\n\t\t});\r\n\t\tthis.setPrivate(\"dropdown\", dropdown);\r\n\r\n\t\tdropdown.events.on(\"opened\", (_ev) => {\r\n\t\t\tthis.set(\"active\", true);\r\n\t\t\tthis._updateInputs();\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"closed\", (_ev) => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.setTimeout(() => {\r\n\t\t\t\t\tdropdown.show();\r\n\t\t\t\t}, 10);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdropdown.hide();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-control-dropdown\";\r\n\r\n\t\tif (this.get(\"useDefaultCSS\", true)) {\r\n\t\t\tthis._loadDefaultCSS();\r\n\t\t}\r\n\t\tthis._initDropdown();\r\n\t}\r\n\r\n\tprotected _initDropdown(): void {\r\n\t\tconst dropdown = this.getPrivate(\"dropdown\");\r\n\t\tconst container = dropdown.getPrivate(\"container\")!;\r\n\r\n\t\tconst content = document.createElement(\"div\")\r\n\t\tcontent.className = \"am5stock-row\";\r\n\t\tcontainer.appendChild(content);\r\n\r\n\t\t// From fields\r\n\t\tconst fromColumn = document.createElement(\"div\")\r\n\t\tfromColumn.className = \"am5stock-column\";\r\n\t\tcontent.appendChild(fromColumn);\r\n\r\n\t\tconst fromGroup = document.createElement(\"div\");\r\n\t\tfromGroup.className = \"am5stock-group\";\r\n\t\tfromColumn.appendChild(fromGroup);\r\n\r\n\t\tconst fromLabel = document.createElement(\"div\");\r\n\t\tfromLabel.className = \"am5stock-small\";\r\n\t\tfromLabel.innerHTML = this._root.language.translate(\"From %1\", undefined, \"\");\r\n\t\tfromGroup.appendChild(fromLabel);\r\n\r\n\t\tconst fromField = document.createElement(\"input\");\r\n\t\tfromField.type = \"text\";\r\n\t\tfromGroup.appendChild(fromField);\r\n\t\tthis.setPrivate(\"fromField\", fromField);\r\n\r\n\t\t// To fields\r\n\t\tconst toColumn = document.createElement(\"div\")\r\n\t\ttoColumn.className = \"am5stock-column\";\r\n\t\tcontent.appendChild(toColumn);\r\n\r\n\t\tconst toGroup = document.createElement(\"div\");\r\n\t\ttoGroup.className = \"am5stock-group\";\r\n\t\ttoColumn.appendChild(toGroup);\r\n\r\n\t\tconst toLabel = document.createElement(\"div\");\r\n\t\ttoLabel.className = \"am5stock-small\";\r\n\t\ttoLabel.innerHTML = this._root.language.translate(\"To %1\", undefined, \"\");\r\n\t\ttoGroup.appendChild(toLabel);\r\n\r\n\t\tconst toField = document.createElement(\"input\");\r\n\t\ttoField.type = \"text\";\r\n\t\ttoGroup.appendChild(toField);\r\n\t\tthis.setPrivate(\"toField\", toField);\r\n\r\n\t\t// Date pickers\r\n\t\tconst pickerLocale = this._getPickerLocale();\r\n\r\n\t\tconst fromPicker = flatpickr(fromField, {\r\n\t\t\tinline: true,\r\n\t\t\tappendTo: fromColumn,\r\n\t\t\tallowInput: true,\r\n\t\t\tlocale: pickerLocale,\r\n\t\t\tformatDate: (date) => {\r\n\t\t\t\treturn this._formatDate(date);\r\n\t\t\t},\r\n\t\t\tparseDate: (date) => {\r\n\t\t\t\treturn this._parseDate(date);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.setPrivate(\"fromPicker\", fromPicker);\r\n\r\n\t\tconst toPicker = flatpickr(toField, {\r\n\t\t\tinline: true,\r\n\t\t\tappendTo: toColumn,\r\n\t\t\tallowInput: true,\r\n\t\t\tlocale: pickerLocale,\r\n\t\t\tformatDate: (date) => {\r\n\t\t\t\treturn this._formatDate(date);\r\n\t\t\t},\r\n\t\t\tparseDate: (date) => {\r\n\t\t\t\treturn this._parseDate(date);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.setPrivate(\"toPicker\", toPicker);\r\n\r\n\r\n\t\t// Buttons\r\n\t\tconst buttons = document.createElement(\"div\")\r\n\t\tbuttons.className = \"am5stock-row\";\r\n\t\tcontainer.appendChild(buttons);\r\n\r\n\t\tconst buttonsColumn = document.createElement(\"div\")\r\n\t\tbuttonsColumn.className = \"am5stock-column\";\r\n\t\tcontainer.appendChild(buttonsColumn);\r\n\r\n\t\tconst saveButton = document.createElement(\"input\");\r\n\t\tsaveButton.type = \"button\";\r\n\t\tsaveButton.value = this._root.language.translateAny(\"Apply\");\r\n\t\tsaveButton.className = \"am5-modal-button am5-modal-primary\";\r\n\t\tbuttonsColumn.appendChild(saveButton);\r\n\r\n\t\tconst xAxis = this._getAxis();\r\n\r\n\t\txAxis.onPrivate(\"selectionMin\", () => {\r\n\t\t\tif (this.getPrivate(\"fromDate\")) {\r\n\t\t\t\tthis._updateInputs();\r\n\t\t\t\tthis._updateLabel();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\txAxis.onPrivate(\"selectionMax\", () => {\r\n\t\t\tif (this.getPrivate(\"toDate\")) {\r\n\t\t\t\tthis._updateInputs();\r\n\t\t\t\tthis._updateLabel();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\txAxis.onPrivate(\"minFinal\", () => {\r\n\t\t\tthis._updatePickers();\r\n\t\t});\r\n\r\n\t\txAxis.onPrivate(\"maxFinal\", () => {\r\n\t\t\tthis._updatePickers();\r\n\t\t});\r\n\r\n\t\tthis._disposers.push($utils.addEventListener(saveButton, \"click\", () => {\r\n\t\t\tconst from = this._parseDate(fromField.value);\r\n\t\t\tconst to = this._parseDate(toField.value);\r\n\t\t\tto.setHours(23, 59, 59);\r\n\t\t\tthis.setPrivate(\"fromDate\", from);\r\n\t\t\tthis.setPrivate(\"toDate\", to);\r\n\t\t\txAxis.zoomToDates(from, to);\r\n\t\t\tthis._updateLabel();\r\n\t\t\tthis.set(\"active\", false);\r\n\r\n\t\t\tconst type = \"rangeselected\";\r\n\t\t\tif (this.events.isEnabled(type)) {\r\n\t\t\t\tthis.events.dispatch(type, {\r\n\t\t\t\t\ttype: type,\r\n\t\t\t\t\ttarget: this,\r\n\t\t\t\t\tfromDate: from,\r\n\t\t\t\t\ttoDate: to\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tconst cancelButton = document.createElement(\"input\");\r\n\t\tcancelButton.type = \"button\";\r\n\t\tcancelButton.value = this._root.language.translateAny(\"Cancel\");\r\n\t\tcancelButton.className = \"am5-modal-button am5-modal-scondary\";\r\n\t\tbuttonsColumn.appendChild(cancelButton);\r\n\r\n\t\tthis._disposers.push($utils.addEventListener(cancelButton, \"click\", () => {\r\n\t\t\tthis.set(\"active\", false);\r\n\t\t}));\r\n\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Calendar\");\r\n\t}\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\t}\r\n\r\n\tprotected _updateInputs(): void {\r\n\t\tconst xAxis = this._getAxis();\r\n\t\tconst min = xAxis.getPrivate(\"selectionMin\", 0);\r\n\t\tconst max = xAxis.getPrivate(\"selectionMax\", 0);\r\n\r\n\t\tif (!min || !max) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst from = new Date(min + 1);\r\n\t\tconst to = new Date(max - 1);\r\n\r\n\t\tthis.setPrivate(\"fromDate\", from);\r\n\t\tthis.setPrivate(\"toDate\", to);\r\n\r\n\t\tthis.getPrivate(\"fromField\").value = this._formatDate(from);\r\n\t\tthis.getPrivate(\"toField\").value = this._formatDate(to);\r\n\r\n\t\tconst fromPicker = this.getPrivate(\"fromPicker\");\r\n\t\tconst minDate = fromPicker.config.minDate;\r\n\t\tif (!minDate || (minDate <= from)) {\r\n\t\t\tfromPicker.setDate(from);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfromPicker.setDate(minDate);\r\n\t\t}\r\n\r\n\t\tconst toPicker = this.getPrivate(\"toPicker\");\r\n\t\tconst maxDate = toPicker.config.maxDate;\r\n\t\tif (!maxDate || (maxDate >= to)) {\r\n\t\t\ttoPicker.setDate(to);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttoPicker.setDate(maxDate);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updatePickers(): void {\r\n\t\tconst xAxis = this._getAxis();\r\n\r\n\t\tconst minDate = this.get(\"minDate\");\r\n\t\tconst maxDate = this.get(\"maxDate\");\r\n\t\tconst toPicker = this.getPrivate(\"toPicker\");\r\n\t\tconst fromPicker = this.getPrivate(\"fromPicker\");\r\n\r\n\t\tif (minDate == \"auto\") {\r\n\t\t\tconst min = xAxis.getPrivate(\"minFinal\");\r\n\t\t\tif (min) {\r\n\t\t\t\tfromPicker.set(\"minDate\", new Date(min + 1));\r\n\t\t\t\ttoPicker.set(\"minDate\", new Date(min + 1));\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (minDate instanceof Date) {\r\n\t\t\tfromPicker.set(\"minDate\", minDate);\r\n\t\t\ttoPicker.set(\"minDate\", minDate);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfromPicker.set(\"minDate\", undefined);\r\n\t\t\ttoPicker.set(\"minDate\", undefined);\r\n\t\t}\r\n\r\n\t\tif (maxDate == \"auto\") {\r\n\t\t\tconst max = xAxis.getPrivate(\"maxFinal\") - 1;\r\n\t\t\tif (max) {\r\n\t\t\t\tfromPicker.set(\"maxDate\", new Date(max));\r\n\t\t\t\ttoPicker.set(\"maxDate\", new Date(max));\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (maxDate instanceof Date) {\r\n\t\t\tfromPicker.set(\"maxDate\", maxDate);\r\n\t\t\ttoPicker.set(\"maxDate\", maxDate);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfromPicker.set(\"maxDate\", undefined);\r\n\t\t\ttoPicker.set(\"maxDate\", undefined);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateLabel(): void {\r\n\t\tconst from = this.getPrivate(\"fromDate\");\r\n\t\tconst to = this.getPrivate(\"toDate\");\r\n\t\tlet label = \"\";\r\n\t\tif (from && to) {\r\n\t\t\tlabel = this._formatDate(from) + \" -- \" + this._formatDate(to);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlabel = this._root.language.translateAny(\"Date Range\");\r\n\t\t}\r\n\t\tthis.set(\"name\", label);\r\n\t}\r\n\r\n\tprotected _formatDate(date: Date): string {\r\n\t\treturn this._root.dateFormatter.format(date, this._getDateFormat(), true);\r\n\t}\r\n\r\n\tprotected _parseDate(date: string): Date {\r\n\t\treturn this._root.dateFormatter.parse(date, this._getDateFormat());\r\n\t}\r\n\r\n\tprotected _getDateFormat(): string {\r\n\t\tconst format = this.get(\"dateFormat\", this._root.dateFormatter.get(\"dateFormat\"));\r\n\t\treturn $type.isString(format) ? format : \"MM/dd/yyyy\";\r\n\t}\r\n\r\n\tprotected _getAxis(): any {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst chart = stockChart.panels.getIndex(0)!;\r\n\t\tconst xAxis: any = chart.xAxes.getIndex(0)!;\r\n\t\treturn xAxis;\r\n\t}\r\n\r\n\tprotected _getPickerLocale(): any {\r\n\t\tconst l = this._root.language;\r\n\t\treturn {\r\n\t\t\tweekdays: {\r\n\t\t\t\tshorthand: [\r\n\t\t\t\t\tl.translate(\"Sun\"),\r\n\t\t\t\t\tl.translate(\"Mon\"),\r\n\t\t\t\t\tl.translate(\"Tue\"),\r\n\t\t\t\t\tl.translate(\"Wed\"),\r\n\t\t\t\t\tl.translate(\"Thu\"),\r\n\t\t\t\t\tl.translate(\"Fri\"),\r\n\t\t\t\t\tl.translate(\"Sat\")\r\n\t\t\t\t],\r\n\t\t\t\tlonghand: [\r\n\t\t\t\t\tl.translate(\"Sunday\"),\r\n\t\t\t\t\tl.translate(\"Monday\"),\r\n\t\t\t\t\tl.translate(\"Tuesday\"),\r\n\t\t\t\t\tl.translate(\"Wednesday\"),\r\n\t\t\t\t\tl.translate(\"Thursday\"),\r\n\t\t\t\t\tl.translate(\"Friday\"),\r\n\t\t\t\t\tl.translate(\"Saturday\"),\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\tmonths: {\r\n\t\t\t\tshorthand: [\r\n\t\t\t\t\tl.translate(\"Jan\"),\r\n\t\t\t\t\tl.translate(\"Feb\"),\r\n\t\t\t\t\tl.translate(\"Mar\"),\r\n\t\t\t\t\tl.translate(\"Apr\"),\r\n\t\t\t\t\tl.translate(\"May(short)\"),\r\n\t\t\t\t\tl.translate(\"Jun\"),\r\n\t\t\t\t\tl.translate(\"Jul\"),\r\n\t\t\t\t\tl.translate(\"Aug\"),\r\n\t\t\t\t\tl.translate(\"Sep\"),\r\n\t\t\t\t\tl.translate(\"Oct\"),\r\n\t\t\t\t\tl.translate(\"Nov\"),\r\n\t\t\t\t\tl.translate(\"Dec\"),\r\n\t\t\t\t],\r\n\t\t\t\tlonghand: [\r\n\t\t\t\t\tl.translate(\"January\"),\r\n\t\t\t\t\tl.translate(\"February\"),\r\n\t\t\t\t\tl.translate(\"March\"),\r\n\t\t\t\t\tl.translate(\"April\"),\r\n\t\t\t\t\tl.translate(\"May\"),\r\n\t\t\t\t\tl.translate(\"June\"),\r\n\t\t\t\t\tl.translate(\"July\"),\r\n\t\t\t\t\tl.translate(\"August\"),\r\n\t\t\t\t\tl.translate(\"September\"),\r\n\t\t\t\t\tl.translate(\"October\"),\r\n\t\t\t\t\tl.translate(\"November\"),\r\n\t\t\t\t\tl.translate(\"December\"),\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\tfirstDayOfWeek: l.translate(\"firstDayOfWeek\"),\r\n\t\t\tordinal: l.translateFunc(\"_dateOrd\"),\r\n\t\t\trangeSeparator: \" \" + l.translateAny(\"to\") + \" \",\r\n\t\t\tweekAbbreviation: l.translateAny(\"Wk\"),\r\n\t\t\tscrollTitle: l.translateAny(\"Scroll to increment\"),\r\n\t\t\ttoggleTitle: l.translateAny(\"Click to toggle\"),\r\n\t\t\tamPM: [l.translate(\"AM\"), l.translate(\"PM\")],\r\n\t\t\tyearAriaLabel: l.translateAny(\"Year\"),\r\n\t\t\tmonthAriaLabel: l.translateAny(\"Month\"),\r\n\t\t\thourAriaLabel: l.translateAny(\"Hour\"),\r\n\t\t\tminuteAriaLabel: l.translateAny(\"Minute\"),\r\n\t\t\ttime_24hr: true,\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Loads the default CSS.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tprotected _loadDefaultCSS(): void {\r\n\t\tconst ic = this._root.interfaceColors;\r\n\t\t//const active = ic.get(\"secondaryButton\")!.toCSS();\r\n\t\tconst primary = ic.get(\"primaryButton\")!.toCSS();\r\n\t\tconst primary2 = ic.get(\"primaryButtonHover\")!.toCSS();\r\n\t\tconst text = ic.get(\"text\")!.toCSS();\r\n\t\tconst border = ic.get(\"secondaryButtonActive\")!.toCSS();\r\n\t\tconst bg = ic.get(\"background\")!.toCSS();\r\n\r\n\t\tthis._disposers.push(new StyleSheet(null, `\r\n.flatpickr-calendar {\r\n  background: transparent;\r\n  opacity: 0;\r\n  display: none;\r\n  text-align: center;\r\n  visibility: hidden;\r\n  padding: 0;\r\n  -webkit-animation: none;\r\n          animation: none;\r\n  direction: ltr;\r\n  border: 0;\r\n  font-size: 12px;\r\n  line-height: 24px;\r\n  border-radius: 5px;\r\n  position: absolute;\r\n  width: 200px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  -ms-touch-action: manipulation;\r\n      touch-action: manipulation;\r\n  background: ${bg};\r\n  margin-top: 0.5em;\r\n}\r\n.flatpickr-calendar.open,\r\n.flatpickr-calendar.inline {\r\n  opacity: 1;\r\n  max-height: 640px;\r\n  visibility: visible;\r\n}\r\n.flatpickr-calendar.open {\r\n  display: inline-block;\r\n  z-index: 99999;\r\n}\r\n.flatpickr-calendar.animate.open {\r\n  -webkit-animation: fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);\r\n          animation: fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);\r\n}\r\n.flatpickr-calendar.inline {\r\n  display: block;\r\n  position: relative;\r\n  top: 2px;\r\n}\r\n.flatpickr-calendar.static {\r\n  position: absolute;\r\n  top: calc(100% + 2px);\r\n}\r\n.flatpickr-calendar.static.open {\r\n  z-index: 999;\r\n  display: block;\r\n}\r\n.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+1) .flatpickr-day.inRange:nth-child(7n+7) {\r\n  -webkit-box-shadow: none !important;\r\n          box-shadow: none !important;\r\n}\r\n.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+2) .flatpickr-day.inRange:nth-child(7n+1) {\r\n  -webkit-box-shadow: -2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;\r\n          box-shadow: -2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;\r\n}\r\n.flatpickr-calendar .hasWeeks .dayContainer,\r\n.flatpickr-calendar .hasTime .dayContainer {\r\n  border-bottom: 0;\r\n  border-bottom-right-radius: 0;\r\n  border-bottom-left-radius: 0;\r\n}\r\n.flatpickr-calendar .hasWeeks .dayContainer {\r\n  border-left: 0;\r\n}\r\n.flatpickr-calendar.hasTime .flatpickr-time {\r\n  height: 40px;\r\n  border-top: 1px solid ${border};\r\n}\r\n.flatpickr-calendar.noCalendar.hasTime .flatpickr-time {\r\n  height: auto;\r\n}\r\n.flatpickr-calendar:before,\r\n.flatpickr-calendar:after {\r\n  position: absolute;\r\n  display: block;\r\n  pointer-events: none;\r\n  border: solid transparent;\r\n  content: '';\r\n  height: 0;\r\n  width: 0;\r\n  left: 22px;\r\n}\r\n.flatpickr-calendar.rightMost:before,\r\n.flatpickr-calendar.arrowRight:before,\r\n.flatpickr-calendar.rightMost:after,\r\n.flatpickr-calendar.arrowRight:after {\r\n  left: auto;\r\n  right: 22px;\r\n}\r\n.flatpickr-calendar.arrowCenter:before,\r\n.flatpickr-calendar.arrowCenter:after {\r\n  left: 50%;\r\n  right: 50%;\r\n}\r\n.flatpickr-calendar:before {\r\n  border-width: 5px;\r\n  margin: 0 -5px;\r\n}\r\n.flatpickr-calendar:after {\r\n  border-width: 4px;\r\n  margin: 0 -4px;\r\n}\r\n.flatpickr-calendar.arrowTop:before,\r\n.flatpickr-calendar.arrowTop:after {\r\n  bottom: 100%;\r\n}\r\n.flatpickr-calendar.arrowTop:before {\r\n  border-bottom-color: ${border};\r\n}\r\n.flatpickr-calendar.arrowTop:after {\r\n  border-bottom-color: ${bg};\r\n}\r\n.flatpickr-calendar.arrowBottom:before,\r\n.flatpickr-calendar.arrowBottom:after {\r\n  top: 100%;\r\n}\r\n.flatpickr-calendar.arrowBottom:before {\r\n  border-top-color: ${border};\r\n}\r\n.flatpickr-calendar.arrowBottom:after {\r\n  border-top-color: ${bg};\r\n}\r\n.flatpickr-calendar:focus {\r\n  outline: 0;\r\n}\r\n.flatpickr-wrapper {\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n.flatpickr-months {\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n}\r\n.flatpickr-months .flatpickr-month {\r\n  background: transparent;\r\n  color: ${text};\r\n  fill: ${text};\r\n  height: 34px;\r\n  line-height: 1;\r\n  text-align: center;\r\n  position: relative;\r\n  -webkit-user-select: none;\r\n     -moz-user-select: none;\r\n      -ms-user-select: none;\r\n          user-select: none;\r\n  overflow: hidden;\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n}\r\n.flatpickr-months .flatpickr-prev-month,\r\n.flatpickr-months .flatpickr-next-month {\r\n  text-decoration: none;\r\n  cursor: pointer;\r\n  position: absolute;\r\n  top: 0;\r\n  height: 34px;\r\n  padding: 10px;\r\n  z-index: 3;\r\n  color: ${text};\r\n  fill: ${text};\r\n}\r\n.flatpickr-months .flatpickr-prev-month.flatpickr-disabled,\r\n.flatpickr-months .flatpickr-next-month.flatpickr-disabled {\r\n  display: none;\r\n}\r\n.flatpickr-months .flatpickr-prev-month i,\r\n.flatpickr-months .flatpickr-next-month i {\r\n  position: relative;\r\n}\r\n.flatpickr-months .flatpickr-prev-month.flatpickr-prev-month,\r\n.flatpickr-months .flatpickr-next-month.flatpickr-prev-month {\r\n/*\r\n      /*rtl:begin:ignore*/\r\n/*\r\n      */\r\n  left: 0;\r\n/*\r\n      /*rtl:end:ignore*/\r\n/*\r\n      */\r\n}\r\n/*\r\n      /*rtl:begin:ignore*/\r\n/*\r\n      /*rtl:end:ignore*/\r\n.flatpickr-months .flatpickr-prev-month.flatpickr-next-month,\r\n.flatpickr-months .flatpickr-next-month.flatpickr-next-month {\r\n/*\r\n      /*rtl:begin:ignore*/\r\n/*\r\n      */\r\n  right: 0;\r\n/*\r\n      /*rtl:end:ignore*/\r\n/*\r\n      */\r\n}\r\n/*\r\n      /*rtl:begin:ignore*/\r\n/*\r\n      /*rtl:end:ignore*/\r\n.flatpickr-months .flatpickr-prev-month:hover,\r\n.flatpickr-months .flatpickr-next-month:hover {\r\n  color: ${primary2};\r\n}\r\n.flatpickr-months .flatpickr-prev-month:hover svg,\r\n.flatpickr-months .flatpickr-next-month:hover svg {\r\n  fill: ${primary2};\r\n}\r\n.flatpickr-months .flatpickr-prev-month svg,\r\n.flatpickr-months .flatpickr-next-month svg {\r\n  width: 14px;\r\n  height: 14px;\r\n}\r\n.flatpickr-months .flatpickr-prev-month svg path,\r\n.flatpickr-months .flatpickr-next-month svg path {\r\n  -webkit-transition: fill 0.1s;\r\n  transition: fill 0.1s;\r\n  fill: inherit;\r\n}\r\n.numInputWrapper {\r\n  position: relative;\r\n  height: auto;\r\n}\r\n.numInputWrapper input,\r\n.numInputWrapper span {\r\n  display: inline-block;\r\n}\r\n.numInputWrapper input {\r\n  width: 100%;\r\n}\r\n.numInputWrapper input::-ms-clear {\r\n  display: none;\r\n}\r\n.numInputWrapper input::-webkit-outer-spin-button,\r\n.numInputWrapper input::-webkit-inner-spin-button {\r\n  margin: 0;\r\n  -webkit-appearance: none;\r\n}\r\n.numInputWrapper span {\r\n  position: absolute;\r\n  right: 0;\r\n  width: 14px;\r\n  padding: 0 4px 0 2px;\r\n  height: 50%;\r\n  line-height: 50%;\r\n  opacity: 0;\r\n  cursor: pointer;\r\n  border: 1px solid rgba(64,72,72,0.15);\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n}\r\n.numInputWrapper span:hover {\r\n  background: rgba(0,0,0,0.1);\r\n}\r\n.numInputWrapper span:active {\r\n  background: rgba(0,0,0,0.2);\r\n}\r\n.numInputWrapper span:after {\r\n  display: block;\r\n  content: \"\";\r\n  position: absolute;\r\n}\r\n.numInputWrapper span.arrowUp {\r\n  top: 0;\r\n  border-bottom: 0;\r\n}\r\n.numInputWrapper span.arrowUp:after {\r\n  border-left: 4px solid transparent;\r\n  border-right: 4px solid transparent;\r\n  border-bottom: 4px solid rgba(64,72,72,0.6);\r\n  top: 26%;\r\n}\r\n.numInputWrapper span.arrowDown {\r\n  top: 50%;\r\n}\r\n.numInputWrapper span.arrowDown:after {\r\n  border-left: 4px solid transparent;\r\n  border-right: 4px solid transparent;\r\n  border-top: 4px solid rgba(64,72,72,0.6);\r\n  top: 40%;\r\n}\r\n.numInputWrapper span svg {\r\n  width: inherit;\r\n  height: auto;\r\n}\r\n.numInputWrapper span svg path {\r\n  fill: rgba(60,63,64,0.5);\r\n}\r\n.numInputWrapper:hover {\r\n  background: rgba(0,0,0,0.05);\r\n}\r\n.numInputWrapper:hover span {\r\n  opacity: 1;\r\n}\r\n.flatpickr-current-month {\r\n  margin-top: 1px;\r\n  font-size: 125%;\r\n  line-height: inherit;\r\n  font-weight: 300;\r\n  color: inherit;\r\n  position: absolute;\r\n  width: 75%;\r\n  left: 12.5%;\r\n  padding: 7.48px 0 0 0;\r\n  line-height: 1;\r\n  height: 34px;\r\n  display: inline-block;\r\n  text-align: center;\r\n  -webkit-transform: translate3d(0px, 0px, 0px);\r\n          transform: translate3d(0px, 0px, 0px);\r\n}\r\n.flatpickr-current-month span.cur-month {\r\n  font-family: inherit;\r\n  font-weight: 700;\r\n  color: inherit;\r\n  display: inline-block;\r\n  margin-left: 0.5ch;\r\n  padding: 0;\r\n}\r\n.flatpickr-current-month span.cur-month:hover {\r\n  background: rgba(0,0,0,0.05);\r\n}\r\n.flatpickr-current-month .numInputWrapper {\r\n  width: 6ch;\r\n  width: 7ch\\\\0;\r\n  display: inline-block;\r\n}\r\n.flatpickr-current-month .numInputWrapper span.arrowUp:after {\r\n  border-bottom-color: ${text};\r\n}\r\n.flatpickr-current-month .numInputWrapper span.arrowDown:after {\r\n  border-top-color: ${text};\r\n}\r\n.flatpickr-current-month input.cur-year {\r\n  background: transparent;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  color: inherit;\r\n  cursor: text;\r\n  padding: 0 0 0 0.5ch;\r\n  margin: 0;\r\n  display: inline-block;\r\n  font-size: inherit;\r\n  font-family: inherit;\r\n  font-weight: 300;\r\n  line-height: inherit;\r\n  height: auto;\r\n  border: 0;\r\n  border-radius: 0;\r\n  vertical-align: initial;\r\n  -webkit-appearance: textfield;\r\n  -moz-appearance: textfield;\r\n  appearance: textfield;\r\n}\r\n.flatpickr-current-month input.cur-year:focus {\r\n  outline: 0;\r\n}\r\n.flatpickr-current-month input.cur-year[disabled],\r\n.flatpickr-current-month input.cur-year[disabled]:hover {\r\n  font-size: 100%;\r\n  color: rgba(60,63,64,0.5);\r\n  background: transparent;\r\n  pointer-events: none;\r\n}\r\n.flatpickr-current-month .flatpickr-monthDropdown-months {\r\n  appearance: menulist;\r\n  background: transparent;\r\n  border: none;\r\n  border-radius: 0;\r\n  box-sizing: border-box;\r\n  color: inherit;\r\n  cursor: pointer;\r\n  font-size: inherit;\r\n  font-family: inherit;\r\n  font-weight: 300;\r\n  height: auto;\r\n  line-height: inherit;\r\n  margin: -1px 0 0 0;\r\n  outline: none;\r\n  padding: 0 0 0 0.5ch;\r\n  position: relative;\r\n  vertical-align: initial;\r\n  -webkit-box-sizing: border-box;\r\n  -webkit-appearance: menulist;\r\n  -moz-appearance: menulist;\r\n  width: auto;\r\n  max-width: 93px;\r\n}\r\n.flatpickr-current-month .flatpickr-monthDropdown-months:focus,\r\n.flatpickr-current-month .flatpickr-monthDropdown-months:active {\r\n  outline: none;\r\n}\r\n.flatpickr-current-month .flatpickr-monthDropdown-months:hover {\r\n  background: rgba(0,0,0,0.05);\r\n}\r\n.flatpickr-current-month .flatpickr-monthDropdown-months .flatpickr-monthDropdown-month {\r\n  background-color: ${bg};\r\n  outline: none;\r\n  padding: 0;\r\n}\r\n.flatpickr-weekdays {\r\n  background: transparent;\r\n  text-align: center;\r\n  overflow: hidden;\r\n  width: 100%;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-align: center;\r\n  -webkit-align-items: center;\r\n      -ms-flex-align: center;\r\n          align-items: center;\r\n  height: 28px;\r\n}\r\n.flatpickr-weekdays .flatpickr-weekdaycontainer {\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n}\r\nspan.flatpickr-weekday {\r\n  cursor: default;\r\n  font-size: 90%;\r\n  background: transparent;\r\n  color: ${text};\r\n  line-height: 1;\r\n  margin: 0;\r\n  text-align: center;\r\n  display: block;\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n  font-weight: bolder;\r\n}\r\n.dayContainer,\r\n.flatpickr-weeks {\r\n  padding: 1px 0 0 0;\r\n}\r\n.flatpickr-days {\r\n  position: relative;\r\n  overflow: hidden;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-align: start;\r\n  -webkit-align-items: flex-start;\r\n      -ms-flex-align: start;\r\n          align-items: flex-start;\r\n  width: 200px;\r\n}\r\n.flatpickr-days:focus {\r\n  outline: 0;\r\n}\r\n.dayContainer {\r\n  padding: 0;\r\n  outline: 0;\r\n  text-align: left;\r\n  width: 200px;\r\n  min-width: 200px;\r\n  max-width: 200px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  display: inline-block;\r\n  display: -ms-flexbox;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: flex;\r\n  -webkit-flex-wrap: wrap;\r\n          flex-wrap: wrap;\r\n  -ms-flex-wrap: wrap;\r\n  -ms-flex-pack: justify;\r\n  -webkit-justify-content: space-around;\r\n          justify-content: space-around;\r\n  -webkit-transform: translate3d(0px, 0px, 0px);\r\n          transform: translate3d(0px, 0px, 0px);\r\n  opacity: 1;\r\n}\r\n.dayContainer + .dayContainer {\r\n  -webkit-box-shadow: -1px 0 0 ${border};\r\n          box-shadow: -1px 0 0 ${border};\r\n}\r\n.flatpickr-day {\r\n  background: none;\r\n  border: 1px solid transparent;\r\n  border-radius: 150px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  color: ${text};\r\n  cursor: pointer;\r\n  font-weight: 400;\r\n  width: 14.2857143%;\r\n  -webkit-flex-basis: 14.2857143%;\r\n      -ms-flex-preferred-size: 14.2857143%;\r\n          flex-basis: 14.2857143%;\r\n  max-width: 32px;\r\n  height: 32px;\r\n  line-height: 30px;\r\n  margin: 0;\r\n  display: inline-block;\r\n  position: relative;\r\n  -webkit-box-pack: center;\r\n  -webkit-justify-content: center;\r\n      -ms-flex-pack: center;\r\n          justify-content: center;\r\n  text-align: center;\r\n}\r\n.flatpickr-day.inRange,\r\n.flatpickr-day.prevMonthDay.inRange,\r\n.flatpickr-day.nextMonthDay.inRange,\r\n.flatpickr-day.today.inRange,\r\n.flatpickr-day.prevMonthDay.today.inRange,\r\n.flatpickr-day.nextMonthDay.today.inRange,\r\n.flatpickr-day:hover,\r\n.flatpickr-day.prevMonthDay:hover,\r\n.flatpickr-day.nextMonthDay:hover,\r\n.flatpickr-day:focus,\r\n.flatpickr-day.prevMonthDay:focus,\r\n.flatpickr-day.nextMonthDay:focus {\r\n  cursor: pointer;\r\n  outline: 0;\r\n  background: ${primary2};\r\n  border-color: ${primary2};\r\n}\r\n.flatpickr-day.today {\r\n  border-color: ${primary2};\r\n}\r\n.flatpickr-day.today:hover,\r\n.flatpickr-day.today:focus {\r\n  border-color: ${primary2};\r\n  background: ${primary2};\r\n  color: ${bg};\r\n}\r\n.flatpickr-day.selected,\r\n.flatpickr-day.startRange,\r\n.flatpickr-day.endRange,\r\n.flatpickr-day.selected.inRange,\r\n.flatpickr-day.startRange.inRange,\r\n.flatpickr-day.endRange.inRange,\r\n.flatpickr-day.selected:focus,\r\n.flatpickr-day.startRange:focus,\r\n.flatpickr-day.endRange:focus,\r\n.flatpickr-day.selected:hover,\r\n.flatpickr-day.startRange:hover,\r\n.flatpickr-day.endRange:hover,\r\n.flatpickr-day.selected.prevMonthDay,\r\n.flatpickr-day.startRange.prevMonthDay,\r\n.flatpickr-day.endRange.prevMonthDay,\r\n.flatpickr-day.selected.nextMonthDay,\r\n.flatpickr-day.startRange.nextMonthDay,\r\n.flatpickr-day.endRange.nextMonthDay {\r\n  background: ${primary};\r\n  -webkit-box-shadow: none;\r\n          box-shadow: none;\r\n  color: ${bg};\r\n  border-color: ${primary};\r\n}\r\n.flatpickr-day.selected.startRange,\r\n.flatpickr-day.startRange.startRange,\r\n.flatpickr-day.endRange.startRange {\r\n  border-radius: 50px 0 0 50px;\r\n}\r\n.flatpickr-day.selected.endRange,\r\n.flatpickr-day.startRange.endRange,\r\n.flatpickr-day.endRange.endRange {\r\n  border-radius: 0 50px 50px 0;\r\n}\r\n.flatpickr-day.selected.startRange + .endRange:not(:nth-child(7n+1)),\r\n.flatpickr-day.startRange.startRange + .endRange:not(:nth-child(7n+1)),\r\n.flatpickr-day.endRange.startRange + .endRange:not(:nth-child(7n+1)) {\r\n  -webkit-box-shadow: -10px 0 0 ${primary};\r\n          box-shadow: -10px 0 0 ${primary};\r\n}\r\n.flatpickr-day.selected.startRange.endRange,\r\n.flatpickr-day.startRange.startRange.endRange,\r\n.flatpickr-day.endRange.startRange.endRange {\r\n  border-radius: 50px;\r\n}\r\n.flatpickr-day.inRange {\r\n  border-radius: 0;\r\n  -webkit-box-shadow: -5px 0 0 ${primary2}, 5px 0 0 ${primary2};\r\n          box-shadow: -5px 0 0 ${primary2}, 5px 0 0 ${primary2};\r\n}\r\n.flatpickr-day.flatpickr-disabled,\r\n.flatpickr-day.flatpickr-disabled:hover,\r\n.flatpickr-day.prevMonthDay,\r\n.flatpickr-day.nextMonthDay,\r\n.flatpickr-day.notAllowed,\r\n.flatpickr-day.notAllowed.prevMonthDay,\r\n.flatpickr-day.notAllowed.nextMonthDay {\r\n  color: rgba(64,72,72,0.3);\r\n  background: transparent;\r\n  cursor: default;\r\n}\r\n.flatpickr-day.flatpickr-disabled,\r\n.flatpickr-day.flatpickr-disabled:hover {\r\n  cursor: not-allowed;\r\n  color: rgba(64,72,72,0.1);\r\n}\r\n.flatpickr-day.week.selected {\r\n  border-radius: 0;\r\n  -webkit-box-shadow: -5px 0 0 ${primary}, 5px 0 0 ${primary};\r\n          box-shadow: -5px 0 0 ${primary}, 5px 0 0 ${primary};\r\n}\r\n.flatpickr-day.hidden {\r\n  visibility: hidden;\r\n}\r\n.rangeMode .flatpickr-day {\r\n  margin-top: 1px;\r\n}\r\n.flatpickr-weekwrapper {\r\n  float: left;\r\n}\r\n.flatpickr-weekwrapper .flatpickr-weeks {\r\n  padding: 0 12px;\r\n  -webkit-box-shadow: 1px 0 0 ${border};\r\n          box-shadow: 1px 0 0 ${border};\r\n}\r\n.flatpickr-weekwrapper .flatpickr-weekday {\r\n  float: none;\r\n  width: 100%;\r\n  line-height: 28px;\r\n}\r\n.flatpickr-weekwrapper span.flatpickr-day,\r\n.flatpickr-weekwrapper span.flatpickr-day:hover {\r\n  display: block;\r\n  width: 100%;\r\n  max-width: none;\r\n  color: rgba(64,72,72,0.3);\r\n  background: transparent;\r\n  cursor: default;\r\n  border: none;\r\n}\r\n.flatpickr-innerContainer {\r\n  display: block;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  overflow: hidden;\r\n}\r\n.flatpickr-rContainer {\r\n  display: inline-block;\r\n  padding: 0;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n}\r\n.flatpickr-time {\r\n  text-align: center;\r\n  outline: 0;\r\n  display: block;\r\n  height: 0;\r\n  line-height: 40px;\r\n  max-height: 40px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  overflow: hidden;\r\n  display: -webkit-box;\r\n  display: -webkit-flex;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n}\r\n.flatpickr-time:after {\r\n  content: \"\";\r\n  display: table;\r\n  clear: both;\r\n}\r\n.flatpickr-time .numInputWrapper {\r\n  -webkit-box-flex: 1;\r\n  -webkit-flex: 1;\r\n      -ms-flex: 1;\r\n          flex: 1;\r\n  width: 40%;\r\n  height: 40px;\r\n  float: left;\r\n}\r\n.flatpickr-time .numInputWrapper span.arrowUp:after {\r\n  border-bottom-color: ${text};\r\n}\r\n.flatpickr-time .numInputWrapper span.arrowDown:after {\r\n  border-top-color: ${text};\r\n}\r\n.flatpickr-time.hasSeconds .numInputWrapper {\r\n  width: 26%;\r\n}\r\n.flatpickr-time.time24hr .numInputWrapper {\r\n  width: 49%;\r\n}\r\n.flatpickr-time input {\r\n  background: transparent;\r\n  -webkit-box-shadow: none;\r\n          box-shadow: none;\r\n  border: 0;\r\n  border-radius: 0;\r\n  text-align: center;\r\n  margin: 0;\r\n  padding: 0;\r\n  height: inherit;\r\n  line-height: inherit;\r\n  color: ${text};\r\n  font-size: 14px;\r\n  position: relative;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  -webkit-appearance: textfield;\r\n  -moz-appearance: textfield;\r\n  appearance: textfield;\r\n}\r\n.flatpickr-time input.flatpickr-hour {\r\n  font-weight: bold;\r\n}\r\n.flatpickr-time input.flatpickr-minute,\r\n.flatpickr-time input.flatpickr-second {\r\n  font-weight: 400;\r\n}\r\n.flatpickr-time input:focus {\r\n  outline: 0;\r\n  border: 0;\r\n}\r\n.flatpickr-time .flatpickr-time-separator,\r\n.flatpickr-time .flatpickr-am-pm {\r\n  height: inherit;\r\n  float: left;\r\n  line-height: inherit;\r\n  color: ${text};\r\n  font-weight: bold;\r\n  width: 2%;\r\n  -webkit-user-select: none;\r\n     -moz-user-select: none;\r\n      -ms-user-select: none;\r\n          user-select: none;\r\n  -webkit-align-self: center;\r\n      -ms-flex-item-align: center;\r\n          align-self: center;\r\n}\r\n.flatpickr-time .flatpickr-am-pm {\r\n  outline: 0;\r\n  width: 18%;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  font-weight: 400;\r\n}\r\n.flatpickr-time input:hover,\r\n.flatpickr-time .flatpickr-am-pm:hover,\r\n.flatpickr-time input:focus,\r\n.flatpickr-time .flatpickr-am-pm:focus {\r\n  background: #f1f1f1;\r\n}\r\n.flatpickr-input[readonly] {\r\n  cursor: pointer;\r\n}\r\n@-webkit-keyframes fpFadeInDown {\r\n  from {\r\n    opacity: 0;\r\n    -webkit-transform: translate3d(0, -20px, 0);\r\n            transform: translate3d(0, -20px, 0);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    -webkit-transform: translate3d(0, 0, 0);\r\n            transform: translate3d(0, 0, 0);\r\n  }\r\n}\r\n@keyframes fpFadeInDown {\r\n  from {\r\n    opacity: 0;\r\n    -webkit-transform: translate3d(0, -20px, 0);\r\n            transform: translate3d(0, -20px, 0);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    -webkit-transform: translate3d(0, 0, 0);\r\n            transform: translate3d(0, 0, 0);\r\n  }\r\n}\r\n.flatpickr-calendar {\r\n  width: 200px;\r\n}\r\n.dayContainer {\r\n  padding: 0;\r\n  border-right: 0;\r\n}\r\nspan.flatpickr-day,\r\nspan.flatpickr-day.prevMonthDay,\r\nspan.flatpickr-day.nextMonthDay {\r\n  border-radius: 0 !important;\r\n  border: 1px solid ${primary2};\r\n  max-width: none;\r\n  border-right-color: transparent;\r\n}\r\nspan.flatpickr-day:nth-child(n+8),\r\nspan.flatpickr-day.prevMonthDay:nth-child(n+8),\r\nspan.flatpickr-day.nextMonthDay:nth-child(n+8) {\r\n  border-top-color: transparent;\r\n}\r\nspan.flatpickr-day:nth-child(7n-6),\r\nspan.flatpickr-day.prevMonthDay:nth-child(7n-6),\r\nspan.flatpickr-day.nextMonthDay:nth-child(7n-6) {\r\n  border-left: 0;\r\n}\r\nspan.flatpickr-day:nth-child(n+36),\r\nspan.flatpickr-day.prevMonthDay:nth-child(n+36),\r\nspan.flatpickr-day.nextMonthDay:nth-child(n+36) {\r\n  border-bottom: 0;\r\n}\r\nspan.flatpickr-day:nth-child(-n+7),\r\nspan.flatpickr-day.prevMonthDay:nth-child(-n+7),\r\nspan.flatpickr-day.nextMonthDay:nth-child(-n+7) {\r\n  margin-top: 0;\r\n}\r\nspan.flatpickr-day.today:not(.selected),\r\nspan.flatpickr-day.prevMonthDay.today:not(.selected),\r\nspan.flatpickr-day.nextMonthDay.today:not(.selected) {\r\n  border-color: ${primary2};\r\n  border-right-color: transparent;\r\n  border-top-color: transparent;\r\n  border-bottom-color: ${primary2};\r\n}\r\nspan.flatpickr-day.today:not(.selected):hover,\r\nspan.flatpickr-day.prevMonthDay.today:not(.selected):hover,\r\nspan.flatpickr-day.nextMonthDay.today:not(.selected):hover {\r\n  border: 1px solid ${primary2};\r\n}\r\nspan.flatpickr-day.startRange,\r\nspan.flatpickr-day.prevMonthDay.startRange,\r\nspan.flatpickr-day.nextMonthDay.startRange,\r\nspan.flatpickr-day.endRange,\r\nspan.flatpickr-day.prevMonthDay.endRange,\r\nspan.flatpickr-day.nextMonthDay.endRange {\r\n  border-color: ${primary};\r\n}\r\nspan.flatpickr-day.today,\r\nspan.flatpickr-day.prevMonthDay.today,\r\nspan.flatpickr-day.nextMonthDay.today,\r\nspan.flatpickr-day.selected,\r\nspan.flatpickr-day.prevMonthDay.selected,\r\nspan.flatpickr-day.nextMonthDay.selected {\r\n  z-index: 2;\r\n}\r\n.rangeMode .flatpickr-day {\r\n  margin-top: -1px;\r\n}\r\n.flatpickr-weekwrapper .flatpickr-weeks {\r\n  -webkit-box-shadow: none;\r\n          box-shadow: none;\r\n}\r\n.flatpickr-weekwrapper span.flatpickr-day {\r\n  border: 0;\r\n  margin: -1px 0 0 -1px;\r\n}\r\n.hasWeeks .flatpickr-days {\r\n  border-right: 0;\r\n}\r\n\r\n\t@media screen and (min-width:0\\\\0) and (min-resolution: +72dpi) {\r\n\t\tspan.flatpickr-day {\r\n\t\t\tdisplay: block;\r\n\t\t\t-webkit-box-flex: 1;\r\n\t\t\t-webkit-flex: 1 0 auto;\r\n\t\t\t    -ms-flex: 1 0 auto;\r\n\t\t\t        flex: 1 0 auto;\r\n\t\t}\r\n\t}\r\n\t\t`, this._root.nonce));\r\n\t}\r\n\r\n}","import type { TimeUnit } from \"../../../core/util/Time\"\r\nimport type { DateAxis } from \"../../xy/axes/DateAxis\";\r\nimport type { AxisRenderer } from \"../../xy/axes/AxisRenderer\";\r\n\r\nimport { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { MultiDisposer, IDisposer } from \"../../../core/util/Disposer\";\r\n\r\nimport * as $utils from \"../../../core/util/Utils\";\r\nimport * as $time from \"../../../core/util/Time\";\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IPeriod {\r\n\ttimeUnit: TimeUnit | \"ytd\" | \"max\" | \"custom\";\r\n\tcount?: number;\r\n\tname?: string;\r\n\tstart?: Date;\r\n\tend?: Date;\r\n}\r\n\r\nexport interface IPeriodSelectorSettings extends IStockControlSettings {\r\n\r\n\t/**\r\n\t * A list periods to choose from.\r\n\t */\r\n\tperiods?: IPeriod[];\r\n\r\n\t/**\r\n\t * Hide periods that are longer than the actual data.\r\n\t *\r\n\t * @default false\r\n\t * @since 5.3.9\r\n\t */\r\n\thideLongPeriods?: boolean;\r\n\r\n\t/**\r\n\t * Indicates whether to select periods from the start or end of the axis\r\n\t * scale.\r\n\t *\r\n\t * @default \"end\"\r\n\t * @since 5.5.0\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/period-selector/#Zoom_anchor_point} for more info\r\n\t */\r\n\tzoomTo?: \"end\" | \"start\";\r\n\r\n}\r\n\r\nexport interface IPeriodSelectorPrivate extends IStockControlPrivate {\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\taxis?: DateAxis<AxisRenderer>;\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tdeferReset?: boolean;\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tdeferTimeout?: IDisposer;\r\n\r\n}\r\n\r\nexport interface IPeriodSelectorEvents extends IStockControlEvents {\r\n\t/**\r\n\t * Invoked when user selects certain period via control.\r\n\t *\r\n\t * @from 5.8.5\r\n\t */\r\n\tperiodselected: {\r\n\t\tperiod: IPeriod;\r\n\t}\r\n}\r\n\r\n/**\r\n * A pre-defined period selector control for [[StockToolback]].\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/period-selector/} for more info\r\n */\r\nexport class PeriodSelector extends StockControl {\r\n\tpublic static className: string = \"PeriodSelector\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([PeriodSelector.className]);\r\n\r\n\tdeclare public _settings: IPeriodSelectorSettings;\r\n\tdeclare public _privateSettings: IPeriodSelectorPrivate;\r\n\tdeclare public _events: IPeriodSelectorEvents;\r\n\r\n\tprotected _groupChangedDp: IDisposer | undefined;\r\n\tprotected _groupChangedTo: IDisposer | undefined;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tbutton.className = button.className + \" am5stock-no-hover\";\r\n\r\n\t\tthis._initPeriodButtons();\r\n\t}\r\n\r\n\tprotected _initPeriodButtons(): void {\r\n\t\tconst container = this.getPrivate(\"label\")!;\r\n\t\tcontainer.style.display = \"\";\r\n\r\n\t\tconst periods = this.get(\"periods\", []);\r\n\t\tconst axis = this._getAxis();\r\n\t\taxis.onPrivate(\"min\", () => this._setPeriodButtonStatus());\r\n\t\taxis.onPrivate(\"max\", () => this._setPeriodButtonStatus());\r\n\t\t$array.each(periods, (period) => {\r\n\t\t\tconst button = document.createElement(\"a\");\r\n\t\t\tbutton.innerHTML = period.name || (period.timeUnit.toUpperCase() + period.count || \"1\");\r\n\t\t\tbutton.className = \"am5stock-link\";\r\n\t\t\tbutton.setAttribute(\"data-period\", period.timeUnit + (period.count || \"\"));\r\n\t\t\tcontainer.appendChild(button);\r\n\r\n\t\t\tthis._disposers.push($utils.addEventListener(button, \"click\", (_ev) => {\r\n\t\t\t\tthis.setPrivate(\"deferReset\", false);\r\n\t\t\t\tthis._resetActiveButtons();\r\n\t\t\t\tthis.selectPeriod(period);\r\n\t\t\t\tthis.setPrivate(\"deferReset\", true);\r\n\t\t\t\t$utils.addClass(button, \"am5stock-active\");\r\n\t\t\t\tconst timeout = this.getPrivate(\"deferTimeout\");\r\n\t\t\t\tif (timeout) {\r\n\t\t\t\t\ttimeout.dispose();\r\n\t\t\t\t}\r\n\t\t\t\tthis.setPrivate(\"deferTimeout\", this.setTimeout(() => this.setPrivate(\"deferReset\", false), axis.get(\"interpolationDuration\", 1000) + 200));\r\n\t\t\t}));\r\n\t\t});\r\n\r\n\t\tif ($utils.supports(\"keyboardevents\")) {\r\n\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\r\n\t\t\t\tif (this.isAccessible()) {\r\n\t\t\t\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\t\t\t\tif (document.activeElement && (document.activeElement === button || $utils.contains(button, document.activeElement))) {\r\n\t\t\t\t\t\tif ([37, 38, 39, 40].indexOf(ev.keyCode) !== -1) {\r\n\t\t\t\t\t\t\tconst dir = ev.keyCode == 37 || ev.keyCode == 38 ? -1 : 1;\r\n\t\t\t\t\t\t\tconst items = this._getPeriodButtons();\r\n\t\t\t\t\t\t\tconst selected = container.querySelectorAll(\".am5stock-link:focus\");\r\n\t\t\t\t\t\t\tlet index: number = -1;\r\n\t\t\t\t\t\t\tif (selected.length > 0) {\r\n\t\t\t\t\t\t\t\t//index = items.entries().indexOf(selected.item(0));\r\n\t\t\t\t\t\t\t\titems.forEach((item, key) => {\r\n\t\t\t\t\t\t\t\t\tif (item === selected.item(0)) {\r\n\t\t\t\t\t\t\t\t\t\tindex = key;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tindex += dir;\r\n\t\t\t\t\t\t\tif (index < 0) {\r\n\t\t\t\t\t\t\t\tindex = items.length - 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (index >= items.length) {\r\n\t\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$utils.focus(items.item(index) as HTMLElement);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (ev.keyCode == 13) {\r\n\t\t\t\t\t\t\t// ENTER\r\n\t\t\t\t\t\t\t(document.activeElement as HTMLElement).click();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\tthis._maybeMakeAccessible();\r\n\r\n\t}\r\n\r\n\tprotected _resetActiveButtons(): void {\r\n\t\tif (this.getPrivate(\"deferReset\") !== true) {\r\n\t\t\tconst container = this.getPrivate(\"label\")!;\r\n\t\t\tconst buttons = container.getElementsByClassName(\"am5stock-active\");\r\n\t\t\t$array.each(buttons, (b) => {\r\n\t\t\t\t$utils.removeClass(<HTMLElement>b, \"am5stock-active\");\r\n\t\t\t});\r\n\r\n\t\t\tlet axis = this.getPrivate(\"axis\");\r\n\t\t\tif (!axis) {\r\n\t\t\t\taxis = this._getAxis();\r\n\t\t\t\tthis.setPrivate(\"axis\", axis);\r\n\t\t\t\tthis._disposers.push(new MultiDisposer([\r\n\t\t\t\t\taxis!.on(\"start\", () => this._resetActiveButtons()),\r\n\t\t\t\t\taxis!.on(\"end\", () => this._resetActiveButtons())\r\n\t\t\t\t]));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setPeriodButtonStatus(): void {\r\n\t\tif (this.get(\"hideLongPeriods\")) {\r\n\t\t\tlet axis = this.getPrivate(\"axis\");\r\n\t\t\tconst container = this.getPrivate(\"label\")!;\r\n\t\t\tconst buttons = container.getElementsByTagName(\"a\");\r\n\t\t\tif (!axis) {\r\n\t\t\t\taxis = this._getAxis();\r\n\t\t\t\tconst min = axis!.getPrivate(\"min\", 0);\r\n\t\t\t\tconst max = axis!.getPrivate(\"max\", 0);\r\n\t\t\t\tif (min && max) {\r\n\t\t\t\t\tconst diff = max - min;\r\n\t\t\t\t\tconst periods = this.get(\"periods\", []);\r\n\t\t\t\t\t$array.each(periods, (period) => {\r\n\t\t\t\t\t\tif (period.timeUnit !== \"ytd\" && period.timeUnit !== \"max\") {\r\n\t\t\t\t\t\t\tconst plen = $time.getDuration(period.timeUnit as TimeUnit, period.count || 1);\r\n\t\t\t\t\t\t\tconst id = period.timeUnit + (period.count || \"\");\r\n\t\t\t\t\t\t\tfor (let i = 0; i < buttons.length; i++) {\r\n\t\t\t\t\t\t\t\tconst button = buttons[i];\r\n\t\t\t\t\t\t\t\tif (button.getAttribute(\"data-period\") == id) {\r\n\t\t\t\t\t\t\t\t\tif (plen > diff) {\r\n\t\t\t\t\t\t\t\t\t\t$utils.addClass(button, \"am5stock-hidden\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t$utils.removeClass(button, \"am5stock-hidden\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// protected _getDefaultIcon(): SVGElement {\r\n\t// \treturn StockIcons.getIcon(\"Period\");\r\n\t// }\r\n\r\n\tpublic _afterChanged() {\r\n\t\tsuper._afterChanged();\r\n\t\tif (this.isPrivateDirty(\"toolbar\")) {\r\n\t\t\tthis._maybeMakeAccessible();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getChart(): any {\r\n\t\treturn this.get(\"stockChart\").panels.getIndex(0)!;\r\n\t}\r\n\r\n\tprotected _getAxis(): any {\r\n\t\treturn this._getChart().xAxes.getIndex(0)!;\r\n\t}\r\n\r\n\tprotected _getMaxOrMax(which: \"min\" | \"max\"): Date {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst series = stockChart.get(\"stockSeries\");\r\n\t\tconst axis = this._getAxis();\r\n\t\tlet val = axis.getPrivate(which);\r\n\t\tif (series && (series.dataItems.length > 0)) {\r\n\t\t\t// Get last data item\r\n\t\t\tlet baseInterval = axis.get(\"baseInterval\");\r\n\t\t\tlet mainDataSetId: string = baseInterval.timeUnit + baseInterval.count;\r\n\t\t\tconst dataSet = series._dataSets[mainDataSetId] || series.dataItems;\r\n\t\t\tconst dataItem = dataSet[which == \"min\" ? 0 : dataSet.length - 1];\r\n\t\t\tif (which == \"min\" && dataItem.open !== undefined && dataItem.open[\"valueX\"] !== undefined) {\r\n\t\t\t\tval = dataItem.open[\"valueX\"];\r\n\t\t\t}\r\n\t\t\telse if (which == \"max\" && dataItem.close !== undefined && dataItem.close[\"valueX\"] !== undefined) {\r\n\t\t\t\tval = dataItem.close[\"valueX\"] - 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn new Date(val);\r\n\t}\r\n\r\n\r\n\tprotected _getMax(): Date {\r\n\t\treturn this._getMaxOrMax(\"max\");\r\n\t}\r\n\r\n\tprotected _getMin(): Date {\r\n\t\treturn this._getMaxOrMax(\"min\");\r\n\t}\r\n\r\n\tpublic selectPeriod(period: IPeriod): void {\r\n\t\tconst type = \"periodselected\";\r\n\t\tif (this.events.isEnabled(type)) {\r\n\t\t\tthis.events.dispatch(type, {\r\n\t\t\t\ttype: type,\r\n\t\t\t\ttarget: this,\r\n\t\t\t\tperiod: period\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst fromStart = this.get(\"zoomTo\", \"end\") == \"start\";\r\n\t\tthis._highlightPeriod(period);\r\n\t\tif (period.timeUnit == \"max\") {\r\n\t\t\tthis._getChart().zoomOut();\r\n\t\t}\r\n\t\telse if (period.timeUnit == \"custom\") {\r\n\t\t\tconst axis = this._getAxis();\r\n\t\t\tlet start = period.start || this._getMin();\r\n\t\t\tlet end = period.end || this._getMax();\r\n\t\t\taxis.zoomToDates(start, end);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst axis = this._getAxis();\r\n\t\t\tlet end = this._getMax();\r\n\t\t\tlet start: Date;\r\n\t\t\tif (period.timeUnit == \"ytd\") {\r\n\t\t\t\tstart = new Date(end.getFullYear(), 0, 1, 0, 0, 0, 0);\r\n\t\t\t\t//end = new Date(axis.getIntervalMax(axis.get(\"baseInterval\")));\r\n\t\t\t\tend = this._getMax();\r\n\t\t\t\tif (axis.get(\"groupData\")) {\r\n\t\t\t\t\taxis.zoomToDates(start, end, 0);\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\taxis.zoomToDates(start, end, 0);\r\n\t\t\t\t\t}, 10);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst timeUnit = period.timeUnit as TimeUnit;\r\n\t\t\t\t// some adjustments in case data is grouped\r\n\t\t\t\tif (axis.get(\"groupData\")) {\r\n\t\t\t\t\t// find interval which will be used after zoom\r\n\t\t\t\t\tconst interval = axis.getGroupInterval($time.getDuration(timeUnit, period.count))\r\n\t\t\t\t\tif (interval) {\r\n\r\n\t\t\t\t\t\tconst firstDay = this._root.locale.firstDayOfWeek;\r\n\t\t\t\t\t\tconst timezone = this._root.timezone;\r\n\t\t\t\t\t\tconst utc = this._root.utc;\r\n\r\n\t\t\t\t\t\tif (fromStart) {\r\n\t\t\t\t\t\t\tstart = this._getMin();\r\n\t\t\t\t\t\t\t//let startTime = axis.getIntervalMin(axis.get(\"baseInterval\"));\r\n\t\t\t\t\t\t\tlet startTime = start.getTime();\r\n\r\n\t\t\t\t\t\t\tif (startTime != null) {\r\n\t\t\t\t\t\t\t\t// round to the previuous interval\r\n\t\t\t\t\t\t\t\tstart = $time.round(new Date(startTime), interval.timeUnit, interval.count, firstDay, utc, undefined, timezone);\r\n\t\t\t\t\t\t\t\tstart.setTime(start.getTime() + $time.getDuration(interval.timeUnit, interval.count * .95));\r\n\t\t\t\t\t\t\t\tstart = $time.round(start, interval.timeUnit, interval.count, firstDay, utc, undefined, timezone);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tend = $time.add(new Date(start), timeUnit, (period.count || 1));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t// find max of the base interval\r\n\t\t\t\t\t\t\t//let endTime = axis.getIntervalMax(axis.get(\"baseInterval\"));\r\n\t\t\t\t\t\t\tlet endTime = this._getMax().getTime();\r\n\r\n\t\t\t\t\t\t\tif (endTime != null) {\r\n\t\t\t\t\t\t\t\t// round to the future interval\r\n\t\t\t\t\t\t\t\tend = $time.round(new Date(endTime), interval.timeUnit, interval.count, firstDay, utc, undefined, timezone);\r\n\t\t\t\t\t\t\t\tend.setTime(end.getTime() + $time.getDuration(interval.timeUnit, interval.count * 1.05));\r\n\t\t\t\t\t\t\t\tend = $time.round(end, interval.timeUnit, interval.count, firstDay, utc, undefined, timezone);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tstart = $time.add(new Date(end), timeUnit, (period.count || 1) * -1);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._groupChangedDp) {\r\n\t\t\t\t\t\t\tthis._groupChangedDp.dispose();\r\n\t\t\t\t\t\t\tthis._groupChangedDp = undefined;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._groupChangedTo) {\r\n\t\t\t\t\t\t\tthis._groupChangedTo.dispose();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis._groupChangedDp = axis.events.once(\"groupintervalchanged\", () => {\r\n\t\t\t\t\t\t\taxis.zoomToDates(start, end, 0);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\taxis.zoomToDates(start, end, 0);\r\n\r\n\t\t\t\t\t\tthis._groupChangedTo = this.setTimeout(() => {\r\n\t\t\t\t\t\t\tif (this._groupChangedDp) {\r\n\t\t\t\t\t\t\t\tthis._groupChangedDp.dispose();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis._groupChangedTo = undefined;\r\n\t\t\t\t\t\t}, 500);\r\n\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (fromStart) {\r\n\t\t\t\t\tstart = this._getMin();\r\n\t\t\t\t\tend = $time.add(new Date(start), timeUnit, (period.count || 1));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tstart = $time.add(new Date(end), timeUnit, (period.count || 1) * -1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\taxis.zoomToDates(start, end);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _highlightPeriod(period: IPeriod): void {\r\n\t\tconst id = period.timeUnit + (period.count || \"\");\r\n\t\tconst container = this.getPrivate(\"label\")!;\r\n\t\tconst buttons = container.getElementsByTagName(\"a\");\r\n\t\tfor (let i = 0; i < buttons.length; i++) {\r\n\t\t\tconst button = buttons[i];\r\n\t\t\tif (button.getAttribute(\"data-period\") == id && id != \"custom\") {\r\n\t\t\t\t$utils.addClass(button, \"am5stock-active\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$utils.removeClass(button, \"am5stock-active\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _maybeMakeAccessible(): void {\r\n\t\tsuper._maybeMakeAccessible();\r\n\t\tif (this.isAccessible()) {\r\n\t\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\t\tbutton.setAttribute(\"aria-label\", button.getAttribute(\"title\") + \"; \" + this._t(\"Press ENTER or use arrow keys to navigate\"));\r\n\t\t\tconst items = this._getPeriodButtons();\r\n\t\t\titems.forEach((item) => {\r\n\t\t\t\t(item as HTMLElement).setAttribute(\"tabindex\", \"-1\");\r\n\t\t\t\t(item as HTMLElement).setAttribute(\"aria-label\", (item as HTMLElement).getAttribute(\"title\") || \"\");\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getPeriodButtons(): NodeList {\r\n\t\treturn this.getPrivate(\"label\")!.querySelectorAll(\".am5stock-link\");\r\n\t}\r\n\r\n}","import { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\n\r\nexport interface ISeriesTypeControlSettings extends IDropdownListControlSettings {\r\n}\r\n\r\nexport interface ISeriesTypeControlPrivate extends IDropdownListControlPrivate {\r\n}\r\n\r\nexport interface ISeriesTypeControlEvents extends IDropdownListControlEvents {\r\n}\r\n\r\n/**\r\n * A control that is used to change type of the main series of the [[StockChart]].\r\n */\r\nexport class SeriesTypeControl extends DropdownListControl {\r\n\tpublic static className: string = \"SeriesTypeControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([SeriesTypeControl.className]);\r\n\r\n\tdeclare public _settings: ISeriesTypeControlSettings;\r\n\tdeclare public _privateSettings: ISeriesTypeControlPrivate;\r\n\tdeclare public _events: ISeriesTypeControlEvents;\r\n\r\n}","import type { IDropdownListItem } from \"./DropdownList\";\r\nimport type { TimeUnit } from \"../../../core/util/Time\";\r\n\r\nimport { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nexport interface IIntervalControlItem extends IDropdownListItem {\r\n\tinterval: {\r\n\t\ttimeUnit: TimeUnit,\r\n\t\tcount?: number\r\n\t};\r\n}\r\n\r\nexport interface IIntervalControlSettings extends IDropdownListControlSettings {\r\n\tcurrentItem?: string | IIntervalControlItem;\r\n\titems?: Array<string | IIntervalControlItem>;\r\n}\r\n\r\nexport interface IIntervalControlPrivate extends IDropdownListControlPrivate {\r\n}\r\n\r\nexport interface IIntervalControlEvents extends IDropdownListControlEvents {\r\n}\r\n\r\n/**\r\n * A control that is used to change type of the main series of the [[StockChart]].\r\n */\r\nexport class IntervalControl extends DropdownListControl {\r\n\tpublic static className: string = \"IntervalControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([IntervalControl.className]);\r\n\r\n\tdeclare public _settings: IIntervalControlSettings;\r\n\tdeclare public _privateSettings: IIntervalControlPrivate;\r\n\tdeclare public _events: IIntervalControlEvents;\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Interval\");\r\n\t}\r\n\r\n}","import { StockControl, IStockControlSettings, IStockControlPrivate, IStockControlEvents } from \"./StockControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nexport interface IResetControlSettings extends IStockControlSettings {\r\n}\r\n\r\nexport interface IResetControlPrivate extends IStockControlPrivate {\r\n}\r\n\r\nexport interface IResetControlEvents extends IStockControlEvents {\r\n}\r\n\r\n/**\r\n * Reset control.\r\n *\r\n * Removes all drawings and indicators when clicked.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/reset-control/} for more info\r\n */\r\nexport class ResetControl extends StockControl {\r\n\tpublic static className: string = \"ResetControl\";\r\n\tpublic static classNames: Array<string> = StockControl.classNames.concat([ResetControl.className]);\r\n\r\n\tdeclare public _settings: IResetControlSettings;\r\n\tdeclare public _privateSettings: IResetControlPrivate;\r\n\tdeclare public _events: IResetControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.events.on(\"click\", () => {\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tstockChart.panels.each((panel) => {\r\n\t\t\t\tpanel.drawings.each((drawing) => {\r\n\t\t\t\t\tdrawing.data.clear();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tstockChart.indicators.clear();\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Reset\");\r\n\t}\r\n\r\n}","import type { IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\nimport { DrawingControl } from \"./DrawingControl\";\r\nimport { IndicatorControl } from \"./IndicatorControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface IDataSaveControlItem extends IDropdownListItem {\r\n}\r\n\r\nexport interface IDataSaveControlSettings extends IDropdownListControlSettings {\r\n\t/**\r\n\t * If set to `true`, all changes to chart's drawings and indicators will be\r\n\t * automatically saved to browser local storage and restored on next load.\r\n\t *\r\n\t * @default false\r\n\t */\r\n\tautoSave?: boolean;\r\n\r\n\t/**\r\n\t * A unique indentifier for local storage.\r\n\t *\r\n\t * Will try to use chart's container ID if not set.\r\n\t *\r\n\t * Consider setting it if you have multipl [[StockChart]] on the same page.\r\n\t */\r\n\tstorageId?: string;\r\n}\r\n\r\nexport interface IDataSaveControlPrivate extends IDropdownListControlPrivate {\r\n\tdrawingControl?: DrawingControl;\r\n\tindicatorControl?: IndicatorControl;\r\n\tstorageId?: string;\r\n}\r\n\r\nexport interface IDataSaveControlEvents extends IDropdownListControlEvents {\r\n\r\n\t/**\r\n\t * Invoked when drawing/indicator data is serialized and saved to local\r\n\t * storage.\r\n\t */\r\n\tsaved: {\r\n\t\tdrawings: string;\r\n\t\tindicators: string;\r\n\t};\r\n\r\n\t/**\r\n\t * Invoked when drawing/indicator data is loaded from local storage and\r\n\t * restored on chart.\r\n\t */\r\n\trestored: {\r\n\t\tdrawings: string;\r\n\t\tindicators: string;\r\n\t};\r\n\r\n\t/**\r\n\t * Invoked when local storage is cleared.\r\n\t */\r\n\tcleared: {};\r\n\r\n}\r\n\r\n/**\r\n * A control that can be used to serialize indicators and drawings, save them\r\n * to local storage, and restore as needed.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/stock/toolbar/data-save-control/} for more info\r\n * @since 5.7.0\r\n */\r\nexport class DataSaveControl extends DropdownListControl {\r\n\tpublic static className: string = \"DataSaveControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([DataSaveControl.className]);\r\n\r\n\tdeclare public _settings: IDataSaveControlSettings;\r\n\tdeclare public _privateSettings: IDataSaveControlPrivate;\r\n\tdeclare public _events: IDataSaveControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.setPrivate(\"storageId\", window.location.href + \"-\" + this.root.dom.id);\r\n\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst dropdown = this.getPrivate(\"dropdown\")!;\r\n\r\n\t\t// Load local storage\r\n\t\tif (localStorage && localStorage.getItem(this._getStorageId(\"autosave\")) == \"1\") {\r\n\t\t\tthis.root.events.once(\"frameended\", () => {\r\n\t\t\t\tthis.restoreData();\r\n\t\t\t\tthis.set(\"autoSave\", true);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tdropdown.events.on(\"changed\", (ev) => {\r\n\t\t\tif (ev.item.id == \"autosave\") {\r\n\t\t\t\tconst autoSave = !ev.item.checked;\r\n\t\t\t\tthis.set(\"autoSave\", autoSave);\r\n\t\t\t\tif (autoSave) {\r\n\t\t\t\t\tthis.saveData();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdropdown.events.on(\"invoked\", (ev) => {\r\n\t\t\tif (ev.item.id == \"save\") {\r\n\t\t\t\tthis.saveData();\r\n\t\t\t}\r\n\t\t\telse if (ev.item.id == \"restore\") {\r\n\t\t\t\tthis.restoreData();\r\n\t\t\t}\r\n\t\t\telse if (ev.item.id == \"clear\") {\r\n\t\t\t\tthis.clearData();\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", () => {\r\n\t\t\tthis._populateInputs();\r\n\t\t});\r\n\r\n\t\tstockChart.events.on(\"drawingsupdated\", (_ev) => {\r\n\t\t\tif (this.get(\"autoSave\")) {\r\n\t\t\t\tthis.saveData();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tstockChart.events.on(\"indicatorsupdated\", (_ev) => {\r\n\t\t\tif (this.get(\"autoSave\")) {\r\n\t\t\t\tthis.saveData();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\r\n\t\tif (this.isDirty(\"autoSave\") && localStorage) {\r\n\t\t\tconst autoSave = this.get(\"autoSave\", false);\r\n\t\t\tif (autoSave) {\r\n\t\t\t\tlocalStorage.setItem(this._getStorageId(\"autosave\"), \"1\");\r\n\t\t\t\t//this.saveData();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlocalStorage.removeItem(this._getStorageId(\"autosave\"));\r\n\t\t\t\t//this.clearData();\r\n\t\t\t}\r\n\t\t\tthis._populateInputs();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic saveData(): void {\r\n\t\tif (localStorage) {\r\n\t\t\tconst drawingControl = this._getDrawingControl();\r\n\t\t\tconst indicatorControl = this._getIndicatorControl();\r\n\t\t\tconst drawings = drawingControl.serializeDrawings(\"string\", \"  \") as string;\r\n\t\t\tconst indicators = indicatorControl.serializeIndicators(\"string\", \"  \") as string;\r\n\t\t\tif (drawings == \"[]\") {\r\n\t\t\t\tlocalStorage.removeItem(this._getStorageId(\"drawings\"));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlocalStorage.setItem(this._getStorageId(\"drawings\"), drawings);\r\n\t\t\t}\r\n\t\t\tif (indicators == \"[]\") {\r\n\t\t\t\tlocalStorage.removeItem(this._getStorageId(\"indicators\"));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlocalStorage.setItem(this._getStorageId(\"indicators\"), indicators);\r\n\t\t\t}\r\n\t\t\tthis.events.dispatch(\"saved\", {\r\n\t\t\t\ttarget: this,\r\n\t\t\t\ttype: \"saved\",\r\n\t\t\t\tdrawings: drawings,\r\n\t\t\t\tindicators: indicators\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic restoreData(): void {\r\n\t\tif (localStorage) {\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tstockChart.panels.each((panel) => {\r\n\t\t\t\tpanel.drawings.each((drawing) => {\r\n\t\t\t\t\tdrawing.data.clear();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tstockChart.indicators.clear();\r\n\r\n\t\t\tconst drawingControl = this._getDrawingControl();\r\n\t\t\tconst indicatorControl = this._getIndicatorControl();\r\n\t\t\tconst drawings = localStorage.getItem(this._getStorageId(\"drawings\")) || \"[]\";\r\n\t\t\tconst indicators = localStorage.getItem(this._getStorageId(\"indicators\")) || \"[]\";\r\n\r\n\t\t\tdrawingControl.unserializeDrawings(drawings);\r\n\t\t\tindicatorControl.unserializeIndicators(indicators);\r\n\t\t\tthis.events.dispatch(\"restored\", {\r\n\t\t\t\ttarget: this,\r\n\t\t\t\ttype: \"restored\",\r\n\t\t\t\tdrawings: drawings,\r\n\t\t\t\tindicators: indicators\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clearData(): void {\r\n\t\tif (localStorage) {\r\n\t\t\tlocalStorage.removeItem(this._getStorageId(\"drawings\"));\r\n\t\t\tlocalStorage.removeItem(this._getStorageId(\"indicators\"));\r\n\t\t\tthis.events.dispatch(\"cleared\", {\r\n\t\t\t\ttarget: this,\r\n\t\t\t\ttype: \"cleared\"\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Save\");\r\n\t}\r\n\r\n\tprotected _populateInputs(): void {\r\n\t\tconst dropdown = this.getPrivate(\"dropdown\")!;\r\n\t\tconst items = dropdown.get(\"items\", []);\r\n\t\tconst autoSave = this.get(\"autoSave\", false);\r\n\t\tconst isSavedData = localStorage && (localStorage.getItem(this._getStorageId(\"drawings\")) !== null || localStorage.getItem(this._getStorageId(\"indicators\")) !== null);\r\n\t\t$array.each(items, (item) => {\r\n\t\t\tif (!localStorage) {\r\n\t\t\t\titem.disabled = true;\r\n\t\t\t}\r\n\t\t\telse if (item.id == \"restore\") {\r\n\t\t\t\titem.disabled = autoSave || !isSavedData;\r\n\t\t\t}\r\n\t\t\telse if (item.id == \"clear\") {\r\n\t\t\t\titem.disabled = !isSavedData;\r\n\t\t\t}\r\n\t\t\telse if (item.id == \"save\") {\r\n\t\t\t\titem.disabled = autoSave;\r\n\t\t\t}\r\n\t\t\telse if (item.id == \"autosave\") {\r\n\t\t\t\titem.checked = autoSave;\r\n\t\t\t}\r\n\t\t})\r\n\t\tdropdown.rebuildList();\r\n\t}\r\n\r\n\tprotected _getStorageId(bucket: string): string {\r\n\t\treturn \"am5-stock-\" + this.get(\"storageId\", this.getPrivate(\"storageId\", \"\")) + \"-\" + bucket;\r\n\t}\r\n\r\n\tprotected _getDrawingControl(): DrawingControl {\r\n\r\n\t\tlet drawingControl: DrawingControl | undefined = this.getPrivate(\"drawingControl\");\r\n\t\tif (drawingControl) {\r\n\t\t\treturn drawingControl;\r\n\t\t}\r\n\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tdrawingControl = stockChart.getControl(\"DrawingControl\") as DrawingControl;\r\n\t\tif (!drawingControl) {\r\n\t\t\tdrawingControl = DrawingControl.new(this.root, {\r\n\t\t\t\tstockChart: stockChart\r\n\t\t\t});\r\n\t\t\tthis.setPrivate(\"drawingControl\", drawingControl);\r\n\t\t}\r\n\t\treturn drawingControl;\r\n\t}\r\n\r\n\tprotected _getIndicatorControl(): IndicatorControl {\r\n\r\n\t\tlet indicatorControl: IndicatorControl | undefined = this.getPrivate(\"indicatorControl\");\r\n\t\tif (indicatorControl) {\r\n\t\t\treturn indicatorControl;\r\n\t\t}\r\n\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tindicatorControl = stockChart.getControl(\"IndicatorControl\") as IndicatorControl;\r\n\t\tif (!indicatorControl) {\r\n\t\t\tindicatorControl = IndicatorControl.new(this.root, {\r\n\t\t\t\tstockChart: stockChart\r\n\t\t\t});\r\n\t\t\tthis.setPrivate(\"indicatorControl\", indicatorControl);\r\n\t\t}\r\n\t\treturn indicatorControl;\r\n\t}\r\n\r\n}","import type { IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport { ValueAxis } from \"../../xy/axes/ValueAxis\";\r\nimport { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\nimport { DataSaveControl } from \"./DataSaveControl\";\r\nimport * as $array from \"../../../core/util/Array\";\r\n\r\nexport interface ISettingsControlItem extends IDropdownListItem {\r\n}\r\n\r\nexport interface ISettingsControlSettings extends IDropdownListControlSettings {\r\n\t/**\r\n\t * If set to `true`, all changes to chart's drawings and indicators will be\r\n\t * automatically saved to browser local storage and restored on next load.\r\n\t *\r\n\t * @default false\r\n\t *\r\n\t * @since 5.4.3\r\n\t */\r\n\tautoSave?: boolean;\r\n\r\n\t/**\r\n\t * A unique indentifier for local storage.\r\n\t *\r\n\t * Will try to use chart's container ID if not set.\r\n\t *\r\n\t * Consider setting it if you have multipl [[StockChart]] on the same page.\r\n\t *\r\n\t * @since 5.4.3\r\n\t */\r\n\tstorageId?: string;\r\n}\r\n\r\nexport interface ISettingsControlPrivate extends IDropdownListControlPrivate {\r\n\tdataSaveControl?: DataSaveControl;\r\n}\r\n\r\nexport interface ISettingsControlEvents extends IDropdownListControlEvents {\r\n}\r\n\r\n/**\r\n * A control that is used to change type of the main series of the [[StockChart]].\r\n */\r\nexport class SettingsControl extends DropdownListControl {\r\n\tpublic static className: string = \"SettingsControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([SettingsControl.className]);\r\n\r\n\tdeclare public _settings: ISettingsControlSettings;\r\n\tdeclare public _privateSettings: ISettingsControlPrivate;\r\n\tdeclare public _events: ISettingsControlEvents;\r\n\r\n\tprotected _afterNew() {\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst dropdown = this.getPrivate(\"dropdown\")!;\r\n\t\tdropdown.events.on(\"changed\", (ev) => {\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\t\tif (stockSeries) {\r\n\t\t\t\tif (ev.item.id == \"y-scale\") {\r\n\t\t\t\t\tif (ev.item.value == \"percent\") {\r\n\t\t\t\t\t\tstockChart.setPercentScale(true);\r\n\t\t\t\t\t\tthis._setLogarithmic(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tstockChart.setPercentScale(false);\r\n\t\t\t\t\t\tthis._setLogarithmic(ev.item.value == \"logarithmic\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if (ev.item.id == \"fills\") {\r\n\t\t\t\t\tthis._setFills((<any>ev).checked)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (ev.item.id == \"autosave\") {\r\n\t\t\t\tconst autoSave = (<any>ev).checked;\r\n\t\t\t\tlet dataSaveControl = this.getPrivate(\"dataSaveControl\")!;\r\n\t\t\t\tdataSaveControl.set(\"autoSave\", autoSave);\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\tthis.on(\"active\", () => {\r\n\t\t\tthis._populateInputs();\r\n\t\t});\r\n\r\n\t\tthis._disposers.push(this.root.events.on(\"frameended\", () => {\r\n\t\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\t\tconst serializableTools = (stockChart.getControl(\"IndicatorControl\") || stockChart.getControl(\"DrawingControl\")) ? true : false;\r\n\t\t\tlet dataSaveControl = stockChart.getControl(\"DataSaveControl\");\r\n\r\n\t\t\tif (!serializableTools) {\r\n\t\t\t\tconst exclude: any = dropdown.get(\"exclude\", []);\r\n\t\t\t\texclude.push(\"save\");\r\n\t\t\t\texclude.push(\"autosave\");\r\n\t\t\t\tdropdown.set(\"exclude\", [\"save\", \"autosave\"]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!dataSaveControl) {\r\n\t\t\t\t\tdataSaveControl = DataSaveControl.new(this.root, {\r\n\t\t\t\t\t\tstockChart: stockChart,\r\n\t\t\t\t\t\tautoSave: this.get(\"autoSave\", false),\r\n\t\t\t\t\t\tstorageId: this.get(\"storageId\")\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tthis.setPrivate(\"dataSaveControl\", dataSaveControl as DataSaveControl);\r\n\t\t\t\tthis.set(\"autoSave\", (dataSaveControl as DataSaveControl).get(\"autoSave\"));\r\n\t\t\t\tthis._populateInputs();\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t}\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Settings\");\r\n\t}\r\n\r\n\tprotected _populateInputs(): void {\r\n\r\n\t\t// Axes-related stuff\r\n\t\tconst button = this.getPrivate(\"button\")!;\r\n\t\tconst inputs = button.getElementsByTagName(\"input\");\r\n\t\tconst currentScale = this._getYScale();\r\n\t\tfor (let i = 0; i < inputs.length; i++) {\r\n\t\t\tconst input = inputs[i];\r\n\t\t\tswitch (input.id) {\r\n\t\t\t\tcase \"am5stock-list-autosave\":\r\n\t\t\t\t\tinput.checked = this.get(\"autoSave\", this.getPrivate(\"dataSaveControl\")!.get(\"autoSave\", false));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"am5stock-list-fills\":\r\n\t\t\t\t\tinput.checked = this._getFillEnabled()\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"am5stock-list-y-scale-percent\":\r\n\t\t\t\tcase \"am5stock-list-y-scale-regular\":\r\n\t\t\t\tcase \"am5stock-list-y-scale-logarithmic\":\r\n\t\t\t\t\tinput.checked = input.value == currentScale;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprotected _getFillEnabled(): boolean {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\tif (stockSeries) {\r\n\t\t\tconst xAxis = stockSeries.get(\"xAxis\");\r\n\t\t\tconst fills = xAxis.get(\"renderer\").axisFills.values;\r\n\t\t\treturn (fills.length > 0) && fills[0].get(\"visible\", false);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected _getYScale(): \"percent\" | \"regular\" | \"logarithmic\" {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\tif (stockSeries) {\r\n\t\t\tconst yAxis = stockSeries.get(\"yAxis\");\r\n\t\t\tif (yAxis instanceof ValueAxis) {\r\n\t\t\t\tif (stockSeries.get(\"valueYShow\") == \"valueYChangeSelectionPercent\") {\r\n\t\t\t\t\treturn \"percent\";\r\n\t\t\t\t}\r\n\t\t\t\tif (yAxis.get(\"logarithmic\")) {\r\n\t\t\t\t\treturn \"logarithmic\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"regular\";\r\n\t}\r\n\r\n\tprotected _setLogarithmic(value: boolean): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tconst stockSeries = stockChart.get(\"stockSeries\");\r\n\t\tif (stockSeries) {\r\n\t\t\tconst yAxis = stockSeries.get(\"yAxis\");\r\n\t\t\tif (yAxis instanceof ValueAxis) {\r\n\r\n\t\t\t\t$array.each(yAxis.series, (series) => {\r\n\t\t\t\t\tseries.resetExtremes();\r\n\t\t\t\t\tseries.markDirtyValues();\r\n\t\t\t\t})\r\n\r\n\t\t\t\tyAxis.set(\"logarithmic\", value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setFills(enabled: boolean): void {\r\n\t\tconst stockChart = this.get(\"stockChart\");\r\n\t\tstockChart.panels.each((panel) => {\r\n\t\t\tpanel.xAxes.each((xAxis) => {\r\n\t\t\t\txAxis.get(\"renderer\").axisFills.template.set(\"visible\", enabled);\r\n\t\t\t\txAxis.get(\"renderer\").grid.template.set(\"forceHidden\", enabled);\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n}","import type { IDropdownListItem } from \"./DropdownList\";\r\n\r\nimport { DropdownListControl, IDropdownListControlSettings, IDropdownListControlPrivate, IDropdownListControlEvents } from \"./DropdownListControl\";\r\nimport { StockIcons } from \"./StockIcons\";\r\n\r\nexport interface IComparisonControlSettings extends IDropdownListControlSettings {\r\n\titems?: Array<string | IDropdownListItem>;\r\n}\r\n\r\nexport interface IComparisonControlPrivate extends IDropdownListControlPrivate {\r\n}\r\n\r\nexport interface IComparisonControlEvents extends IDropdownListControlEvents {\r\n}\r\n\r\n/**\r\n * A control that is used to change type of the main series of the [[StockChart]].\r\n */\r\nexport class ComparisonControl extends DropdownListControl {\r\n\tpublic static className: string = \"ComparisonControl\";\r\n\tpublic static classNames: Array<string> = DropdownListControl.classNames.concat([ComparisonControl.className]);\r\n\r\n\tdeclare public _settings: IComparisonControlSettings;\r\n\tdeclare public _privateSettings: IComparisonControlPrivate;\r\n\tdeclare public _events: IComparisonControlEvents;\r\n\r\n\tprotected _getDefaultIcon(): SVGElement {\r\n\t\treturn StockIcons.getIcon(\"Comparison\");\r\n\t}\r\n\r\n}","\"use strict\";\nif (typeof Object.assign !== \"function\") {\n    Object.assign = function (target) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (!target) {\n            throw TypeError(\"Cannot convert undefined or null to object\");\n        }\n        var _loop_1 = function (source) {\n            if (source) {\n                Object.keys(source).forEach(function (key) { return (target[key] = source[key]); });\n            }\n        };\n        for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n            var source = args_1[_a];\n            _loop_1(source);\n        }\n        return target;\n    };\n}\n","import * as m from \"./../../dist/es2015/stock.js\";\nexport const am5stock = m;"],"names":["PanelControls","Container","this","children","push","Button","new","_root","themeTags","icon","Graphics","_afterNew","super","upButton","downButton","events","on","get","moveDown","moveUp","closeButton","close","expandButton","expand","classNames","concat","className","StockIcons","getIcon","id","icons","_getSVG","svg","document","createElementNS","setAttribute","viewbox","path","appendChild","style","StockChartDefaultTheme","Theme","setupDefaultRules","l","language","r","rule","bind","verticalLayout","ic","interfaceColors","setAll","paddingLeft","paddingRight","paddingTop","paddingBottom","width","height","layout","percentScaleSeriesSettings","valueYShow","openValueYShow","highValueYShow","lowValueYShow","percentScaleValueAxisSettings","numberFormat","interpolationDuration","extraMax","strictMinMaxSelection","autoSetPercentScale","drawingSelectionEnabled","panY","wheelY","panX","minHeight","states","create","p0","visible","wheelZoomPositionX","clickTarget","fontSize","marginLeft","marginRight","marginTop","marginBottom","useLastColorForLegendMarker","forceHidden","strokeOpacity","strokeDasharray","fillOpacity","cornerRadiusBL","cornerRadiusBR","cornerRadiusTL","cornerRadiusTR","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowBlur","interactive","centerY","fill","cursorOverStyle","opposite","pan","position","x","y","centerX","layer","horizontalLayout","opacity","scale","strokeWidth","draw","display","moveTo","lineTo","drawCircle","angleStep","angle","dAngle","i","Math","cos","sin","autoOpenSettings","field","selectorPadding","radius","stateRule","draggable","crisp","hoverRule","minWidth","textAlign","isMeasured","sequence","colors","populateText","text","legendLabelText","legendValueText","stroke","adapters","add","target","dataItem","dataContext","volumeColor","name","shortName","seriesColor","type","period","offset","fastColor","fastPeriod","deviation","depth","upperColor","lowerColor","shift","shiftType","increasingColor","decreasingColor","signalColor","signalPeriod","useVolume","movingAverageType","slowPeriod","standardDeviations","factor","smaPeriod","overSold","overBought","overSoldColor","overBoughtColor","smaColor","kSmoothing","dSmoothing","slowColor","dPeriod","emaPeriod","emaColor","limitMoveValue","positiveColor","negativeColor","upColor","downColor","Color","fromHex","countType","count","axisWidth","valueArea","valueAreaOpacity","set","active","translateAny","scrollable","fixedLabel","searchable","indicators","drawingIcons","svgPath","fillDisabled","tool","tools","togglable","strokeColor","strokeWidths","strokeDasharrays","showExtension","fillColor","labelFill","labelFontSize","labelFontSizes","labelFontWeight","labelFontStyle","labelFontFamily","labelFontFamilies","drawingIcon","snapToData","useOpacity","description","minDate","maxDate","periods","timeUnit","maxSearchItems","items","currentItem","label","interval","ColorSet","form","value","autoSave","subLabel","labelText","labelVolumeText","StockControl","Entity","controls","_defaultThemes","_afterNewApplyThemes","_initElements","_applyClassNames","_maybeMakeAccessible","addDisposer","button","createElement","setPrivate","_getIcon","innerHTML","_disposers","ev","_handleClick","isEnabled","dispatch","originalEvent","getPrivate","userIcon","_getDefaultIcon","_beforeChanged","isDirty","_setLabel","isPrivateDirty","_dispose","hide","show","isAccessible","tabindex","toString","getAttribute","_t","activeElement","keyCode","click","toolbar","Dropdown","isOpen","preventDefault","container","stopPropagation","arrow","parent","_sizeItems","root","onPrivate","maxHeight","overflow","toolbarContainer","round","getBoundingClientRect","right","abs","toggle","DropdownColors","_setupKeyboardNav","list","_initItems","cs","item","addItem","_initOpacity","color","currentColor","hex","background","toCSS","_ev","currentOpacity","hr","indexOf","dir","_getActiveItems","selected","querySelectorAll","index","length","forEach","key","rules","element","_prefix","hover","textDisabled","border","bg","link","disposer","StyleRule","nonce","undefined","dispose","increment","ColorControl","dropdownSettings","control","dropdown","setTimeout","backgroundColor","loadDefaultCSS","setColor","setOpacity","StockToolbarCSS","dom","SettingsModal","Modal","openIndicator","_settingsTarget","initContent","_editableSettings","openSeries","series","stockChart","isline","LineSeries","settings","CandlestickSeries","columns","column","getIndex","additionalKeys","currentValue","lookup","template","invalidateTarget","options","strokes","fills","_updatedSettings","content","clear","title","table","populateDefaults","defaults","settingInputs","settingsWithTarget","prevLine","prevName","setting","_getSettingKey","keyTarget","getDropdown","input","option","selectedIndex","extTarget","getNumber","minValue","Number","getColor","getCheckbox","line","heading","cell","resetLink","checked","saveButton","targetKey","split","pop","additionalKey","markDirtyValues","cancelButton","cancel","open","focus","optionElement","extTargetValue","extTargetMinValue","_setting","settingsTarget","_colorControl","StockChart","List","SpriteResizer","_settings","XYChartDefaultTheme","tooltipContainer","e","deleteSelectedDrawings","unselectDrawings","cancelDrawing","spriteResizer","panelsContainer","panels","onAll","change","oldValues","chart","_removePanel","moveValue","newValue","_processPanel","setIndex","insertIndex","Error","oldValue","indicator","_removeIndicator","_processIndicator","setPrivateRaw","license","licenses","match","_licenseApplied","_showBranding","settingsModal","markDirtyDrawings","_drawingsChanged","markDirty","markDirtyIndicators","_indicatorsChanged","toggleDrawing","enabled","each","panel","isType","_prepareChildren","enableDrawingSelection","enableErasing","disableErasing","volumeSeries","_markDirtyKey","stockSeries","previous","_prevSettings","_setSoft","mainChart","xAxis","xAxes","_syncExtremesDp","_baseDP","baseInterval","_syncExtremes","setPercentScale","_afterChanged","_updateChildren","volumePanel","event","stockNegativeColor","stockPositiveColor","dataItems","dropFromOpen","riseFromOpen","dropFromPrevious","riseFromPrevious","_applyGraphicsStates","percentScale","seriesSettings","axisSettings","yAxis","_maybePrepAxisDefaults","seriesList","_maybePrepSeriesDefaults","apply","seriesDefaults","markDataDirty","addComparingSeries","comparingSeriesSettings","comparedSeries","legendDataItem","legend","component","data","ldi","removeComparingSeries","removeValue","_val","getSeriesDefault","axis","prepareData","_updateControls","panelControls","len","_updateResizers","values","topPlotContainer","stockPanel","resizer","Rectangle","panelResizer","chartsContainer","_downResizer","_downY","toLocal","point","upperChart","_upperPanel","_uhp","_dhp","max","lowerChart","min","downY","dhp","uhp","diff","_removeXAxis","_processXAxis","leftAxesContainer","_syncYAxesSize","rightAxesContainer","hidden","maxLeft","maxRight","lw","rw","toolsContainer","_axis","_xAxes","_skipSync","_syncXAxes","once","mainAxis","axisMin","axisMax","_customDates","_dates","getVolumeColor","stockDataItem","previousClose","getControl","found","_dragStartDrawing","_dragStart","_dragStopDrawing","_dragStop","drawingsInteractive","except","setInteractive","deleteSelected","selectDrawing","keepSelection","unselectDrawing","deleteDrawing","registerClass","ref","Indicator","_sDP","_markDataDirty","_vDP","setCustomData","_dataDirty","_updateSeriesColor","markDirtySelectionExtremes","disposeDataItem","duration","Promise","all","_handleLegend","settingsButton","editableSettings","contextName","BaseColumnSeries","toCSSHex","customData","_getValue","o","h","c","_getDataArray","valueX","value_y","_getTypicalPrice","_sma","toField","ma","valueToRemove","_wma","sum","m","k","n","pValue","_ema","multiplier","_dema","ema2","ema","_tema","ema3","StockLegend","Legend","Template","_new","closeButtons","settingsButtons","makeCloseButton","make","makeSettingsButton","unhover","processDataItem","itemContainer","_setDataItem","StockPanel","XYChart","drawings","removeIndex","oldIndex","newIndex","isVisible","ChartIndicator","seriesChart","_themeTags","addTag","seriesXAxis","xRenderer","AxisRendererX","start","end","GaplessDateAxis","renderer","DateAxis","Tooltip","yRenderer","AxisRendererY","minGridDistance","yAxes","ValueAxis","tooltip","_createSeries","XYCursor","OverboughtOversold","strictMinMax","autoZoom","middle","createAxisRange","makeDataItem","middleGrid","_applyThemes","side","overBoughtRB","plotContainer","_updateRange","AxisBullet","location","sprite","overBoughtRange","overBoughtFills","overBoughtGrid","overSoldRB","overSoldRange","overSoldFills","overSoldGrid","toAxisPosition","positionToValue","valueXField","valueYField","overBoughtLabel","overSoldLabel","middleLabel","numberFormatter","getNumberFormatter","overSoldValue","overBoughtValue","middleValue","format","MovingAverage","groupDataDisabled","calculateAggregates","baseDuration","firstTime","lastTime","newX","Momentum","prevValue","valueY","VWAP","Infinity","totalVolume","totalVW","volumeDI","volume","vw","volumeToRemove","vwToRemove","vwap","MovingAverageEnvelope","upperBandSeries","openValueYField","lowerBandSeries","smaData","upper","lower","MovingAverageDeviation","ColumnSeries","increasing","decreasing","unit","deviationColor","AccelerationBands","low","high","_lower","_upper","_average","BollingerBands","mean","stdSum","j","di","diValue","pow","std","sqrt","RelativeStrengthIndex","unshift","smaSeries","averageGain","averageLoss","prevAverageGain","prevAverageLoss","rsi","gain","loss","isNaN","valueS","AccumulationDistribution","setRaw","prevAD","mf","ad","AccumulativeSwingIndex","_axisRangeDI","_axisRange","axisRange","t","asi","swingColor","yDataItem","cy","oy","hl","hc","lc","tr","er","dasi","Aroon","downSeries","li","hi","vh","vl","up","down","MACD","signalSeries","differenceSeries","emaFast","emaSlow","macd","p","signal","difference","differenceColor","MACross","fastSeries","ChaikinMoneyFlow","mfv","cmf","ChaikinOscillator","BullBearPower","bbp","OnBalanceVolume","obv","PVT","pvt","StochasticOscillator","slowSeries","lp","hp","StochasticMomentumIndex","emaSeries","kPeriod","hhh","dhl","d","hhh_ema2","dhl_ema2","AwesomeOscillator","po","sma5","sma34","ao","oscillatorColor","WilliamsR","Volume","VolumeProfile","val","step","panelXAxis","grid","labels","zoomable","snapTooltip","openValueXField","upSeries","_addInteractivity","_previousColumn","updateLegendValue","area","startIndex","endIndex","rows","floor","ceil","rowDataDown","rowDataUp","previousDataItem","volumeDataItem","dataDown","total","yOpen","xOpen","dataUp","highest","cd","cu","dlen","rowAbove1","sumAbove","rowBelow1","sumBelow","CommodityChannelIndex","sma","meanDeviation","DisparityIndex","disparity","StandardDeviation","TypicalPrice","typical","Trix","previousValue","trix","MedianPrice","median","ZigZag","zigZagTime","zigZagValue","firstDataItem","goesUp","firstValue","firstHigh","firstLow","time","zigzag","b","skip","lastDataItem","lastValue","lastHigh","lastLow","AverageTrueRange","value_close","value_high","value_low","prevClose","prevATR","valueClose","atr","DrawingSeries","setStateOnChildren","grips","Circle","C","circles","outerCircles","selectors","_tag","strokesTemplate","fillsTemplate","templateField","_getIndex","_erasingEnabled","_disposeIndex","_drawingEnabled","_handlePointerDown","_getStrokeIndex","dragStart","startDragItem","_isDrawing","_selectDrawing","ctrlKey","stopDragItem","_isHover","_showSegmentBullets","bulletsContainer","bullets","_series","_di","dc","strokeTemplate","circle","outerCircle","_addBulletInteraction","_tweakBullet","Bullet","locationX","_handlePointerOver","_handlePointerOut","_getStockChart","markDirtyKey","disposeIndex","drawingId","_key","_pIndex","_dispatchStockEvent","selector","_getSprite","_selected","_afterDataChange","corner","_createElements","_index","_dataItem","_clearDirty","_isSelecting","clearDrawings","_dataItems","userData","bullet","_hideResizer","resizerSprite","unselectAllDrawings","_handleFillDragStart","_handleFillDragStop","_isPointerDown","_dragStartPX","coordinateToPosition","valueXns","_dragStartY","_getYValue","_dvpX","_dvY","valueToPosition","posX","dpx","dy","dvpx","dvy","vpx","vxns","vx","_getXValue","vy","roundTo","_setContext","_setXLocation","_positionBullets","dragStop","_updateSegment","_updateElements","defaultState","_applySettings","fillTemplate","_valuesDirty","_updateSelectors","isDrawing","_selectionWasOn","_getFillTemplate","_getStrokeTemplate","_container","_handleBulletDragged","_isDragging","_handleBulletDragStart","_handleBulletDragStop","_handlePointerClick","_increaseIndex","_drawingId","_generateId","Date","getTime","random","_clickPointerPoint","_placeBulletsContainer","enableDrawing","disableDrawing","_handleBulletDraggedReal","_event","_clickDp","_downDp","_upDp","_handlePointerUp","_moveDp","_movePoint","_handlePointerMove","grip","_movePointerPoint","_setXLocationReal","firstDayOfWeek","locale","utc","timezone","doNotConvert","_snap","baseValueSeries","baseValue","_getBase","working","realValue","getSeriesItem","sprites","force","_unselectDrawing","selectorContainer","indexToDrawingId","_updateSelector","_getContext","context","getContext","PolylineSeries","mainContainer","Line","forceInactive","_endPolyline","_setContextSprite","_drawingLine","_addPoint","closing","_dispatchAdded","movePoint","points","bLastItem","bPoint","closingDataItem","SimpleLineSeries","lines","hitLines","makeLine","makeHitLine","lineTemplate","_lines","strokeIndex","hitTemplate","s","diP1","diP2","p1","p2","p11","p22","_updateLine","hitLine","_hitLines","segments","hitSegments","_handlePointerClickReal","_addPoints","_handlePointerMoveReal","_addTemplates","addPoints","valueYns","_addPointsReal","addLine","RectangleSeries","y1","y2","fillGraphics","makeFill","strokeGraphics","_updateOthers","_fillGraphics","_p1","_p2","_drawFill","ParallelChannelSeries","_firstClick","diP3","diP4","diM1","diM2","_updateMiddlePoints","valueX1","valueX2","valueX3","valueX4","valueY1","valueY2","valueY3","valueY4","xM1","xM2","mBullet","point1","point2","p3","p4","dy1","dy2","LineArrowSeries","Triangle","arrows","child","makeArrow","_changed","di1","di2","w","settings2","HorizontalLineSeries","VerticalLineSeries","AverageSeries","x1","x2","i1","i2","average","number","precision","RegressionSeries","inversed","ii","resultPoints","run","rise","gradient","intercept","map","predict","linear","DoodleSeries","_handleBulletPosition","_panX","_panY","cursor","_down","IconSeries","_e","rotation","_context","_getIconTemplate","iconSvgPath","iconScale","iconCenterX","iconCenterY","bounds","left","bottom","top","LabelSeries","EditableLabel","editOn","_isEditing","_isSelected","_tweakBullet2","_label","_getLabelTemplate","_afterTextSave","_dataContext","fontFamily","fontWeight","fontStyle","_hideAllBullets","labelSettings","CalloutSeries","PointedRectangle","bgSettings","off","_updatePointer","animate","to","from","easing","toGlobal","pointerX","pointerY","_getBgTemplate","EllipseSeries","radiusX","radiusY","Ellipse","ellipses","makeEllipse","ellipse","ellipseTemplate","bDI","tDI","rDI","lDI","positionL","positionR","mx","valueXReal","locationXReal","valueYReal","vwy","valueY0","my","valueX0","positionX0","positionX","mpos","_ellipses","diT","diB","diL","diR","_clickVY","_clickPX","_getEllipseTemplate","pt","pb","pr","pl","rx","ry","TrendLineSeries","QuadrantLineSeries","fill1","fill2","m1y","m2y","m3y","FibonacciSeries","Label","makeLabel","_updateChildrenReal","_labels","_strokes","_fills","markDirtyText","labelArr","fillsArr","strokesArr","remove","makeStroke","_drawStroke","_clearGraphics","FibonacciTimezoneSeries","_updateSegmentReal","open1","open2","endValue","positionToCoordinate","HorizontalRaySeries","Measure","RoundedRectangle","ix","labelBg","iy","value1","value2","percent","time1","time2","intervalCount","div1","div2","intervalUnit","millisecond","second","minute","hour","day","week","month","year","StockToolbar","_initControls","_cssDisposer","DropdownList","_initSearch","rebuildList","exclude","searchBox","placeholder","_filterItems","_currentSelectedIndex","search","searchCallback","maxItems","call","slice","getElementsByTagName","regex","RegExp","innerText","info","inputId","disabled","inputs","isCustomSearch","DrawingToolControl","setTool","_initTools","_getToolIcon","DropdownListControl","itemObject","setItem","cloneNode","setItemById","getItemById","dropdownItems","DropdownControl","html","IconControl","JSON","parse","listIcon","setIcon","_initIcons","_getDrawingIcon","setIconByPath","getIconByPath","stringify","DrawingControl","_initToolbar","_updatePanelBindings","_getSeriesTool","_isInited","strokeControl","fillControl","_resetControls","toolControl","eraserControl","iconControl","snapControl","strokeWidthControl","currentStrokeDasharray","dasharray","join","strokeDasharrayControl","labelFillControl","fontSizes","size","fontSizeControl","boldControl","italicControl","fontFamilies","fontFamilyControl","extensionControl","selectControl","setEraser","clearControl","_setTool","_drawingSeries","_tool","isInited","rootEvents","_setStroke","_setFill","_setExtension","_setDrawingIcon","_setSnap","_currentEnabledSeries","_maybeInitToolSeries","prevPanel","labelFontSizeControl","labelFontFamilyControl","controlElement","initializedPanels","chartSeries","targetSeries","_getPanelMainSeries","toolSettings","toolTemplates","fillShape","pointCount","_updateSeriesBindings","isDisposed","labelTools","snap","replace","serializeDrawings","output","indent","res","panelIndex","serializer","Serializer","includeSettings","maxDepth","row","__parse","json","__tool","__panelIndex","__drawing","serialize","unserializeDrawings","drawing","drawingSeries","Json","then","drawingData","_updateDrawingIndexes","pushAll","IndicatorControl","addIndicator","_initList","supportsIndicator","indicatorId","clearIndicators","eachReverse","callback","modal","serializeIndicators","excludeSettings","__stockSeries","__volumeSeries","_walkParents","__legendIndex","__indicator","unserializeIndicators","walkChildren","HOOKS","_disable","allowInput","allowInvalidPreload","altFormat","altInput","altInputClass","window","navigator","userAgent","ariaDateFormat","autoFillDefaultTime","clickOpens","closeOnSelect","conjunction","dateFormat","defaultHour","defaultMinute","defaultSeconds","disable","disableMobile","enableSeconds","enableTime","errorHandler","err","console","warn","getWeek","givenDate","date","setHours","setDate","getDate","getDay","week1","getFullYear","hourIncrement","ignoredFocusElements","inline","minuteIncrement","mode","monthSelectorType","nextArrow","noCalendar","now","onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition","plugins","positionElement","prevArrow","shorthandCurrentMonth","showMonths","static","time_24hr","weekNumbers","wrap","english","weekdays","shorthand","longhand","months","daysInMonth","ordinal","nth","rangeSeparator","weekAbbreviation","scrollTitle","toggleTitle","amPM","yearAriaLabel","monthAriaLabel","hourAriaLabel","minuteAriaLabel","pad","bool","debounce","fn","wait","_this","args","arguments","clearTimeout","arrayify","obj","Array","toggleClass","elem","classList","tag","textContent","clearNode","node","firstChild","removeChild","findParent","condition","parentNode","createNumberInput","inputClassName","opts","wrapper","numInput","arrowUp","arrowDown","pattern","getEventTarget","composedPath","error","doNothing","monthToStr","monthNumber","revFormat","D","F","dateObj","monthName","setMonth","G","getHours","parseFloat","H","J","K","test","M","shortMonth","S","seconds","setSeconds","U","_","unixSeconds","W","weekNum","weekNumber","parseInt","Y","setFullYear","Z","ISODate","minutes","setMinutes","u","unixMillSeconds","tokenRegex","formats","toISOString","getMonth","getSeconds","getMinutes","String","substring","createDateFormatter","_a","_b","config","_c","l10n","_d","isMobile","frmt","overrideLocale","formatDate","arr","createDateParser","givenFormat","timeless","customLocale","parsedDate","dateOrig","toFixed","datestr","trim","parseDate","matched","ops","matchIndex","regexStr","token","isBackSlash","escaped","exec","compareDates","date1","date2","isBetween","ts","ts1","ts2","calculateSecondsSinceMidnight","hours","parseSeconds","secondsSinceMidnight","DAY","getDefaultHours","minHour","minMinutes","minSeconds","maxHr","maxMinutes","__assign","Object","assign","prototype","hasOwnProperty","__spreadArrays","il","a","jl","DEBOUNCED_CHANGE_MS","FlatpickrInstance","instanceConfig","self","flatpickr","defaultConfig","getClosestActiveElement","calendarContainer","getRootNode","bindToInstance","setCalendarWidth","requestAnimationFrame","visibility","daysContainer","daysWidth","days","offsetWidth","weekWrapper","removeProperty","updateTime","selectedDates","defaultDate","getMilliseconds","latestSelectedDateObj","isKeyDown","eventTarget","curValue","delta","which","isHourElem","hourElement","isMinuteElem","minuteElement","incrementNumInput","timeWrapper","_input","setHoursFromInputs","updateValue","_debouncedChange","secondElement","limitMinHours","minTime","minDateHasTime","limitMaxHours","maxTime","maxDateHasTime","minBound","maxBound","currentTime","result","setHoursFromDate","onYearInput","changeYear","handler","el","addEventListener","_handlers","removeEventListener","triggerChange","triggerEvent","jumpToDate","jumpDate","jumpTo","oldYear","currentYear","oldMonth","currentMonth","message","buildMonthSwitch","redraw","timeIncrement","contains","inputElem","createEvent","dispatchEvent","createDay","_dayNumber","dateIsEnabled","dayElement","$i","todayDateElem","tabIndex","isDateSelected","selectedDateElem","isDateInRange","insertAdjacentHTML","focusOnDayElem","targetNode","onMouseOver","getFirstAvailableDay","startMonth","endMonth","focusOnDay","current","dayFocused","isInView","body","startElem","givenMonth","loopDelta","numMonthDays","changeMonth","getNextAvailableDay","buildMonthDays","firstOfMonth","prevMonthDays","utils","getDaysInMonth","createDocumentFragment","isMultiMonth","prevMonthDayClass","nextMonthDayClass","dayNumber","dayIndex","dayNum","dayContainer","buildDays","frag","shouldBuildMonth","monthsDropdownContainer","buildMonth","monthElement","monthNavFragment","selectedMonth","yearInput","yearElement","buildMonths","monthNav","prevMonthNav","yearElements","monthElements","nextMonthNav","buildWeekdays","weekdayContainer","updateWeekdays","splice","isOffset","_hidePrevMonthArrow","_hideNextMonthArrow","updateNavigationCurrentMonth","isCalendarElem","documentClick","eventTarget_1","isCalendarElement","lostFocus","relatedTarget","isIgnored","some","timeContainer","newYear","newYearNum","isNewYear","dateToCheck","enable","array","parsed","onBlur","isInput","valueChanged","trimEnd","getDateStr","allowKeydown","allowInlineKeydown","blur","isTimeObj","focusAndClose","selectDate","delta_1","currentYearElement","elems","pluginElements","filter","shiftKey","charAt","toLowerCase","cellClass","hoverDate","firstElementChild","initialDate","rangeStartDate","rangeEndDate","containsDisabled","minRange","maxRange","rContainer","dayElem","timestamp","outOfRange","onResize","positionCalendar","minMaxDateSetter","inverseDateObj","removeAttribute","getInputElem","querySelector","setupLocale","l10ns","default","dataset","customPositionElement","_positionElement","calendarHeight","reduce","acc","offsetHeight","calendarWidth","configPos","configPosVertical","configPosHorizontal","inputBounds","distanceFromBottom","innerHeight","showOnTop","pageYOffset","pageXOffset","isCenter","isRight","rightMost","centerMost","doc","editableSheet","styleSheets","sheet","cssRules","head","getDocumentStyleSheet","bodyWidth","centerLeft","centerIndex","centerStyle","insertRule","centerBefore","msMaxTouchPoints","selectedDate","shouldChangeMonth","sort","single","range","loadedPlugins","_bind","_setHoursFromDate","_positionCalendar","triggerChangeEvent","toInitial","mobileInput","_initialDate","_createElement","destroy","lastChild","insertBefore","_type","wasOpen","select","CALLBACKS","setSelectedDate","updatePositionElement","inputDate","dates","parseDateRules","hooks","initEvent","specificFormat","dObj","mobileFormatStr","onMonthNavClick","isPrevMonth","isNextMonth","boolOpts","userConfig","defineProperty","_enable","timeMode","defaultDateFormat","defaultAltFormat","_minDate","_maxDate","minMaxTimeSetter","_minTime","_maxTime","hook","pluginConf","parseConfig","nodeName","required","nextSibling","preloadedDate","setupDates","yr","fragment","__hidePrevMonthArrow","__hideNextMonthArrow","innerContainer","buildWeeks","separator","hourInput","minuteInput","military2ampm","secondInput","buildTime","customAppend","appendTo","nodeType","build","evt","inputType","defaultValue","setupMobile","debouncedResize","ontouchstart","capture","bindEvents","isSafari","init","_flatpickr","nodeList","nodes","HTMLElement","instances","HTMLCollection","NodeList","Node","en","localize","setDefaults","jQuery","fp_incr","DateRangeSelector","_updateInputs","_loadDefaultCSS","_initDropdown","fromColumn","fromGroup","fromLabel","translate","fromField","toColumn","toGroup","toLabel","pickerLocale","_getPickerLocale","fromPicker","_formatDate","_parseDate","toPicker","buttons","buttonsColumn","_getAxis","_updateLabel","_updatePickers","zoomToDates","fromDate","toDate","dateFormatter","_getDateFormat","translateFunc","primary","primary2","StyleSheet","PeriodSelector","_initPeriodButtons","_setPeriodButtonStatus","toUpperCase","_resetActiveButtons","selectPeriod","timeout","_getPeriodButtons","getElementsByClassName","plen","_getChart","_getMaxOrMax","mainDataSetId","dataSet","_dataSets","_getMax","_getMin","fromStart","_highlightPeriod","zoomOut","getGroupInterval","firstDay","startTime","setTime","endTime","_groupChangedDp","_groupChangedTo","SeriesTypeControl","IntervalControl","ResetControl","DataSaveControl","href","localStorage","getItem","_getStorageId","restoreData","saveData","clearData","_populateInputs","removeItem","drawingControl","_getDrawingControl","indicatorControl","_getIndicatorControl","isSavedData","bucket","SettingsControl","_setLogarithmic","_setFills","serializableTools","dataSaveControl","storageId","currentScale","_getYScale","_getFillEnabled","axisFills","resetExtremes","ComparisonControl","_i","TypeError","_loop_1","source","keys","args_1","am5stock"],"sourceRoot":""}